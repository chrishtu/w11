var Yn=Object.defineProperty;var Jn=(e,c,v)=>c in e?Yn(e,c,{enumerable:!0,configurable:!0,writable:!0,value:v}):e[c]=v;var Nt=(e,c,v)=>(Jn(e,typeof c!="symbol"?c+"":c,v),v);(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))b(x);new MutationObserver(x=>{for(const k of x)if(k.type==="childList")for(const S of k.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&b(S)}).observe(document,{childList:!0,subtree:!0});function v(x){const k={};return x.integrity&&(k.integrity=x.integrity),x.referrerpolicy&&(k.referrerPolicy=x.referrerpolicy),x.crossorigin==="use-credentials"?k.credentials="include":x.crossorigin==="anonymous"?k.credentials="omit":k.credentials="same-origin",k}function b(x){if(x.ep)return;x.ep=!0;const k=v(x);fetch(x.href,k)}})();const Zn="imgs/icons/Apps/";function Re(e){return Zn+e}const Q={settings:{name:"settings",productName:"Settings",icon:Re("settings.png")},notepad:{name:"notepad",productName:"NotePad",icon:Re("notepad.png")},explorer:{name:"explorer",productName:"File Explorer",icon:Re("explorer.png")},word:{name:"word",productName:"Word",icon:Re("word.png")},powerpoint:{name:"powerpoint",productName:"PowerPoint",icon:Re("powerpoint.png")},onenote:{name:"onenote",productName:"OneNote",icon:Re("onenote.png")},mail:{name:"mail",productName:"Mail",icon:Re("mail.png")},todo:{name:"todo",productName:"To Do",icon:Re("todo.png")},store:{name:"store",productName:"Store",icon:Re("store.png")},photos:{name:"photos",productName:"Photos (Demo)",icon:Re("photos.png")},yourphone:{name:"yourphone",productName:"Your Phone",icon:Re("yourphone.png")},whiteboard:{name:"whiteboard",productName:"White Board",icon:Re("whiteboard.png")},calculator:{name:"calculator",productName:"Calculator",icon:Re("calculator.png")},spotify:{name:"spotify",productName:"Spotify",icon:Re("spotify.png")},twitter:{name:"twitter",productName:"Twitter",icon:Re("twitter.png")},vscode:{name:"vscode",productName:"VS Code",icon:Re("vscode.png")},terminal:{name:"terminal",productName:"Terminal",icon:Re("terminal.png")},cmd:{name:"cmd",productName:"Command Promt",icon:Re("terminal.png")},github:{name:"github",productName:"GitHub",icon:Re("github.png")},discord:{name:"discord",productName:"Discord",icon:Re("discord.png")}},Qn=Object.keys(Q).map(e=>Q[e]);function er(e,c){return e.name>c.name?1:e.name<c.name?-1:0}function tr(){const e=Qn.sort(er),c={},v=e.length;for(let b=0;b<v;b++){const x=e[b];let k=x.name.substring(0,1).toUpperCase();/[A-Z]/.test(k)||(/[0-9]/.test(k)?k="#":k="&"),c[k]||(c[k]=[]),c[k].push(x)}return c}const yt={photoViewer:{name:"photoViewer",productName:"Photos Viewer",icon:Re("photos.png")},mediaPlayer:{name:"mediaPlayer",productName:"Media Player",icon:Re("media-player.png")}};function nt(e,c){typeof c>"u"||c===null||(c instanceof HTMLElement?e.appendChild(c):c instanceof Array?Dt(e,c):e.appendChild(document.createTextNode(c.toString())))}function Dt(e,c){c instanceof Array?c.forEach(v=>{nt(e,v)}):nt(e,c)}function ge(e,c){for(let v in c)v.indexOf("-")>-1?e.style.setProperty(v,c[v]):v==="myBackgroundImage"?Fi(c[v],b=>{e.style.backgroundImage=`url(${b})`}):e.style[v]=c[v]}function zs(e){for(let c of e){if(c.children.length>0){const v=Array.from(c.children);zs(v)}ye(c.onBeforeRemove)&&c.onBeforeRemove()}}Element.prototype.remove=function(){var v;const e=Array.from(this.children);zs(e);const c=this;ye(c.onBeforeRemove)&&c.onBeforeRemove(),(v=this.parentElement)==null||v.removeChild(this)};function _(e,c,v){let b=document.createElement(e);function x(k){Fi(k,S=>{b.src=S})}if((e==="img"||e==="audio"||e==="video")&&Object.defineProperty(b,"mySrc",{set:function(k){x(k)}}),c){const k=c;for(let S in k)if(S==="style"){const n=k[S];ge(b,n)}else if(S==="mySrc"){const n=k[S];x(n)}else if(S.indexOf("-")>-1||S.indexOf(":")>-1){const n=k[S];b.setAttribute(S,n)}else b[S]=k[S]}return v&&Dt(b,v),Object.defineProperty(b.style,"myBackgroundImage",{set:function(k){Fi(k,S=>{b.style.backgroundImage=`url(${S})`})}}),b}function at(e){let c=e.firstChild;for(;c;)c.remove(),c=e.firstChild}function Fi(e,c){Xe(e)?cs(e,(v,b)=>{if(v)c(null);else{const x=URL.createObjectURL(b);c(x)}}):c(e)}function ir(e){let c;const v=Object.create(null);v.width=0,e.color&&(v.backgroundColor=e.color);let b=_("div",{className:"progress"},c=_("div",{className:"progress-value",style:v}));function x(k){c.style.width=k/e.maxValue*100+"%"}return{element:b,setValue:x}}const Ws=`
<svg aria-hidden="true" version="1.1" viewbox="0 0 10 10" width="10" height="10" class="svg-fill">
<path d="M 0,5 10,5 10,6 0,6 Z"></path>
</svg>
`,zi=`
<svg aria-hidden="true" version="1.1" viewbox="0 0 10 10" width="10" height="10" class="svg-fill">
<path d="m 2,1e-5 0,2 -2,0 0,8 8,0 0,-2 2,0 0,-8 z m 1,1 6,0 0,6 -1,0 0,-5 -5,0 z m -2,2 6,0 0,6 -6,0 z"></path>
</svg>
`,Wi=`
<svg aria-hidden="true" version="1.1" viewbox="0 0 10 10" width="10" height="10" class="svg-fill">
<path d="M 0,0 0,10 10,10 10,0 Z M 1,1 9,1 9,9 1,9 Z"></path>
</svg>
`,$s=`
<svg aria-hidden="true" version="1.1" viewbox="0 0 10 10" width="10" height="10" class="svg-fill">
<path d="M 0,0 0,0.7 4.3,5 0,9.3 0,10 0.7,10 5,5.7 9.3,10 10,10 10,9.3 5.7,5 10,0.7 10,0 9.3,0 5,4.3 0.7,0 Z"></path>
</svg>
`;function sr(e){const c={};e&&(c.backgroundImage=`url("${e}")`);let v=_("div",{className:"window-titlebar-icon flex content-center items-center flex-shrink-0",style:c});function b(x){G(x)&&(v.style.backgroundImage=`url("${x}")`)}return{element:v,setWindowIcon:b}}const nr={window:{titlebar:{buttons:{minimize:"Minimize",maximize:"Restore Down",maximizeDown:"Maximize",close:"Close"}}}},rr={window:{titlebar:{buttons:{minimize:"Thu gọn",maximize:"Thu nhỏ",maximizeDown:"Phóng to",close:"Đóng"}}}},or={"en-us":nr,"vi-vn":rr};function ar(e){return or[e]}function lr(e,c){const v=ar("en-us");let b=n(e.isMaximized),x=_("div",{title:b.title,className:"window-titlebar-button window-titlebar-maximize-button flex items-center content-center"+(e.disableMaximize?" disabled":""),innerHTML:b.icon,onclick:c.onMaximizeButtonClick}),k=_("div",{className:"window-titlebar-buttons flex"},[_("div",{title:v.window.titlebar.buttons.minimize,className:"window-titlebar-button window-titlebar-minimize-button flex items-center content-center",innerHTML:Ws,onclick:c.onMinimizeButtonClick}),x,_("div",{title:v.window.titlebar.buttons.close,className:"window-titlebar-button window-titlebar-close-button flex items-center content-center",innerHTML:$s,onclick:c.onCloseButtonClick})]);function S(s){let l=n(s);x.title=l.title,x.innerHTML=s?zi:Wi}function n(s){return{title:s?v.window.titlebar.buttons.maximize:v.window.titlebar.buttons.maximizeDown,icon:s?zi:Wi}}return{element:k,setMaximize:S}}function cr(e,c,v,b){let x,k,S=_("div",{tabIndex:-1,className:"window-title h-full flex items-center"+(e.stretchTitlebarContent?" stretch":""),onfocus:b,oncontextmenu:v,ondblclick:e.disableMaximize?null:c},[_("div",{["drag-region"]:"drag",className:"absolute w-full h-full top left-0"}),e.hideTitle?null:_("div",{className:"window-title-text h-full flex items-center"},x=_("div",{title:e.title,className:"text-ellipsis"},e.title)),k=_("div",{className:"window-titlebar-content flex-1 h-full flex items-center relative"+(G(e.content)?"":" hide")},G(e.content)&&ye(e.content)?e.content():e.content)]);function n(l){G(x)&&(x.title=l,x.textContent=l)}function s(l){at(k),k.classList.remove("hide"),k.appendChild(ye(l)?l():l)}return{element:S,setTitle:n,setContent:s}}function hr(e,c){let v=sr(e.icon),b=cr({title:e.title,hideTitle:e.hideTitle,disableMaximize:e.disableMaximize,content:e.content,stretchTitlebarContent:e.stretchTitlebarContent},c.onDoubleClick,c.onContextMenu,c.onTitleFocus),x=lr({isMaximized:e.maximized,disableMaximize:e.disableMaximize},{onMinimizeButtonClick:c.onMinimizeButtonClick,onMaximizeButtonClick:c.onMaximizeButtonClick,onCloseButtonClick:c.onCloseButtonClick}),k,S=!1;k=_("div",{className:"window-titlebar flex items-center"+(e.hideIcon?" no-icon":"")+(e.hideTitle?" no-title":"")},[v.element,b.element,x.element]),e.autoHide&&(k.addEventListener("mouseover",()=>{S=!0},!1),k.addEventListener("mouseout",()=>{S=!1},!1));function n(p){p?(k.classList.remove("titlebar-fade-in"),S||(k.classList.add("titlebar-fade-out"),c.onHidden&&c.onHidden())):(k.classList.add("titlebar-fade-in"),k.classList.remove("titlebar-fade-out"),c.onVisible&&c.onVisible())}function s(p){S=p}function l(p){p?k.classList.remove("hidden"):k.classList.add("hidden")}return{element:k,titleElem:b.element,setIcon:v.setWindowIcon,setTitle:b.setTitle,setTitlebarContent:b.setContent,setMaximize:x.setMaximize,setVisible:l,setAutoHide:n,setPreventHide:s}}function Us(e,c,v){var b=0,x=0,k=0,S=0;c?c.onmousedown=s:e.onmousedown=s;let n=!1;function s(a){a.button===0&&(a.preventDefault(),k=a.clientX,S=a.clientY,document.onmouseup=p,document.onmousemove=l,G(v)&&ye(v.onDragStart)&&v.onDragStart())}function l(a){b=k-a.clientX,x=S-a.clientY,k=a.clientX,S=a.clientY;let h=e.offsetTop-x,f=e.offsetLeft-b;n=Math.abs(f)>0||Math.abs(h)>0,e.style.top=h+"px",e.style.left=f+"px",G(v)&&ye(v.onDrag)&&v.onDrag({x:a.clientX,y:a.clientY},{top:h,left:f})}function p(){n&&G(v)&&ye(v.onDragEnd)&&v.onDragEnd(e),n=!1,document.onmouseup=null,document.onmousemove=null}}function Ze(e,c,v,b,x){let k=v,S=b,n="default",s="";c.addEventListener("mousedown",T,!1);let l=0,p=0,a=0,h=0,f=0,u=0,d=0,t=0,i=0,o=0,r,m,g,E;function T(C){let D=window.getComputedStyle(e);a=parseInt(D.left),h=parseInt(D.top),f=e.offsetWidth,u=e.offsetHeight,i=parseInt(D.minHeight),o=parseInt(D.minWidth),l=C.clientX,p=C.clientY,window.addEventListener("mousemove",w,!1),window.addEventListener("mouseup",y,!1);var A=C.currentTarget;s=A.dataset.resize,G(x)&&ye(x.onResizeStart)&&x.onResizeStart()}function w(C){let D=C.clientX-l+d,A=C.clientY-p+t;d=0,t=0,l=C.clientX,p=C.clientY;var H=A,N=D;s==="t"?(n="ns-resize",u-H<i?t=H-(A=u-i):h+H<g&&(t=H-(A=g-h)),h+=A,u-=A,k&&(f=Math.round(u*S))):s==="l"?(n="ew-resize",f-N<o?d=N-(D=f-o):a+N<r&&(d=N-(D=r-a)),a+=D,f-=D,k&&(u=Math.round(f/S))):s==="tl"?(n="nw-resize",f-N<o?d=N-(D=f-o):a+N<r&&(d=N-(D=r-a)),a+=D,f-=D,u-H<i?t=H-(A=u-i):h+H<g&&(t=H-(A=g-h)),h+=A,k?Math.abs(D)>Math.abs(A)?u=Math.round(f/S):f=Math.round(u*S):u-=A):s==="b"?(n="ns-resize",u+H<i?t=H-(A=i-u):h+u+H>E&&(t=H-(A=E-h-u)),u+=A,k&&(f=Math.round(u*S))):s==="bl"?(n="ne-resize",f-N<o?d=N-(D=f-o):a+N<r&&(d=N-(D=r-a)),a+=D,f-=D,k?u=Math.round(f/S):(u+H<i?t=H-(A=i-u):h+u+H>E&&(t=H-(A=E-h-u)),u+=A)):s==="r"?(n="ew-resize",f+N<o?d=N-(D=o-f):a+f+N>m&&(d=N-(D=m-a-f)),f+=D,k&&(u=Math.round(f/S))):s==="tr"?(n="ne-resize",f+N<o?d=N-(D=o-f):a+f+N>m&&(d=N-(D=m-a-f)),f+=D,u-H<i?t=H-(A=u-i):h+H<g&&(t=H-(A=g-h)),h+=A,u-=A,k&&(f=Math.round(u*S))):s==="br"&&(n="nw-resize",f+N<o?d=N-(D=o-f):a+f+N>m&&(d=N-(D=m-a-f)),f+=D,u+H<i?t=H-(A=i-u):h+u+H>E&&(t=H-(A=E-h-u)),u+=A,k&&(f=Math.round(u*S))),e.style.top=h+"px",e.style.left=a+"px",e.style.width=f+"px",e.style.height=u+"px",document.body.style.pointerEvents="none",document.documentElement.style.cursor=n,G(x)&&ye(x.onResize)&&x.onResize({top:h,left:a,width:f,height:u})}function y(){d=0,t=0,G(x)&&ye(x.onResizeEnd)&&x.onResizeEnd(),document.body.style.pointerEvents="initial",document.documentElement.style.cursor="default",window.removeEventListener("mousemove",w,!1),window.removeEventListener("mouseup",y,!1)}function M(C){S=C}function I(C){k=C}return{setAspectRatio:M,setKeepAspectRatio:I}}const Zi=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dr=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],$i=["January","February","March","April","May","June","July","August","September","October","November","December"],Mt=30,bt=38,We=46,ur="imgs/user.gif",Ee={top:"top",left:"left",right:"right",topLeft:"topLeft",bottomLeft:"bottomLeft",bottomRight:"bottomRight",topRight:"topRight"},Te=()=>"var(--window-icon-color)",fr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
<path
  d="M 3 3 L 11 3 L 11 11 L 3 11 L 3 3 z M 11 13 L 11 21 L 3 21 V 13 L 11 13 z M 13 3 L 21 3 V 11 L 13 11 V 3 z M 21 13 L 21 21 L 13 21 L 13 13 L 21 13 z" />
</svg>
`,Qi=`
<svg xmlns="http://www.w3.org/2000/svg" class="svg-stroke" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" />
  <circle cx="12" cy="12" r="3" />
</svg>
`,mr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="${Te()}"><path d="M20 5h-9.586L8.707 3.293A.997.997 0 0 0 8 3H4c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V7c0-1.103-.897-2-2-2z"></path></svg>
`,js=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="${Te()}" fill="none" stroke-linecap="round">
  <circle cx="12" cy="17" r="1" style="fill: ${Te()}" />
  <path d="M9.172 14a4 4 0 0 1 5.656 0" />
  <path d="M6.343 12a8 8 0 0 1 11.314 0" />
  <path d="M3.515 9.5c4.686 -4.687 12.284 -4.687 17 0" />
</svg>
`,Vs=`
<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" stroke="${Te()}"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
`,Ks=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" fill="none" stroke-linejoin="round">
<rect x="5.5" y="7.5" width="14" height="9" stroke="${Te()}"/>
<rect x="7" y="9" width="11" height="6" fill="${Te()}"/>
<rect x="19.5" y="10" width="1.5" height="4" fill="${Te()}"/>
</svg>
`,qs=`
<svg aria-hidden="true" version="1.1" width="10" height="10">
<path d="M 0,0 0,0.7 4.3,5 0,9.3 0,10 0.7,10 5,5.7 9.3,10 10,10 10,9.3 5.7,5 10,0.7 10,0 9.3,0 5,4.3 0.7,0 Z"></path>
</svg>
`,Xs=`
<svg class="svg-stroke" width="14" height="14" viewBox="0 0 24 24" stroke-width="2" stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <line x1="18" y1="6" x2="6" y2="18" />
  <line x1="6" y1="6" x2="18" y2="18" />
</svg>
`,pr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" fill="none" stroke="${Te()}" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<path d="M7 6a7.75 7.75 0 1 0 10 0" />
<line x1="12" y1="4" x2="12" y2="12" />
</svg>
`,gr=`
 <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"  stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
 <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
 <path d="M19.95 11a8 8 0 1 0 -.5 4m.5 5v-5h-5" />
</svg>
`,Gs=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<polyline points="6 15 12 9 18 15" />
</svg>
`,Ut=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke="${Te()}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round" class="svg-stroke">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<polyline points="9 6 15 12 9 18" />
</svg>
 `,vr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<polyline points="7 8 17 16 12 20 12 4 17 8 7 16" />
</svg>
`,_r=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<path d="M16 10h4a2 2 0 0 1 0 4h-4l-4 7h-3l2 -7h-4l-2 2h-3l2 -4l-2 -4h3l2 2h4l-2 -7h3z" />
</svg>
`,wr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
</svg>
`,br=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<path d="M5 12l5 5l10 -10" />
</svg>
`,Ys=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<circle cx="10" cy="10" r="7" />
<line x1="21" y1="21" x2="15" y2="15" />
</svg>
`,yr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<circle cx="12" cy="12" r="4" style="fill: ${Te()}"/>
<circle cx="12" cy="12" r="9"/>
</svg>
`,Sr=`
<svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" class="no-stroke">
  <circle cx="12" cy="12" r="9" fill="#000" />
  <circle cx="12" cy="12" r="8" fill="#fff" />
  <path d="M12 21A2 2 1 0 1 12 3" fill="#000" />
</svg>
`,xr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${Te()}"
  stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
  <circle cx="12" cy="12" r="3"></circle>
  <line x1="12" y1="1" x2="12" y2="5"></line>
  <line x1="12" y1="19" x2="12" y2="23"></line>
  <line x1="4" y1="4" x2="7" y2="7"></line>
  <line x1="17" y1="17" x2="20" y2="20"></line>
  <line x1="1" y1="12" x2="5" y2="12"></line>
  <line x1="19" y1="12" x2="23" y2="12"></line>
  <line x1="4" y1="20" x2="7" y2="17"></line>
  <line x1="17" y1="7" x2="20" y2="4"></line>
</svg>
`,Cr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${Te()}"
stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
<circle cx="12" cy="12" r="5"></circle>
<circle cx="10" cy="11" r="2" fill="${Te()}"></circle>
<line x1="12" y1="1" x2="12" y2="3"></line>
<line x1="12" y1="21" x2="12" y2="23"></line>
<line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
<line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
<line x1="1" y1="12" x2="3" y2="12"></line>
<line x1="21" y1="12" x2="23" y2="12"></line>
<line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
<line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>
`,kr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
stroke="${Te()}" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
<path d="M2 16.1A5 5 0 0 1 5.9 20M2 12.05A9 9 0 0 1 9.95 20M2 8V6a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-6">
</path>
<line x1="2" y1="20" x2="2.01" y2="20"></line>
</svg>
`,Er=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" fill="none" stroke="${Te()}">
<rect x="3" y="3" width="18" height="18" />
<line x1="6" x2="10" y1="10" y2="6" />
<line x1="6" x2="18" y1="18" y2="6" />
<line x1="14" x2="18" y1="18" y2="14" />
</svg>
`;function es(e=24,c=1.5,v=Te()){return`
<svg xmlns="http://www.w3.org/2000/svg" class="svg-stroke" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="${v}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<line x1="12" y1="5" x2="12" y2="19" />
<line x1="5" y1="12" x2="19" y2="12" />
</svg>
`}function Lr(e=20,c="var(--window-icon-color)"){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" stroke="${c}"
"><rect x="1" y="1" width="22" height="14" style="" stroke-width="2"></rect><path d="M8.5 1L8.5 15.5M11.5 15.5L11.5 20.5L2.5 20.5M11.5 20.5L21.5 20.5"></path></svg>`}function Tr(e=24,c="var(--window-icon-color)"){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="1.5" stroke="${c}" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(60 12 12)"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(120 12 12)"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(180 12 12)"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(240 12 12)"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(300 12 12)"></path>
</svg>`}function Dr(e=24){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="1.5" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l14 0" />
  <path d="M5 12l6 6" />
  <path d="M5 12l6 -6" />
</svg>`}function Mr(e=24){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="1.5" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l14 0" />
  <path d="M13 18l6 -6" />
  <path d="M13 6l6 6" />
</svg>`}function Ir(e=24){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="1.5" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M12 5l0 14" />
  <path d="M18 11l-6 -6" />
  <path d="M6 11l6 -6" />
</svg>`}function Br(e=24){return`<svg xmlns="http://www.w3.org/2000/svg"width="${e}" height="${e} "viewBox="0 0 24 24" stroke-width="1" stroke="var(--window-icon-color)" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M3.5 5.5l1.5 1.5l2.5 -2.5" />
  <path d="M3.5 11.5l1.5 1.5l2.5 -2.5" />
  <path d="M3.5 17.5l1.5 1.5l2.5 -2.5" />
  <path d="M11.5 6.5l9.5 0" />
  <path d="M11.5 12.5l9.5 0" />
  <path d="M11.5 18.5l9.5 0" />
</svg>`}function Rr(e=24){return`<svg xmlns="http://www.w3.org/2000/svg"width="${e}" height="${e} "viewBox="0 0 24 24" stroke-width="1" stroke="var(--window-icon-color)" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M15 8h.01" />
  <path d="M12.5 21h-6.5a3 3 0 0 1 -3 -3v-12a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v6.5" />
  <path d="M3 16l5 -5c.928 -.893 2.072 -.893 3 0l4 4" />
  <path d="M14 14l1 -1c.653 -.629 1.413 -.815 2.13 -.559" />
  <path d="M19 16v6" />
  <path d="M22 19l-3 3l-3 -3" />
</svg>`}function Ar(e=24){return`<svg xmlns="http://www.w3.org/2000/svg"width="${e}" height="${e} "viewBox="0 0 24 24" stroke-width="1" stroke="var(--window-icon-color)" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M15 8h.01" />
  <path d="M12.5 21h-6.5a3 3 0 0 1 -3 -3v-12a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v6.5" />
  <path d="M3 16l5 -5c.928 -.893 2.072 -.893 3 0l4 4" />
  <path d="M14 14l1 -1c.67 -.644 1.45 -.824 2.182 -.54" />
  <path d="M16 19h6" />
  <path d="M19 16v6" />
</svg>`}function Nr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e} " viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M19.933 13.041a8 8 0 1 1 -9.925 -8.788c3.899 -1 7.935 1.007 9.425 4.747"></path>
   <path d="M20 4v5h-5"></path>
</svg>`}function Js(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
  <path d="M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
  <path d="M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
</svg>`}function Zs(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path d="M15 8h.01" />
  <path d="M3 6a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3v-12z" />
  <path d="M3 16l5 -5c.928 -.893 2.072 -.893 3 0l5 5" />
  <path d="M14 14l1 -1c.928 -.893 2.072 -.893 3 0l3 3" />
</svg>`}function Pr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M15 8h.01" />
  <path d="M11 20h-4a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v4" />
  <path d="M4 15l4 -4c.928 -.893 2.072 -.893 3 0l3 3" />
  <path d="M14 14l1 -1c.31 -.298 .644 -.497 .987 -.596" />
  <path d="M18.42 15.61a2.1 2.1 0 0 1 2.97 2.97l-3.39 3.42h-3v-3l3.42 -3.39z" />
</svg>`}function Hr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <rect x="1" y="3" width="4" height="4"/>
  <path d="M10 5h10" />
  <rect x="1" y="10" width="4" height="4"/>
  <path d="M10 12h10" />
  <rect x="1" y="17" width="4" height="4"/>
  <path d="M10 19h10" />
</svg>`}function Or(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
  <path d="M7 10l6 0" />
  <path d="M10 7l0 6" />
  <path d="M21 21l-6 -6" />
</svg>`}function Fr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
  <path d="M7 10l6 0" />
  <path d="M21 21l-6 -6" />
</svg>`}function zr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 16" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path d="M.5.5h23v15H.5z" />
  <path d="M3.5 6.5v-3h3m14 3v-3h-3m3 6v3h-3m-11 0h-3v-3" />
</svg>`}function Wr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 16" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path d="M.5.5h23v15H.5zM6.5 4.5v7m11-7v7" />
  <circle cx="12" cy="5.5" r=".5" />
  <circle cx="12" cy="10.5" r=".5" />
</svg>`}function $r(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path d="M15 1h8v8m0-8L1 23v-8m0 8h8" />
</svg>`}function Ur(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 7l16 0" />
  <path d="M10 11l0 6" />
  <path d="M14 11l0 6" />
  <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" />
  <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" />
</svg>`}function jr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M19.5 12.572l-7.5 7.428l-7.5 -7.428a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572" />
</svg>`}function Vr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M17 17h2a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2h-14a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h2" />
  <path d="M17 9v-4a2 2 0 0 0 -2 -2h-6a2 2 0 0 0 -2 2v4" />
  <path d="M7 13m0 2a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2v4a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2z" />
</svg>`}function Kr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M13 4v4c-6.575 1.028 -9.02 6.788 -10 12c-.037 .206 5.384 -5.962 10 -6v4l8 -7l-8 -7z" />
</svg>`}const Tt={};function Ne(e,c,v){typeof Tt[e]>"u"&&(Tt[e]=Object.create(null)),Tt[e][c]=v}function Me(e,c){if(!(typeof Tt[e]>"u"))for(let v in Tt[e])Tt[e][v](c)}function si(e,c){delete Tt[e][c]}const ae={backgroundImageChange:"background-image-change",backgroundImageStyleChange:"background-image-style-change",themeChange:"theme-change",blurChange:"blur-change",nightLightChange:"night-light-change",closePopup:"close-popup",showPopup:"show-popup",hidePopup:"hide-popup",createWindow:"create-window",startProcess:"start-process",viewWindow:"view-window",restoreView:"restore-view",showDesktopHover:"show-desktop-hover",showDesktopOut:"show-desktop-out",showDesktop:"show-desktop",blurAllWindow:"blur-all-window",brightnessChange:"brightness-change",transparentChange:"transparency-change",customThemeChange:"custom-theme-change"};function Fe(e,c){Me(ae.createWindow,{appName:e,args:c})}function ni(e){Me(ae.startProcess,e)}let Ve,ei;function qr(){return Ve}function Xr(e,c){if(Ve instanceof HTMLDivElement){Ve.innerHTML="",s();return}function v(){return e.map(l=>{const p=parseInt(l.element.style.width),a=parseInt(l.element.style.height),h=Array.from(l.element.getElementsByTagName("video")),f=l.element.cloneNode(!0),u=Array.from(f.getElementsByTagName("video")),d=Array.from(f.getElementsByTagName("audio"));for(let i=0;i<u.length;i++){const o=u[i];o.muted=!0,o.pause(),o.controls=!1,o.currentTime=h[i].currentTime}for(let i of d)i.muted=!0,i.pause(),i.controls=!1;f.style.pointerEvents="none",f.classList.add("taskbar-app-thumbnail-content");let t=120/a;return t*p>200&&(t=200/p),f.className.indexOf("fluid")===-1&&(f.style.height=a-Mt+"px"),f.style.transform=`scale(${t})`,{container:_("div",{title:l.getTitle(),className:"taskbar-app-thumbnail"+(l.isFocused()?" active":""),onmouseover:b.bind(null,l.id),onmouseout:x.bind(null,l.id)},[_("div",{className:"taskbar-app-thumbnail-inner relative w-full h-full fade-in",onclick:S.bind(null,l)},[_("div",{className:"taskbar-app-thumbnail-heading flex items-center"},[_("div",{className:"taskbar-app-thumbnail-icon image-cover flex-shrink-0",style:{backgroundImage:`url("${l.icon}")`}}),_("div",{className:"taskbar-app-thumbnail-title"},_("div",{className:"text-ellipsis"},l.getTitle())),_("div",{title:"Close",className:"taskbar-app-thumbnail-close-button flex content-center items-center flex-shrink-0",innerHTML:qs,onclick:()=>{l.close(),wi(),k()}})]),_("div",{className:"taskbar-app-thumbnail-container"},f)])]),thumbnail:f}})}function b(l){Me(ae.viewWindow,{id:l}),Me(ae.hidePopup)}function x(l){k(l),Me(ae.showPopup)}function k(l){Me(ae.restoreView,{id:l})}function S(l){l.show(),l.focus(),wi(),k()}function n(l){if(Ve){const p=Ve.getBoundingClientRect(),a=Math.round(c.left+c.width/2-p.width/2);Ve.style.left=a+"px",Ve.style.height=l+62+"px"}}function s(){const l=v();Ve&&Dt(Ve,l.map(a=>a.container));let p=0;l.forEach(a=>{const h=a.thumbnail.getBoundingClientRect();a.container.style.width=h.width+"px",a.container.style.height=h.height+32+"px",h.height>p&&(p=h.height)}),n(p),setTimeout(()=>{ge(Ve,{visibility:"visible"})},50)}Ve=_("div",{className:"taskbar-app-thumbnails flex",style:{visibility:"hidden"},onmouseover:Qs,onmouseleave:en}),document.body.appendChild(Ve),s()}function Qs(){ei&&clearTimeout(ei)}function en(){ei&&clearTimeout(ei),ei=setTimeout(()=>{wi()},500)}function wi(){Ve==null||Ve.remove(),Ve=void 0}function tn(e,c){const v=Object.create(null);return v.className="taskbar-app-item-icon w-full h-full flex items-center content-center",c==="svg"?v.innerHTML=e:(v.className+=" image-icon",v.style||(v.style=Object.create(null)),v.style.backgroundImage=`url("${e}")`,v.style.pointerEvents="none"),v}function Gr(e,c,v){let b;const x=Object.create(null);x.title=e.productName,x.className="taskbar-item taskbar-app-item";const k=tn(e.icon,e.iconType);return x.onmousedown=S=>S.stopImmediatePropagation(),x.onclick=c==null?void 0:c.onclick,x.oncontextmenu=c==null?void 0:c.oncontextmenu,b=_("div",x,_("div",k)),G(v)&&b.style.setProperty("--window-icon-color",v),{element:b}}function _t(e,c){let v;const b=[],x=Object.create(null);x.className="taskbar-item taskbar-app-item";const k=tn(e.icon,e.iconType);let S;x.onmousedown=r=>{vt(),r.stopPropagation(),Me(ae.closePopup),S&&clearTimeout(S)},x.oncontextmenu=r=>{r.stopPropagation(),r.preventDefault(),vt(),typeof c.oncontextmenu=="function"&&c.oncontextmenu(r)};function n(){const r=b.map(m=>m.app);Xr(r,v.getBoundingClientRect())}x.onmouseover=()=>{b.length&&(Qs(),S&&clearTimeout(S),qr()?n():S=setTimeout(()=>{n()},500))},x.onmouseleave=()=>{S&&clearTimeout(S),b.length&&en()},x.onclick=s;function s(){if(b.length===0)Fe(e.name);else if(b.length===1){wi();const r=b[0];r.app.isVisible()?r.app.isFocused()?r.app.hide():r.app.focus():(r.app.show(),r.app.focus())}else b.length>1&&n()}let l;v=_("div",x,[_("div",k),l=_("div",{className:"taskbar-app-item-status"})]),v.addEventListener("customdragover",p,!1),v.addEventListener("customdrop",a,!1);function p(r){}function a(r){}function h(){b.length?l.classList.add("active"):l.classList.remove("active")}function f(r,m){b.push({name:r,active:!0,app:m}),h()}function u(r){const m=b.findIndex(g=>g.name===r);m>-1&&(b.splice(m,1),b.length===0&&c!=null&&c.onRemove&&c.onRemove()),h()}function d(r){setTimeout(()=>{v.classList.add("active")},10)}function t(r){setTimeout(()=>{v.classList.remove("active")},0)}function i(){return b}function o(){v.remove()}return{element:v,addInstance:f,removeInstance:u,getInstances:i,setActive:d,removeActive:t,remove:o}}function Bt(e,c,v){const b="popup"+Ii(32);let x="popup dropdown-box"+(e.noBorder?" no-border":""),k=!1,S={};e.className&&(x+=" "+e.className),G(e.top)&&(S.top=e.top+"px"),G(e.left)&&(S.left=e.left+"px"),G(e.width)&&(S.width=e.width+"px"),G(e.height)&&(S.height=e.height+"px");let n=_("div");function s(t){n=_("div",{tabIndex:-1,className:x,style:S},_("div",{className:"popup-inner relative w-full h-full"},t)),nt(document.body,n),Me(ae.blurAllWindow),n.focus(),document.addEventListener("mousedown",f,!1)}function l(t){ge(n,t)}function p(t){s(c),G(t)&&(G(t.top)&&(n.style.top=t.top+"px"),G(t.left)&&(n.style.left=t.left+"px"),G(t.width)&&(n.style.width=t.width+"px"),G(t.height)&&(n.style.height=t.height+"px")),k=!0,v&&v.onShow&&v.onShow()}function a(){n.remove(),document.removeEventListener("mousedown",f,!1),k=!1,v&&v.onHide&&v.onHide()}function h(t){k?a():p(t)}function f(t){const i=t.target;n.contains(i)||a()}function u(){n&&n.classList.add("hidden")}function d(){n&&n.classList.remove("hidden")}return Ne(ae.closePopup,b,t=>{k&&b!==t&&a()}),Ne(ae.showPopup,b,()=>{d()}),Ne(ae.hidePopup,b,()=>{u()}),{element:n,id:b,show:p,close:a,visible:d,hide:u,toggleShow:h,setStyle:l}}let Yt=class{constructor({startDate:c=null,endDate:v=null,siblingMonths:b=!1,weekNumbers:x=!1,weekStart:k=0}={}){Nt(this,"startDate");Nt(this,"endDate");Nt(this,"siblingMonths");Nt(this,"weekNumbers");Nt(this,"weekStart");this.startDate=c,this.endDate=v,this.siblingMonths=b,this.weekNumbers=x,this.weekStart=k}getCalendar(c,v){const b=new Date(Date.UTC(c,v,1,0,0,0,0));c=b.getUTCFullYear(),v=b.getUTCMonth();const x=[],k=b.getUTCDay(),S=-((7-this.weekStart+k)%7),n=Yt.daysInMonth(c,v),s=(n-S)%7,l=Yt.daysInMonth(c,v-1);let p=S,a,h,f=!1,u=null,d,t;const i=n-p+(s!==0?7-s:0)+S;for(;p<i;)h=p+1,a=((p<1?7+p:p)+k)%7,h<1||h>n?this.siblingMonths?(h<1?(d=v-1,t=c,d<0&&(d=11,t--),h=l+h):h>n&&(d=v+1,t=c,d>11&&(d=0,t++),h=p-n+1),d!==void 0&&t!==void 0&&(f={day:h,weekDay:a,month:d,year:t,siblingMonth:!0})):f=!1:f={day:h,weekDay:a,month:v,year:c},f&&this.weekNumbers&&(u===null?u=Yt.calculateWeekNumber(f):a===1&&u===52?u=1:a===1&&u++,f.weekNumber=u),f&&this.startDate&&(f.selected=this.isDateSelected(f)),x.push(f),p++;return x}isDateSelected(c){return this.startDate?c.year===this.startDate.year&&c.month===this.startDate.month&&c.day===this.startDate.day?!0:!(!this.endDate||c.year===this.startDate.year&&c.month===this.startDate.month&&c.day<this.startDate.day||c.year===this.endDate.year&&c.month===this.endDate.month&&c.day>this.endDate.day||c.year===this.startDate.year&&c.month<this.startDate.month||c.year===this.endDate.year&&c.month>this.endDate.month||c.year<this.startDate.year||c.year>this.endDate.year):!1}setStartDate(c){this.startDate=c}setEndDate(c){this.endDate=c}setDate(c){return this.setStartDate(c)}static diff(c,v){const b=new Date(Date.UTC(c.year,c.month,c.day,0,0,0,0)),x=new Date(Date.UTC(v.year,v.month,v.day,0,0,0,0));return Math.ceil((b.getTime()-x.getTime())/864e5)}static interval(c,v){return Math.abs(Yt.diff(c,v))+1}static compare(c,v){if(typeof c!="object"||typeof v!="object"||c===null||v===null)throw new TypeError("dates must be objects");return c.year<v.year?-1:c.year>v.year?1:c.month<v.month?-1:c.month>v.month?1:c.day<v.day?-1:c.day>v.day?1:0}static daysInMonth(c,v){return new Date(c,v+1,0).getDate()}static isLeapYear(c){return c%4===0&&c%100!==0||c%400===0}static calculateWeekNumber(c){const v=new Date(Date.UTC(c.year,c.month,c.day,0,0,0,0)),b=new Date(v.valueOf()),x=(v.getUTCDay()+6)%7;b.setUTCDate(b.getUTCDate()-x+3);const k=b.valueOf();return b.setUTCMonth(0,1),b.getUTCDay()!==4&&b.setUTCMonth(0,1+(4-b.getUTCDay()+7)%7),1+Math.ceil((k-b.getTime())/6048e5)}};function Yr(){let e,c,v=new Date().getDate(),b;const x=new Yt({siblingMonths:!0});function k(){c.innerHTML="";const l=new Date;e.innerHTML=$i[l.getUTCMonth()];const p=Zi.map(a=>a.substring(0,2));for(let a=0;a<p.length;a++){const h=p[a];c.appendChild(_("div",{className:"calendar-day -weekday"},_("div",{className:"w-full h-full flex items-center content-center"},h)))}x.getCalendar(l.getUTCFullYear(),l.getUTCMonth()).forEach(a=>{const h=_("div",{className:"calendar-day"+(a&&a.siblingMonth?" -sibling-month":"")},_("div",{"data-date":a?a.day:"",className:"calendar-day-inner w-full h-full flex items-center content-center"+(a&&l.getDate()===a.day&&!a.siblingMonth?" active":"")},a?a.day.toString():""));c.appendChild(h)})}function S(){const l=new Date,p=l.getDate();if(v!==p){const a=c.querySelector(`[data-date="${v}"`);a instanceof HTMLDivElement&&a.classList.remove("active");const h=c.querySelector(`[data-date="${p}"`);h instanceof HTMLDivElement&&h.classList.add("active"),v=p,e.innerHTML=$i[l.getUTCMonth()]}}function n(){k(),b=setInterval(()=>{S()},1e3)}function s(){clearInterval(b)}return Bt({className:"calendar-popup"},_("div",{className:"calendar-content"},[e=_("div",{className:"calendar-month"}),c=_("div",{className:"calendar-items"})]),{onShow:n,onHide:s})}const bs=Yr();function Jr(){function e(){vt(),Me(ae.closePopup,bs.id),bs.toggleShow()}const c=_("div",{className:"taskbar-item taskbar-date-time taskbar-date h-full flex items-center flex-shrink-0",onclick:e,onmousedown:v=>v.stopPropagation()},Ui(new Date));return setInterval(()=>{c.textContent=Ui(new Date)},500),{element:c}}function Zr(){let e,c,v,b,x;function k(){const s=new Date,l=s.getSeconds(),p=l/60*360+90;e.style.transform=`rotate(${p}deg)`;const a=s.getMinutes(),h=a/60*360+l/60*6+90;c.style.transform=`rotate(${h}deg)`;const u=s.getHours()/12*360+a/60*30+90;v.style.transform=`rotate(${u}deg)`,b.textContent=It(s,!0)}function S(){k(),setInterval(k,500)}function n(){clearInterval(x)}return Bt({className:"clock-popup"},_("div",{className:"clock-container flex"},[_("div",{className:"clock-inner"},[_("div",{className:"clock"},[_("div",{className:"outer-clock-face"},[_("div",{className:"clock-marking clock-marking-one"}),_("div",{className:"clock-marking clock-marking-two"}),_("div",{className:"clock-marking clock-marking-three"}),_("div",{className:"clock-marking clock-marking-four"}),_("div",{className:"inner-clock-face"},[v=_("div",{className:"clock-hand clock-hour-hand"}),c=_("div",{className:"clock-hand clock-min-hand"}),e=_("div",{className:"clock-hand clock-second-hand"})])])]),b=_("div",{className:"clock-time"})]),_("div",{className:"clock-divider"}),_("div",{className:"alarm-container flex flex-col flex-1 w-full"},[_("div",{className:"alarm-heading"},"Alarms"),_("div",{className:"alarm-items flex items-center content-center flex-1"},"No alarms")])]),{onShow:S,onHide:n})}const ys=Zr();function Qr(){const e=_("div",{className:"taskbar-item taskbar-date-time taskbar-time h-full flex items-center",onclick:()=>{vt(),Me(ae.closePopup,ys.id),ys.toggleShow({left:Math.round(e.getBoundingClientRect().left)})},onmousedown:c=>c.stopPropagation()},It(new Date));return setInterval(()=>{e.textContent=It(new Date)},500),{element:e}}function eo(){let e,c;function v(){c=setInterval(()=>{e.textContent=It(new Date)},500)}function b(){clearInterval(c)}function x(S,n){return _("div",{},[_("div",{},S),_("div",{style:{fontSize:"16px"}},n)])}return Bt({className:"weather-popup"},_("div",{className:"weather-container w-full h-full p-20"},[_("div",{className:"flex"},[e=_("div",{className:"weather-popup-time flex items-center"},It(new Date)),_("div",{className:"flex items-center",style:{fontWeight:"bold",marginLeft:"auto"}},[_("div",{style:{marginRight:"10px"}},"Somewhere"),_("div",{className:"flex items-center",innerHTML:Qi})])]),_("div",{className:"flex items-center",style:{paddingBlock:"20px"}},[_("div",{style:{width:"80px",height:"80px",backgroundImage:'url("imgs/icons/Weather/sunny snow.png")',backgroundRepeat:"no-repeat",backgroundSize:"contain"}}),_("div",{className:"weather-popup-temperature",style:{marginLeft:"20px",fontSize:"32px"}},"-37°C"),_("div",{style:{marginLeft:"20px"}},[_("div",{style:{fontWeight:"bold",fontSize:"14px"}},"Snow"),_("div",{className:"flex",style:{marginTop:"10px"}},[_("div",{},"Feel like"),_("div",{style:{marginLeft:"10px",fontWeight:"bold",fontSize:"14px"}},"-37°C")])])]),_("div",{className:"weather-popup-index"},[x("Air quality","60"),x("Winds","4 km/h"),x("Humidity","50 %"),x("Visibility","10 km"),x("Pressure","1021 mb"),x("Dew point","10°")])]),{onShow:v,onHide:b})}function to(){const e=eo(),c=_("div",{title:"Somewhere, -37°C, Snow",className:"taskbar-item taskbar-weather h-full flex items-center",onclick:()=>{vt(),Me(ae.closePopup,e.id),e.toggleShow({left:Math.round(c.getBoundingClientRect().left)})},onmousedown:v=>v.stopPropagation()},[_("div",{style:{height:"20px"},innerHTML:Tr(20,"var(--accent-color)")}),_("div",{style:{marginLeft:"5px"}},"-37°C")]);return{element:c}}const Ue=[];for(let e=0;e<6;e++){const c="IMG"+e+".jpg";Ue.push({name:c,path:"imgs/Wallpapers/"+c,thumbnailPath:"imgs/Wallpapers/Thumbnails/"+c})}const Ht={useTitleBarAccentColor:!1,useTaskbarAndStartMenuAccentColor:!1,useWindowBorderAccentColor:!1},io={name:"Default Light",background:Ue[0],accentColor:{h:200,s:100,l:50},dark:!1,transparency:!0,backgroundImageStyle:"Fill",...Ht},so={name:"Default Dark",background:Ue[1],backgroundImageStyle:"Fill",accentColor:{h:200,s:100,l:50},dark:!0,transparency:!0,...Ht},no=[{name:"Spring",background:Ue[2],backgroundImageStyle:"Fill",accentColor:{h:120,s:100,l:40},dark:!1,transparency:!0,...Ht},{name:"Summer",background:Ue[3],backgroundImageStyle:"Fill",accentColor:{h:48,s:100,l:49},dark:!1,transparency:!0,...Ht},{name:"Autumn",background:Ue[4],backgroundImageStyle:"Fill",accentColor:{h:356,s:98,l:69},dark:!1,transparency:!0,...Ht},{name:"Winter",background:Ue[5],backgroundImageStyle:"Fill",accentColor:{h:215,s:50,l:40},dark:!0,transparency:!1,...Ht}],ro=[io,so].concat(no),sn={showDesktopIcons:!0,volume:100,brightness:100,nightlight:!1,themes:ro,themeIndex:0,recentImages:[Ue[0],Ue[2],Ue[3],Ue[4],Ue[5]],roundedCorner:!0,useBorder:!1},Se=ts("preferences",sn);function ts(e,c={}){let v={};try{const S=localStorage.getItem(e);S?v=mn(JSON.parse(S),c):v=c}catch{}function b(S){if(typeof S=="string")return{[S]:v[S]};if(S instanceof Array){const n={};for(let s=0;s<S.length;s++){const l=S[s];n[l]=v[l]}return n}return v}function x(S){v={...v,...S},localStorage.setItem(e,JSON.stringify(v))}function k(){v=sn,localStorage.setItem(e,JSON.stringify(v))}return{getState:b,setState:x,reset:k}}function oo(){let{nightlight:e}=Se.getState("nightlight"),c,v,b=_("div",{className:"screen"},[c=_("div",{className:"screen-bright-overlay w-full h-full"}),v=_("div",{className:"screen-nightlight w-full h-full"+(e?" active":"")})]);nt(document.body,b);function x(n){let s=Zt(.7-n/100*.7,2);c.style.opacity=s.toString(),Me(ae.brightnessChange,n)}function k(n,s=!0){e=n,v.classList[e?"add":"remove"]("active"),s&&Se.setState({nightlight:e}),Me(ae.nightLightChange,e)}function S(){k(!e)}return{setBrightness:x,setNightLight:k,toogleNightLight:S}}const ri=oo();function Ss(e){let c,v,b,x,k,S,n=!1,s={top:0,left:0,width:0,height:0};function l(){s=b.getBoundingClientRect()}function p(r,m){let g=r-s.left;g<0?g=0:g>s.width&&(g=s.width);let E=g/s.width*100;m(E)}function a(r){typeof r=="number"&&p(r,m=>{c=m,x.style.width=m+"%",k.style.width=m+"%",typeof e.onChange=="function"?e.onChange(m,g=>{e.showBagde&&(S.textContent=g.toString())}):e.showBagde&&(S.textContent=Math.round(m).toString())})}function h(r){n=!0,v.classList.add("hoding"),l(),a(r.x),typeof e.onHoding=="function"&&e.onHoding(),document.addEventListener("mousemove",f,!1),document.addEventListener("mouseup",u,!1)}function f(r){n&&a(r.x)}function u(){n=!1,v.classList.remove("hoding"),typeof e.onRelease=="function"&&e.onRelease(c),document.removeEventListener("mousemove",f,!1),document.removeEventListener("mouseup",u,!1)}function d(){l()}function t(r){n||p(r.x,m=>{m||(m=0),k.style.width=m+"%",typeof e.onHoverMove=="function"?e.onHoverMove(m,g=>{e.showBagde&&(S.textContent=g.toString())}):e.showBagde&&(S.textContent=Math.round(m).toString())})}function i(){k.style.width="0%"}v=_("div",{className:"slider",onmousedown:h,onmouseover:d,onmousemove:t,onmouseleave:i},b=_("div",{className:"slider-inner"},[x=_("div",{className:"slider-thumb-primary"},_("div",{className:"slider-thumb-primary-inner"})),k=_("div",{className:"slider-thumb-secondary"},_("div",{className:"slider-thumb-secondary-inner"},e.showBagde?S=_("div",{className:"slider-thumb-secondary-text"}):null))]));function o(r){r>100&&(r=100),n||(x.style.width=r+"%")}return{element:v,update:o}}function ht(e){let c=e.active,v=_("div",{className:"action-center-button"+(c?" active":"")},[_("div",{className:"action-center-button-icon",innerHTML:e.icon,onclick:b}),_("div",{className:"action-center-button-text"},e.text)]);function b(){e.disableActiveOnClick||(c=!c,typeof e.onclick=="function"&&e.onclick(c))}function x(S){v.classList[S?"add":"remove"]("active")}function k(S){c=S,x(S)}return{element:v,setActive:k}}function ao(){const{themes:e,themeIndex:c,customTheme:v,nightlight:b,brightness:x,volume:k}=Se.getState(["themes","themeIndex","customTheme","nightlight","brightness","volume"]),S=c>-1?e[c]:v,n=S.dark,s=S.transparency,l=ht({icon:js,text:"Wifi"}),p=ht({icon:vr,text:"Bluetooth"}),a=ht({icon:_r,text:"Airplan Mode"}),h=ht({active:n,icon:Sr,text:"Dark Theme",onclick:g=>{as(g)}}),f=ht({icon:wr,text:"Focus Assist"}),u=ht({icon:yr,text:"Location"}),d=ht({active:b,icon:Cr,text:"Night Light",onclick:()=>{ri.toogleNightLight()}}),t=ht({icon:kr,text:"Connect"}),i=ht({active:s,icon:Er,text:"Transparency",onclick:g=>{ls(g)}});Ne(ae.themeChange,"actionCenter",g=>{h.setActive(g)});let o=!1;const r=Ss({showBagde:!0,onHoding:()=>{o=!0},onChange:(g,E)=>{ri.setBrightness(g),E(Math.round(g))},onRelease:g=>{o=!1,Se.setState({brightness:Math.round(g)})}});r.update(x);const m=Ss({showBagde:!0,onRelease:g=>{Se.setState({volume:Math.round(g)})}});return m.update(k),Ne(ae.nightLightChange,"actionCenter",g=>{d.setActive(g)}),Ne(ae.brightnessChange,"actionCenter",g=>{o||r.update(g)}),Ne(ae.transparentChange,"actionCenter",g=>{i.setActive(g)}),Bt({className:"action-center"},[_("div",{className:"action-center-top"},[_("div",{className:"action-center-buttons"},[l.element,p.element,a.element,h.element,f.element,u.element,d.element,t.element,i.element]),_("div",{className:"action-center-sliders"},[_("div",{className:"action-center-slider w-full flex items-center"},[_("div",{className:"action-center-slider-icon",innerHTML:xr}),r.element]),_("div",{className:"action-center-slider w-full flex items-center"},[_("div",{className:"action-center-slider-icon",innerHTML:Vs}),m.element])])]),_("div",{className:"action-center-footer flex items-center"},[_("div",{className:"action-center-footer-item action-center-batery flex items-center"},[_("div",{className:"action-center-batery-icon flex items-center",innerHTML:Ks}),_("div",{className:"action-center-batery-text"},"100%")]),_("div",{title:"Open Settings",className:"action-center-footer-item action-center-config",innerHTML:Qi,onclick:()=>{Me(ae.closePopup),Fe("settings")}})])])}const xs=ao(),Be={Tab:"Tab",Enter:"Enter",ArrowLeft:"ArrowLeft",ArrowRight:"ArrowRight",ArrowUp:"ArrowUp",ArrowDown:"ArrowDown",Escape:"Escape",Space:" ",BackSpace:"Backspace",Delete:"Delete",Home:"Home",End:"End",Insert:"Insert"};function nn(e=16,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <polyline points="6 15 12 9 18 15" />
</svg>`}function Li(e=16,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <polyline points="6 9 12 15 18 9" />
</svg>`}function rn(e=16,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round" class="svg-stroke">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l5 5l10 -10" />
</svg>`}function on(e,c,v){const b=typeof e.children<"u"&&e.children!==null&&e.children instanceof Array&&e.children.length>0;let x=_("div",{onBeforeRemove(){x=null}});x.className="menu-item",x.tabIndex=-1,e.disabled?x.classList.add("disabled"):(x.onclick=a,x.onkeydown=l),x.onfocus=p,x.onmouseenter=n;let k=document.createElement("div");k.className="menu-item-icon",e.checked?(x.classList.add("checked"),k.innerHTML=rn()):e.icon&&(!e.iconType&&!(e.icon instanceof Node)||e.iconType==="svg"?k.innerHTML=e.icon:e.iconType==="image"?k.style.backgroundImage=`url("${e.icon}")`:(e.icon instanceof Node||e.iconType==="element")&&k.appendChild(e.icon)),e.emphasis&&x.classList.add("emphasis"),x.appendChild(k);let S=document.createElement("div");if(S.className="menu-item-text",S.textContent=e.text||"",x.appendChild(S),e.shortcut){let f=document.createElement("div");f.className="menu-item-shortcut",f.textContent=e.shortcut,x.appendChild(f)}if(b){let f=document.createElement("div");f.className="menu-item-arrow flex items-center",f.innerHTML=Ut,x.appendChild(f)}function n(f){f.stopPropagation(),f.currentTarget.focus(),v.onHover(c)}function s(){b||v.onEnter(e),typeof e.onClick=="function"&&e.onClick()}function l(f){f.key===Be.Enter&&(f.stopPropagation(),s())}function p(f){f.stopPropagation(),v.onFocus(c)}function a(f){f.stopPropagation(),s()}function h(f){x.classList[f?"add":"remove"]("active")}return{element:x,setActive:h}}function bi(e,c){let v;e.addEventListener("mouseenter",b,!1);function b(){v=requestAnimationFrame(k),e.addEventListener("mouseleave",x,!1)}function x(){cancelAnimationFrame(v),setTimeout(()=>{cancelAnimationFrame(v)},50),e.removeEventListener("mouseleave",x,!1)}function k(){v=requestAnimationFrame(k),typeof c=="function"&&c()}}const Lt=6;function an(e,c,v,b,x){const k=v.length;let S=0,n=[],s=-1,l,p={close:M},a=!1,h=document.createElement("div");h.className="sub-menu";let f=document.createElement("div");f.className="context-menu-scroll-button top",f.innerHTML=nn(),h.appendChild(f);let u=document.createElement("div");u.className="context-menu-scroll-button bottom",u.innerHTML=Li(),h.appendChild(u);let d=document.createElement("div");d.tabIndex=-1,d.className="context-menu-inner",d.onkeydown=g,d.addEventListener("scroll",()=>{t()},!1);function t(){d.scrollTop<=10?f.classList.remove("show"):f.classList.add("show"),d.scrollTop+d.getBoundingClientRect().height>=d.scrollHeight-10?u.classList.remove("show"):u.classList.add("show")}function i(){d.scrollTop+=4}function o(){d.scrollTop-=4}bi(f,o),bi(u,i),h.appendChild(d),c.element.appendChild(h);for(let I=0;I<k;I++){const C=v[I];if(!a&&G(C.shortcut)&&(a=!0),C.divider){let D=document.createElement("div");D.className="menu-item-divider",d.appendChild(D)}else{let D=on(C,S,{onEnter:b,onFocus:E,onHover:m});d.appendChild(D.element),typeof C.children<"u"&&C.children!==null&&C.children instanceof Array&&C.children.length>0&&!C.disabled&&an(h,D,C.children,b,r),n.push(D),S+=1}}a&&h.classList.add("has-shortcut");function r(I){l=I}function m(){y()}c.element.addEventListener("keydown",I=>{(I.key===Be.ArrowRight||I.key===Be.Enter)&&(I.stopPropagation(),w(!0))},!1),c.element.addEventListener("mouseenter",I=>{I.stopPropagation(),w(!1)},!1);function g(I){if(I.key===Be.ArrowLeft&&(I.stopPropagation(),h.classList.remove("show"),c.setActive(!1),c.element.focus()),I.key===Be.ArrowRight)I.stopPropagation(),s===-1&&(s=0,n[s].element.focus());else if(I.key===Be.ArrowUp){if(I.stopPropagation(),I.preventDefault(),s===-1)s=n.length-1,n[s].element.focus();else{let C=n[s-1];C?C.element.focus():n[n.length-1].element.focus()}y()}else if(I.key===Be.ArrowDown){if(I.stopPropagation(),I.preventDefault(),s===-1)s=0,n[s].element.focus();else{let C=n[s+1];C?C.element.focus():n[0].element.focus()}y()}}function E(I){s=I}let T;function w(I){const C=window.innerWidth,D=window.innerHeight;c.setActive(!0),h.classList.add("show");const A=e.getBoundingClientRect(),H=c.element.getBoundingClientRect();let N=A.left+A.width-Lt,F=H.top+2,L=h.getBoundingClientRect();T||(T=L);let B=d.getBoundingClientRect();A.left+A.width+L.width>C&&(N=A.left-L.width+Lt),F+L.height>=D?F=D-L.height-Lt/2:F-=Lt,B.height>=D&&(F=Lt,h.style.height=D-20+"px"),B=d.getBoundingClientRect(),d.scrollHeight>B.height&&(h.style.width=T.width+"px",d.style.width=T.width+20+"px"),h.style.top=F+"px",h.style.left=N+"px",t(),I&&n[0].element.focus(),x(p)}function y(){l&&l.close()}function M(){c.setActive(!1),h.classList.remove("show"),y()}return p}function jt(e,c,v=[],b=!1,x,k=!0,S){window.lastContextMenu&&window.lastContextMenu.close(),window.contextMenuDirectionLTR=!0;const n=window.innerWidth,s=window.innerHeight;let l=!1,p,a=[],h=-1,f,u=0;const d=v.length;function t(L){if(L.key===Be.ArrowRight)h===-1&&(h=0,a[h].element.focus());else if(L.key===Be.ArrowUp){if(L.preventDefault(),h===-1)h=a.length-1,a[h].element.focus();else{let B=a[h-1];B?B.element.focus():a[a.length-1].element.focus()}o()}else if(L.key===Be.ArrowDown){if(L.preventDefault(),h===-1)h=0,a[h].element.focus();else{let B=a[h+1];B?B.element.focus():a[0].element.focus()}o()}else L.key===Be.Escape&&N()}function i(L){h=L}function o(){f&&f.close()}function r(){o()}let m=_("div",{className:"context-menu-scroll-button top",innerHTML:nn()}),g=_("div",{className:"context-menu-scroll-button bottom",innerHTML:Li()});p=_("div",{tabIndex:-1,className:"context-menu"+(G(S)?" "+S:"")},[m,g]);let E=_("div",{tabIndex:-1,className:"context-menu-inner",onkeydown:t,onscroll:()=>{T()}});function T(){E.scrollTop<=10?m.classList.remove("show"):m.classList.add("show");let L=E.getBoundingClientRect();E.scrollTop+L.height>=E.scrollHeight-10?g.classList.remove("show"):g.classList.add("show")}function w(){E.scrollTop+=4}function y(){E.scrollTop-=4}bi(m,y),bi(g,w),p.appendChild(E),document.body.appendChild(p),p.focus();for(let L=0;L<d;L++){const B=v[L];if(!l&&G(B.shortcut)&&(l=!0),B.divider){let O=_("div",{className:"menu-item-divider"});E.appendChild(O)}else{let O=on(B,u,{onEnter:D,onFocus:i,onHover:r});E.appendChild(O.element),typeof B.children<"u"&&B.children!==null&&B.children instanceof Array&&B.children.length>0&&!B.disabled&&an(p,O,B.children,D,F),a.push(O),u+=1}}l&&p.classList.add("has-shortcut"),setTimeout(()=>{b?a[0].element.focus():E.focus()},0);let M={top:e.top,left:e.left};const I=p.getBoundingClientRect();let C=E.getBoundingClientRect();M.left+I.width>n&&(M.left=M.left-I.width),M.top+I.height>s&&(M.top=s-I.height-Lt/2),C.height>s&&(M.top=Lt,p.style.height=s-20+"px"),C=E.getBoundingClientRect(),E.scrollHeight>C.height&&(p.style.width=I.width+"px",E.style.width=I.width+20+"px"),p.style.left=M.left+"px",p.style.top=M.top+"px",T();function D(){N()}function A(){N()}window.addEventListener("resize",A,!1),document.addEventListener("mousedown",H,!1);function H(L){p.contains(L.target)||N()}function N(){window.removeEventListener("scroll",A,!1),document.removeEventListener("mousedown",H,!1),p.remove(),k&&c.focus(),window.lastContextMenu=null,x&&x()}function F(L){f=L}window.lastContextMenu={close:N}}const rt=ts("env",{USER_NAME:"User 1",USER_HOME:"c:/Users/User 1",VERSION:"10.0.23711.1466"}),dt="imgs/icons/",Ae={thisPC:dt+"Computer.png",driverC:dt+"Drives/Hardrive%20Windows.png",user:dt+"User.png",desktop:dt+"Desktop.png",document:dt+"Folder%20Documents.png",download:dt+"Folder%20Downloads.png",pictures:dt+"Folder%20Pictures.png",music:dt+"Folder%20Music.png",videos:dt+"Folder%20Videos.png"},mt="imgs/icons/Folder.png",{USER_HOME:Kt}=rt.getState("USER_HOME"),lo=[{text:"Documents",icon:"imgs/icons/Folder%20Documents.png",iconType:"image",onclick:()=>{Fe("explorer",`${Kt}/Documents`)}},{text:"Downloads",icon:"imgs/icons/Folder%20Downloads.png",iconType:"image",onclick:()=>{Fe("explorer",`${Kt}/Downloads`)}},{text:"Music",icon:"imgs/icons/Library%20Music.png",iconType:"image",onclick:()=>{Fe("explorer",`${Kt}/Music`)}},{text:"Pictures",icon:"imgs/icons/Libray%20Pictures.png",iconType:"image",onclick:()=>{Fe("explorer",`${Kt}/Pictures`)}},{text:"Videos",icon:"imgs/icons/Library%20Videos.png",iconType:"image",onclick:()=>{Fe("explorer",`${Kt}/Videos`)}}],co=[{text:"Accounts",icon:"imgs/user.gif",iconType:"image",onclick:()=>{ni({type:"app",...Q.settings,args:"accounts"})}},{text:"Settings",icon:Qi,onclick:()=>{Fe("settings")}},{text:"Power",icon:pr,preventClose:!0,onclick:e=>{jt({top:e.y,left:e.x},e.currentTarget,[{text:"Sleep"},{text:"Restart"},{text:"Shutdown"}])}}];function ho(e){return _("div",{className:"start-menu-column start-menu-actions h-full flex flex-col scrollable scroll-y"},[_("div",{className:"start-menu-action-list start-menu-actions-top"},lo.map(c=>{const v={className:"start-menu-action-item-icon",style:{},innerHTML:""};return c.iconType==="image"?v.style.backgroundImage=`url(${c.icon})`:v.innerHTML=c.icon,_("div",{className:"start-menu-action-item flex items-center",onclick:()=>{c.onclick(),G(e)&&e(c)}},[_("div",v),_("div",null,c.text)])})),_("div",{className:"start-menu-action-list start-menu-actions-bottom"},co.map(c=>{const v={className:"start-menu-action-item-icon",style:{},innerHTML:""};return c.iconType==="image"?v.style.backgroundImage=`url(${c.icon})`:v.innerHTML=c.icon,_("div",{className:"start-menu-action-item flex items-center",onclick:b=>{c.onclick(b),G(e)&&e(c)}},[_("div",v),_("div",null,c.text)])}))])}function uo(e){const c=tr();return _("div",{className:"start-menu-column  start-menu-apps-list-container w-full h-full flex flex-col flex-1"},[_("div",{className:"start-menu-apps-list w-full h-full scrollable scroll-y"},Object.keys(c).map((b,x)=>_("div",{key:"app-item"+x,className:"start-menu-apps-list-section"},[_("div",{className:"start-menu-apps-list-label flex items-center"},b),_("div",{className:"start-menu-apps-list-items"},c[b].map((k,S)=>_("div",{key:"app-item"+S,className:"start-menu-apps-list-item flex items-center",onclick:e.bind(null,k)},[_("div",{className:"start-menu-apps-list-item-icon flex-shrink-0",style:{backgroundImage:`url(${k.icon})`}}),_("div",{className:"start-menu-apps-list-item-name"},_("div",{className:"text-ellipsis"},k.productName))])))])))])}function fo(e){let c;function v(k){c.toggleShow(),Fe(k.name)}function b(){}function x(k){G(k)&&!k.preventClose&&c.toggleShow()}return c=Bt({noBorder:!0,width:524,height:(e==null?void 0:e.height)||540,className:"start-menu"},_("div",{className:"w-full h-full flex"},[ho(x),uo(v)]),{onHide:b}),c}const Cs=fo();function mo(){let e=_("div",{className:"window-container",style:{position:"fixed",top:0,left:0}});document.body.appendChild(e);function c(k){e.appendChild(k)}function v(){e.style.display="none"}function b(){e.style.removeProperty("display")}function x(k){e.classList[k?"add":"remove"]("fullscreen")}return{addWindow:c,show:b,hide:v,toogleFullScreen:x}}const yi=mo();function po(e){let c;function v(k){const S=k.target;c!=null&&c.contains(S)||(x(),e.onClose&&e.onClose())}function b(){yi.hide(),$e.showDesktopIcons(!1);const k=Co().toReversed();c=_("div",{className:"taskview flex flex-col",style:{transform:"scale(1.2)"},onclick(){x()}},[_("div",{className:"taskview-header flex-shrink-0 flex items-center",style:{paddingInline:"40px"}},[_("div",{className:"taskview-header-button flex items-center",onclick(S){S.stopPropagation()}},[_("div",{className:"taskview-header-button-icon flex items-center content-center",innerHTML:es(),style:{width:"24px",height:"24px"}}),_("div",{className:"taskview-header-button-text",style:{marginLeft:"10px"}},"New windows group")])]),_("div",{className:"taskview-app-items flex-1"},k.map(S=>{const n=parseInt(S.element.style.width),s=parseInt(S.element.style.height),l=S.element.cloneNode(!0);l.classList.add("taskbar-app-item-window"),l.style.pointerEvents="none";const p=Array.from(S.element.getElementsByTagName("video")),a=Array.from(l.getElementsByTagName("video")),h=Array.from(l.getElementsByTagName("audio"));for(let i=0;i<a.length;i++){const o=a[i];o.muted=!0,o.pause(),o.controls=!1,o.currentTime=p[i].currentTime}for(let i of h)i.muted=!0,i.pause(),i.controls=!1;let f=160/s,u=!1;f*n>=400&&(u=!0,f=400/n);const d=Math.round(f*n);l.style.transform=`scale(${f})`;const t={width:d+"px"};return u&&(t.height=Math.round(f*s)+"px"),_("div",{className:"taskview-app-item",onclick(i){i.stopPropagation(),S.show(),S.focus(),x()}},[_("div",{className:"taskview-app-item-header flex",style:{marginBottom:"5px",width:d+"px"}},[_("div",{className:"taskview-app-item-icon flex-shrink-0",style:{width:"32px",height:"32px",backgroundImage:`url(${S.icon})`,backgroundRepeat:"no-repeat",backgroundSize:"24px",backgroundPosition:"center"}}),_("div",{className:"taskview-app-item-text flex items-center"},_("div",{title:S.title,className:"text-ellipsis line-clamp-1"},S.title)),_("div",{title:"Close",className:"taskview-app-item-close flex items-center content-center flex-shrink-0",style:{width:"32px",height:"32px",marginLeft:"auto"},innerHTML:Xs,onclick(i){i.stopPropagation(),S.close(),x()}})]),_("div",{className:"taskview-app-thumbnail",style:t},l)])}))]),document.body.appendChild(c),document.addEventListener("click",v,!1),setTimeout(()=>{c.style.transform="scale(1)"},0),e.onShow&&e.onShow()}function x(){document.removeEventListener("click",v,!1),G(c)&&ge(c,{transform:"scale(1.5)",opacity:"0"}),yi.show(),Se.getState("showDesktopIcons").showDesktopIcons&&$e.showDesktopIcons(!0),setTimeout(()=>{c==null||c.remove(),c=null,e.onClose&&e.onClose()},150)}return{element:c,show:b,close:x}}function go(){let e=!1,c=po({onClose:v});function v(){e=!1}return{element:_("div",{title:"Task View",className:"taskbar-item h-full flex-shrink-0",onclick:x=>{x.stopPropagation(),vt(),Me(ae.closePopup),e?(e=!1,c.close()):(e=!0,c.show())},onmousedown:x=>x.stopPropagation()},_("div",{className:"taskbar-item-button flex items-center content-center h-full",style:{width:"40px"},innerHTML:Lr(20)}))}}function ln(e){let c,v;const b={};e.width&&(b.width=ji(e.width)?e.width+"px":e.width.toString());function x(a){a.preventDefault(),v.classList.add("focus")}function k(){v.classList.remove("focus")}v=_("div",{className:"textbox flex items-center",style:b},[c=_("input",{name:"search-input",autocomplete:"off",type:e.type||"text",className:"textbox-input",placeholder:e.placeholder,oninput:S,onfocus:x,onblur:k}),typeof e.optional=="function"?e.optional(e):e.optional]);function S(a){a.preventDefault(),typeof e.onChange=="function"&&e.onChange(c.value)}function n(a){c.value=a}function s(a){c.placeholder=a}function l(){c.focus()}function p(){c.value=""}return{element:v,setValue:n,setPlaceHolder:s,focus:l,clear:p}}function Ti(e){const c=ln({placeholder:e.placeholder,value:e.value,onChange:e.onChange,optional:()=>_("div",{className:"search-box-icon flex items-center content-center",innerHTML:Ys}),...e});return{element:c.element,setPlaceHolder:c.setPlaceHolder,focus:c.focus,clear:c.clear}}function vo(){let e=Ti({placeholder:"Type here to search"});const c=[Q.settings,Q.notepad,Q.explorer,Q.photos,Q.calculator];function v(){e.focus()}function b(){e.clear()}let x=Bt({className:"search-popup"},_("div",{className:"search-container flex flex-col p-20"},[_("div",{className:"search-popup-top flex-1"},[_("div",{style:{fontWeight:"bold"}},"Top Apps"),_("div",{className:"search-popup-apps"},[c.map(k=>_("div",{className:"search-popup-app-item",onclick(){x.close(),ni({...k,type:"app"})}},[_("div",{className:"search-popup-app-item-icon",style:{backgroundImage:`url(${k.icon})`}}),_("div",{className:"search-popup-app-item-text"},k.productName)]))])]),_("div",{className:"search-popup-bottom"},[_("div",{className:"search-popup-filter flex"},[_("div",{className:"search-popup-filter-item selected"},"All"),_("div",{className:"search-popup-filter-item"},"Apps"),_("div",{className:"search-popup-filter-item"},"Settings"),_("div",{className:"search-popup-filter-item"},"Folders"),_("div",{className:"search-popup-filter-item"},"Documents"),_("div",{className:"search-popup-filter-item"},"Web"),_("div",{className:"search-popup-filter-item"},"Photos"),_("div",{className:"search-popup-filter-item"},"Music"),_("div",{className:"search-popup-filter-item"},"Videos")]),_("div",{className:"search-popup-input"},e.element)])]),{onShow:v,onHide:b});return x}function _o(){let e=vo();const c=_("div",{title:"Search",className:"taskbar-item h-full flex-shrink-0",onclick:()=>{vt(),Me(ae.closePopup,e.id),e.toggleShow({left:Math.round(c.getBoundingClientRect().left)})},onmousedown:v=>v.stopPropagation()},_("div",{className:"taskbar-item-button taskbar-item-button-search flex items-center content-center h-full",style:{width:"40px"},innerHTML:Ys}));return{element:c}}function wo(){Me(ae.showDesktopHover)}function bo(){Me(ae.showDesktopOut)}function cn(){Me(ae.showDesktop)}function yo(){function e(){vt(),Me(ae.closePopup,Cs.id),Cs.toggleShow()}function c(x){x.stopPropagation(),x.preventDefault(),jt({top:x.y,left:x.x},x.currentTarget,[{text:"Apps and Features",onClick:()=>{Fe(Q.settings.name,"apps")}},{text:"Mobility Center"},{text:"Power Options"},{text:"Event Viewer"},{text:"System"},{text:"Device Manager"},{text:"Network Connection"},{text:"Disk Management"},{text:"Computer Management"},{text:"Command Prompt(Admin)",onClick:()=>{Fe(Q.terminal.name)}},{divider:!0},{text:"Task Manager"},{text:"Settings",onClick:()=>{Fe(Q.settings.name)}},{text:"File Explorer",onClick:()=>{Fe(Q.explorer.name)}},{text:"Search"},{text:"Run"},{divider:!0},{text:"Shutdown or signout",children:[{text:"Sign out"},{text:"Sleep"},{text:"Shut down"},{text:"Restart"}]},{text:"Desktop",onClick:()=>{cn()}}])}const b=[{name:"startMenu",item:Gr({isSystemApp:!0,name:"start-menu",productName:"Start",icon:fr,iconType:"svg"},{onclick:e,oncontextmenu:c})}].map(x=>x.item.element);return _("div",{className:"taskbar-app-items h-full flex flex-shrink-0 items-center content-center"},b)}function So(){let e=[],c=localStorage.getItem("taskbarItems");if(typeof c>"u"||c===null)e=[{name:"explorer",item:_t(Q.explorer,{onRemove:x}),pinned:!0},{name:"settings",item:_t(Q.settings,{onRemove:x}),pinned:!0},{name:"notepad",item:_t(Q.notepad,{onRemove:x}),pinned:!0},{name:"calculator",item:_t(Q.calculator,{onRemove:x}),pinned:!0},{name:"photos",item:_t(Q.photos,{onRemove:x}),pinned:!0},{name:"cmd",item:_t(Q.cmd,{onRemove:x}),pinned:!0}];else try{c&&(c=JSON.parse(c),c instanceof Array&&(e=c.map(u=>({name:u,item:_t(Q[u],{onRemove:x}),pinned:!0}))))}catch{}let v;const b=_("div",{className:"w-full h-full flex content-center"},[v=_("div",{className:"taskbar-app-items h-full flex items-center content-center"},e.map(u=>u.item.element))]);function x(){}function k(u){return e.find(d=>d.name===u)}function S(u,d){const t={name:u,item:d};return e.push(t),v.appendChild(d.element),t}function n(u){e=e.filter(d=>d.name!==u)}function s(u,d,t){u.item.addInstance&&u.item.addInstance(d,t)}function l(u,d,t){const i=k(u);if(i)s(i,d,t);else{let o=_t({name:t.name,productName:t.productName,icon:t.icon});const r=S(u,o);s(r,d,t),e.push({name:u,item:o})}}function p(u,d){const t=k(u);t&&(t.item.removeInstance(d),t.item.getInstances().length||(t.pinned?t.item.removeActive(d):(t.item.remove(),n(u))))}function a(u,d){const t=k(u);t&&t.item.setActive(d)}function h(u,d){const t=k(u);t&&t.item.removeActive(d)}function f(u){return k(u).item.element.getBoundingClientRect()}return{element:b,addInstance:l,removeAppItem:n,removeInstance:p,setActiveWindow:a,removeActiveWindow:h,getAppItemBounds:f}}function xo(){const e=So(),c=_("div",{className:"taskbar fixed bottom w-full",style:{height:We+"px"}},_("div",{className:"taskbar-inner flex h-full",oncontextmenu:v},[_("div",{className:"taskbar-left h-full flex-1 flex-shrink-0 flex items-center"},[yo(),Qr().element,to().element,go().element,_o().element]),_("div",{className:"taskbar-center flex-2 h-full"},e.element),_("div",{className:"taskbar-right h-full flex-1 flex-shrink-0 relative flex items-center content-end",style:{paddingRight:"6px"}},[_("div",{title:"Show hidden icons",className:"taskbar-item flex items-center content-center flex-shrink-0 taskbar-item-more",innerHTML:Gs}),_("div",{className:"taskbar-item flex items-center content-center flex-shrink-0",onmousedown:b=>b.stopPropagation(),onclick:()=>{vt(),Me(ae.closePopup,xs.id),xs.toggleShow()}},[_("div",{className:"taskbar-item-button flex items-center content-center h-full flex-shrink-0",style:{width:We+"px"},innerHTML:Vs}),_("div",{className:"taskbar-item-button flex items-center content-center h-full flex-shrink-0",style:{width:We+"px"},innerHTML:js}),_("div",{className:"taskbar-item-button flex items-center content-center h-full flex-shrink-0",style:{width:We+"px"},innerHTML:Ks})]),Jr().element,_("div",{className:"show-desktop flex-shrink-0",onmouseover:wo,onmouseout:bo,onclick:cn})])]));function v(b){jt({top:b.y,left:b.x},b.currentTarget,[{text:"Taskbar Settings",onClick:()=>{Fe("settings","personalization/taskbar")}},{text:"Lock the taskbar",checked:!0,onClick:()=>{console.log("Lock taskbar")}}])}return nt(document.body,c),e}const Ot=xo(),ze=[],it=[];let ti=[],mi=!1;function Co(){return it}function ko(e){const c=ti.findIndex(v=>v.window.id===e);c>-1&&ti.splice(c,1)}function Eo(e){const c=it.findIndex(v=>v.id===e.id);c>-1&&it.splice(c,1),it.push(e)}function Lo(e){const c=it.findIndex(v=>v.id===e);if(c>-1&&(it.splice(c,1),it.length>0)){const v=it[it.length-1];v.isVisible()&&v.focus()}}function is(e){const c=ze.length;for(let v=0;v<c;v++)e(ze[v])}function ss(e){return ze.find(c=>c.appName===e)}function To(e,c,v){mi=!1;const b=ze.length;for(let x=0;x<b;x++){const k=ze[x];k.window.decrementZIndex(),k.window.blur()}ze.push({appName:e,id:c,window:v}),Ot.addInstance(e,c,v)}function Do(e,c){const v=ze.findIndex(b=>b.id===c);v>-1&&(ze.splice(v,1),Ot.removeInstance(e,c)),Lo(c),ko(c)}function Mo(e,c,v){v.restoreZIndex(),Eo(v);const b=ze.length;for(let x=0;x<b;x++){const k=ze[x];k.id!==c&&(k.window.decrementZIndex(),k.window.blur())}}function Io(e){const c=ze.length;for(let v=0;v<c;v++){const b=ze[v];b.id!==e?b.window.isVisible()&&b.window.makeTransparent():b.window.element.classList.add("top-view")}}function Bo(e){if(e){const c=ze.length;for(let v=0;v<c;v++){const b=ze[v];b.id!==e?b.window.isVisible()&&b.window.removeTransparent():b.window.element.classList.remove("top-view")}}else{const c=ze.length;for(let v=0;v<c;v++){const b=ze[v];b.window.isVisible()&&b.window.removeTransparent()}}}function Ro(){is(e=>{e.window.blur()})}function Ao(){const e=ze.some(c=>c.window.isFullScreen);yi.toogleFullScreen(e)}window.addEventListener("resize",()=>{const e=ze.length;for(let c=0;c<e;c++){const v=ze[c];v.window.isMaximized()&&v.window.maximize()}},!1);function No(){if(!mi)ti=ze.filter(e=>e.window.isVisible()),ti.forEach(e=>{e.window.removeTransparent(),e.window.hide()});else{ti.forEach(c=>{c.window.removeTransparent(),c.window.show()});const e=it[it.length-1];e&&e.isVisible()&&e.focus()}mi=!mi}Ne(ae.viewWindow,"window-manager",e=>{Io(e.id)});Ne(ae.restoreView,"window-manager",e=>{Bo(e.id)});Ne(ae.showDesktopHover,"window-manager",()=>{is(e=>{e.window.isVisible()&&e.window.makeTransparent()})});Ne(ae.showDesktopOut,"window-manager",()=>{is(e=>{e.window.isVisible()&&e.window.removeTransparent()})});Ne(ae.showDesktop,"window-manager",()=>{No()});Ne(ae.blurAllWindow,"window-manager",()=>{Ro()});function Po(){let e=0,c=0;function v(){e=window.innerWidth,c=window.innerHeight}return v(),window.addEventListener("resize",v,!1),{get width(){return e},get height(){return c}}}let Ce=Po();const ks=1e6,Ke=30;function lt(e){let c={...e};const v={};if(e.singleInstance){let K=ss(e.name);if(K)return K.window.executeListeners("secondInstance",e.args),K.window}let b,x=ks;const k=Ii(32);let S,n=!1,s=!1,l=!1,p=!1,a=!1,h=!1,f="",u=!1,d=!1,t=!1,i,o=!1;function r(K,re){v[K]||(v[K]=[]),v[K].push(re)}function m(K,re){const Ie=v[K];if(Ie)for(let Je=0;Je<Ie.length;Je++)Ie[Je](re)}function g(K,re){if(G(v[K])){const Ie=v[K].findIndex(Je=>Je.name===re.name);Ie>-1&&v[K].splice(Ie,1)}}let E=e.title||"",T=hr({icon:e.icon,hideIcon:e.hideIcon,title:e.title,hideTitle:e.hideTitle,disableMaximize:e.disableMaximize,maximized:e.maximized,autoHide:e.autoHideTitleBar,content:e.titlebarContent,stretchTitlebarContent:e.stretchTitlebarContent},{onMinimizeButtonClick:me,onMaximizeButtonClick:be,onCloseButtonClick:Wn,onVisible:()=>m("ontitlebarshow"),onHidden:()=>m("ontitlebarhide")}),w={top:0,left:0,width:0,height:0};const y={zIndex:x.toString()};let M=0,I=0,C=300,D=200,A=300,H=200,N=!1,F=0;e.keepAspectRatio&&(N=e.keepAspectRatio),e.minWidth&&(A=e.minWidth),e.minHeight&&(H=e.minHeight),e.top&&(M=Number(e.top)),e.left&&(I=Number(e.left)),e.width&&(C=Number(e.width),C<A&&(C=A)),e.height&&(D=Number(e.height),D<H&&(D=H)),e.center&&(M=Math.round((window.innerHeight-D-We)/2),I=Math.round((window.innerWidth-C)/2)),N&&(F=C/D),y.top=M+"px",y.left=I+"px",y.minWidth=A+"px",y.width=C+"px",y.height=D+"px",y.minHeight=H+"px",w={top:M,left:I,width:C,height:D};let L="";e.noBorder&&(L+=" no-border"),e.className&&(L+=" "+e.className);let B="window-content";e.fluidContent&&(B+=" fluid"),e.transprencyContent||(B+=" theme-background");let O,P,z,W,U,j,Y,R,$,q,X,se,V,he={top:!1,left:!1,right:!1,topLeft:!1,topRight:!1,bottomLeft:!1,bottomRight:!1},ke=!0;const ee=()=>{let re=[{text:"Restore",icon:_("i",{className:"window-titlebar-context-icon",innerHTML:zi}),disabled:!s,onClick:()=>{At()},emphasis:s},{text:"Move",disabled:!0},{text:"Size",disabled:!0},{text:"Minimize",icon:_("i",{className:"window-titlebar-context-icon",innerHTML:Ws}),onClick:()=>{ci()}},{text:"Maximize",icon:_("i",{className:"window-titlebar-context-icon",innerHTML:Wi}),onClick:()=>{At()},disabled:e.disableMaximize||s},{divider:!0},{text:"Close",icon:_("i",{className:"window-titlebar-context-icon",innerHTML:$s}),onClick:()=>{Ni()},shortcut:"Alt+X"}];return G(e.extendContextMenu)&&(re=re.concat(e.extendContextMenu)),re},le=e.disableResize?" disabled":"";V=_("div",{tabIndex:-1,className:"window"+L,style:y,id:k},[_("div",{className:"window-background absolute w-full h-full"}),_("div",{className:"window-inner relative w-full h-full"},[T.element,S=_("div",{className:B})]),O=_("div",{"data-resize":"t",className:"window-resize-handle window-resize-horizontal window-resize-top"+le}),z=_("div",{"data-resize":"b",className:"window-resize-handle window-resize-horizontal window-resize-bottom"+le}),P=_("div",{"data-resize":"l",className:"window-resize-handle window-resize-vertical window-resize-left"+le}),W=_("div",{"data-resize":"r",className:"window-resize-handle window-resize-vertical window-resize-right"+le}),U=_("div",{"data-resize":"tl",className:"window-resize-handle window-resize-conner window-resize-nw window-resize-tl window-resize-tl-v"+le}),j=_("div",{"data-resize":"tl",className:"window-resize-handle window-resize-conner window-resize-nw window-resize-tl window-resize-tl-h"+le}),$=_("div",{"data-resize":"br",className:"window-resize-handle window-resize-conner window-resize-nw window-resize-br window-resize-br-v"+le}),q=_("div",{"data-resize":"br",className:"window-resize-handle window-resize-conner window-resize-nw window-resize-br window-resize-br-h"+le}),Y=_("div",{"data-resize":"bl",className:"window-resize-handle window-resize-conner window-resize-ne window-resize-bl window-resize-bl-v"+le}),R=_("div",{"data-resize":"bl",className:"window-resize-handle window-resize-conner window-resize-ne window-resize-bl window-resize-bl-h"+le}),X=_("div",{"data-resize":"tr",className:"window-resize-handle window-resize-conner window-resize-ne window-resize-tr window-resize-tr-v"+le}),se=_("div",{"data-resize":"tr",className:"window-resize-handle window-resize-conner window-resize-ne window-resize-tr window-resize-tr-h"+le})]),V.addEventListener("customdrop",K=>{m("customdrop",K.detail)},!1),typeof e.titlebarHeight=="number"&&e.titlebarHeight>0&&Z(e.titlebarHeight);function Z(K){V.style.setProperty("--titlebar-height",K+"px")}yi.addWindow(V);let de=!1;V.addEventListener("animationend",()=>{de||(m("ready"),de=!0),m("animationend")});let _e=new ResizeObserver(K=>{if(!o&&!d){if(s||h){const re=K[0].contentRect;M=re.top,I=re.left,C=re.width,D=re.height}l||m("passiveResize")}});_e.observe(V);let we;e.autoHideTitleBar&&(V.addEventListener("mouseover",J,!1),V.addEventListener("mouseout",te,!1),V.addEventListener("mousemove",oe,!1)),V.addEventListener("mousedown",pe,!1);function J(){we&&clearTimeout(we),T.setAutoHide(!1),t&&T.setAutoHide(!0)}function oe(){we&&clearTimeout(we),T.setAutoHide(!1),we=setTimeout(()=>{t&&T.setAutoHide(!0)},100)}function te(){we&&clearTimeout(we),t&&T.setAutoHide(!0)}function xe(K){t=K,T.setAutoHide(K)}function ce(K){at(S),nt(S,K),ct()}function Pe(K,re){let Ie=[Ze(K,O,N,F,re),Ze(K,z,N,F,re),Ze(K,P,N,F,re),Ze(K,W,N,F,re),Ze(K,U,N,F,re),Ze(K,j,N,F,re),Ze(K,Y,N,F,re),Ze(K,R,N,F,re),Ze(K,$,N,F,re),Ze(K,q,N,F,re),Ze(K,X,N,F,re),Ze(K,se,N,F,re)];function Je(Hi){for(let kt=0;kt<Ie.length;kt++)Ie[kt].setAspectRatio(Hi)}function Pi(Hi){for(let kt=0;kt<Ie.length;kt++)Ie[kt].setKeepAspectRatio(Hi)}return{setAspectRatio:Je,setKeepAspectRatio:Pi}}function ve(){o=!1,w=Ct(),m("resizeend"),us()}e.disableResize||(i=Pe(V,{onResizeStart:()=>m("resizestart"),onResize:K=>{o=!0,M=K.top,I=K.left,C=K.width,D=K.height,m("resize",{width:C,height:D})},onResizeEnd:ve})),document.addEventListener("mousedown",ie,!1);function ie(K){const re=K.target;V.contains(re)||gs()}function pe(){Vt()}function me(){ci()}function Le(){m("minimize")}function ne(){m("maximize")}function ue(){V.offsetWidth,s||V.classList.remove("window-maximized"),m("restore")}function be(){At()}function ct(){Array.from(V.querySelectorAll("[drag-region=drag]")).forEach(re=>{re.oncontextmenu=An,re.ondblclick=Rn,Us(V,re,{onDragStart:()=>m("dragstart"),onDrag:Tn,onDragEnd:us})})}ct();function ot(K,re){he[K]||(he[K]=!0,V.classList.add("max-z-index"),Object.keys(he).forEach(Ie=>{Ie!==K&&(he[Ie]=!1)}),ke=!1,re())}function Ln(K){ke||(ke=!0,V.classList.remove("max-z-index"),Object.keys(he).forEach(re=>{he[re]=!1}),K())}function Tn(K,re){M=re.top,I=re.left,ds(K),m("drag",K)}function ds(K){setTimeout(()=>{if(s||u){const re=Ct(),Ie=Math.round((K.x-re.left)/re.width*w.width),Je=K.x-Ie;let Pi=K.y-re.top;et({...w,top:s?0:K.y-Pi,left:Je}),u&&(u=!1,In()),s&&(s=!1,T.setMaximize(s),V.classList.remove("window-maximized"),m("unmaximize"))}},0),e.disableResize||(K.y<=0&&K.x<=Ke||K.x<=0&&K.y<=Ke?ot(Ee.topLeft,()=>{f=Ee.topLeft,$e.showShape(Ee.topLeft,w)}):K.y<=0&&K.x>=Ce.width-Ke||K.x>=Ce.width-1&&K.y<=Ke?ot(Ee.topRight,()=>{f=Ee.topRight,$e.showShape(Ee.topRight,w)}):K.y>=Ce.height-We&&K.x<=Ke||K.x<=0&&K.y>=Ce.height-We-Ke?ot(Ee.bottomLeft,()=>{f=Ee.bottomLeft,$e.showShape(Ee.bottomLeft,w)}):K.y>=Ce.height-We&&K.x>=Ce.width-Ke||K.x>=Ce.width-1&&K.y>=Ce.height-We-Ke?ot(Ee.bottomRight,()=>{f=Ee.bottomRight,$e.showShape(Ee.bottomRight,w)}):K.y<=0&&K.x>Ke&&K.x<Ce.width-Ke?ot(Ee.top,()=>{f=Ee.top,$e.showShape(Ee.top,w)}):K.x<=0&&K.y>Ke&&K.y<Ce.height-We-Ke?ot(Ee.left,()=>{f=Ee.left,$e.showShape(Ee.left,w)}):K.x>=Ce.width-1&&K.y>Ke&&K.y<Ce.height-We-Ke?ot(Ee.right,()=>{f=Ee.right,$e.showShape(Ee.right,w)}):Ln(()=>{f="",$e.removeShape()}))}function Dn(){V.classList.add("window-restore-down"),setTimeout(()=>{V.classList.remove("window-restore-down")},100),m("unmaximize")}function Mn(){V.offsetTop<0&&(V.style.top=0+"px"),window.innerHeight-V.offsetTop<We+Mt&&(V.style.top=window.innerHeight-(We+Mt)+"px"),V.offsetLeft+V.offsetWidth<30&&(V.style.left=-100+"px"),window.innerWidth-V.offsetLeft<30&&(V.style.left=window.innerWidth-100+"px")}function Rt(){V.classList.add("win-snap")}function In(){V.classList.remove("win-snap"),m("unSnap")}function us(){fs(),m("dragend",w)}function fs(){if(!s&&!c.disableMaximize&&!c.disableResize){if(f!==""&&!e.disableMaximize){u=!0;let K=Math.floor(Ce.width/2),re=Ce.height-We,Ie=Math.floor(re/2),Je=re-Ie;K=Math.max(K,A),Ie=Math.max(Ie,H),f===Ee.top?At(!0):f===Ee.left?(et({top:0,left:0,width:K,height:re}),Rt()):f===Ee.right?(et({top:0,left:Ce.width-K,width:K,height:re}),Rt()):f===Ee.topLeft?(et({top:0,left:0,width:K,height:Ie}),Rt()):f===Ee.bottomLeft?(et({top:Ie,left:0,width:K,height:Je}),Rt()):f===Ee.bottomRight?(et({top:Ie,left:Ce.width-K,width:K,height:Je}),Rt()):f===Ee.topRight&&(et({top:0,left:Ce.width-K,width:K,height:Ie}),Rt()),m("snap")}else w=Ct(),Mn();for(let K in he)if(he[K]){$e.removeShape();break}}}function Bi(){f="",s=!0,e.disableMaximize||(et({top:0,left:0,width:window.innerWidth,height:window.innerHeight-We}),V.classList.add("window-maximized"),ne())}function Bn(){s=!1,e.disableMaximize||(et(w),V.classList.remove("window-maximized"),Dn())}function At(K){e.disableMaximize||(s=!s,s?(!K&&!u&&(w=Ct()),w.top<0&&(w.top=0),Bi()):Bn(),T.setMaximize(s),V.focus())}function Rn(){At()}function An(K){K.preventDefault(),Vt(),jt({top:K.y,left:K.x},K.currentTarget,ee(),!1,()=>{setTimeout(()=>{V&&!l&&Vt()},10)},!1)}function et(K){G(K.top)&&(M=K.top,V.style.top=K.top+"px"),G(K.left)&&(I=K.left,V.style.left=K.left+"px"),G(K.width)&&(C=K.width,V.style.width=K.width+"px"),G(K.height)&&(D=K.height,V.style.height=K.height+"px"),e.disableResize||i.setAspectRatio(C/D)}function Ct(){const K=V.getBoundingClientRect();return{top:K.top,left:K.left,width:K.width,height:K.height}}function Nn(K){C=K.width,D=K.height,V.style.width=K.width+"px",V.style.height=K.height+"px",e.disableResize||i.setAspectRatio(C/D)}function ms(){V.style.zIndex=x.toString()}function Pn(){x-=1,ms()}function ps(){x=ks,ms()}function Ri(){V.classList.remove("top-view")}function Vt(){p||(V.focus(),V.classList.add("focus"),Ri(),Mo(b.name,k,b),Ot.setActiveWindow(b.name,k),p=!0),setTimeout(()=>{m("focus",p)},0)}function gs(){p=!1,V.classList.remove("focus"),Ot.removeActiveWindow(b.name,k),m("blur")}function vs(){V.classList.add("transparent"),n=!0}function _s(){V.classList.remove("transparent"),n=!1}function Hn(){n?_s():vs()}function On(){h=!h,h?(!s&&!u&&(w=Ct()),V.classList.add("fullscreen"),T.setVisible(!1)):(s||et(w),T.setVisible(!0),V.classList.remove("fullscreen")),Ao(),m("fullscreen",h)}function Fn(){return s}function ws(){d=!1,V.classList.remove("show"),V.removeEventListener("animationend",ws,!1)}function Ai(){V.classList.remove("minimized"),Ri(),l?(V.classList.add("window-restored"),V.style.transform="translate3d(0px,0px,0px)",setTimeout(()=>{ue(),V.classList.remove("window-restored"),V.style.removeProperty("transform")},300)):a||(d=!0,V.classList.add("show"),V.addEventListener("animationend",ws,!1)),a=!0,l=!1,ps(),s&&Bi()}function ci(){Ri();const K=Ot.getAppItemBounds(e.name);V.classList.remove("window-restored"),V.classList.remove("show"),V.classList.remove("focus"),V.classList.add("minimized");const re=Ct();setTimeout(()=>{V.style.transform=`translate3d(${K.left-re.left}px, ${K.top}px, 0) scale(0.2)`},0),a=!1,p=!1,l=!0,e.name,Ot.removeActiveWindow(e.name,k),Le()}function zn(){a?ci():Ai()}function Wn(){Ni()}function Ni(){_e.disconnect(),document.removeEventListener("mousedown",ie,!1),G(V)&&(V.className="window closing",m("close"),d=!0,V.addEventListener("animationend",()=>{d=!1,T.element.remove(),V.remove(),V=void 0,Do(e.name,k)}))}function $n(){return a}function Un(){return p}function jn(K){c.icon=K,T.setIcon(K)}function Vn(K){E=K,T.setTitle(K)}function Kn(){return E}function qn(K){V.style.top=K.top+"px",V.style.left=K.left+"px"}function Xn(){let K=Math.round((window.innerHeight-D-We)/2),re=Math.round((window.innerWidth-C)/2);qn({top:K,left:re})}function Gn(K){S.classList[K?"add":"remove"]("fluid")}return b={id:k,get icon(){return c.icon},get name(){return c.name},get productName(){return c.productName},get title(){return E},get isFullScreen(){return h},element:V,setContent:ce,show:Ai,hide:ci,titlebar:T,setAutoHideTitleBar:xe,setIcon:jn,setTitle:Vn,getTitle:Kn,setMaximize:T.setMaximize,toggleMaximize:At,maximize:Bi,decrementZIndex:Pn,restoreZIndex:ps,focus:Vt,blur:gs,makeTransparent:vs,removeTransparent:_s,toggleTransprent:Hn,toggleFullscreen:On,isMaximized:Fn,close:Ni,toggleShow:zn,isVisible:$n,isFocused:Un,getBounds:Ct,setBounds:et,setSize:Nn,makeCenter:Xn,addEventListener:r,executeListeners:m,removeListeners:g,updateDragHandle:ct,setTitlebarHeight:Z,checkWindowSnap:ds,setWindowSnap:fs,setFluidContent:Gn},ye(e.content)&&ce(e.content(b)),To(e.name,k,b),Ai(),setTimeout(()=>{Vt()},0),b}function ns(e){let c;const v=ir({maxValue:e.maxValue,color:"#00b521"}),b=lt({name:"explorer-transfer",title:"Copying...",icon:Q.explorer.icon,width:500,height:120,minHeight:100,center:!0,disableMaximize:!0,disableResize:!0,content:()=>_("div",{className:"p-20 w-full h-full"},[c=_("div",{style:{marginBottom:"10px"},innerHTML:e.description}),_("div",{className:"w-full"},v.element)])});function x(s){v.setValue(s)}function k(s){b.setTitle(s)}function S(s){c.innerHTML=s}function n(){b.close()}return{setTitle:k,setDescription:S,setValue:x,close:n}}function rs(e){let c,v,b,x=!0;function k(){const h={maxWidth:e.width+"px",maxHeight:e.height+"px",width:"100%",height:"100%"};if(G(e.parent)){const f=e.parent.getBoundingClientRect();h.top=Math.round((f.height-e.height)/2)+"px",h.left=Math.round((f.width-e.width)/2)+"px"}else h.top=Math.round((Ce.height-Mt)/2-Math.round(e.height/2))+"px",h.left=Ce.width/2-Math.round(e.width/2)+"px";c=_("div",{className:"dialog-content zoom-in focus relative flex flex-col",style:h},[_("div",{className:"dialog-titlebar flex"},[b=_("div",{className:"dialog-titlebar-text w-full flex items-center"},_("div",{className:"text-ellipsis line-clamp-1"},e.title)),_("div",{className:"dialog-titlebar-buttons flex-shrink-0 flex items-center",style:{marginLeft:"auto"}},[_("div",{title:"Close",className:"window-titlebar-button window-titlebar-close-button flex items-center content-center",innerHTML:qs,onclick:l})])]),_("div",{className:"w-full flex-1"},e.content),e.hideButtons?null:_("div",{className:"dialog-footer flex"},[_("button",{className:"dialog-footer-button button",onclick(){ye(e.onOK)&&e.onOK(),a()}},"OK"),v=_("button",{className:"dialog-footer-button button",onclick:()=>{a()}},"Cancel")])]),nt(G(e.parent)?e.parent:document.body,c),e.hideButtons||v.focus(),Us(c,b),document.addEventListener("mousedown",S,!1)}k();function S(h){const f=h.target;c.contains(f)?x||(x=!0,n()):s()}function n(){c.classList.add("focus")}function s(){x=!1,c.classList.remove("focus")}function l(){a()}function p(){c.remove()}function a(){c.classList.add("closing"),document.removeEventListener("mousedown",S,!1),x=!1,c.addEventListener("animationend",p,!1)}return{element:c,close:a}}function Ho(e){return rs({title:e.title,width:e.width||300,height:e.height||160,content:e.content,onOK:e.onOK})}function Ui(e){let c=e.getDate().toString();return e.getDate()<10&&(c="0"+c),`${Zi[e.getDay()]}, ${dr[e.getMonth()]} ${c}, ${e.getFullYear()}`}function It(e,c=!1){let v=e.getHours(),b=e.getMinutes(),x=e.getSeconds(),k=v>=12?"PM":"AM";return v=v%12,v=v||12,b=b<10?"0"+b:b,x=x<10?"0"+x:x,v+":"+b+(c?":"+x:"")+" "+k}function vt(){window.lastContextMenu&&window.lastContextMenu.close()}function Oo(e,c){const v=_("img");v.onload=()=>{const b=v.naturalWidth,x=v.naturalHeight,k=b/x;c({width:b,height:x,ratio:k})},v.onerror=()=>{c()},Xe(e)?v.mySrc=e:v.src=e}function Di(e){switch(e){case".jpg":case".png":case".webp":case".jfif":case".jpeg":return!0;default:return!1}}function Fo(e){switch(e){case".mp3":case".aac":case".m4a":case".ogg":case".flac":case".wav":return!0;default:return!1}}function Mi(e){switch(e){case".mp4":case".mkv":case".webm":case".ogv":return!0;default:return!1}}function os(e,c,v=200){const b=document.createElement("canvas"),x=b.getContext("2d"),k=new Image,S=v;k.height=S,k.src=e,k.onload=()=>{const n=k.naturalWidth/k.naturalHeight,s=Math.round(S*n);b.width=s,b.height=S,x.drawImage(k,0,0,s,S);const l=b.toDataURL("image/png");fetch(l).then(p=>p.blob()).then(p=>{const a=URL.createObjectURL(p);c(a,p,l,n)})}}function zo(e,c,v=200){let b=_("video");b.onloadedmetadata=function(){b.currentTime=b.duration*.2},b.onseeked=()=>{const x=b.videoWidth,k=b.videoHeight,S=k>0&&x>0?x/k:16/9,n=Math.round(v*S),s=document.createElement("canvas");s.width=n,s.height=v,s.getContext("2d").drawImage(b,0,0,n,v);const p=s.toDataURL("image/jpeg");fetch(p).then(a=>a.blob()).then(a=>{const h=URL.createObjectURL(a);c(h,a,p,S)}),b=void 0},b.onerror=()=>{c(null,null,null,null),b=void 0},b.src=e}function as(e,c=!0){document.documentElement.classList[e?"add":"remove"]("dark"),c&&pt({dark:e}),Me(ae.themeChange,e)}function ls(e,c=!0){document.documentElement.classList[e?"add":"remove"]("glass"),c&&pt({transparency:e}),Me(ae.transparentChange,e)}function G(e){return e!=null}function ji(e){return typeof e=="number"}function ye(e){return typeof e=="function"}function Vi(e,c){switch(e.style.backgroundColor="var(--theme-background)",e.style.backgroundRepeat="no-repeat",e.style.backgroundPosition="center",c){case"fill":e.style.backgroundSize="cover";break;case"fit":e.style.backgroundSize="contain";break;case"stretch":e.style.backgroundSize="100% 100%";break;case"center":e.style.backgroundSize="cover";break;case"tile":e.style.backgroundSize="contain",e.style.backgroundRepeat="repeat";break;case"span":e.style.backgroundSize="cover",e.style.backgroundPosition="left top";break;default:e.style.backgroundSize="cover";break}}function Ki(e){document.documentElement.classList.toggle("no-border-radius",!e),document.documentElement.classList.toggle("rounded-corner",e)}function zt(e,c){document.documentElement.classList.toggle(e,c)}function hn(e){document.documentElement.classList.toggle("use-border",e)}function pi(e,c){e.addEventListener("mousedown",s,!1);let v,b,x=0,k=0,S={x:0,y:0},n=!1;function s(a){a.button===0&&(document.addEventListener("mousemove",l,!1),document.addEventListener("mouseup",p,!1),S.x=a.x,S.y=a.y)}function l(a){if(document.documentElement.style.cursor=a.ctrlKey?"copy":"default",(Math.abs(a.x-S.x)>1||Math.abs(a.y-S.y)>1)&&!n){n=!0;const f=e.getBoundingClientRect();x=a.x-f.left,k=a.y-f.top,v=e.cloneNode(!0),v.classList.add("drag-item"),ge(v,{width:f.width+"px",height:f.height+"px"}),document.body.appendChild(v),e.dispatchEvent(new CustomEvent("customdragstart",{bubbles:!0,detail:c}))}G(v)&&ge(v,{top:a.y-k+"px",left:a.x-x+"px"});const h=document.elementFromPoint(a.x,a.y);h instanceof Element&&(b!==h?(b=h,b.dispatchEvent(new CustomEvent("customdragover",{bubbles:!0,detail:c}))):b.dispatchEvent(new CustomEvent("customdrag",{bubbles:!0,detail:c})))}function p(a){document.documentElement.style.cursor="default",n&&(b.dispatchEvent(new CustomEvent("customdrop",{bubbles:!0,detail:c})),document.body.removeChild(v),n=!1),document.removeEventListener("mousemove",l,!1),document.removeEventListener("mouseup",p,!1)}}function hi(e,c){c.parentNode.insertBefore(e,c.nextSibling)}function dn(e,c=!0){document.documentElement.style.setProperty("--accent-color",`hsl(${e.h}, ${e.s}%, ${e.l}%)`),document.documentElement.style.setProperty("--accent-color-value",e.h.toString()),c&&pt({accentColor:e})}function Xe(e){let v=/[a-z]:[\\/](?:[^\\/:*?"<>|\r\n]+[\\/])*[^\\/:*?"<>|\r\n]*/.exec(e);return G(v)&&v[0]===v.input}function St(e){const v=/^[a-zA-Z]:[\\/]?/.exec(e);return G(v)&&v[0]===v.input}function qt(e){const v=/(?:[\\/]?[^\\/:*?"<>|\r\n]+[\\/]?)*/.exec(e);return G(v)&&v[0]===v.input}function Es(e,c){return e.reduce((v,b)=>((v[c(b)]=v[c(b)]||[]).push(b),v),{})}function Wo(e,c){var v=5,b={r:0,g:0,b:0},x=document.createElement("canvas"),k=x.getContext("2d"),S,n,s=-4,l,p={r:0,g:0,b:0},a=0;const h=new Image;h.height=200,h.src=e,h.onload=()=>{const f=h.naturalWidth/h.naturalHeight;n=Math.round(200*f),k.drawImage(h,0,0,n,200);try{S=k.getImageData(0,0,n,200)}catch{c(b)}for(l=S.data.length;(s+=v*4)<l;)++a,p.r+=S.data[s],p.g+=S.data[s+1],p.b+=S.data[s+2];p.r=Math.floor(p.r/a),p.g=Math.floor(p.g/a),p.b=Math.floor(p.b/a),k.clearRect(0,0,n,200),c(p)}}function $o({r:e,g:c,b:v}){return e*.299+c*.587+v*.114>140?"#000":"#fff"}function Ls(e){Wo(e,c=>{const v=$o(c);document.documentElement.style.setProperty("--contrast-text-color",v)})}function un(e){Xe(e)?cs(e,(c,v)=>{if(!c)try{const b=URL.createObjectURL(v);Ls(b)}catch{}}):Ls(e)}function fn(e){zt("use-titlebar-accent-color",e.useTitleBarAccentColor),zt("use-startmenu-and-taskbar-accent-color",e.useTaskbarAndStartMenuAccentColor),zt("use-window-border-accent-color",e.useWindowBorderAccentColor),dn(e.accentColor,!1),as(e.dark,!1),ls(e.transparency,!1),$e.setBackgroundImage(e.background,!1),$e.setBackgroundStyle(e.backgroundImageStyle)}function pt(e){let{themes:c,themeIndex:v,customTheme:b}=Se.getState(["themes","themeIndex","customTheme"]);v>-1?b={...c[v],...e}:b={...b,...e},Se.setState({customTheme:b,themeIndex:-1}),Me(ae.customThemeChange)}function Uo(e){const c=Se.getState("recentImages").recentImages;if(G(c)){const v=c.find(b=>b.path===e.path);v?(c.splice(c.indexOf(v),1),c.unshift(e),Se.setState({recentImages:c})):(c.pop(),c.unshift(e)),Se.setState({recentImages:c})}}function di(){window.location.reload()}function jo(){Ho({title:"Reset This PC",text:"Reset",content:_("div",{},[_("div",{style:{paddingInline:"10px",fontWeight:"bold"}},"Reseting will:"),_("ul",{},[_("li",null,"Change settings back to their defaults"),_("li",null,"Remove personal files")])]),onOK(){Se.reset();const e=indexedDB.deleteDatabase("Local Disk C");e.onsuccess=()=>{di()},e.onerror=()=>{di()},e.onblocked=()=>{di()},e.onupgradeneeded=()=>{di()}}})}function Vo(e){Fe("cmd",e)}function Jt(e,c=0,v,b,x=[],k){const S=e.length-1,n=e[c];if(k=k||"",c>S){b(x);return}if(n.isFile)n.file(s=>{x.push({type:"file",path:v+k+"/"+s.name,file:s}),Jt(e,c+1,v,b,x,k)});else if(n.isDirectory){let s=function(){p.readEntries(function(h){h.length>0?(a=a.concat(h),s()):a.length===0?Jt(e,c+1,v,b,x,k):Jt(a,0,v,f=>{const u=f.length;for(let d=0;d<u;d++)x.push(f[d]);Jt(e,c+1,v,b,x,k)},[],l)})},l=k;l+="/"+n.name,x.push({type:"dir",path:v+l});let p=n.createReader(),a=[];s()}}function gi(e,c){const v=Array.from(c).map(b=>b.webkitGetAsEntry());Jt(v,0,e,b=>{const x=b.length;let k=0;for(let l=0;l<x;l++)b[l].type==="file"&&(k+=b[l].file.size);let S=0;const n=ns({maxValue:k,title:"Copying...",description:`Copying ${v.length} items from <span style="color: var(--blue-color)">Local machine</span> to <span style="color: var(--blue-color)">${Qe(e)}</span>`});function s(l=0){if(l>=x){setTimeout(()=>{n.close()},1e3);return}const p=b[l];p.type==="file"?(S+=p.file.size,fe.writeFile(p.path,p.file,a=>{a&&console.log(a),n.setValue(S),s(l+1)})):p.type==="dir"&&fe.createFolder(p.path,a=>{s(l+1)})}s()})}function Ko(e,c){let v=0,b=0;const x=c.length;for(let n of c)v+=n.size;const k=ns({maxValue:v,title:"Copying...",description:`Copying ${x} items from <span style="color: var(--blue-color)">Local machine</span> to <span style="color: var(--blue-color)">${Qe(e)}</span>`});function S(n=0){if(n>=x){setTimeout(()=>{k.close()},1e3);return}const s=c[n];b+=s.size,fe.writeFile(e+"/"+s.name,s,l=>{l&&console.log(l),k.setValue(b),S(n+1)})}S()}function qo(e,c){v((b,x)=>{if(!b){let k=function(p=0){if(p>=S){setTimeout(()=>{l.close()},1e3);return}const a=x[p];fe.unlink(a.location,h=>{h&&console.log(h),a.type==="file"&&(s+=a.size,l.setValue(s)),k(p+1)})};const S=x.length;let n=0;for(let p=0;p<S;p++)x[p].type==="file"&&(n+=x[p].size);if(n<10485760&&S<10){e.forEach(p=>{fe.unlink(p.location,a=>{a&&console.log(a)})});return}let s=0;const l=ns({maxValue:n,title:"Removing...",description:`Removing ${S} items from <span style="color: var(--blue-color)">${Qe(c)}</span>`});k()}});function v(b){let x=0,k=[];S();function S(){if(x===e.length){const s=k.concat(e);b(null,s);return}const n=e[x];n.type==="folder"?fe.readFolderRecursive(n.location,(s,l)=>{if(s){b(s);return}const p=l.map(a=>{const h={type:a.type,location:a.location};return a.type==="file"&&(h.size=a.size),h}).toReversed();k=k.concat(p),x++,S()}):(x++,S())}}}function Xo(e){Bt({width:300,height:400,className:"openWith-popup"},_("div",{className:"w-full h-full p-20"},"How do you want to open this file?")).show()}function Ts(e,c){return Math.floor(Math.random()*(c-e+1)+e)}function Ii(e=8){for(var c="",v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",b=0;b<e;b++)c+=v.charAt(Math.floor(Math.random()*v.length));return c}const Go=/webkit/.test(navigator.userAgent.toLowerCase()),vi=()=>[/Android/i,/webOS/i,/iPhone/i,/iPad/i].some(c=>navigator.userAgent.match(c));function Yo(e){return e.lastIndexOf(".")>-1?e.substring(e.lastIndexOf("."),e.length):null}function qi(e,c){Xe(e)?fe.readFile(e,(v,b)=>{v?c(v):G(b)?b.text().then(x=>{c(null,x)}):c(new Error("File not exists"))}):fetch(e).then(v=>v.text()).then(v=>c(null,v)).catch(v=>c(v))}function Qe(e){return e.substring(e.lastIndexOf("/")+1,e.length)}function gt(e){const c=e.lastIndexOf(".");return c>-1?e.substring(c,e.length):""}function cs(e,c){const v=indexedDB.open("Local Disk C");v.onsuccess=()=>{const k=v.result.transaction("files","readwrite").objectStore("files").get(e);k.onsuccess=()=>{G(k.result)?c(null,k.result):c(new Error("Item has removed!"))},k.onerror=()=>{c(new Error("Invalid path"))}},v.onerror=()=>{c(new Error("Can not access"))}}function Jo(e,c){let v;return function b(){const x=b,k=arguments;clearTimeout(v),v=setTimeout(()=>e.apply(x,k),c)}}function Ge(e,c=100){let v,b;return function x(){const k=x,S=arguments;b?(clearTimeout(v),v=setTimeout(function(){Date.now()-b>=c&&(e.apply(k,S),b=Date.now())},c-(Date.now()-b))):(e.apply(k,S),b=Date.now())}}function Wt(e,c){let v,b,x,k,S=c.limit||100,n=c.debounceDelay||200;return function s(){const l=s,p=arguments;ye(c.onFrame)&&(cancelAnimationFrame(k),k=requestAnimationFrame(()=>{c.onFrame.apply(l,p)})),ye(c.onDebounce)&&(clearTimeout(x),x=setTimeout(()=>{c.onDebounce.apply(l,p)},n)),ye(c.onFunction)&&c.onFunction.apply(l,p),b?(clearTimeout(v),v=setTimeout(function(){Date.now()-b>=S&&(e.apply(l,p),b=Date.now())},S-(Date.now()-b))):(e.apply(l,p),b=Date.now())}}function Zt(e,c=0){return Number(Math.round(parseFloat(e+"e"+c))+"e-"+c)}function mn(e,c){if(typeof e=="object")for(let v in c)typeof e[v]!=typeof c[v]?e[v]=c[v]:typeof e[v]=="object"&&mn(e[v],c[v]);return e}function Qt(e){return e>=1099511627776?{value:Zt(e/1099511627776,1),unit:"TB"}:e>=1073741824?{value:Zt(e/1073741824,1),unit:"GB"}:e>=1048576?{value:Zt(e/1048576,1),unit:"MB"}:e>=1024?{value:Zt(e/1024),unit:"KB"}:e>0?{value:1,unit:"KB"}:{value:0,unit:"B"}}const Ds=new Date(2023,0,1).getTime(),Pt={type:"mediumIcons",sortBy:"text",orderBy:"asc"};function De(e){const c={...e,name:e.name,type:e.type||"folder",children:e.children||[],cdate:Ds,mdate:Ds};return G(e.text)&&(c.text=e.text),G(e.type)&&(e.type==="file"||e.type==="shortcut")&&(c.size=0),G(e.icon)&&(c.icon=e.icon),c}const{USER_NAME:Zo,USER_HOME:Xt}=rt.getState(["USER_NAME","USER_HOME"]),pn=De({name:"c:",text:"Local Disk C",icon:"imgs/icons/Drives/Hardrive%20Windows.png",children:[De({name:"windows",children:[De({name:"system32",children:[]}),De({name:"Program Data",children:[De({name:"Explorer",children:[]})]})]}),De({name:"Code",children:[De({name:"App1"}),De({name:"App2"}),De({name:"App3"}),De({name:"App4"})],view:{type:"mediumIcons",sortBy:"text",orderBy:"asc"}}),De({name:"Users",children:[De({name:Zo,icon:Ae.user,children:[De({name:"Desktop",icon:Ae.desktop}),De({name:"Documents",icon:Ae.document,children:[De({name:"Google"}),De({name:"Microsoft"})]}),De({name:"Downloads",icon:Ae.download}),De({name:"Pictures",icon:Ae.pictures,children:[De({name:"Natures",view:Pt}),De({name:"Screenshots",view:Pt}),De({name:"Art",view:Pt}),De({name:"Abstract",view:Pt}),De({name:"Wallpapers",view:Pt})],view:Pt}),De({name:"Music",icon:Ae.music}),De({name:"Videos",icon:Ae.videos})]})]})]});function Qo(e){const c=e.transaction("tree","readwrite").objectStore("tree");let v=[];function b(x,k="",S=0){const n=x[S];let s=k===""?n.name:k+"/"+n.name;if(n.type==="folder"){const l={...n},p=n.children.map(a=>{const h={...a};return delete h.children,h});l.children=p,v.push({location:s,data:l})}n.children.length&&b(n.children,s),S<x.length-1&&b(x,k,S+1)}b([pn]);for(let x of v)c.put(x.data,x.location)}window.createDefaultFolderTree=Qo;function ea(){let e,c,v,b={};const x=indexedDB.open("Local Disk C");let k=pn,S,n,s=!1,l=!1,p=0,a=0;x.onupgradeneeded=function(){e=x.result,e.createObjectStore("tree").put(k,"c"),e.createObjectStore("files",{autoIncrement:!0});const I=indexedDB.open("Local Disk C");I.onsuccess=()=>{e=I.result;for(let C=1;C<=5;C++)fetch(`imgs/Pictures/IMG ${C}.jpg`).then(D=>D.blob()).then(D=>{o(`${Xt}/Pictures/Wallpapers/IMG ${C}.jpg`,D)});fetch("videos/VID 1.mp4").then(C=>C.blob()).then(C=>{o(`${Xt}/Videos/VID 1.mp4`,C),o(`${Xt}/Desktop/VID 1.mp4`,C)}),fetch("videos/VID 2.mp4").then(C=>C.blob()).then(C=>{o(`${Xt}/Videos/VID 2.mp4`,C),o(`${Xt}/Desktop/VID 2.mp4`,C)}),setTimeout(()=>{w("ready",e)},1e3)}},x.onsuccess=function(){e=x.result,window.db=e,h(),f();const I=c.get("c");I.onsuccess=function(){I.result&&(k=I.result)},w("ready",e)},x.onerror=function(I){w("error",I)};function h(){c=e.transaction("tree","readwrite").objectStore("tree")}function f(){v=e.transaction("files","readwrite").objectStore("files")}function u(I,C,D){const A=I.replace(/\\+/g,"/");h(),f();const H=A.split("/").filter(P=>P!=="");if(H.length===1){D(new Error("Invalid Path"));return}const N=Date.now(),F=H.length-1;let L=1,B=k;O();function O(){let P=B.children.findIndex(W=>W.name===H[L]),z;if(P===-1){const W=B.children.push({name:H[L],type:C.type,children:[],cdate:N,mdate:N})-1;if(z=B.children[W],L<F&&(z.type="folder"),L===F){c.put(k,"c"),C.type==="file"||C.type==="shortcut"?(z.type,C.type,delete z.children,v.put(null,A)):z.type,D(),w("added",A);return}else B=z,L+=1,O()}else if(z=B.children[P],L===F){D(new Error(C.type+" already exists"));return}else z.type==="folder"&&!G(z.children)&&(z.children=[]),B=z,L+=1,O()}}function d(I,C){u(I,{type:"folder"},C)}function t(I,C){const D=I.replace(/\\+/g,"/");h();const A=c.get("c");A.onsuccess=()=>{let H=A.result;const N=D.split("/").filter(F=>F!=="");if(N.length===0)C(new Error("Invalid path"));else if(N.length===1){if(St(N[0])){const F=H.children.map(L=>(delete L.children,L));C(null,F);return}C(new Error("Invalid path"))}else{N.shift();let F;for(let B of N){const O=H.children.findIndex(P=>P.name===B);if(O>-1)H=H.children[O];else{F=new Error("Path is no longer exists");break}}if(H.type!=="folder"&&(F=new Error("Path is no longer exists")),F){C(F);return}const L=H.children.map(B=>(delete B.children,B));C(null,L)}}}function i(I,C){const D=I.replace(/\\+/g,"/").replace(/\/+/g,"/");f();const A=v.get(D);A.onsuccess=()=>{C(null,A.result)},A.onerror=()=>{C(A.error)}}function o(I,C,D){const A=I.replace(/\\+/g,"/"),H=A.split("/").filter(z=>z!=="");if(H.length===1){ye(D)&&D(new Error("Invalid Path"));return}const N=H.length-1;let F=1,L=k;const B=Date.now();O();function O(){let z=L.children.findIndex(U=>U.name===H[F]),W;if(z===-1){const U=L.children.push({name:H[F],type:"folder",children:[],cdate:B,mdate:B})-1;if(W=L.children[U],F===N){W.type="file",delete W.children,W.size=C.size,f();const j=new File([C],Qe(A)),Y=v.put(j,A);Y.onsuccess=()=>{ye(D)&&D(),P(),w("added",A)},Y.onerror=()=>{D(Y.error)};return}else L=W,F+=1,O()}else if(W=L.children[z],F===N){delete W.children,W.type="file",W.size=C.size,W.mdate=Date.now(),f();const U=v.put(C,A);U.onsuccess=()=>{ye(D)&&D(),P(),w("modified",A)},U.onerror=()=>{D(U.error)};return}else L=W,F+=1,O()}function P(){p+=1,s||(s=!0,h(),c.put(k,"c")),S&&clearTimeout(S),S=setTimeout(()=>{if(p>1){h();const z=c.put(k,"c");z.onerror=()=>{D(z.error)}}p=0,s=!1},200)}}function r(I,C){const D=I.replace(/\\+/g,"/");h();const A=c.get("c");A.onsuccess=()=>{let H=A.result,N;const F=D.split("/").filter(B=>B!=="");if(F.length===0){C(new Error("Invalid path",{cause:1}));return}if(F.length===1){const B=F[0],O=B.split(":")[0];St(B)&&O==="c"?(delete H.children,C(null,H)):C(new Error("Invalid path",{cause:1}));return}F.shift();let L;for(let B of F){const O=H.children.findIndex(P=>P.name===B);if(O>-1)N=H.children[O],H=N;else{L=new Error("Path is no longer exists",{cause:2});break}}G(N)&&delete N.children,C(L,N)},A.onerror=()=>{C(new Error("Unknown error",{cause:0}))}}function m(I,C){const D=I.replace(/\\+/g,"/"),A=D.split("/").filter(B=>B!=="");if(A.length===1){C(new Error("Invalid Path"));return}const H=A.length-1;let N=1,F=k;L();function L(){const B=F.children.findIndex(P=>P.name===A[N]);if(B===-1){C(new Error("Item not exsist"));return}else if(N===H){const P=F.children[B];if(P.type==="file"||P.type==="shortcut"){F.children.splice(B,1),f();const z=v.delete(D);z.onsuccess=()=>{C(),O(),w("removed",D)},z.onerror=()=>C(z.error)}else P.type==="folder"?g(D,(z,W)=>{if(G(z))C(z);else{const U=W.filter(R=>R.type==="file"),j=U.length;f();for(let R=0;R<j;R++){const $=U[R];v.delete($.location),w("removed",$.location)}const Y=F.children.findIndex(R=>R.name===P.name);Y>-1?(F.children.splice(Y,1),O(),C(),w("removed",D)):C(new Error("Invalid Path"))}}):C(new Error("Unknown error"))}else F=F.children[B],N+=1,L();function O(){a+=1,l||(l=!0,h(),c.put(k,"c")),n&&clearTimeout(n),n=setTimeout(()=>{if(a>1){h();const P=c.put(k,"c");P.onerror=()=>{C(P.error)}}a=0,l=!1},200)}}}function g(I,C,D=[]){t(I,(A,H)=>{if(A)return C(A,D);let N=0;(function F(){var L=H[N++];if(!L)return C(null,D);let B=I+"/"+L.name;L.location=B,D.push(L),L.type==="folder"?g(B,(O,P)=>{if(A)return C(A,D);D=D.concat(P),F()}):F()})()})}function E(I,C,D){const A=I.replace(/\\+/g,"/");h();const H=A.split("/").filter(O=>O!=="");if(H.length===1){St(H[0])?(k.view=C,c.put(k,"c"),ye(D)&&D()):ye(D)&&D(new Error("InValid Path"));return}const N=H.length-1;let F=1,L=k;B();function B(){let O=L.children.findIndex(z=>z.name===H[F]),P;if(O>-1)if(P=L.children[O],F===N){P.view=C,c.put(k,"c"),ye(D)&&D();return}else L=P,F+=1,B()}}function T(I,C,D){b[I]||(b[I]=Object.create(null)),b[I][C]=D}function w(I,C){if(!(typeof b[I]>"u"))for(let D in b[I])b[I][D](C)}function y(I,C){delete b[I][C]}function M(){return k}return{addEventListener:T,removeListeners:y,createItem:u,createFolder:d,readFolder:t,readFolderRecursive:g,readFile:i,writeFile:o,unlink:m,stats:r,check:M,setView:E}}const fe=ea();function ta(){const c="c:/Program Data/Explorer/"+"thumbnails";let v=[],b=0;const x=[];fe.addEventListener("ready","explorer-thumbnails",()=>{k()});function k(){qi(c,(f,u)=>{if(f)n();else try{v=JSON.parse(u)}catch(d){console.error(d)}})}let S;function n(){S&&clearTimeout(S),S=setTimeout(()=>{fe.writeFile(c,new Blob([JSON.stringify(v)],{type:"text/plain"}))},1e3)}function s(){const f=x.shift();G(f)&&l(f.location,f.fileExt,f.cb)}function l(f,u,d){b+=1,b<3&&s(),fe.readFile(f,(t,i)=>{if(t||!G(i)){d("");return}const o=URL.createObjectURL(i);Di(u)&&os(o,(r,m,g,E)=>{d(r,E),v.push({location:f,data:g,ratio:E}),n(),b-=1,s()},160),Mi(u)&&zo(o,(r,m,g,E)=>{d(r,E),v.push({location:f,data:g,ratio:E}),n(),b-=1,s()},160)})}function p(f,u,d){const t=v.find(i=>i.location===f);if(G(t))fetch(t.data).then(i=>i.blob()).then(i=>{const o=URL.createObjectURL(i);d(o,t.ratio)});else{if(b>2){const i=x.findIndex(o=>o.location===f);if(i===-1)x.push({location:f,fileExt:u,cb:d});else{const o=x[i];o.cb=d}return}l(f,u,d)}}let a;function h(f){const u=v.findIndex(d=>d.location===f);u>-1&&(v.splice(u,1),a&&clearTimeout(a),a=setTimeout(()=>{n()},100))}return{getThumbnail:p,removeThumbnail:h}}const oi=ta();function tt(e){return`imgs/icons/${encodeURIComponent(e)}`}const je={blank:tt("Blank.png"),image:tt("Pictures file.png"),videos:tt("Videos file.png"),audio:tt("Audio file.png")},ia={"":{icon:je.blank,appName:"",description:"File"},".jpg":{icon:je.image,appName:"photoViewer",description:"Picture file"},".png":{icon:je.image,appName:"photoViewer",description:"Picture file"},".jfif":{icon:je.image,appName:"photoViewer",description:"Picture file"},".webp":{icon:je.image,appName:"photoViewer",description:"Picture file"},".jpeg":{icon:je.image,appName:"photoViewer",description:"Picture file"},".mp3":{icon:je.audio,appName:"mediaPlayer",description:"Audio file"},".aac":{icon:je.audio,appName:"mediaPlayer",description:"Audio file"},".ogg":{icon:je.audio,appName:"mediaPlayer",description:"Audio file"},".m4a":{icon:je.audio,appName:"mediaPlayer",description:"Audio file"},".flac":{icon:je.audio,appName:"mediaPlayer",description:"Audio file"},".wav":{icon:je.audio,appName:"mediaPlayer",description:"Audio file"},".mp4":{icon:je.videos,appName:"mediaPlayer",description:"Video file"},".mkv":{icon:je.videos,appName:"mediaPlayer",description:"Video file"},".webm":{icon:je.videos,appName:"mediaPlayer",description:"Video file"},".txt":{icon:tt("Notes.png"),appName:"notepad",description:"Text Document File"},".exe":{icon:tt("Notes.png"),appName:"",description:"Application"},".html":{icon:tt("Notes.png"),appName:"notepad",description:"HTML Document"},".js":{icon:tt("Notes.png"),appName:"notepad",description:"Javascript Source File"},".json":{icon:tt("Notes.png"),appName:"notepad",description:"JSON File"},".css":{icon:tt("Notes.png"),appName:"notepad",description:"CSS Source File"},".md":{icon:tt("Notes.png"),appName:"notepad",description:"Markdown File"}},$t=e=>{let c=ia[e];return G(c)||(c={appName:"",description:e.substring(1,e.length).toUpperCase()+" file",icon:je.blank,iconType:"image"}),c};function sa(e){const{showDesktopIcons:c}=Se.getState("showDesktopIcons");return[{text:"View",children:[{text:"Large Icons",value:"large-icons"},{text:"Medium Icons",value:"medium-icons",checked:!0},{text:"Small Icons",value:"small-icons"},{divider:!0},{text:"Auto arrange icons"},{text:"Align icons to grid",checked:!0},{divider:!0},{text:"Show desktop icons",checked:c,onClick:e.onShowDesktopIconsClick}]},{text:"Sort by",children:[{text:"Name"},{text:"Size"},{text:"Item type"},{text:"Date Modified"}]},{text:"Refresh"},{divider:!0},{text:"Paste",disabled:!0},{text:"Paste shortcut",disabled:!0},{text:"Open command window here",icon:"imgs/icons/Apps/terminal.png",iconType:"image",onClick(){Vo(rt.getState("USER_HOME").USER_HOME+"/Desktop")}},{divider:!0},{text:"New",children:[{text:"Folder",icon:"imgs/icons/Folder.png",iconType:"image"},{text:"Shortcut",iconType:"image",icon:"imgs/icons/Emblems/1010.png"},{divider:!0},{text:"Bitmap Image"},{text:"Rich Text Document"},{text:"Text Document",icon:"imgs/icons/Notes.png",iconType:"image",onClick:()=>{Fe(Q.notepad.name)}}],emphasis:!0},{divider:!0},{icon:"imgs/icons/Desktop.png",iconType:"image",text:"Display settings",onClick:()=>{ni({...Q.settings,type:"app",args:"system/display"})}},{icon:"imgs/icons/Personalization.png",iconType:"image",text:"Personalize",onClick:()=>{ni({...Q.settings,type:"app",args:"personalization"})}}]}const Et=rt.getState("USER_HOME").USER_HOME+"/Desktop";function na(){let e=[],c=[],v=!1;const b=[{icon:"imgs/icons/Trash Empty.png",name:"explorer",productName:"Recycle Bin",args:"Recycle Bin",type:"app"},{...Q.settings,type:"app"},{...Q.notepad,type:"app"},{...Q.explorer,type:"app"},{...Q.photos,type:"app"},{...Q.github,type:"link",args:"https://github.com/chrishtu/windows11"}];function x(i){u(),ni(i)}const k=_("div",{className:"desktop-app-items absolute top flex flex-col flex-wrap"});S();function S(){for(let i of b)k.appendChild(a(i))}function n(){at(k),S(),fe.readFolder(Et,(i,o)=>{i||o.forEach(r=>{const m={type:r.type,args:Et+"/"+r.name,name:r.name,productName:r.name,icon:r.icon||(r.type==="folder"?mt:null),iconType:"image"},g=a(m);k.appendChild(g)})})}function s(i){return i.substring(Et.length+1,i.length).split("/")}fe.addEventListener("ready","desktop",()=>{n()});function l(){v&&(n(),v=!1)}fe.addEventListener("added","desktop",Wt(()=>{l()},{limit:1e3,onFunction(i){i.includes(Et)&&s(i).length===1&&(v||(v=!0))}})),fe.addEventListener("modified","desktop",Wt(()=>{l()},{limit:1e3,onFunction(i){i.includes(Et)&&s(i).length===1&&(v||(v=!0))}})),fe.addEventListener("removed","desktop",Wt(()=>{l()},{limit:1e3,onFunction(i){i.includes(Et)&&s(i).length===1&&(v||(v=!0))}}));function p(i){let o=_("div",{className:"app-association"}),r=_("div",{className:"pannel-item-icon-bg"},o);const m=_("div",{className:"desktop-app-item-icon flex items-center content-center",style:{backgroundImage:`url(${i.icon})`}},r);function g(E,T){const w=T||1;m.style.backgroundImage="none",r.style.aspectRatio=w.toString(),w>=1?r.style.width="100%":r.style.height="100%",r.style.backgroundImage=`url(${E})`,o.style.backgroundImage=`url(${yt.mediaPlayer.icon})`}if(i.icon&&(i.iconType==="svg"?m.innerHTML=i.icon:m.style.backgroundImage=`url("${i.icon}")`),i.type==="file"){const E=gt(i.args),T=$t(E);T.icon?T.iconType==="svg"?m.innerHTML=T.icon:m.style.backgroundImage=`url("${T.icon}")`:m.style.backgroundImage='url("imgs/icons/Blank.png")',Xe(i.args)&&(Di(E)||Mi(E))&&oi.getThumbnail(i.args,E,g)}return m}function a(i){let o=i.productName;i.type==="file"&&(o=Qe(i.args));const r=_("div",{className:"desktop-app-item",ondblclick:x.bind(null,i),onclick:m=>{const g=m.currentTarget;m.shiftKey||u(),g.classList.add("desktop-app-item-selected"),e.push(g)}},[_("div",{className:"flex items-center content-center",style:{padding:"3px 0"}},p(i)),_("div",{title:o,className:"desktop-app-item-label"},_("div",{className:"text-ellipsis line-clamp-2"},o))]);return pi(r,i),r}function h(i,o=!1){Array.from(k.children).forEach(m=>{const g=m.getBoundingClientRect();g.left+g.width<i.x1||g.left>i.x2||g.top+g.height<i.y1||g.top>i.y2?o||m.classList.remove("desktop-app-item-selected"):m.classList.add("desktop-app-item-selected")})}function f(){const i=Array.from(k.children);return e=i.filter(o=>o.classList.contains("desktop-app-item-selected")),c=i.filter(o=>!o.classList.contains("desktop-app-item-selected")),{items:i,selectedItems:e,notSelectedItems:c}}function u(){e.forEach(i=>{i.classList.remove("desktop-app-item-selected")}),e=[]}function d(i){k.classList.toggle("hidden",!i)}function t(){const{showDesktopIcons:i}=Se.getState("showDesktopIcons");d(!i),Se.setState({showDesktopIcons:!i})}return{element:k,selectItems:h,getItems:f,removeSelection:u,setShowDesktopIcons:d,toggleDesktopIcons:t}}function ra(){const{backgroundImageStyle:e,showDesktopIcons:c}=Se.getState(["backgroundImageStyle","showDesktopIcons"]),v=na();function b(r){r.preventDefault(),jt({top:r.y,left:r.x},r.currentTarget,sa({onShowDesktopIconsClick:v.toggleDesktopIcons}),!1,null,!1,"desktop-context-menu")}function x(r){r.preventDefault(),gi(Et,r.dataTransfer.items)}let k=_("div",{className:"desktop-shape-presentation"}),S=_("div",{className:"desktop-selection-presentation"}),n=_("div",{className:"desktop fade-in",ondrop:x},[_("div",{className:"desktop-selection-handler",onmousedown:p,oncontextmenu:b}),S]),s=!1,l=null;function p(r){Se.getState("showDesktopIcons").showDesktopIcons&&(r.shiftKey||v.removeSelection(),r.button===0&&(s=!0,l={x:r.x,y:r.y},document.onmousemove=a,document.onmouseup=h))}function a(r){if(!s||Math.abs(r.x-l.x)<2&&Math.abs(r.y-l.y)<2)return;let m=0,g=0,E=0,T=0;r.x>l.x?(g=l.x,E=r.x-l.x):(g=r.x,E=l.x-r.x),r.y>l.y?(m=l.y,T=r.y-l.y):(m=r.y,T=l.y-r.y),ge(S,{visibility:"visible",top:m+"px",left:g+"px",width:E+"px",height:T+"px"}),v.selectItems({x1:g,x2:g+E,y1:m,y2:m+T},r.shiftKey)}function h(){s=!1,ge(S,{visibility:"hidden",width:"0px",height:"0px"}),v.getItems()}let f,u=!1;o(e),nt(document.body,n),nt(document.body,k),setTimeout(()=>{nt(n,v.element),v.setShowDesktopIcons(c)},500);function d(r,m=!0){n.style.myBackgroundImage=r.path,m&&(pt({background:r}),Uo(r)),Me(ae.backgroundImageChange,r)}function t(r,m){f&&clearTimeout(f);const g=Math.floor(Ce.width/2),E=Ce.height-We,T=Math.floor(E/2);u||(r==="top"?ge(k,{top:"10px",left:g+"px"}):r==="left"?ge(k,{top:T+"px",left:"10px"}):r==="right"?ge(k,{top:T+"px",left:Ce.width+"px"}):r==="topLeft"?ge(k,{top:"10px",left:"10px"}):r==="topRight"?ge(k,{top:"10px",left:Ce.width+"px"}):r==="bottomLeft"?ge(k,{top:E+"px",left:"10px"}):r==="bottomRight"&&ge(k,{top:E+"px",left:Ce.width+"px"}),u=!0),f=setTimeout(()=>{r==="top"?ge(k,{top:"10px",left:"10px",height:E-20+"px",width:Ce.width-20+"px",transformOrigin:"top"}):r==="left"?ge(k,{top:"10px",left:"10px",height:E-20+"px",width:g-10+"px",transformOrigin:"left"}):r==="right"?ge(k,{top:"10px",left:g+"px",height:E-20+"px",width:g-10+"px",transformOrigin:"center right"}):r==="topLeft"?ge(k,{top:"10px",left:"10px",height:T-10+"px",width:g-10+"px",transformOrigin:"left top"}):r==="topRight"?ge(k,{top:"10px",left:g+"px",height:T-10+"px",width:g-10+"px",transformOrigin:"right top"}):r==="bottomLeft"?ge(k,{top:T+"px",left:"10px",height:T-10+"px",width:g-10+"px",transformOrigin:"left bottom"}):r==="bottomRight"&&ge(k,{top:T+"px",left:g+"px",height:T-10+"px",width:g-10+"px",transformOrigin:"right bottom"}),k.classList.add("show")},150)}function i(){u=!1,f&&clearTimeout(f),k.classList.remove("show"),k.style.top="0",k.style.left="0",k.style.width="0",k.style.height="0"}function o(r){Vi(n,r)}return{element:n,setBackgroundImage:d,setBackgroundStyle:o,showShape:t,removeShape:i,showDesktopIcons:v.setShowDesktopIcons}}const $e=ra();function oa(e,c,v){let b,x,k,S=Ii(32);const n={...e},s=20;G(n.id)?S=e.id:n.id=S;const l={};G(n.icon)&&(l.backgroundImage=`url(${n.icon})`);function p(){H(!0),c.onTabChange(n),c.onDragOver(n)}const a={};G(v)&&(a.position="absolute",a.left=v+"px"),b=_("div",{className:"tab",style:a},[_("div",{className:"tab-inner w-full h-full flex items-center",onmousedown:M,oncontextmenu:c.onContextMenu},[x=_("div",{className:"tab-icon h-full flex-shrink-0 background-icon",style:l}),_("div",{className:"tab-text h-full flex-1"},k=_("div",{className:"w-full h-full flex items-center"},n.text))]),_("div",{className:"tab-close-button h-full flex-shrink-0 flex items-center content center",innerHTML:Xs,onclick:()=>{L()}})]),b.addEventListener("customdragover",p,!1);let h,f,u,d=0,t=0,i=0,o=0,r=0,m=0,g=!1,E=!1,T=!1,w=0,y=!1;function M(B){B.button===0&&(ye(c.onTabChange)&&c.onTabChange(n),h=b.getBoundingClientRect(),u=b.parentElement.parentElement.getBoundingClientRect(),r=h.x,m=h.y,d=B.x-u.x,i=B.x,t=B.y-u.y,o=B.y,c.getTabCount()===1&&(y=!0),document.addEventListener("mousemove",I,!1),document.addEventListener("mouseup",C,!1))}function I(B){if(!g&&(Math.abs(B.x-i)>10||Math.abs(B.y-o)>10))y?(c.moveWindow({...n,element:b},{left:h.left,top:h.top,dl:B.x-h.left,width:h.width,height:h.height,deltaLeft:B.x-u.x,deltaTop:B.y-h.top+8}),C()):(g=!0,b.style.position="relative",b.style.removeProperty("left"),f=b.cloneNode(!0),f.classList.add("active"),f.classList.add("tab-clone"),ge(f,{position:"absolute",top:h.top+"px",left:h.left+"px",width:h.width+"px",height:h.height+"px",pointerEvents:"none",zIndex:"10000000"}),document.body.appendChild(f),b.style.visibility="hidden",ye(c.onDragStart)&&c.onDragStart());else if(!y){if(g){let O=T?B.x-w:B.x-u.left-d+r;if(O<u.left&&(O=u.left),O+h.width>u.left+u.width&&(O=u.left+u.width-h.width),f.style.left=O+"px",O>=0){let P=document.elementFromPoint(B.x,B.y);if(G(P)){let z=P.closest(".tab");G(z)&&(B.x-i>0?hi(b,z):B.x-i<0&&hi(z,b)),i=B.x}}}if(B.x<u.left-s||B.x>u.left+u.width+s||B.y<u.top-s||B.y>u.top+u.height+s){let O=B.y-u.top-t+m;if(f.style.top=O+"px",!E){E=!0;const P=f.getBoundingClientRect();c.onDragOut({...n,element:b},{left:P.left,top:P.top,dl:B.x-P.left,width:h.width,height:h.height,deltaLeft:B.x-u.x,deltaTop:B.y-P.top+8}),C(),L(E)}}}}function C(){G(f)&&f.remove(),b.style.removeProperty("visibility"),document.removeEventListener("mousemove",I,!1),document.removeEventListener("mouseup",C,!1),ye(c.onDragEnd)&&c.onDragEnd(n,T),y=!1,T=!1,g=!1}function D(B){n.text=B,k.innerText=B}function A(B){n.icon=B,x.style.backgroundImage=`url(${B})`}function H(B){var O;b.classList[B?"add":"remove"]("active"),(O=b.previousElementSibling)==null||O.classList[B?"add":"remove"]("no-divider")}function N(B){T=!0,h=b.getBoundingClientRect(),u=b.parentElement.parentElement.getBoundingClientRect(),r=h.x,m=h.y,d=B.detail.x-u.x,i=B.detail.x,t=B.detail.y-u.y,o=B.detail.y;let O=B.detail.x-B.detail.dx;if(w=B.detail.dx,g=!0,f=b.cloneNode(!0),f.classList.add("active"),f.classList.add("tab-clone"),ge(f,{position:"fixed",top:h.top+"px",left:O+"px",width:h.width+"px",height:h.height+"px",pointerEvents:"none",zIndex:"10000000"}),document.body.appendChild(f),b.style.visibility="hidden",ye(c.onDragStart)&&c.onDragStart(),O>=0){let P=document.elementFromPoint(B.detail.x,B.detail.y);if(G(P)){let z=P.closest(".tab");G(z)&&(B.detail.x-i>0?hi(b,z):B.detail.x-i<0&&hi(z,b)),i=B.detail.x}}document.addEventListener("mousemove",I,!1),document.addEventListener("mouseup",C,!1)}function F(B){n.content=B}function L(B){ye(c.onClose)&&c.onClose(n,B),b.remove()}return{id:n.id,element:b,setTitle:D,setIcon:A,setActive:H,triggerMouseMove:N,setContent:F,close:L}}function gn(e){let c,v;const b=[];function x(f){b.forEach(d=>d.setActive(!1));const u=b.find(d=>d.id===f);G(u)&&u.setActive(!0)}function k(f){return b.find(d=>d.id===f)}function S(f){return x(f.id),e.onTabChange(f),b.length}function n(f){const u=oa(f,{onTabChange:S,onClose:e.onTabClose,onContextMenu:e.onContextMenu,updateDragHandle:e.updateDragHandle,onDrag:e.onDrag,onDragStart:e.onTabDragStart,onDragOver:e.onDragOver,onDragOut:e.onDragOut,onDragEnd:e.onDragEnd,getTabCount:e.getTabCount,moveWindow:e.moveWindow});return b.push(u),c.insertBefore(u.element,v),v.scrollIntoView(),x(u.id),u}function s(f){b.splice(b.findIndex(u=>u.id===f),1)}c=_("div",{className:"tabs w-full h-full flex"},[v=_("div",{className:"tabs-action-new flex items-center content-center"},_("div",{title:"New Tab",className:"tabs-action-new-button flex items-center content-center",onclick:e.onNewTabActionClick,innerHTML:es(18,2)})),_("div",{["drag-region"]:"drag",className:"h-full flex-1"})]);function l(){v.style.visibility="hidden"}function p(){v.style.visibility="visible"}function a(){c.classList.remove("no-scrollbar")}function h(){c.classList.add("no-scrollbar")}return{element:c,add:n,remove:s,getTab:k,setActiveTab:x,showNewButton:p,hideNewButton:l,enabledScrollbar:a,disabledScrollbar:h}}function Ms(e,c){let v,b=[];v=_("div",{className:"tree-view"+(c.className?" "+c.className:"")});function k(s,l,p=0,a=0,h=""){const f=l[p];let u,d;function t(o,r,m){var g;(g=m.children)!=null&&g.length?o.isShow===!1&&(k(u,m.children,0,a+10,h+=m.text+"/"),o.isShow=!0):typeof c.requestChildren=="function"&&c.requestChildren(m.location,E=>{m.children=E,k(u,E,0,a+10,h+=m.text+"/"),o.isShow=!0}),o.classList.toggle("show"),r.classList.toggle("show")}function i(o){c==null||c.onChange(o)}if(G(f)){const o={backgroundImage:`url(${f.icon})`};u=_("div",{isShow:!1,className:"tree-node"},_("div",{className:"tree-node-inner",style:{paddingLeft:a+"px"}},[_("div",{className:"tree-display flex items-center",ondblclick:r=>{r.stopPropagation(),!f.noToggle&&G(f.children)&&f.children.length>0&&t(u,d,f)},onclick:i.bind(null,f)},[f.noToggle?_("div",{className:"tree-node-action flex-shrink-0 flex items-center"}):d=_("div",{className:"tree-node-action flex-shrink-0 flex items-center",innerHTML:Ut,onclick:r=>{r.stopPropagation(),t(u,d,f)}}),_("div",{className:"tree-node-icon",style:o}),_("div",{className:"tree-node-text"},f.text)])])),s.appendChild(u),k(s,l,p+1,a,h),b.push({path:h+f.text,target:u,actionElement:d,currentData:f,toggleShow:t})}}k(v,[e]);function S(s){k(v,[s])}function n(s){return b.find(l=>l.path===s)}return{element:v,appendChild:S,getItem:n}}function aa(e){let c;const{USER_HOME:v}=rt.getState("USER_HOME");let b;function x(n){e==null||e.onChange({location:n.location,text:n.text,icon:n.icon,children:n.children,type:n.type})}function k(n,s){fe.readFolder(n,(l,p)=>{const a=p.filter(h=>h.type==="folder").map(h=>({text:h.name,icon:h.icon||mt,location:n+"/"+h.name,properties:h,type:"folder"}));s(a)})}const S=Ms({text:"Favourites",icon:"imgs/icons/Quick%20Access.png",location:"",type:"root",children:[{icon:"imgs/icons/Folder%20Documents.png",text:"Documents",location:v+"/Documents",children:[],type:"folder",noToggle:!0},{icon:"imgs/icons/Folder%20Downloads.png",text:"Downloads",location:v+"/Downloads",children:[],type:"folder",noToggle:!0}]},{onChange:x,className:"explorer-sidebar-item",requestChildren:k});return c=_("div",{tabIndex:-1,className:"explorer-sidebar scrollable flex-shrink-0"},S.element),indexedDB.databases().then(n=>{b=Ms({text:"This PC",icon:"imgs/icons/Computer.png",location:"",type:"root",children:[{text:"Code",icon:mt,location:"c:/Code",children:[],type:"folder"},{text:"Desktop",icon:Ae.desktop,location:v+"/Desktop",children:[],type:"folder"},{icon:Ae.document,text:"Documents",location:v+"/Documents",children:[],type:"folder"},{icon:Ae.download,text:"Downloads",location:v+"/Downloads",children:[],type:"folder"},{icon:Ae.pictures,text:"Pictures",location:v+"/Pictures",children:[],type:"folder"},{icon:Ae.music,text:"Music",location:v+"/Music",children:[],type:"folder"},{icon:Ae.videos,text:"Videos",location:v+"/Videos",children:[],type:"folder"}].concat(n.map(l=>{const p=l.name.split(" ");let a=p[p.length-1].toLowerCase()+":";return{text:l.name,location:a,icon:"imgs/icons/Drives/Hardrive%20Windows.png",children:[],type:"driver"}}))},{className:"explorer-sidebar-item",onChange:x,requestChildren:k});const s=b.getItem("This PC");G(s)&&s.toggleShow(s.target,s.actionElement,s.currentData),c.appendChild(b.element),setTimeout(()=>{c.focus()},200)}),{element:c}}function la(e){let c="",v=rs({title:e.title,width:e.width||300,height:e.height||160,parent:e.parent,content:_("div",{className:"text-dialog flex items-center content-center h-full"},ln({placeholder:e.placholder,type:"text",value:e.text,onChange:b}).element),onOK:x});function b(k){c=k}function x(){typeof e.onSubmit=="function"&&e.onSubmit(c),v.close()}return v}function ca(e){let c;const v=e.options.map(s=>{let l={style:{}};return G(s.icon)&&(s.iconType==="svg"?l.innerHTML=s.icon:l.style.backgroundImage=`url(${s.icon})`),_("div",{className:"dropdown-option"+(s.disabled?" disabled":""),onclick:s.disabled?null:s.onClick},[_("div",{className:"dropdown-option-icon image-icon",...l}),_("div",{className:"dropdown-option-label"},s.text)])}),{offsetLeft:b,offsetTop:x,offsetHeight:k}=e.triggerElement;c=_("div",{className:"dropdown",style:{top:x+k+"px",left:b+"px"},onclick:s=>s.stopPropagation()},v),e.triggerElement.appendChild(c);function S(s){const l=s.target;c.contains(l)||n()}setTimeout(()=>{document.onmousedown=S,document.onkeydown=s=>{s.key===Be.Escape&&n()}},10);function n(){c.remove(),G(e.triggerElement)&&e.triggerElement.focus()}return{element:c,close:n}}function ha(e){let c=_("div",{style:{width:"100%",height:"100%",backgroundImage:`url(${e.url})`,backgroundSize:e.imageSize||"100% 100%",backgroundPosition:"center center",backgroundRepeat:"no-repeat"}});function v(b){c.style.backgroundImage=`url(${b})`}return{element:c,setImage:v}}function Xi(){const{USER_HOME:e}=rt.getState("USER_HOME"),c=[{name:"Code",icon:mt,path:"This PC/Code",location:"c:/Code",type:"folder"},{name:"Desktop",icon:Ae.desktop,path:"Desktop",location:e+"/Desktop",type:"folder"},{name:"Documents",icon:Ae.document,path:"Documents",location:e+"/Documents",type:"folder"},{name:"Downloads",icon:Ae.download,path:"Downloads",location:e+"/Downloads",type:"folder"},{name:"Pictures",icon:Ae.pictures,path:"Pictures",location:e+"/Pictures",type:"folder"},{name:"Music",icon:Ae.music,path:"Music",location:e+"/Music",type:"folder"},{name:"Videos",icon:Ae.videos,path:"Videos",location:e+"/Videos",type:"folder"},{name:"Local Disk (C:)",icon:Ae.driverC,path:"c:/",location:"c:",type:"driver"}],{USER_NAME:v}=rt.getState("USER_HOME");return[...[{name:"Favourites",icon:"imgs/icons/Quick%20Access.png",path:"Favourites",location:"Favourites",type:"root",children:[c[2],c[3]],view:"mediumIcons",sortBy:"text",orderBy:"asc"},{name:"Recycle Bin",icon:"imgs/icons/Trash Empty.png",path:"Recycle Bin",location:"Recycle Bin",type:"root",children:[]},{name:"This PC",icon:Ae.thisPC,path:"This PC",location:"This PC",type:"root",children:c,group:{by:"type",orderBy:"desc"},view:"tiles",sortBy:"text",orderBy:"asc"},{name:v,icon:Ae.user,path:v,location:e,type:"folder"}],...c]}function Ft(e){return e==="This PC"||e==="Favourites"||e==="Recycle Bin"}function da(e){const c=vi();let v,b=h(e.actionEvents),x=l(e.history),k,S;v=_("div",{className:"explorer-toolbar flex-shrink-0"},[_("div",{className:"explorer-toolbar-drag w-full h-full",["drag-region"]:"drag"}),b.element,x.element]);let n=new ResizeObserver(()=>{x.toolbarPath.checkOverflow(),b.checkOverflow()});b.disableButtons(["undo","redo","paste"]),n.observe(v);function s(){let d,t,i,o,r,m=!1;function g(){m||(m=!0,d.value=o.path,d.select(),d.focus(),t.style.borderColor="var(--blue-color)",i.style.display="none")}function E(D=!1){m=!1,d.value="",t.style.borderColor="var(--border-color)",i.style.display="flex",D&&y.focus()}function T(D){if(D.key===Be.Enter){const A=w(d.value);e.onItemClick({text:A,location:A}),E(!0)}}function w(D){return D.charAt(D.length-1)==="/"?D.substring(0,D.length-1):D}r=ha({url:mt,imageSize:"18px 18px"});let y=_("div",{className:"explorer-toolbar-path w-full flex",style:{height:"28px"},tabIndex:-1},[t=_("div",{className:"explorer-toolbar-path-box w-full h-full flex",style:{border:"1px solid var(--border-color)"}},[_("div",{className:"explorer-toolbar-path-icon h-full",style:{width:"32px"}},r.element),_("div",{className:"relative w-full h-full"},[_("div",{className:"absolute w-full h-full flex"},[d=_("input",{name:"path-input",autocomplete:"off",className:"explorer-toolbar-path-input w-full h-full",style:{left:0,top:0,border:0,outline:0,background:"none",color:"var(--primary-text-color)",font:"inherit"},onblur:()=>{E()},onkeydown:T}),_("div",{className:"explorer-toolbar-path-history flex-shrink-0 h-full flex items-center content-center",style:{width:"28px"},innerHTML:Li()})]),i=_("div",{className:"explorer-toolbar-path-items w-full h-full absolute flex items-center",onclick:g,style:{left:0,top:0,zIndex:1,overflowX:"auto"}})])]),_("div",{className:"explorer-toolbar-path-refresh flex-shrink-0 flex items-center content-center",style:{width:"28px",border:"1px solid var(--border-color)",borderLeft:0},innerHTML:Nr(14,2)})]);function M(D){return _("div",{className:"explorer-toolbar-path-item flex h-full flex-shrink-0",onclick:H=>{H.stopPropagation()}},[_("div",{className:"explorer-toolbar-path-item-text flex items-center",onclick:()=>{const H=w(D.location);e.onItemClick({text:H,location:H})},title:D.text},_("div",{className:"text-ellipsis"},D.text)),_("div",{className:"explorer-toolbar-path-item-icon flex items-center content-center",innerHTML:Ut})])}function I(D){if(o=D,G(D.icon)&&r.setImage(D.icon),Xe(D.path)||St(D.path)){let A="";const H=Xi(),N=D.path.replace(/\\+/g,"/").split("/").filter(F=>F!=="").map((F,L)=>{A+=F+"/";let B=F;if(L===0){const O=H.findIndex(P=>P.path===A);O>-1&&(B=H[O].name)}return{text:B,location:A}}).map(F=>M(F));N.unshift(M({text:"This PC",location:"This PC"})),at(i),Dt(i,N)}else{const A=Xi(),H=D.path.replace(/\\/,"/").split("/").filter(N=>N!=="").map((N,F)=>{let L=N,B=N;const O=A.findIndex(P=>P.path===(F===0?N+"/":N));return O>-1&&(L=A[O].name,B=A[O].location),{text:L,location:B}}).map(N=>M(N));at(i),Dt(i,H)}C()}function C(){const D=i.offsetWidth;i.scrollWidth>D&&(i.scrollLeft=D+i.scrollWidth)}return{element:y,setPath:I,checkOverflow:C}}function l(d){let t,i,o,r,m=Ti({placeholder:"Search "}),g=s(),E="";t=_("div",{className:"explorer-toolbar-top flex items-center"},[_("div",{className:"explorer-toolbar-top-col explorer-toolbar-actions flex items-center"},[i=_("div",{className:"explorer-toolbar-actions-button",innerHTML:Dr(),onclick:d.onBackward}),o=_("div",{className:"explorer-toolbar-actions-button",innerHTML:Mr(),onclick:d.onForward}),r=_("div",{className:"explorer-toolbar-actions-button",innerHTML:Ir(),onclick:()=>{d.onGoUp(E)}})]),_("div",{className:"explorer-toolbar-top-col explorer-toolbar-path"},[g.element]),_("div",{className:"explorer-toolbar-top-col explorer-toolbar-search"},m.element)]);function T(y){m.setPlaceHolder(`Search ${y}`)}function w(y,M,I){const C=y.length;i.classList[M>0?"remove":"add"]("disabled"),o.classList[M>=C-1?"add":"remove"]("disabled");const D=I.split("/").filter(A=>A!=="");if(D.length>1){let A=[...D];A.pop(),E=A.join("/")}r.classList[D.length<=1?"add":"remove"]("disabled")}return{element:t,toolbarPath:g,setPlaceHolder:T,checkHistoryButtons:w}}function p(){la({title:k,placholder:"Enter folder name",parent:e.getContainer(),onSubmit(d){fe.createFolder(k+"/"+d,t=>{t&&rs({title:"",width:300,height:150,parent:e.getContainer(),content:_("div",{className:"w-full h-full flex items-center content-center"},_("div",{className:"text-ellipsis line-clamp-1"},t.message))})})}}),S.close()}function a(d){const t=d.currentTarget,i=[{icon:"imgs/icons/Folder.png",iconType:"image",text:"Folder",onClick:()=>{p()},disabled:!G(k)||k===""||k==="This PC"||k==="Favourites"}];S=ca({triggerElement:t,options:i})}function h(d){let t,i,o,r,m,g=!1,E=!1,T={new:{onclick:a},undo:{onclick:d.onUndo},redo:{onclick:d.onRedo},copy:{onclick:d.onCopy},cut:{onclick:d.onCut},paste:{onclick:d.onPaste},open:{onclick:d.onOpen},delete:{onclick:d.onDelete},rename:{onclick:d.onRename}};t=_("div",{className:"explorer-toolbar-bottom flex items-center"},[i=_("div",{className:"explorer-toolbar-bottom-items h-full flex items-center"},[_("div",{className:"explorer-toolbar-group"},[T.new.elem=_("div",{className:"explorer-toolbar-bottom-item",onclick:a},[_("div",{className:"explorer-toolbar-bottom-item-icon",innerHTML:es(20,1.5)}),_("div",{className:"explorer-toolbar-bottom-item-text"},"New")])]),_("div",{className:"explorer-toolbar-group"},[T.undo.elem=_("div",{className:"explorer-toolbar-bottom-item",onclick:T.undo.onclick},[_("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/Undo.png)"}}),_("div",{className:"explorer-toolbar-bottom-item-text"},"Undo")]),T.redo.elem=_("div",{className:"explorer-toolbar-bottom-item",onclick:T.redo.onclick},[_("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/Redo.png)"}}),_("div",{className:"explorer-toolbar-bottom-item-text"},"Redo")])]),_("div",{className:"explorer-toolbar-group"},[T.copy.elem=_("div",{className:"explorer-toolbar-bottom-item",onclick:T.copy.onclick},[_("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/copy.png)"}}),_("div",{className:"explorer-toolbar-bottom-item-text"},"Copy")]),T.cut.elem=_("div",{className:"explorer-toolbar-bottom-item",onclick:T.cut.onclick},[_("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/scissors.png)"}}),_("div",{className:"explorer-toolbar-bottom-item-text"},"Cut")]),T.paste.elem=_("div",{className:"explorer-toolbar-bottom-item",onclick:T.paste.onclick},[_("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/clipboard.png)"}}),_("div",{className:"explorer-toolbar-bottom-item-text"},"Paste")])]),_("div",{className:"explorer-toolbar-group"},[T.open.elem=_("div",{className:"explorer-toolbar-bottom-item",onclick:T.open.onclick},[_("div",{className:"explorer-toolbar-bottom-item-icon",innerHTML:mr}),_("div",{className:"explorer-toolbar-bottom-item-text"},"Open")])]),_("div",{className:"explorer-toolbar-group"},[T.delete.elem=_("div",{className:"explorer-toolbar-bottom-item",onclick:T.delete.onclick},[_("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Emblems/170.png)"}}),_("div",{className:"explorer-toolbar-bottom-item-text"},"Delete")]),T.rename.elem=_("div",{className:"explorer-toolbar-bottom-item",onclick:T.rename.onclick},[_("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/Rename.png)"}}),_("div",{className:"explorer-toolbar-bottom-item-text"},"Rename")])])]),r=_("div",{className:"explorer-overflow-action-more",style:{width:"30px",height:"30px",display:"none",marginInline:"10px"},innerHTML:Js()},o=_("div",{className:"explorer-overflow-actions flex flex-col"})),_("div",{["drag-region"]:"drag",className:"h-full flex-1"}),c?m=_("label",{className:"explorer-toolbar-bottom-item",style:{marginLeft:"auto",marginRight:"5px"}},[_("input",{name:"file-chooser",type:"file",accept:"*",style:{display:"none"},multiple:!0,onchange:e.onImportFiles}),"Import"]):null]);function w(){const A=i.offsetWidth,H=[];if(i.scrollWidth>A){const N=Array.from(i.children);for(let F of N)F.offsetLeft+F.offsetWidth>A?(H.push(F.cloneNode(!0)),F.style.visibility="hidden"):F.style.visibility="visible";at(o),H.forEach(F=>{F.style.visibility="visible",o.appendChild(F)}),g||(g=!0,E=!1,r.style.display="block")}else if(!E){E=!0,g=!1;const N=Array.from(i.children);for(let F of N)F.style.visibility="visible";r.style.display="none"}}function y(A){var H,N;for(let F of A)(N=(H=T[F])==null?void 0:H.elem)==null||N.classList.remove("disabled")}function M(A){var H,N;for(let F of A)(N=(H=T[F])==null?void 0:H.elem)==null||N.classList.add("disabled")}function I(){const A=Object.keys(T);for(let H of A)T[H].elem.classList.add("disabled")}function C(){m.classList.remove("disabled")}function D(){m.classList.add("disabled")}return{element:t,checkOverflow:w,enableButtons:y,disableButtons:M,disableAllButtons:I,enableImportButton:C,disableImportButton:D}}function f(d){k=d,c&&(Ft(k)?b.disableImportButton():b.enableImportButton())}function u(d,t){if(Ft(t))b.disableButtons(["new","copy","cut","paste","open","delete","rename"]);else{const i=d.length;i===0?(b.enableButtons(["new"]),b.disableButtons(["copy","cut","open","delete","rename"])):i===1?b.enableButtons(["new","copy","cut","open","delete","rename"]):i>1&&(b.disableButtons(["rename"]),b.enableButtons(["new","copy","cut","open","delete"]))}}return{element:v,toolbarActions:b,toolbarNavigation:x,setLocation:f,setSelectedItems:u}}const ua=e=>({"":"",folder:"File Folder",file:e.type==="file"?$t(gt(e.text)).description:"File Folder",driver:"Local Disk"})[e.type];function fa(e,c){let v,b,x,k,S=0,n=0,s={...e},l=[],p=_("div",{className:"pannel-selection",style:{display:"none",pointerEvents:"none"}}),a=!1,h,f;v=_("div",{className:"pannel w-full h-full scrollable"},[p,b=_("div",{className:"pannel-selector-handler w-full h-full",onmousedown:D}),k=d(s.view)]);function u(P){c.onChange(P)}function d(P="details"){switch(P){case"extraLargeIcons":case"largeIcons":case"mediumIcons":case"smallIcons":return t(P);case"list":return E();case"details":return g();case"tiles":return T();default:return g()}}function t(P){if(G(s.group)){let W=Es(e.items,Y=>Y[s.group.by]);const U=Object.keys(W).map(Y=>Y).sort((Y,R)=>s.group.orderBy==="asc"?Y.localeCompare(R):R.localeCompare(Y));x=_("div",{className:"pannel-items-group-container"});const j=U.length;for(let Y=0;Y<j;Y++){const R=U[Y];let $=W[R];G(s.sortBy)&&($=$.sort((X,se)=>s.orderBy==="asc"?X[s.sortBy].localeCompare(se[s.sortBy]):se[s.sortBy].localeCompare(X[s.sortBy])));const q=r(R.toFirstUpperCase()+` (${$.length})`,o($,P));x.appendChild(q)}return x}let z=s.items.sort((W,U)=>{const j=U.type.localeCompare(W.type),Y=W.text.localeCompare(U.text);return j||Y});return G(s.sortBy)&&(z=z.sort((W,U)=>s.orderBy==="asc"?W[s.sortBy].localeCompare(U[s.sortBy]):U[s.sortBy].localeCompare(W[s.sortBy]))),x=o(z,P)}function i(P){let z=_("div",{className:"pannel-item-icon-bg"});const W=_("div",{className:"pannel-item-icon flex items-end content-center",style:{backgroundImage:`url(${P.icon})`}},z);function U(j,Y){const R=Y||1;W.style.backgroundImage="none",z.style.aspectRatio=R.toString(),R>=1?z.style.width="100%":z.style.height="100%",z.style.backgroundImage=`url(${j})`}if(P.type==="file"){const j=gt(P.name||P.text);if(Xe(P.location)){if(Di(j))oi.getThumbnail(P.location,j,U);else if(Mi(j)){const Y=_("div",{className:"app-association",style:{backgroundImage:`url(${yt.mediaPlayer.icon})`}});z.appendChild(Y),oi.getThumbnail(P.location,j,U)}}}return W}function o(P,z){let W=P.sort((U,j)=>{const Y=j.type.localeCompare(U.type),R=U.text.localeCompare(j.text);return Y||R});return _("div",{className:"pannel-items pannel-items-thumbnail "+z},W.map(U=>{let j,Y;return j=_("div",{className:"w-full h-full"},Y=_("div",{className:"pannel-item flex flex-col items-center content-center",info:U,onclick:()=>{vi()&&u(U)},ondblclick:u.bind(null,U),onmousedown:m,ondragover(R){c.onPannelItemDragover(R,U),j.classList.add("pannel-item-selected")},ondragleave(){j.classList.remove("pannel-item-selected")},ondrop(R){j.classList.remove("pannel-item-selected"),c.onPannelItemDrop(R,U)}},[i(U),_("div",{title:U.text,className:"pannel-item-text text-center"},U.text)])),pi(Y,U),j}))}function r(P,z){return _("div",{className:"pannel-items-group"},[_("div",{className:"pannel-items-group-header flex items-center",style:{padding:"3px 5px"}},[_("div",{className:"pannel-items-group-header-icon flex-shrink-0 flex items-center content-center",innerHTML:Li(18)}),_("div",{className:"pannel-items-group-header-label flex-shrink-0"},P),_("div",{className:"pannel-items-group-header-line w-full",style:{height:"1px",backgroundColor:"var(--border-color)",marginLeft:"5px"}})]),_("div",{className:"pannel-items-group-body"},z)])}function m(P){if(P.button!==0)return;c.onItemMouseDown();const z=P.currentTarget;if(!P.shiftKey)if(P.ctrlKey)if(z.classList.contains("pannel-item-selected")){z.classList.remove("pannel-item-selected");const W=l.findIndex(U=>U.info.location===z.info.location);W>-1&&l.splice(W,1)}else z.classList.add("pannel-item-selected"),l.push(z);else F(),z.classList.add("pannel-item-selected"),l.push(z);ye(c.onSelect)&&c.onSelect(l)}function g(){let P=s.items.sort((z,W)=>{const U=W.type.localeCompare(z.type),j=z.text.localeCompare(W.text);return U||j});return _("div",{className:"pannel-detail w-full"},_("table",{},[_("thead",{},_("tr",{className:"pannel-detail-header"},[_("td",{className:"pannel-detail-header-col pannel-detail-name",colSpan:2},"Name"),_("td",{className:"pannel-detail-header-col pannel-detail-date"},"Date modified"),_("td",{className:"pannel-detail-header-col pannel-detail-type"},"Type"),_("td",{className:"pannel-detail-header-col pannel-detail-size"},"Size")])),x=_("tbody",{className:"pannel-items pannel-items-details"},P.map(z=>{let W,U="";if(z.size){const j=Qt(parseInt(z.size));U=j.value+" "+j.unit}return W=_("tr",{className:"pannel-item",info:z,onclick:()=>{vi()&&u(z)},ondblclick:u.bind(null,z),onmousedown:m,ondragover(j){c.onPannelItemDragover(j,z),W.classList.add("pannel-item-selected")},ondragleave(){W.classList.remove("pannel-item-selected")},ondrop(j){W.classList.remove("pannel-item-selected"),c.onPannelItemDrop(j,z)}},[_("td",{className:"pannel-item-icon",style:{backgroundImage:`url(${z.icon})`}}),_("td",{className:"pannel-item-col"},_("div",{className:"text-ellipsis line-clamp-1"},z.text)),_("td",{className:"pannel-item-col pannel-item-mdate pannel-detail-date"},_("div",{className:"text-ellipsis line-clamp-1"},z.properties.mdate?C(z.properties.mdate):"")),_("td",{className:"pannel-item-col pannel-item-type pannel-detail-type"},_("div",{className:"text-ellipsis line-clamp-1"},ua(z))),_("td",{className:"pannel-item-col pannel-item-size pannel-detail-size"},U)]),pi(W,z),W}))]))}function E(){return _("div")}function T(){if(G(s.group)){let P=Es(e.items,U=>U.type);const z=Object.keys(P).map(U=>U).sort((U,j)=>s.group.orderBy==="asc"?U.localeCompare(j):j.localeCompare(U));x=_("div",{className:"pannel-items-group-container"});const W=z.length;for(let U=0;U<W;U++){const j=z[U];let Y=P[j];G(s.sortBy)&&(Y=Y.sort(($,q)=>s.orderBy==="asc"?$[s.sortBy].localeCompare(q[s.sortBy]):q[s.sortBy].localeCompare($[s.sortBy])));const R=r(j.toFirstUpperCase()+` (${Y.length})`,w(Y));x.appendChild(R)}return x}return x=w(e.items)}function w(P){return _("div",{className:"pannel-items pannel-items-tiles"},P.map(z=>{let W,U;return W=_("div",{className:"w-full h-full flex items-center content-center"},U=_("div",{className:"pannel-item flex items-center",info:z,onclick:()=>{vi()&&u(z)},ondblclick:u.bind(null,z),onmousedown:m,ondragover(j){c.onPannelItemDragover(j,z),W.classList.add("pannel-item-selected")},ondragleave(){W.classList.remove("pannel-item-selected")},ondrop(j){W.classList.remove("pannel-item-selected"),c.onPannelItemDrop(j,z)}},[_("div",{className:"pannel-item-icon",style:{backgroundImage:`url(${z.icon})`}}),_("div",{className:"pannel-item-info w-full"},[_("div",{className:"pannel-item-text"},z.text),_("div",{className:"pannel-item-desc"},z.type==="driver"?_("div",{className:"progress w-full"},M()):""),_("div",{className:"pannel-item-size"},z.type==="driver"?I():"")])])),pi(U,z),W}))}function y(P){navigator.storage.estimate().then(({quota:z,usage:W})=>{let U=W/z*100,j=Qt(z),Y=Qt(z-W);z>2e10&&(U=(W+2e10)/z*100,Y=Qt(z-2e10-W)),P({available:j,free:Y,percent:U})})}function M(){const P=_("div",{className:"progress-value",style:{width:"80%"}});return y(({percent:z})=>{P.style.width=z+"%"}),P}function I(){const P=_("div",{},"4 GB free of 20 GB");return y(({available:z,free:W})=>{P.textContent=`${W.value} ${W.unit} free of ${z.value} ${z.unit}`}),P}function C(P){const z=new Date(P),W=z.getDate();return Zi[z.getDay()]+", "+(W<10?"0"+W:W)+"-"+$i[z.getMonth()]+"-"+z.getFullYear()+" "+It(z)}function D(P){P.button===0&&(P.shiftKey||F(),a=!0,h={x:P.x+v.scrollLeft,y:P.y+v.scrollTop},f=v.getBoundingClientRect(),document.addEventListener("mousemove",A,!1),document.addEventListener("mouseup",H,!1))}function A(P){const z={top:v.scrollTop,left:v.scrollLeft};if(S=Math.abs(P.x+z.left-h.x),n=Math.abs(P.y+z.top-h.y),!a||S<2&&n<2)return;let W=0,U=0,j=S,Y=n;P.x+z.left>h.x?U=h.x-f.left:U=P.x-f.left+z.left,P.y+z.top>h.y?W=h.y-f.top:W=P.y-f.top+z.top,ge(p,{display:"initial",top:W+"px",left:U+"px",width:j+"px",height:Y+"px"}),(U+j>f.width+z.left||U<z.left)&&v.scrollTo({top:P.y-f.top,left:P.x-f.left}),N({x1:U,x2:U+j,y1:W,y2:W+Y},P.shiftKey)}function H(){a=!1,document.removeEventListener("mousemove",A,!1),document.removeEventListener("mouseup",H,!1),ge(p,{display:"none",top:0,left:0,width:0,height:0}),l=Array.from(x.getElementsByClassName("pannel-item-selected")),ye(c.onSelected)&&c.onSelected(l)}function N(P,z){const W=Array.from(x.getElementsByClassName("pannel-item")).map(j=>j),U=[];for(let j of W){let Y=j.offsetLeft,R=j.offsetTop,$=j.offsetWidth,q=j.offsetHeight;Y+$<P.x1||Y>P.x2||R+q<P.y1||R>P.y2?z||j.classList.remove("pannel-item-selected"):(U.push(j),j.classList.add("pannel-item-selected"))}ye(c.onSelect)&&c.onSelect(U)}function F(){for(let P of l)P.classList.remove("pannel-item-selected");l=[],ye(c.onSelect)&&c.onSelect([])}function L(P){G(k)&&k.remove(),k=d(P),v.appendChild(k),O()}function B(){b.style.height="0px"}function O(){B(),b.style.height=v.scrollHeight+"px"}return{element:v,setView:L,updateSelectionHandler:O}}function ma(e){let c,v,b,x,k,S;c=_("div",{className:"explorer-status-bar flex items-center flex-shrink-0"},[v=_("div",{className:"explorer-status-bar-item"},"0 items"),b=_("div",{className:"explorer-status-bar-item"}),x=_("div",{className:"explorer-status-bar-item"}),_("div",{className:"explorer-status-bar-item",style:{marginLeft:"auto",marginRight:"10px"}},[k=_("div",{className:"explorer-status-bar-view button-presentation",innerHTML:Hr(16),onclick:n.bind(null,"details")}),S=_("div",{className:"explorer-status-bar-view button-presentation",innerHTML:Zs(16),onclick:n.bind(null,"mediumIcons")})])]);function n(h){e.onViewChange(h)}function s(h){k.classList.remove("selected"),S.classList.remove("selected"),h==="details"?k.classList.add("selected"):h==="mediumIcons"&&S.classList.add("selected")}function l(h=0){v.textContent=h+" items"}function p(h=0){b.textContent=h>0?h+" items selected":""}function a(h){x.textContent=h}return{element:c,setItemCount:l,setSelectedItem:p,setView:s,setSize:a}}const vn=(e,c,v=!1)=>{let b;const x=[];let k,S=[],n;const s=Xi(),l=gn({onTabChange:f,onTabClose:d,onNewTabActionClick:y,onDragOut:r,onDragOver:()=>{},onDragEnd(M,I){I&&(k.content.setCurrentWindow(b),l.showNewButton())},getTabCount:h,moveWindow:a}),p=_("div",{className:"window-tabs-container explorer-tabs-container w-full"},[_("div",{className:"tabs-drag-handle w-full h-full absolute",["drag-region"]:"drag"}),l.element]);p.addEventListener("tabdragover",o,!1);function a(M,I){ge(b.element,{pointerEvents:"none"}),document.addEventListener("mousemove",D,!1),document.addEventListener("mouseup",A,!1);let C;function D(H){b.checkWindowSnap({x:H.x,y:H.y}),b.setBounds({top:H.y-I.deltaTop,left:H.x-I.deltaLeft});const N=document.elementFromPoint(H.x,H.y);if(N instanceof Element){const F=N.closest(".explorer-tabs-container");G(F)&&C!==F&&(C=F,A(),b.close(),F.dispatchEvent(new CustomEvent("tabdragover",{bubbles:!0,detail:{x:H.x,dx:I.dl,y:H.y,tabId:M.id,windowId:M.windowId,icon:M.icon,text:M.text,content:k.content}})))}}function A(){b.setWindowSnap(),ge(b.element,{pointerEvents:"initial"}),document.removeEventListener("mousemove",D,!1),document.removeEventListener("mouseup",A,!1)}}function h(){return x.length}function f(M){if(n===M.id)return;n=M.id,k=u(M.id);const I=S.findLastIndex(C=>C===M.id);I>-1&&S.splice(I,1),S.unshift(M.id),l.setActiveTab(M.id),b.setContent(k.content.element),k.content.updateSelectionHandler(),i(k.id,k.text,k.icon)}function u(M){return x.find(I=>I.id===M)}function d(M,I){const C=x.findIndex(A=>A.id===M.id);l.remove(M.id),C>-1&&(I||x[C].content.dispose(),x.splice(C,1));const D=S.findIndex(A=>A===M.id);D>-1&&S.splice(D,1),x.length===0?b.close():(k=u(S[0]),l.setActiveTab(k.id),i(k.id,k.text,k.icon),b.setContent(k.content.element))}function t(M){let I=b,C,D="wtct"+Ii(),A;const H=[];let N=0,F="",L=[],B;const O=J=>{B=J},P=da({onItemClick:J=>{let oe=!(Xe(J.location)||St(J.location));U(J,!0,oe)},onImportFiles(J){const oe=J.target;Ft(F)||Ko(F,Array.from(oe.files))},history:{onBackward:Y,onForward:R,onGoUp:$},getContainer:()=>b.element,getCurrentLocation:()=>F,actionEvents:{onDelete(){const J=L.map(oe=>{const te={type:oe.info.type,location:oe.info.location};return oe.info.type==="file"&&(te.size=oe.info.properties.size),te});qo(J,F)}}}),z=aa({onChange:J=>{U(J,!0,!0)}}),W=ma({onViewChange:J=>{C.setView(J),W.setView(J),fe.setView(F,{type:J,sortBy:"name",orderBy:"asc"})}});function U(J,oe=!0,te=!1){var ce;if(W.setSelectedItem(0),P.setLocation(J.location),oe&&(H.splice(N+1,H.length),((ce=H[H.length-1])==null?void 0:ce.text)!==J.text&&(N=H.push(J)-1)),te){const Pe=s.findIndex(ie=>ie.name===J.text||ie.path===J.text),ve=s[Pe];if(Pe>-1)if(F=ve.location,P.setLocation(F),q(),ve.type==="root"){const ie=ve.children.filter(me=>me.type==="folder").map(me=>new Promise((Le,ne)=>{fe.stats(me.location,(ue,be)=>{ue?ne(ue):Le({...be,location:me.location})})})),pe=ve.children.filter(me=>me.type!=="folder");Promise.all(ie).then(me=>{const ne=pe.concat(me).map(ue=>({icon:ue.icon||(ue.type==="file"?$t(gt(ue.name)).icon:mt),text:ue.name,properties:{...ue},type:ue.type,location:ue.location}));he(ne,{view:ve.view,group:ve.group,sortBy:ve.sortBy,orderBy:ve.orderBy})}),P.toolbarNavigation.toolbarPath.setPath({text:ve.name,icon:ve.icon,path:ve.path,location:ve.location}),P.toolbarNavigation.setPlaceHolder(ve.name),ye(B)&&B(M,ve.name,ve.icon)}else(ve.type==="folder"||ve.type==="driver")&&xe(ve.location,ve.path,{view:ve.view,group:ve.group,sortBy:ve.sortBy,orderBy:ve.orderBy});else xe(J.location)}else xe(J.location);function xe(Pe,ve,ie){fe.readFolder(Pe,(pe,me)=>{if(pe)console.log(pe);else{F=Pe,P.setLocation(F),q();const Le=me.map(ne=>{var ue;return{icon:ne.icon||(ne.type==="file"?$t(gt(ne.name)).icon:mt),text:ne.name,properties:{...ne},type:ne.type,location:Pe+"/"+ne.name,name:ne.name,cdate:ne.cdate.toString(),size:(ue=ne.size)==null?void 0:ue.toString()}});fe.stats(Pe,(ne,ue)=>{if(ne)console.log(ne);else{P.toolbarNavigation.toolbarPath.setPath({text:ue.text||ue.name,icon:ue.icon||mt,path:G(ve)?ve:Pe,location:Pe}),ye(B)&&B(M,ue.text||ue.name,ue.icon||mt),P.toolbarNavigation.setPlaceHolder(ue.text||ue.name);let be={};G(ue.view)?Object.assign(be,{...ue.view,view:ue.view.type}):G(ie)&&(be=ie),he(Le,be)}})}})}}function j(){let J=!1,oe=F;function te(){J&&oe===F&&(U({location:F,text:F},!1),J=!1)}function xe(ce){return ce.substring(F.length+1,ce.length).split("/")}fe.addEventListener("added",D,Wt(()=>{te()},{limit:1e3,onFunction(ce){ce.includes(F)&&xe(ce).length===1&&(J||(J=!0),oe=F)}})),fe.addEventListener("modified",D,Wt(()=>{te()},{limit:1e3,onFunction(ce){ce.includes(F)&&xe(ce).length===1&&(J||(J=!0),oe=F)}})),fe.addEventListener("removed",D,Wt(()=>{te()},{limit:1e3,onFunction(ce){ce.includes(F)&&xe(ce).length===1&&(J||(J=!0),oe=F)}}))}j();function Y(){N-=1,U(H[N],!1,!0)}function R(){N+=1,U(H[N],!1,!0)}function $(J){U({text:J,location:J})}function q(){P.toolbarNavigation.checkHistoryButtons(H,N,F)}function X(J){J.preventDefault(),Ft(F)||gi(F,J.dataTransfer.items)}function se(J){J.preventDefault(),J.stopPropagation(),J.dataTransfer.dropEffect="copy"}function V(J,oe){J.preventDefault(),J.stopPropagation(),oe.type==="folder"||oe.type==="driver"?gi(oe.location,J.dataTransfer.items):Ft(F)||gi(F,J.dataTransfer.items)}function he(J,oe){setTimeout(()=>{at(A),P.setSelectedItems([],F),W.setItemCount(J.length),W.setView(oe.view),!G(J)||(J==null?void 0:J.length)===0?A.appendChild(_("div",{style:{textAlign:"center",padding:"20px 0"}},"This folder is empty")):(C=fa({selectable:!0,items:J,...oe},{onItemMouseDown(){},onChange:te=>{if(te.type==="folder"||te.type==="driver")U({text:te.location,location:te.location},!0);else{const xe=gt(te.text),ce=$t(xe);Fe(ce.appName,te.location)}},onSelect(te){if(L=te,P.setSelectedItems(te,F),W.setSelectedItem(te.length),te.length>0&&te.every(ce=>ce.info.type==="file")){const ce=Qt(Z(te));W.setSize(ce.value+" "+ce.unit)}else W.setSize("")},onPannelItemDragover:se,onPannelItemDrop:V}),A.appendChild(C.element),C.updateSelectionHandler())},50)}function ke(){I.addEventListener("resize",Ge(()=>{C.updateSelectionHandler()})),I.addEventListener("passiveResize",Ge(()=>{C.updateSelectionHandler()})),I.addEventListener("maximize",Ge(()=>{C.updateSelectionHandler()})),I.addEventListener("unmaximize",Ge(()=>{C.updateSelectionHandler()})),I.addEventListener("unSnap",Ge(()=>{C.updateSelectionHandler()})),I.addEventListener("restore",Ge(()=>{C.updateSelectionHandler()}))}function ee(){I.removeListeners("resize",Ge(()=>{})),I.removeListeners("passiveResize",Ge(()=>{})),I.removeListeners("maximize",Ge(()=>{})),I.removeListeners("unmaximize",Ge(()=>{})),I.removeListeners("unSnap",Ge(()=>{})),I.removeListeners("restore",Ge(()=>{}))}function le(){ke()}le();function Z(J){let oe=0,te=J.length;for(let xe=0;xe<te;xe++){const ce=J[xe];ce.info.type==="file"&&(oe+=ce.info.properties.size)}return oe}const de=_("div",{className:"explorer-container w-full h-full relative"},[P.element,_("div",{className:"explorer-body flex flex-col w-full h-full"},[_("div",{className:"w-full flex",style:{height:"calc(100% - 25px)"}},[z.element,A=_("div",{className:"explorer-content h-full flex-1",ondragover(J){Ft(F)&&(J.dataTransfer.dropEffect="none")},ondrop:X})]),W.element])]);function _e(J){I=J,le()}function we(){fe.removeListeners("added",D),fe.removeListeners("modified",D),fe.removeListeners("removed",D)}return{element:de,toolbar:P,listenEvent:O,routeTo:U,listenFileChange:j,setCurrentWindow:_e,updateSelectionHandler(){C==null||C.updateSelectionHandler()},addWindowEvents:ke,removeWindowEvents:ee,dispose:we}}function i(M,I,C){b.setTitle(I),G(C)&&b.setIcon(C);const D=l.getTab(M);G(D)&&(D.setTitle(I),G(C)&&D.setIcon(C));const A=u(M);G(A)&&(A.text=I,A.icon=C)}function o(M){l.hideNewButton(),b.focus();const I=M,C={icon:I.detail.icon,text:I.detail.text,content:I.detail.content},D=l.add(C);D.triggerMouseMove(I),k={id:D.id,text:C.text,icon:C.icon,content:C.content},k.content.listenEvent((A,H,N)=>{i(D.id,H,N)}),k.content.listenFileChange(),S.unshift(D.id),x.push(k),b.setContent(C.content.element)}function r(M,I){const C=b.getBounds(),D={top:I.top-I.deltaTop,left:I.left-I.deltaLeft,width:C.width,height:C.height},A=u(M.id);A.content.listenEvent(null),A.content.removeWindowEvents(),M.content=A.content;const H=vn(null,D,!0);H.addTabAndMoveWindow(M,{...I,windowBounds:D},H.window)}function m(M,I,C){const D=l.add(M);l.disabledScrollbar(),ge(D.element,{position:"absolute",left:I.deltaLeft-I.dl+"px"}),k={id:D.id,text:M.text,icon:M.icon,content:M.content},k.content.setCurrentWindow(C),k.content.addWindowEvents(),S.unshift(D.id),n=D.id,k.content.listenEvent((A,H,N)=>{i(k.id,H,N)}),k.content.listenFileChange(),x.push(k),b.setContent(k.content.element),i(k.id,k.text,k.icon),g(M,I,D),l.hideNewButton()}function g(M,I,C){ge(b.element,{pointerEvents:"none"}),document.addEventListener("mousemove",A,!1),document.addEventListener("mouseup",H,!1);let D;function A(N){b.checkWindowSnap({x:N.x,y:N.y}),b.setBounds({top:N.y-I.deltaTop,left:N.x-I.deltaLeft});const F=document.elementFromPoint(N.x,N.y);if(F instanceof Element){const L=F.closest(".explorer-tabs-container");G(L)&&D!==L&&(D=L,H(),b.close(),L.dispatchEvent(new CustomEvent("tabdragover",{bubbles:!0,detail:{x:N.x,dx:I.dl,y:N.y,tabId:M.id,windowId:M.windowId,icon:M.icon,text:M.text,content:k.content}})))}}function H(){l.enabledScrollbar(),b.setWindowSnap(),l.showNewButton(),ge(b.element,{pointerEvents:"initial"}),C.element.style.removeProperty("position"),C.element.style.removeProperty("left"),document.removeEventListener("mousemove",A,!1),document.removeEventListener("mouseup",H,!1)}}function E(M){const I={text:M,icon:"imgs/icons/Folder.png"},C=l.add(I),D=t(C.id);D.listenEvent((A,H,N)=>{i(A,H,N)}),D.routeTo({text:M,location:M},!0,!0),k={id:C.id,text:I.text,icon:I.icon,content:D},S.unshift(C.id),x.push(k),b.setContent(D.element),i(I.id,I.text,I.icon)}function T(M){const I=l.add({...M,windowId:b.id});let C=t(I.id);C.listenEvent(i),k={id:I.id,text:M.text,icon:M.icon,content:C},S.unshift(I.id),n=I.id,x.push(k),b.setContent(C.element),C.routeTo({text:M.text},!0,!0),i(M.id,M.text,M.icon)}function w(){T({text:"This PC",windowId:b.id,icon:"imgs/icons/Computer.png"})}function y(){w()}return b=lt({args:e,icon:Q.explorer.icon,hideIcon:!0,name:Q.explorer.name,title:Q.explorer.productName,hideTitle:!0,titlebarHeight:bt,titlebarContent:p,top:(c==null?void 0:c.top)||50,left:(c==null?void 0:c.left)||50,width:(c==null?void 0:c.width)||800,height:(c==null?void 0:c.height)||520,className:"explorer-app-window",transprencyContent:!0}),v||(G(e)?E(e):w()),b.addEventListener("close",()=>{for(let M=0;M<x.length;M++)x[M].content.dispose()}),b.addEventListener("secondInstance",M=>{b.isVisible()||b.show(),b.focus(),G(M)?E(M):w()}),b.addEventListener("restore",function(){b.isMaximized()||b.setTitlebarHeight(bt)}),b.addEventListener("unmaximize",function(){b.isMaximized()||b.setTitlebarHeight(bt)}),b.addEventListener("unSnap",function(){b.isMaximized()||b.setTitlebarHeight(bt)}),b.addEventListener("maximize",function(){b.setTitlebarHeight(Mt)}),{addTabAndMoveWindow:m,tabs:l,window:b}};function pa(e){let c=ss(Q.explorer.name);G(c)?c.window.executeListeners("secondInstance",e):vn(e)}function qe(e,c){const v=Ts(50,200),b=Ts(50,200);lt({icon:e.icon,name:e.name,title:e.productName,top:v,left:b,width:450,height:300,content:()=>_("div",{className:"w-full h-full flex content-center items-center"},_("h3",{},"In Progress"))})}function ga(e,c){let v;v=_("div",{tabIndex:0,className:"menu-strip flex items-center",onfocus:c.onfocus,onblur:c.onblur});for(let k=0;k<e.length;k++){const S=e[k],n=_("div",{className:"menu-strip-item flex-shrink-0"},_("div",{className:"h-full flex items-center"},S.text));b(n,S.children),v.appendChild(n)}function b(k,S){if(G(S)){const n=_("div",{className:"context-menu"});S.forEach(s=>[x(n,s)]),k.appendChild(n)}}function x(k,S){if(S.divider){let l=_("div",{className:"menu-item-divider"});k.appendChild(l);return}const n=G(S.children)&&S.children.length>0,s=_("div",{className:"menu-item"+(S.disabled?" disabled":"")+(S.emphasis?" emphasis":"")+(S.checked?" checked":""),onclick:()=>{!S.disabled&&!n&&ye(c.onItemClick)&&c.onItemClick(S)}},[_("div",{className:"menu-item-icon",innerHTML:S.checked?rn():"",style:{pointerEvents:"none"}}),_("div",{className:"menu-item-text",style:{pointerEvents:"none"}},S.text||"")]);if(S.shortcut){let l=_("div",{className:"menu-item-shortcut",style:{pointerEvents:"none"}},S.shortcut);s.appendChild(l)}if(n){let l=_("div",{className:"menu-item-arrow flex items-center",innerHTML:Ut});s.appendChild(l)}k.appendChild(s),b(s,S.children)}return v}function _n(e,c,v=!1){let b,x;const k=[];let S,n=[],s;const l=gn({onTabChange:h,onTabClose:u,onNewTabActionClick:d,onDragOver:()=>{},onDragOut:g,onDragEnd(y,M){M&&l.showNewButton()},getTabCount:a,moveWindow:p});function p(y,M){ge(x.element,{pointerEvents:"none"}),document.addEventListener("mousemove",C,!1),document.addEventListener("mouseup",D,!1);let I;function C(A){x.checkWindowSnap({x:A.x,y:A.y}),x.setBounds({top:A.y-M.deltaTop,left:A.x-M.deltaLeft});const H=document.elementFromPoint(A.x,A.y);if(H instanceof Element){const N=H.closest(".notepad-tabs-container");G(N)&&I!==N&&(I=N,D(),x.close(),N.dispatchEvent(new CustomEvent("tabdragover",{bubbles:!0,detail:{x:A.x,dx:M.dl,y:A.y,tabId:y.id,windowId:y.windowId,icon:y.icon,text:y.text,content:S.element}})))}}function D(){x.setWindowSnap(),ge(x.element,{pointerEvents:"initial"}),setTimeout(()=>{S.element.input.focus()},10),document.removeEventListener("mousemove",C,!1),document.removeEventListener("mouseup",D,!1)}}function a(){return k.length}function h(y){if(s===y.id)return;s=y.id,S=f(y.id);const M=n.findLastIndex(I=>I===y.id);M>-1&&n.splice(M,1),n.unshift(y.id),l.setActiveTab(y.id),x.setContent(S.element.element),setTimeout(()=>{S.element.input.focus()},10),r(y.id,y.text,y.icon)}function f(y){return k.find(M=>M.id===y)}function u(y){const M=k.findIndex(C=>C.id===y.id);M>-1&&k.splice(M,1);const I=n.findIndex(C=>C===y.id);I>-1&&n.splice(I,1),k.length===0?x.close():(S=f(n[0]),l.setActiveTab(S.id),r(S.id,S.text),x.setContent(S.element.element))}function d(){t()}function t(){i({text:"Untitled - Notepad",icon:"imgs/icons/Apps/notepad.png"})}function i(y,M){const I=l.add({...y,windowId:x.id});let C;G(M)?C=M:C=o(),S={id:I.id,text:y.text,element:C},n.unshift(I.id),k.push(S),x.setContent(C.element),setTimeout(()=>{C.input.focus()},10),r(y.id,y.text)}function o(){let y,M,I,C;y=_("div",{className:"w-full h-full flex flex-col"},[ga([{text:"File",children:[{text:"New",shortcut:"Ctrl+N"},{text:"Open",shortcut:"Ctrl+O"},{text:"Save",shortcut:"Ctrl+S"},{text:"SaveAs",shortcut:"Ctrl+Shift+S"},{divider:!0},{text:"Close",shortcut:"Alt+W"}]},{text:"Edit",children:[{text:"Undo",disabled:!0,shortcut:"Ctrl+Z"},{divider:!0},{text:"Cut",disabled:!0,shortcut:"Ctrl+X"},{text:"Copy",disabled:!0,shortcut:"Ctrl+C"},{text:"Paste",disabled:!0,shortcut:"Ctrl+V"},{text:"Delete",disabled:!0,shortcut:"Del"},{divider:!0},{text:"Find",shortcut:"Ctrl+F"},{text:"Replace...",shortcut:"Ctrl+H"},{divider:!0},{text:"Select All",shortcut:"Ctrl+A"}]},{text:"Format",children:[{text:"Wordwrap",checked:!0},{text:"Font..."}]},{text:"View",children:[{text:"Zoom",children:[{text:"Zoom In",shortcut:"Ctrl+Plus"},{text:"Zoom Out",shortcut:"Ctrl+Minus"},{text:"Restore Default Zoom",shortcut:"Ctrl+0"}]},{text:"Status Bar",checked:!0}]},{text:"Help",children:[{text:"View Help"},{text:"Send Feedback"},{divider:!0},{text:"About Notepad"}]}],{onItemClick(){M.focus()}}),M=_("textarea",{tabIndex:0,name:"notepad-input",className:"w-full h-full scrollable scroll-y",style:{display:"block",border:0,borderTop:"1px solid var(--border-color)",outline:0,padding:"5px",color:"var(--primary-text-color)",backgroundColor:"transparent",font:"400 14px Consolas",cursor:"default",resize:"none"},onselect(N){N.preventDefault()},onkeydown:()=>{A(),document.onkeyup=H},onmousedown:()=>{A(),H(),document.onmousemove=()=>{A(),H()},document.onmouseup=H}}),_("div",{className:"note-pad-status-bar w-full flex items-center flex-shrink-0",style:{borderTop:"1px solid var(--border-color)",minHeight:"25px",paddingInline:"10px"}},[_("div",{className:"note-pad-status-left h-full"}),_("div",{className:"note-pad-status-right flex h-full",style:{marginLeft:"auto"}},[I=_("div",{className:"note-pad-status-bar-item"}),C=_("div",{className:"note-pad-status-bar-item"}),_("div",{className:"note-pad-status-bar-item"},"100%"),_("div",{className:"note-pad-status-bar-item"},"Windows (CRLF)"),_("div",{className:"note-pad-status-bar-item"},"UTF-8")])])]),A(),H();function A(){setTimeout(()=>{const N=M.value.substring(0,M.selectionStart).split(`
`),F=N.length,L=N[N.length-1].length;C.textContent=`Ln ${F}, Col ${L}`},150)}function H(){setTimeout(()=>{const N=M.value.substring(M.selectionStart,M.selectionEnd);I.textContent=(N.length>0?N.length:0)+" selected"},100)}return{element:y,input:M}}function r(y,M,I){x.setTitle(M);const C=l.getTab(y);G(C)&&(C.setIcon(I||"imgs/icons/Apps/notepad.png"),C.setTitle(M))}function m(y){l.hideNewButton(),x.focus();const M=y,I={icon:M.detail.icon,text:M.detail.text,content:M.detail.content},C=l.add(I);C.triggerMouseMove(M),S={id:C.id,text:I.text,element:I.content},n.unshift(C.id),k.push(S),x.setContent(I.content.element),setTimeout(()=>{S.element.input.focus()},10),r(C.id,S.text)}function g(y,M){const I=x.getBounds(),C={top:M.top-M.deltaTop,left:M.left-M.deltaLeft,width:I.width,height:I.height},D=f(y.id);y.content=D.element,_n(null,C,!0).addTabAndMoveWindow(y,{...M,windowBounds:C})}function E(y,M){const I=l.add(y);ge(I.element,{position:"absolute",left:M.deltaLeft-M.dl+"px"}),S={id:I.id,text:y.text,element:y.content},n.unshift(I.id),k.push(S),x.setContent(S.element.element),setTimeout(()=>{S.element.input.focus()},10),r(I.id,y.text,y.icon),T(y,M,I),l.hideNewButton()}function T(y,M,I){ge(x.element,{pointerEvents:"none"}),document.addEventListener("mousemove",D,!1),document.addEventListener("mouseup",A,!1);let C;function D(H){x.checkWindowSnap({x:H.x,y:H.y}),x.setBounds({top:H.y-M.deltaTop,left:H.x-M.deltaLeft,width:M.windowBounds.width,height:M.windowBounds.height});const N=document.elementFromPoint(H.x,H.y);if(N instanceof Element){const F=N.closest(".notepad-tabs-container");G(F)&&C!==F&&(C=F,A(),x.close(),F.dispatchEvent(new CustomEvent("tabdragover",{bubbles:!0,detail:{x:H.x,dx:M.dl,y:H.y,tabId:y.id,windowId:y.windowId,icon:y.icon,text:y.text,content:S.element}})))}}function A(){x.setWindowSnap(),l.showNewButton(),ge(x.element,{pointerEvents:"initial"}),I.element.style.removeProperty("position"),I.element.style.removeProperty("left"),setTimeout(()=>{S.element.input.focus()},10),document.removeEventListener("mousemove",D,!1),document.removeEventListener("mouseup",A,!1)}}function w(y){qi(y,(M,I)=>{if(M)return;const C=Qe(y)+" - Notepad";x.setTitle(C);const D={text:C,icon:"imgs/icons/Apps/notepad.png"},A=l.add({...D,windowId:x.id}),H=o();H.input.value=I,S={id:A.id,text:C,element:H},n.unshift(A.id),k.push(S),x.setContent(H.element),H.input.focus(),r(A.id,D.text,D.icon)})}return b=_("div",{className:"window-tabs-container notepad-tabs-container w-full"},[_("div",{className:"tabs-drag-handle w-full h-full absolute",["drag-region"]:"drag"}),l.element]),b.addEventListener("tabdragover",m,!1),x=lt({args:e,icon:Q.notepad.icon,hideIcon:!0,name:Q.notepad.name,title:Q.notepad.productName,hideTitle:!0,top:(c==null?void 0:c.top)||50,left:(c==null?void 0:c.left)||100,width:(c==null?void 0:c.width)||700,height:(c==null?void 0:c.height)||450,titlebarHeight:bt,titlebarContent:b,className:"notepad-app-window",transprencyContent:!0}),v||(G(e)?w(e):t()),x.addEventListener("customdrop",y=>{y!=null&&y.type&&y.type==="file"&&gt(y.args)===".txt"&&qi(y.args,(M,I)=>{M||(S.element.input.value=I,x.focus(),r(S.id,Qe(y.args)+" - NotePad"))})}),x.addEventListener("secondInstance",y=>{x.isVisible()||x.show(),G(y)?w(y):t(),x.focus()}),x.addEventListener("restore",()=>{x.isMaximized()||x.setTitlebarHeight(bt)}),x.addEventListener("unmaximize",()=>{x.isMaximized()||x.setTitlebarHeight(bt)}),x.addEventListener("unSnap",()=>{x.isMaximized()||x.setTitlebarHeight(bt)}),x.addEventListener("maximize",()=>{x.setTitlebarHeight(Mt)}),{addTabAndMoveWindow:E,tabs:l,window:x}}const va=e=>{let c=ss(Q.notepad.name);G(c)?c.window.executeListeners("secondInstance",e):_n(e)};const Si=1.7777777777777777,ii=120,ut=140,xi=160,ft=8,xt=48,Is=200,_a=200,Bs=40,Gi=xt,wa=60,Rs=45,Gt=4,ba="#bbb",ya=`
<svg width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="#333" fill="none" stroke-linecap="round" stroke-linejoin="round" style="stroke: var(--stroke-color)">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="12" y1="5" x2="12" y2="19" />
  <line x1="16" y1="9" x2="12" y2="5" />
  <line x1="8" y1="9" x2="12" y2="5" />
</svg>`,Sa=`
<svg width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="#333" fill="none" stroke-linecap="round" stroke-linejoin="round" style="stroke: var(--stroke-color)">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="12" y1="5" x2="12" y2="19" />
  <line x1="16" y1="15" x2="12" y2="19" />
  <line x1="8" y1="15" x2="12" y2="19" />
</svg>
`;function As(e,c){typeof c>"u"||c===null||(c instanceof HTMLElement?e.appendChild(c):c instanceof Array?wn(e,c):e.appendChild(document.createTextNode(c.toString())))}function wn(e,c){c instanceof Array?c.forEach(v=>{As(e,v)}):As(e,c)}function xa(e,c){for(let v in c)v.indexOf("-")>-1?e.style.setProperty(v,c[v]):e.style[v]=c[v]}function He(e,c,v){let b=document.createElement(e);if(c){const x=c;for(let k in x)if(k==="style"){const S=x[k];xa(b,S)}else if(k.indexOf("-")>-1||k.indexOf(":")>-1){const S=x[k];b.setAttribute(k,S)}else b[k]=x[k]}return v&&wn(b,v),b}function Ns(e){let c=e.firstChild;for(;c;)e.removeChild(c),c=e.firstChild}function bn(e=0,c=[],v=4){const b=c.length;let x=[0],k=!1,S=0;function n(h=[],f=0,u=0,d=0,t){const i=c[u];if(!i)return h;const o=u+1-f,r=o>1?(o-1)*v:0;d+=i.ratio;const m=d*ut,g=(e-r)/d,E=g<=xi+S&&g>=ii,T=e-m<=0?g/xi:g/ii,w=Math.pow(Math.abs(T),3)*100,y=d;if(E)h.push({edge:u,badness:w,rowHeight:g,flag:1,itemCount:o,boxSpacing:v,ratio:y}),S=0,k=!1;else{if(m+r>e)return k?(S=0,h.length===0&&(g<ii||!t?h.push({edge:u,badness:w,rowHeight:g,flag:o>1?-1:0,ratio:y,itemCount:o,boxSpacing:v}):t&&h.push(t)),h):(k=!0,S=20,n(h,f,u,d-i.ratio,t));if(u===(b>1?b-1:0))return h.push({edge:u,badness:w,flag:0,rowHeight:ut,ratio:y,itemCount:o,boxSpacing:v}),h;t={edge:u,badness:w,rowHeight:g,flag:o>1?1:0,ratio:y,itemCount:o,boxSpacing:v}}return n(h,f,u+1,d,t)}let s=[];function l(){let h=x.shift();if(typeof h>"u"||h===null||!c[h])return;let f=n([],h,h),u;u=f[0];for(let t=1;t<f.length;t++){const i=f[t];i.badness<u.badness&&(u=i)}const d={flag:u.flag,row:[h,u.edge],ratio:u.ratio||Si,itemCount:u.itemCount,boxSpacing:u.boxSpacing,rowHeight:u.rowHeight||ut};s.push(d),u.edge+1<=b&&x.push(u.edge+1)}for(;x.length>0;)l();let p=s.length,a=s[p-1];return p>1&&a.flag===0&&(a.rowHeight=s[p-2].rowHeight),{paths:s,rowCount:s.length}}function Ca(e=0,c=[],v=48){const b=c.length;let x=[0];function k(s=[],l=0,p=0,a=0,h=0,f){const u=c[p];if(!u)return s;h+=u.itemCount>1?(u.itemCount-1)*ft:0;const d=p+1-l,t=(d>1?(d-1)*v:0)+h;a+=u.ratio;const i=a*ut,o=(e-t)/a,r=o<=xi&&o>=ii,m=e-i<=0?o/xi:o/ii,g=Math.pow(Math.abs(m),3)*100;if(r)s.push({edge:p,badness:g,rowHeight:o,flag:1,itemCount:d,boxSpacing:v,ratio:a});else{if(i+t>e)return s.length===0&&(f?s.push(f):s.push({edge:p,badness:g,rowHeight:o,flag:1,itemCount:d,boxSpacing:v,ratio:a})),s;if(p===(b>1?b-1:0))return s.push({edge:p,badness:g,flag:0,rowHeight:ut,ratio:a,itemCount:d,boxSpacing:v}),s;f={edge:p,badness:g,rowHeight:ut,flag:0,itemCount:d,boxSpacing:v,ratio:a}}return k(s,l,p+1,a,h,f)}let S=[];function n(){let s=x.shift();if(typeof s>"u"||s===null||!c[s])return;const l=c[s];let p=c[s+1];if(l.rowCount>1||typeof p<"u"&&p.rowCount>1)S.push({flag:1,row:[s,s],boxSpacing:v,rowHeight:ut,ratio:l.ratio||Si}),s+1<=b&&x.push(s+1);else{let a=k([],s,s,0,0),h=a[0];for(let u=1;u<a.length;u++){const d=a[u];d.badness<h.badness&&(h=d)}const f={flag:h.flag,row:[s,h.edge],rowHeight:h.rowHeight||ut,boxSpacing:h.boxSpacing,ratio:h.ratio||Si};S.push(f),h.edge+1<=b&&x.push(h.edge+1)}}for(;x.length>0;)n();return{paths:S,rowCount:S.length}}function Ps(e=300,c){const v=c.segments.map(l=>{const{paths:p,rowCount:a}=bn(e,l.items),h=p[0];return{rows:p,rowCount:a,ratio:h.ratio||Si,itemCount:a===1?h.row[1]+1-h.row[0]:0}}),b=v.map(({rowCount:l,ratio:p,itemCount:a})=>({rowCount:l,ratio:p,itemCount:a})),x=Ca(e,b,xt),k={index:c.index,name:c.name,loaded:!0,left:0,width:e,height:0,segments:[],segmentInfo:[]};let S=0,n=0;for(let l=0;l<x.paths.length;l++){const p=x.paths[l],a=p.flag,h=p.row[1]+1-p.row[0];let f=0;for(let u=p.row[0];u<=p.row[1];u++){const d=v[u];var s=c.segments[u];const t={index:s.index,name:s.name,top:S,left:f,width:0,height:0,items:[],flag:a};let i=0,o=0;for(let r=0;r<d.rows.length;r++){const m=d.rows[r],g=p.rowHeight||m.rowHeight||ut,E=Math.floor(g);let T=0;for(let w=m.row[0];w<=m.row[1];w++){const y=s.items[w],M=Math.round(y.ratio*g);let I={...y,top:i+xt,left:T,width:a===0?M:h>1?u===p.row[1]&&w===m.row[1]?e-(f+T):M:m.flag===0?M:w===m.row[1]&&m.itemCount>1?e-T:M,height:E};t.items.push(I),T+=I.width+ft}o=T-ft,i+=E+ft,f+=T-ft+xt}t.width=d.rowCount===1?o:e,n=i-ft+Gi,t.height=n,u===p.row[1]&&(S+=n),k.segments.push(t),k.segmentInfo.push({index:t.index,top:t.top,height:t.height})}}return k.height=S,k}function Hs(e=300,c){const v={index:c.index,name:c.name,left:0,width:e,height:0,segments:[],segmentInfo:[],loaded:!0},b=c.segments;let x=0;for(let k=0;k<b.length;k++){const S=b[k],{paths:n,rowCount:s}=bn(e,S.items),l={index:S.index,name:S.name,top:x,left:0,width:e,height:0,items:[]};let p=0;for(let a=0;a<s;a++){const h=n[a],f=h.rowHeight,u=Math.floor(f);let d=0;for(let t=h.row[0];t<=h.row[1];t++){const i=S.items[t],o=Math.round(i.ratio*f);let r={...i,top:p+xt,left:d,width:h.flag===0?o:t===h.row[1]&&h.itemCount>1?e-d:o,height:u+Gi};l.items.push(r),d+=r.width+ft}p+=u+ft+xt}l.height=p-ft+Gi,x+=l.height,v.segments.push(l),v.segmentInfo.push({index:l.index,top:l.top,height:l.height})}return v.height=x,v}function yn(e,c,v,b){let x=0;return e+c<b-Is&&(x=-1),e>b+v+Is&&(x=-1),x===0}function ka(e=0,c=[],v,b){const x=[];for(let k=0;k<c.length;k++){const S=c[k];yn(e+S.top,S.height,v,b)&&x.push(S.index)}return x}function ui(e,c,v,b=10,x){let k,S,n,s;return function(){const l=this,p=arguments;window.cancelAnimationFrame(s),s=window.requestAnimationFrame(()=>{typeof x=="function"&&x.apply(l,p,s)}),window.clearTimeout(n),n=window.setTimeout(()=>{typeof v=="function"&&v.apply(l,p)},b),S?(window.clearTimeout(k),k=window.setTimeout(function(){Date.now()-S>=c&&(e.apply(l,p),S=Date.now())},c-(Date.now()-S))):(e.apply(l,p),S=Date.now())}}function Ea(e=[],c,v,b={},x){var k;let S=e.length,n={position:"absolute",top:"0",bottom:"0",right:"0",width:wa+"px",height:"100%",margin:"auto",background:"none",fontFamily:"inherit",cursor:"ns-resize"};b.style&&(n={...n,...b.style});let s=[],l=48,p=(l-2)/2,a=c,h,f,u,d,t,i,o,r,m,g,E;const T=x.getBounds();let w={width:T.width,height:T.height},y=!1,M=!1,I=!1,C=!1,D=0,A=0,H=!1,N,F=!1,L=!1,B=!1;u=He("div",{className:"grid-scrollbar",style:n},d=He("div",{className:"scrollbar-wrapper w-full h-full"},[t=He("div",{className:"grid-scrollbar-inner w-full",style:{top:p+(b.hideButton?0:Rs)+"px",bottom:p+(b.hideButton?0:Rs)+2+"px",cursor:n.cursor},onmouseover:W,onmouseleave:U},[He("div",{className:"w-full h-full",onmousemove:se,onmousedown:P},[i=He("div",{className:"grid-scrollbar-thumb-primary"}),o=He("div",{className:"grid-scrollbar-thumb-secondary",tabIndex:0,style:{top:-(l/2-1)+"px",height:l+"px",cursor:n.cursor},onmouseover:W,onmouseleave:U,onkeydown:j,onclick:Y},He("div",{className:"grid-scrollbar-thumb-secondary-inner"},[m=He("div",{className:"grid-scrollbar-thumb-text"}),He("div",{className:"grid-scrollbar-thumb-line",style:{top:p+"px"}})]))]),r=He("div",{className:"grid-scrollbar-parts"})]),b.hideButton?null:g=He("button",{className:"grid-scrollbar-button grid-scrollbar-button-up disabled",innerHTML:ya}),b.hideButton?null:E=He("button",{className:"grid-scrollbar-button grid-scrollbar-button-down",innerHTML:Sa})])),(k=v.parentElement)==null||k.appendChild(u),O();function O(){v.scrollHeight/v.getBoundingClientRect().height<=1?u.style.display="none":u.style.display="initial"}if(he(),V(),ee(),J(0),oe(0),x.addEventListener("passiveResize",ui($,100),!1),x.addEventListener("resize",ui($,100),!1),b.autoHide){let ie=function(){C=!0,d.classList.add("mouse-over"),d.classList.remove("fade-out"),d.classList.add("fade-in")},pe=function(){C=!1,!M&&!F&&(d.classList.remove("fade-in"),d.classList.add("fade-out"),d.classList.remove("mouse-over"))};d.classList.add("auto-hide"),d.addEventListener("mouseover",ie,!1),d.addEventListener("mouseleave",pe,!1),setTimeout(()=>{v.addEventListener("scroll",R,!1)},50)}b.hideButton||(_e(g,L,()=>{ce()}),_e(E,B,()=>{xe()}));function P(){i.style.visibility="hidden",M=!0,document.addEventListener("mousemove",se,!1),document.addEventListener("mouseup",z,!1)}function z(){i.style.visibility="visible",M=!1,document.removeEventListener("mousemove",se,!1),document.removeEventListener("mouseup",z,!1)}function W(){y=!0}function U(){y=!1}function j(ie){ie.key==="ArrowUp"?ce():ie.key==="ArrowDown"&&xe()}function Y(ie){let pe=ie.y-h.top;te(pe),de()}function R(){F||(setTimeout(()=>{H||(C||(d.classList.remove("fade-out"),d.classList.add("fade-in")),d.classList.add("scrolling"))},1e3),F=!0),N&&clearTimeout(N),N=setTimeout(()=>{d.classList.remove("scrolling"),C||(d.classList.add("fade-out"),d.classList.remove("fade-in"),d.classList.remove("mouse-over")),H=!1,F=!1},2e3)}function $(){const ie=x.getBounds();w.height!==ie.height&&(w={width:ie.width,height:ie.height},he(),V(),ee(),q(!0),de(),O())}function q(ie){const pe=v.scrollTop/(v.scrollHeight-f.height)*h.height;J(pe),(ie||!y)&&oe(pe),de()}function X(ie=0,pe=0){D=ie,A=pe;const me=D/(A-f.height)*h.height;J(me),y||oe(me),de()}function se(ie){ie.stopPropagation();let pe=ie.y-h.top;M?(te(pe),oe(pe)):y&&oe(pe)}function V(){f=v.getBoundingClientRect()}function he(){h=t.getBoundingClientRect()}function ke(ie,pe){e=ie,S=ie.length,a=pe,ee();const me=D/(A-f.height)*h.height;J(me),y||oe(me),O(),de()}function ee(){le(),Z()}function le(){let ie=0,pe=[];function me(ue){const be=pe[ue+1];return be?be.isMileStone?be:me(ue+1):null}for(let ue=0;ue<S;ue++){const be=e[ue];let ct=be.height/a*h.height;pe.push({index:be.index,name:be.name,top:ie,height:ct,isMileStone:be.isMileStone,year:be.year}),ie+=ct}let Le=-20,ne=0;for(let ue=0;ue<S;ue++){const be=pe[ue];if(be.isMileStone)be.top+be.height-ne>=20&&(be.visible=!1,be.displayMileStone=!0,ne=be.top),Le=be.top;else{const ct=me(ue),ot=be.top-Le>=10;ct?ot&&ct.top-be.top>=10&&(be.visible=!0,Le=be.top):ot&&(be.visible=!0,Le=be.top)}}s=pe}function Z(){r.innerHTML="";let ie=s.length;for(let pe=0;pe<ie;pe++){const me=s[pe];(me.visible||me.isMileStone)&&r.appendChild(He("div",{style:{position:"absolute",top:me.top+me.height-Gt+"px",right:"10px",width:Gt+"px",height:Gt+"px",display:"flex",alignItem:"center",justifyContent:"flex-end",boxSizing:"border-box"}},[me.displayMileStone?He("div",{className:"grid-scrollbar-point-text",style:{position:"absolute",top:"-5px",right:"-2px"}},me.year):null,me.visible?He("div",{style:{width:Gt+"px",height:Gt+"px",borderRadius:"100%",background:ba,boxSizing:"border-box"}}):null]))}}function de(){b.hideButton||(D===0?(L=!0,B=!1,g.classList.add("disabled"),E.classList.remove("disabled")):D+f.height===A?(L=!1,B=!0,E.classList.add("disabled"),g.classList.remove("disabled")):(L=!1,B=!1,I||(g.classList.remove("disabled"),E.classList.remove("disabled"))))}function _e(ie,pe=!1,me){if(pe)return;let Le;ie.addEventListener("mousedown",ne,!1);function ne(){I=!0,Le=requestAnimationFrame(be),document.addEventListener("mouseup",ue,!1)}function ue(){cancelAnimationFrame(Le),setTimeout(()=>{cancelAnimationFrame(Le),I=!1,de()},50),document.removeEventListener("mouseup",ue,!1)}function be(){Le=requestAnimationFrame(be),typeof me=="function"&&me()}}function we(ie){m.textContent=ie}function J(ie=0){i.style.transform=`translate3d(0px, ${ie}px, 0px)`}function oe(ie=0){if(ie>=0&&ie<=h.height){o.style.transform=`translate3d(0px, ${ie}px, 0px)`;let pe,me=s.length;for(let Le=0;Le<me;Le++){const ne=s[Le];ie>=ne.top&&ie<ne.top+ne.height&&(pe=ne)}pe&&we(pe.name)}}function te(ie=0){v.scroll({top:ie/h.height*(v.scrollHeight-f.height)})}function xe(){v.scrollTop+=Bs}function ce(){v.scrollTop-=Bs}function Pe(){x.removeEventListener("resize",ui($,100),!1),x.removeEventListener("passiveResize",ui($,100),!1)}function ve(){o.focus()}return{element:u,getContainerInfo:he,update:ke,updateScroll:X,focus:ve,destroy:Pe}}function La(e,c,v,b,x,k,S,n,s){let l=0,p=[],a=[],h=0,f=0,u=b.padding||120,d=[],t=c,i,o,r,m,g=!1,E,T=0,w=0;const y=He("div",{className:"justified-layout w-full"},r=He("div",{tabIndex:-1,className:"grid-scroll-panel w-full h-full scrollable scroll-y"+(b.useNativeScrollbar?" use-native-scrollbar":""),style:{position:"relative"},onkeydown:ee=>{ee.altKey&&ee.key==="s"&&(b.useNativeScrollbar||o.focus())},onscroll:O}));e.appendChild(y),t.length===0?(s instanceof HTMLElement&&(Ns(r),r.appendChild(s)),D()):(r.appendChild(M()),I(),v!==null?(N(),D(),setTimeout(()=>{r.scrollTop=v.scrollTop,T=v.scrollTop,T===0&&Y(d)},10)):C()),b.resizeSmooth?(x.addEventListener("passiveResize",F,!1),x.addEventListener("resize",F,!1)):(x.addEventListener("passiveResize",L,!1),x.addEventListener("resize",L,!1));function M(){return m=He("div",{className:"grid-layout-container",style:{position:"relative",marginBottom:xt+"px"}},i=He("div",{className:"layout"}))}function I(){const ee=r.getBoundingClientRect();f=ee.height;let le=Math.round(ee.width)-u;x.getBounds().width<600&&(le=le-le*.2+u),h=le-le%2,R(h)}function C(){A(),D(),U(),Y(d),z()}function D(){b.useNativeScrollbar||(o=Ea(a,l,r,b.scrollbar,x))}function A(){const ee=[],le=[];let Z=0;for(let de=0;de<t.length;de++){const _e=t[de],we=b.useNavieLayout?Hs(h,_e):Ps(h,_e);le.push({index:_e.index,name:_e.name,top:Z,width:h,height:we.height,loaded:!0,isMileStone:_e.isMileStone,year:_e.year}),ee.push(we),Z+=we.height}p=ee,a=le,l=Z,$(Z)}function H(){typeof n=="function"&&n({layoutHeight:l,scrollTop:T,loadedSections:p,sectionBounds:a,lastSectionInViewport:d})}function N(){l=v.layoutHeight,p=v.loadedSections,a=v.sectionBounds,d=v.lastSectionInViewport,$(l)}function F(){t.length!==0&&(E&&cancelAnimationFrame(E),E=requestAnimationFrame(()=>{B()}))}function L(){t.length!==0&&(E&&clearTimeout(E),E=setTimeout(()=>{B()},50))}function B(){q(),I(),A(),b.useNativeScrollbar||o.update(a,l),U(),Y(d),z()}function O(){g||(requestAnimationFrame(()=>{T=r.scrollTop,w=r.scrollHeight,P(),b.useNativeScrollbar||o.updateScroll(T,w),g=!1,setTimeout(()=>{z()},_a)}),g=!0)}function P(){U(),Y(d)}function z(){H(),W()}function W(){const ee=U(!0),le=ee.map(de=>de.index).toString(),Z=d.map(de=>de.index).toString();le!==Z&&(d=ee,z())}function U(ee){const le=[];let Z=a.length;for(let de=0;de<Z;de++){const _e=a[de];yn(_e.top,_e.height,f,T)&&le.push(_e)}return ee||(d=le),le}function j(ee){let le=i.querySelector(`.grid-section[data-index="${ee.index}"]`);if(le||(le=He("div",{className:"grid-section",sectionIndex:ee.index,"data-index":ee.index,style:{top:ee.top+"px",height:ee.height+"px"}}),i.appendChild(le)),ee.loaded){const Z=p[ee.index],de=ka(ee.top,Z.segmentInfo,f,T),_e=[...le.getElementsByClassName("grid-segment")];for(let we=0;we<_e.length;we++){const J=_e[we];let oe=!1;for(let te=0;te<de.length;te++){const xe=de[te];if(parseInt(J.dataset.index||"")===xe){oe=!0;break}}oe||J.remove()}for(let we=0;we<de.length;we++){const J=de[we],oe=Z.segments[J];if(!le.querySelector(`.grid-segment[data-index="${J}"]`)){const te=He("div",{className:"grid-segment",segmentIndex:J,"data-index":J,style:{top:oe.top+"px",left:oe.left+"px",width:oe.width+"px",height:oe.height+"px"}},S(oe)),xe=oe.items.length;for(let ce=0;ce<xe;ce++){const Pe=oe.items[ce];let ve=k(Pe);te.appendChild(ve)}le.appendChild(te)}}}}function Y(ee=[]){const le=[...i.getElementsByClassName("grid-section")];for(let Z=0;Z<le.length;Z++){const de=le[Z];let _e=!1;for(let we=0;we<ee.length;we++){const J=ee[we];if(parseInt(de.dataset.index||"")===J.index){_e=!0;break}}_e||de.remove()}for(let Z=0;Z<ee.length;Z++){const de=ee[Z];j(de)}}function R(ee=0){m.style.width=ee+"px"}function $(ee=0){i.style.height=ee+"px"}function q(){i.innerHTML=""}function X(){t=[],p=[],a=[],b.useNativeScrollbar||o.update(a,0)}function se(ee){ee.length>0?(Ns(r),r.appendChild(M()),t=ee,B(),b.useNativeScrollbar||(o.getContainerInfo(),o.update(a,l)),r.scrollTop=T):(X(),r.innerHTML="",s instanceof HTMLElement&&r.appendChild(s),$(f-xt),b.useNativeScrollbar||o.update([],0))}function V(ee){const{sectionName:le,sections:Z}=ee;t=Z;const de=a.find(te=>te.name===le);if(!de)return;let _e;b.useNavieLayout?_e=Hs(h,t[de.index]):_e=Ps(h,t[de.index]);let we=de.height-_e.height;a[de.index].height=_e.height,p[de.index]=_e;let J=a.length;for(let te=de.index+1;te<J;te++)a[te].top-=we;l-=we,$(l),U();let oe=d.length;for(let te=0;te<oe;te++){const xe=d[te];let ce=i.querySelector(`.grid-section[data-index="${xe.index}"]`);ce instanceof HTMLElement&&ce.remove()}Y(d),b.useNativeScrollbar||(o.getContainerInfo(),o.update(a,l))}function he(){b.useNativeScrollbar||o.destroy(),b.resizeSmooth?x.removeEventListener("resize",F,!1):x.removeEventListener("resize",L,!1)}function ke(){b.useNativeScrollbar||o.getContainerInfo()}return{element:y,update:se,updateItem:V,recalculateLayout:B,updateScrollbar:ke,destroy:he}}function Ci(e){let c,v,b,x=!1,k=e.options.find(d=>d.value===e.value),S=[];function n(d){k=d,c.textContent=d.text,e.onChange&&e.onChange(d),h(),p()}const s=e.value?e.options.find(d=>d.value===e.value).text:"Select",l=e.options.map(d=>{const t=d.value===e.value,i=_("div",{className:"select-option"+(t?" selected":""),onclick:n.bind(null,d)},[_("div",{className:"select-option-decorator"}),_("div",{className:"select-option-label"},d.text)]);return S.push({id:d.value,element:i}),i});v=_("div",{className:"select-options"},l);function p(){v.classList.remove("show"),x=!1,b.classList.remove("show"),document.removeEventListener("click",a)}function a(d){d.target!==b&&!b.contains(d.target)&&p()}function h(){S.forEach(d=>{d.element.classList.remove("selected"),k&&d.id===k.value&&d.element.classList.add("selected")})}function f(){x=!x,b.classList[x?"add":"remove"]("show"),x&&(h(),document.addEventListener("click",a)),v.classList.toggle("show")}b=_("div",{className:"select"+(e.noBackground?" no-background":"")},[_("div",{className:"select-placeholder flex items-center",onclick:f},[c=_("div",{className:"select-placeholder-text flex-1"},s),_("div",{className:"select-placeholder-icon",innerHTML:Gs})]),v=_("div",{className:"select-options"},l)]);function u(d){const t=e.options.find(i=>i.value===d);t&&n(t)}return{element:b,setValue:u}}const Sn="imgs/apps/photos/",Ta=Sn+"Thumbnails/",Da=e=>{if(G(e)){v(e);return}const c=b=>{const x=window.photoData;let k,S,n,s;S=_("div",{className:"app-photos w-full h-full standard-content"},_("div",{className:"w-full h-full flex flex-col theme-background"},[_("div",{className:"photos-app-toolbar flex items-center"},[_("div",{className:"photos-app-toolbar-col flex-1"},[_("div",{className:"photos-app-toolbar-nav flex items-center"},[_("div",{className:"photos-app-toolbar-nav-item active"},"Collection"),_("div",{className:"photos-app-toolbar-nav-item"},"Albums"),_("div",{className:"photos-app-toolbar-nav-item"},"Folders")])]),_("div",{className:"photos-app-toolbar-col flex-1 flex content-center"},Ti({placeholder:"Search photos or things..."}).element),_("div",{className:"photos-app-toolbar-col photos-app-toolbar-actions flex-1 flex content-end"},[_("div",{className:"photos-app-toolbar-action flex items-center"},[_("div",{className:"photos-app-toolbar-action-icon",innerHTML:Ar(20)}),_("div",{className:"photos-app-toolbar-action-text"},"New")]),_("div",{className:"photos-app-toolbar-action flex items-center"},[_("div",{className:"photos-app-toolbar-action-icon",innerHTML:Br(20)}),_("div",{className:"photos-app-toolbar-action-text"},"Select")]),_("div",{className:"photos-app-toolbar-action flex items-center"},[_("div",{className:"photos-app-toolbar-action-icon",innerHTML:Rr(20)}),_("div",{className:"photos-app-toolbar-action-text"},"Import")])])]),n=_("div",{className:"photos-app-content w-full"})])),b.addEventListener("secondInstance",h=>{b.isVisible()||b.show(),b.focus(),v(h)}),b.addEventListener("dragend",()=>{G(k)&&k.updateScrollbar()}),b.addEventListener("ready",()=>{nt(n,l()),k=La(s,x,null,{},b,p,a,()=>{})}),b.addEventListener("restore",()=>{k.recalculateLayout()}),b.addEventListener("snap",()=>{k.recalculateLayout()});function l(){return _("div",{className:"w-full h-full"},[_("div",{className:"photos-app-grid-header flex items-center w-full"},[_("div",{className:"flex items-center flex-1"},[_("div",{className:"flex-shrink-0",style:{marginRight:"10px"}},"View By"),Ci({value:"datetaken",options:[{text:"Date taken",value:"datetaken"},{text:"Recently added",value:"recentlyadded"}]}).element]),_("div",{className:"flex items-center flex-1"})]),s=_("div",{className:"photos-app-grid w-full"})])}function p(h){const f=window.encodeURI(Ta+h.name),u=window.encodeURI(Sn+h.name);let d={};return h.name&&(d.backgroundImage=`url('${f}')`),_("div",{title:h.name,className:"grid-item",style:{top:h.top+"px",left:h.left+"px",width:h.width+"px",height:h.height+"px"}},[_("div",{className:"grid-item-content w-full h-full",style:d,onclick:()=>{v(u)}})])}function a(h){return _("div",{className:"segment-heading flex items-center"},_("div",{className:"segment-heading-inner flex items-center full-height"},_("div",{title:h.name,className:"segment-heading-text text-ellipsis line-clamp-1"},h.name)))}return S};function v(b){G(b)&&Fe("photoViewer",b)}lt({args:e,icon:Q.photos.icon,hideIcon:!0,name:Q.photos.name,title:Q.photos.productName,top:100,left:100,width:980,height:585,center:!0,fluidContent:!0,singleInstance:!0,transprencyContent:!0,content:c})},ai={system:{icon:"imgs/icons/Desktop.png",iconType:"image",text:"System",items:{display:{icon:"",text:"Display",desc:"Monitors, brightness, nightlight, display profile"},sound:{icon:"",text:"Sound",desc:"Volume levels, ouput, input sound devices"},noitification:{icon:"",text:"Noitification",desc:"Alerts from apps and system"},focusAssist:{icon:"",text:"Focus Assist",desc:"Notifications, automatic rules"},powerAndBatery:{icon:"",text:"Power & batery",desc:"Sleep, batery usage, batery saver"},storage:{icon:"",text:"Storage",desc:"View storage usage on driver"},troubleshoot:{icon:"",text:"Troubleshoot",desc:"Recommended troubleshooters, preferences, history"},recovery:{icon:"",text:"Recovery",desc:"Reset, advanced startup, go back"}}},bluetoothAndDevice:{icon:"imgs/icons/Misc/Bluetooth.png",text:"Bluetooth & Devices"},networkAndInternet:{icon:"imgs/icons/Misc/wifi.png",text:"Network & Intenet"},personalization:{icon:"imgs/icons/Personalization.png",iconType:"image",text:"Personalization",items:{background:{icon:"",text:"Background",desc:"Change desktop background image"},colors:{icon:"",text:"Colors",desc:"Accent color, transparency, dark theme"},lockScreen:{icon:"",text:"Lock Screen",desc:"Background image, notifications"},theme:{icon:"",text:"Themes",desc:"Customize window theme"},font:{icon:"",text:"Fonts",desc:"Browser installed fonts or install new fonts"},start:{icon:"",text:"Start",desc:"Pinned apps, remommended"},taskbar:{icon:"",text:"Taskbar",desc:"Taskbar arrangement, position"}}},apps:{icon:"imgs/icons/Misc/15.png",text:"Apps"},accounts:{icon:"imgs/icons/Users.png",iconType:"image",text:"Accounts"},timeAndLanguage:{icon:"imgs/icons/Misc/Time And Language.png",text:"Time & Language"},gaming:{icon:"imgs/icons/Misc/Gaming.png",text:"Gaming"},accessibility:{icon:"imgs/icons/Help.png",text:"Accessibility"},privacyAndSecurity:{icon:"imgs/icons/Security.png",text:"Privacy & Security"},windowUpdate:{icon:"imgs/icons/Emblems/1401.png",text:"Window Update"}},Os=Object.keys(ai).map((e,c)=>{const v=ai[e];let b=Object.create(null);return b={name:e,icon:v.icon,text:v.text},c===0&&(b.active=!0),b});function Ma(e){return _("label",{className:"button "+(e.className||"")},[_("input",{type:"file",accept:e.accept||"",className:"button "+(e.className||""),style:{display:"none"},onchange:e.onChange}),e.children])}function wt(e){return _("div",{className:"setting-nav-row flex flex-wrap"+(e.hasIcon?" has-icon":"")},[_("div",{className:"setting-nav-row-left flex-1"+(G(e.contentCenter)||G(e.itemsCenter)?" flex":"")+(e.contentCenter?" content-center":"")+(e.itemsCenter?" items-center":"")},e==null?void 0:e.contentLeft),_("div",{className:"setting-nav-row-right flex-shrink-0"},e==null?void 0:e.contentRight)])}function st(e,c){let v=!1,b,x,k;function S(){if(e.isNav){c(e.path);return}v=!v,b.classList[v?"add":"remove"]("expanded"),x.classList[v?"add":"remove"]("show"),k.classList[v?"add":"remove"]("rotate"),x.scrollIntoView()}b=_("div",{className:"setting-nav-item"+(e.isNav?"":" no-hover"),onclick:e.isNav?c.bind(null,e.path):null},[_("div",{className:"setting-nav-item-header flex"},[e.icon?_("div",{className:"setting-nav-item-icon flex items-center content-center flex-shrink-0",innerHTML:e.icon}):null,_("div",{className:"setting-nav-item-info flex-1 flex flex-col content-center"},[_("div",{className:"setting-nav-item-name flex items-center"},e.text),e.desc?_("div",{className:"setting-nav-item-desc flex items-center"},e.desc):null]),e.control?_("div",{className:"setting-nav-item-control flex items-center"},e.control):null,k=_("div",{className:"setting-nav-item-icon setting-nav-item-icon-more flex items-center content-center flex-shrink-0",innerHTML:Ut,onclick:s=>{s.stopPropagation(),S()}})]),e.isNav?null:x=_("div",{className:"setting-nav-item-content"},e.content)]),e.expanded&&S();function n(s){at(x),Dt(x,s)}return{element:b,setContent:n}}function hs(e,c){return _("div",{className:"setting-nav-list"},e.map(v=>st(v,c).element))}function Ia(e,c,v){return _("div",{className:"setting-group"},[_("div",{className:"setting-label"},e),_("div",{className:"setting-items"},hs(c,v))])}function Ba(e){let c,v,b=[];function x(S){e(S)}c=_("div",{className:"settings-recent-images-container"},[_("div",{className:"settings-recent-images-header"},"Recent Images"),v=_("div",{className:"settings-recent-images flex flex-wrap"},k())]);function k(){return Se.getState("recentImages").recentImages.map((n,s)=>{let l=_("div",{key:s,className:"settings-recent-image",onclick:x.bind(null,n)},_("div",{className:"settings-recent-image-inner",style:{myBackgroundImage:n.thumbnailPath}}));return b.push({id:n.path,element:l}),l})}return Ne(ae.backgroundImageChange,"settingRecentImage",()=>{at(v),Dt(v,k())}),c}function xn(e){const{themes:c,themeIndex:v,customTheme:b}=Se.getState(["themes","themeIndex","customTheme"]),k=(v>-1?c[v]:b).backgroundImageStyle,S={};G(e.backgroundImage)&&(S.myBackgroundImage=e.backgroundImage);let n=_("div",{className:"settings-screen-preview",style:S},_("div",{className:"settings-screen-preview-inner"},[_("div",{className:"settings-screen-preview-taskbar"}),_("div",{className:"settings-screen-preview-card"},[_("div",{className:"settings-screen-preview-card-placeholder"},[_("div",{className:"settings-screen-preview-card-placeholder-line"}),_("div",{className:"settings-screen-preview-card-placeholder-line"}),_("div",{className:"settings-screen-preview-card-placeholder-line"}),_("div",{className:"settings-screen-preview-card-placeholder-line half"})]),_("div",{className:"settings-screen-preview-card-button"})])]));Vi(n,k);function s(p){n.style.myBackgroundImage=p}function l(p){Vi(n,p)}return{element:n,changeBackground:s,setBackgroundStyle:l}}function Ra(){const{themeIndex:e,themes:c,customTheme:v}=Se.getState(["themeIndex","themes","customTheme"]),x=(e>-1?c[e]:v).background,k=xn({});let S,n;S=Ci({options:[{id:"solid",text:"Solid Color",value:"solid"},{id:"slideshow",text:"Slideshow",value:"slideshow"},{id:"picture",text:"Picture",value:"picture"}],value:"picture",onChange:u=>{n.setContent(p(u.value))}});function s(u){const t=u.target.files[0];if(!t)return;const i=URL.createObjectURL(t),o=rt.getState("USER_HOME").USER_HOME+"/AppData/Microsoft/Windows/Desktop/Background/",r=o+t.name,m=o+"Thumbnails/"+t.name;fe.writeFile(o+t.name,t,g=>{g||os(i,(E,T)=>{fe.writeFile(m,T,w=>{if(!w){const y={name:t.name,path:r,thumbnailPath:m};$e.setBackgroundImage(y),k.changeBackground(E)}})})})}function l(){const{themeIndex:u,themes:d,customTheme:t}=Se.getState(["themeIndex","themes","customTheme"]),o=(u>-1?d[u]:t).backgroundImageStyle;return[wt({contentLeft:Ba(f)}),wt({contentLeft:"Choose a photo",contentRight:Ma({accept:"image/png, image/jpeg",children:"Choose a photo",onChange:s}),itemsCenter:!0}),wt({contentLeft:"Choose a fit for your desktop image",contentRight:Ci({options:[{id:"fill",text:"Fill",value:"fill"},{id:"fit",text:"Fit",value:"fit"},{id:"stretch",text:"Stretch",value:"stretch"},{id:"center",text:"Center",value:"center"},{id:"tile",text:"Tile",value:"tile"},{id:"span",text:"Span",value:"span"}],value:o.toLowerCase(),onChange:r=>{k.setBackgroundStyle(r.value),$e.setBackgroundStyle(r.value),pt({backgroundImageStyle:r.text})}}).element,itemsCenter:!0})]}function p(u){switch(u){case"solid":return wt({contentLeft:"Solid Color"});case"slideshow":return wt({contentLeft:"Slideshow"});case"picture":return l()}return""}n=st({name:"background",text:"Personalize your Background",icon:"",desc:"A picture background applies to your current desktop. Solid color or slideshow background apply to all your desktops.",path:"background",control:S.element,expanded:!0,content:l()});let a=_("div",{className:"setting-system flex flex-wrap"},[_("div",{className:"w-full background-selector"},[k.element,n.element,Ia("Related Settings",[{name:"contras theme",text:"Contrast Theme",icon:"",desc:"Color themes for low vision light sensitvity",path:"contras theme"}])])]);h(x);function h(u){k.changeBackground(u.thumbnailPath)}function f(u){h(u),$e.setBackgroundImage(u)}return{element:a,dispose:()=>{}}}function Oi(e,c,v){let b,x;function k(l){const p=l.target;typeof v=="function"&&v(p.checked),S(p.checked)}function S(l){n.classList[l?"add":"remove"]("checked"),x.innerHTML=l?br:""}const n=_("div",{className:"checkbox"},_("label",{className:"flex items-center"},[b=_("input",{type:"checkbox",style:{display:"none"},checked:c,onchange:k}),x=_("div",{className:"checkbox-mark flex items-center content-center"}),_("div",{className:"checkbox-label"},e)]));S(c);function s(l){b.checked=l,S(l)}return{element:n,setChecked:s}}function Aa(e){let c,v,b,x=0;function k(p){b=c.getBoundingClientRect(),x=s(p.clientX),l(x),document.addEventListener("mousemove",S,!1),document.addEventListener("mouseup",n,!1),e!=null&&e.onChange&&e.onChange(x),e!=null&&e.onDidChange&&e.onDidChange(x)}function S(p){p.clientX<b.left||p.clientX>b.left+b.width||(x=s(p.clientX),l(x),e!=null&&e.onChange&&e.onChange(x))}function n(){e!=null&&e.onDidChange&&e.onDidChange(x),document.removeEventListener("mousemove",S,!1),document.removeEventListener("mouseup",n,!1)}c=_("div",{className:"hue-picker",style:{position:"relative",width:"360px",height:"30px"},onmousedown:k},v=_("div",{className:"hue-picker-mark"}));function s(p=0){return p-b.left}function l(p=0){v.style.left=p-1+"px"}return{element:c,setValue:l}}function li(e){let c=!1,v;v=_("div",{className:"toggle",onclick:()=>{b(),e.onChange&&e.onChange(c)}},[_("div",{className:"toggle-button"}),_("div",{className:"toggle-indicator"}),e.showLabel?_("div",{className:"toggle-label"},e.label):null]),x(e.checked);function b(){c=!c,v.classList.toggle("checked",c)}function x(k){c=k,v.classList.toggle("checked",c)}return{element:v,get checked(){return c},set checked(k){x(k)}}}const fi="setting-color";function Na(){let{themes:e,themeIndex:c,customTheme:v}=Se.getState(["themes","themeIndex","customTheme"]);const b=c>-1?e[c]:v,{useTitleBarAccentColor:x,useTaskbarAndStartMenuAccentColor:k,useWindowBorderAccentColor:S,accentColor:n,transparency:s,dark:l}=b;let p=li({label:"Dark Theme",checked:l,onChange:i=>{as(i)}}),a=li({label:"Dark Theme",checked:s,onChange:i=>{ls(i)}}),h=Aa({onChange:u,onDidChange:d}),f=_("div",{className:"setting-personalization-colors"},[st({name:"darktheme",text:"Dark Theme",icon:"",desc:"Dark theme for all windows",path:"personalization/colors/darktheme",control:p.element}).element,st({name:"transparency",text:"Transparency",icon:"",desc:"Transparency for all windows",path:"personalization/colors/transparency",control:a.element}).element,st({name:"accentColor",text:"Accent Color",icon:"",desc:"Choose your accent color",path:"personalization/colors/accentColor",expanded:!0,content:wt({contentLeft:_("div",null,h.element)})}).element,st({name:"showAccentColor",text:"Show Accent Color",icon:"",expanded:!0,desc:"Show accent color on the following surfaces",path:"personalization/colors/showAccentColor",content:wt({contentLeft:[_("div",null,Oi("Window Titlebar",x,i=>{zt("use-titlebar-accent-color",i),pt({useTitleBarAccentColor:i})}).element),_("div",null,Oi("Start menu, Taskbar,...",k,i=>{zt("use-startmenu-and-taskbar-accent-color",i),pt({useTaskbarAndStartMenuAccentColor:i})}).element),_("div",null,Oi("Window Borders",S,i=>{zt("use-window-border-accent-color",i),pt({useWindowBorderAccentColor:i})}).element)]})}).element]);h.setValue(n.h);function u(i){dn({h:i,s:b.dark?100:70,l:b.dark?60:50},!1)}function d(i){pt({accentColor:{h:i,s:b.dark?100:70,l:b.dark?60:50}})}Ne(ae.themeChange,fi,i=>{p.checked=i}),Ne(ae.transparentChange,fi,i=>{a.checked=i});function t(){f.remove(),f=null,si(ae.themeChange,fi),si(ae.nightLightChange,fi)}return{element:f,dispose:t}}function Pa(e){const{themes:c,themeIndex:v}=Se.getState(["themes","themeIndex"]);let b=v,x;function k(S,n,s){const{themeIndex:l}=Se.getState(["themeIndex"]);l>-1&&s===b||(b=s,Array.from(x.children).forEach(p=>{p.classList.remove("selected-item")}),S.classList.add("selected-item"),e(n,s))}return Ne(ae.customThemeChange,"quicktheme",()=>{Array.from(x.children).forEach(S=>{S.classList.remove("selected-item")})}),x=_("div",{className:"setting-quick-theme flex",onBeforeRemove(){si(ae.customThemeChange,"quicktheme")}},c.map((S,n)=>_("div",{className:"setting-quick-theme-item"+(n===b?" active selected-item":""),onclick:s=>{k(s.currentTarget,S,n)}},_("div",{className:"setting-quick-theme-item-inner"},[_("div",{className:"setting-quick-theme-item-image",style:{backgroundImage:`url("${S.background.thumbnailPath}")`}}),_("div",{className:"setting-quick-theme-item-color flex items-end content-center",style:{backgroundColor:S.dark?"#333":"#f8f8f8"}},_("div",{className:"setting-quick-theme-item-color-accent",style:{backgroundColor:`hsl(${S.accentColor.h},${S.accentColor.s}%,${S.accentColor.l}%)`}}))])))),x}function Ha(e){let c=ai.personalization.items,v;v=Object.keys(c).map(d=>{const t=c[d];return{isNav:!0,name:d,text:t.text,icon:t.icon,desc:t.desc,path:"personalization/"+d}});const{roundedCorner:b,useBorder:x,themes:k,themeIndex:S,customTheme:n}=Se.getState(["roundedCorner","useBorder","backgroundImage","themes","themeIndex","customTheme"]),s=S>-1?k[S]:n;Ki(b);const l={isNav:!1,name:"roundedCorner",icon:"",text:"Rounded Corner",desc:"Atjust window and controls corner radius",path:"personalization/roundedCorner",control:li({label:"Rounded Corner",checked:b,onChange:d=>{Ki(d),Se.setState({roundedCorner:d})}}).element},p={isNav:!1,name:"useBorder",icon:"",text:"Window Border",desc:"Show window border",path:"personalization/useBorder",control:li({checked:x,onChange:d=>{hn(d),Se.setState({useBorder:d})}}).element},a=xn({});function h(d,t,i=!0){fn(d),u(d.background),i&&Se.setState({themeIndex:t})}let f=_("div",{className:"setting-personalization"},[_("div",{className:"w-full flex flex-wrap"},[_("div",{style:{marginTop:"28px",marginRight:"40px"}},a.element),_("div",{className:"flex-1"},[_("div",{style:{height:"26px",fontWeight:"bold",fontSize:"14px"}},"Select a theme to apply"),Pa(h)])]),hs(v,e),st(l,e).element,st(p,e).element]);u(s.background);function u(d){a.changeBackground(d.thumbnailPath)}return{element:f,dispose:()=>{}}}function Cn(e){return e?_("div",{className:"setting-help flex-shrink-0"},[e.relates&&_("div",{className:"setting-system-help-items"},e.relates.map(c=>{var v;return _("div",{className:"setting-system-help-item",onclick:(v=c.onClick)==null?void 0:v.bind(null,c.name)},[_("div",{className:"setting-system-help-item-label"},c.text),_("div",{className:"setting-system-help-item-content"},c.desc)])})),e.actions&&_("div",{className:"setting-system-help-actions"},[_("div",{className:"setting-system-help-item-label"},"Have a question?"),_("div",{className:"setting-system-help-actions-list"},e.actions.map(c=>{var v;return _("div",{onclick:(v=c.onClick)==null?void 0:v.bind(null,c.name),className:"setting-system-help-item-link"},c.text)}))])]):null}function Oa(){const e=()=>"settings/system/",{nightlight:c}=Se.getState("nightlight"),v=li({checked:c,onChange:()=>{ri.toogleNightLight()}});Ne(ae.nightLightChange,"settings-display-nightlight",s=>{v.checked=s});const b=[{path:"",text:"Night light",desc:"Use warmer colors to help block blue light",icon:"",name:"nightlight",control:v.element,content:wt({itemsCenter:!0,contentLeft:"Atjust the color of the screen to help block blue light"})},{path:"",text:"HDR",desc:"More about HDR",icon:"",name:"nightlight"}],x=st(b[0]),k=st(b[1]);let S=_("div",{className:"setting-system-display flex flex-wrap",onBeforeRemove(){si(ae.nightLightChange,"settings-display-nightlight")}},[_("div",{className:"flex-1"},_("div",{className:"setting-system-main-content"},[x.element,k.element])),Cn({relates:[{name:e()+"nightlight",text:"Sleep better",desc:"Nightlight can help you get to sleep by displaying warmer colors at night. Select Night light settings to set things up."}],actions:[{name:"",text:"Changing screen brightness",desc:""},{name:"",text:"Adjusting font size",desc:""}]})]);function n(){S.remove(),S=null}return{element:S,dispose:n}}function Fa(e){return _("button",{className:"button "+(e.className||""),onclick:e.onclick},e.children)}function za(){let e=_("div",{className:"setting-recovery"},[_("div",{},"If you're having problems with your PC or want to reset it, these recovery options might help"),_("div",{},[st({path:"",text:"Reset this PC",desc:"Choose or keep your personal files, then reinstall Windows",icon:"",name:"recovery",control:Fa({children:"Reset PC",onclick(){jo()}})}).element])]);function c(){e=null}return{element:e,dispose:c}}function Wa(){const{themes:e,themeIndex:c,customTheme:v}=Se.getState(["themes","themeIndex","customTheme"]),x=(c>-1?e[c]:v).background;let k;const{USER_NAME:S}=rt.getState("USER_NAME");let n=_("div",{className:"setting-system-overall",onBeforeRemove(){si(ae.backgroundImageChange,"setting-system")}},[_("div",{className:"flex"},[_("div",{className:"setting-system-desktop relative"},k=_("div",{className:"setting-system-desktop-inner image-cover"})),_("div",{className:"setting-system-info"},[_("div",{className:"setting-system-info-name"},`${S}`),_("div",{className:"setting-system-info-role"},"Administrator"),_("div",{className:"setting-system-info-action"},"Rename")])]),_("div",{className:"setting-system-office flex"},[_("div",{className:"setting-system-office-onedrive flex"},[_("div",{className:"setting-system-office-onedrive-icon flex items-center content-center"}),_("div",{className:"setting-system-office-onedrive-info"},[_("div",{className:"setting-system-office-onedrive-info-name"},"OneDrive"),_("div",{className:"setting-system-office-onedrive-info-action"},"Manage")])])])]);x&&s(x.path),Ne(ae.backgroundImageChange,"setting-system",l=>{s(l.path)});function s(l){k.style.myBackgroundImage=l}return n}function $a(e){let c=ai.system.items,v;v=Object.keys(c).map(k=>{const S=c[k];return{isNav:!0,name:k,text:S.text,icon:S.icon,iconType:S.iconType,desc:S.desc,path:"system/"+k}});let b=_("div",{className:"setting-system flex flex-wrap"},[_("div",{className:"flex-1"},_("div",{className:"setting-system-main-content"},[Wa(),hs(v,e)])),Cn()]);function x(){b.remove(),b=null}return{element:b,dispose:x}}function Oe(){let e=_("div",{},"In progress");function c(){e.remove(),e=null}return{element:e,dispose:c}}const Ua={system:{content:$a,children:{display:{content:Oa},sound:{content:Oe},noitification:{content:Oe},focusAssist:{content:Oe},powerAndBatery:{content:Oe},storage:{content:Oe},troubleshoot:{content:Oe},recovery:{content:za}}},bluetoothAndDevice:{content:Oe},networkAndInternet:{content:Oe},personalization:{content:Ha,children:{background:{content:Ra},colors:{content:Na},lockScreen:{content:Oe},theme:{content:Oe},font:{content:Oe},start:{content:Oe},taskbar:{content:Oe}}},apps:{content:Oe},accounts:{content:Oe},timeAndLanguage:{content:Oe},gaming:{content:Oe},accessibility:{content:Oe},privacyAndSecurity:{content:Oe},windowUpdate:{content:Oe}};function ja(e,c,v){let b=_("div",{className:"setting-sidebar-nav-item flex items-center"+(e.active?" active":""),onclick:()=>v(e,b,c)},[_("div",{className:"setting-sidebar-nav-item-icon flex-shrink-0",style:{backgroundImage:`url("${e.icon}")`}}),_("div",{className:"setting-sidebar-nav-item-text"},e.text)]);return b}function Va(e){const c=Os.map((s,l)=>ja(s,l,S));let v=0,b=c[0];b.classList.add("active");let x=Ti({placeholder:"Find a Setting"}),k=_("div",{className:"setting-sidebar h-full flex-shrink-0"},_("div",{className:"setting-sidebar-inner standard-content w-full h-full"},_("div",{className:"w-full h-full flex flex-col"},[_("div",{className:"setting-sidebar-heading"},x.element),_("div",{tabIndex:0,className:"setting-sidebar-nav scrollable scroll-y"},c)])));function S(s,l,p){p!==v&&(b.classList.remove("active"),l.classList.add("active"),v=p,b=l,e(s.name))}function n(s){const l=s.split("/")[0];if(l){const p=Os.findIndex(a=>a.name===l);if(p>-1){b.classList.remove("active");let a=c[p];v=p,a.classList.add("active"),b=a}}}return{element:k,setRoute:n}}function Ka(e){let c;const v=_("div",{className:"setting-content-heading flex-shrink-0 flex items-center"},c=_("div",{className:"setting-content-heading-item"},"System"));function b(x){const k=_("div",{className:"w-full flex items-center"},x.map((S,n)=>{let s=_("div",{className:"setting-content-heading-route flex items-center"+(n===x.length-1&&n>0?" disabled":""),onclick:x.length-1?e.bind(null,S.path):null},S.text);return n>0&&s.prepend(_("div",{className:"setting-content-heading-route-divider flex-center",innerHTML:Ut})),s}));c.innerHTML="",c.appendChild(k)}return{element:v,setRoute:b}}function qa(e){let c;const v=Ka(e);let b,x=_("div",{className:"setting-content w-full h-full"},_("div",{className:"setting-content-inner standard-content w-full h-full flex flex-col"},[v.element,b=_("div",{tabIndex:0,className:"setting-content-main scrollable scroll-y"})]));function k(S){const n=S.split("/"),s=n.length;if(s===0)return;let l=Ua[n[0]];if(!l)return;c&&c.dispose();let p;s===1?p=l.content(e):s===2&&(p=l.children[n[1]].content(e)),c=p;const a=n.reduce((h,f,u)=>(h.path+=f,h.currentSetting=u===0?ai[f]:h.currentSetting.items[f],h.routes.push({text:h.currentSetting.text,path:h.path}),u<s-1&&(h.path+="/"),h),{routes:[],path:"",currentSetting:Object.create(null)});v.setRoute(a.routes),at(b),b.scrollTop=0,b.appendChild(p.element)}return{element:x,update:k}}const Xa=e=>{const c=function(b){let x=Va(n),k=qa(n);function S(s){x.setRoute(s),k.update(s)}e?S(e):k.update("system"),b.addEventListener("secondInstance",s=>{b.isVisible()||b.show(),b.focus(),s&&S(s)});function n(s){k.update(s)}return _("div",{className:"app-settings w-full h-full"},_("div",{className:"setting-inner flex w-full h-full"},[x.element,k.element]))},v=_("div",{className:"w-full h-full flex items-center"},[_("div",{["drag-region"]:"drag",className:"flex-1 h-full"}),_("div",{className:"setting-user-info-avatar",style:{padding:"6px"}},_("div",{className:"setting-user-info-avatar-image w-full h-full",style:{marginLeft:"auto",backgroundImage:`url("${ur}")`,backgroundSize:"cover"}}))]);lt({args:e,icon:Q.settings.icon,name:Q.settings.name,title:Q.settings.productName,singleInstance:!0,titlebarHeight:36,titlebarContent:v,top:200,left:300,minWidth:700,minHeight:400,width:1e3,height:540,center:!0,fluidContent:!0,transprencyContent:!0,content:c})};function Ga(e){const x=ts("calculator",{top:50,left:Ce.width-380-50});let{top:k,left:S}=x.getState();k>Ce.height-We-Mt&&(k=50),S>Ce.width-380-50&&(S=Ce.width-380-50);let n,s;const l=Ci({options:[{id:"standard",value:"standard",text:"Standard"},{id:"scientific",value:"scientific",text:"Scientific"},{id:"programmer",value:"programmer",text:"Programmer"}],value:"standard",noBackground:!0,onChange(d){p(d.value),n.setContent(s)}});n=lt({icon:Q.calculator.icon,name:Q.calculator.name,title:Q.calculator.productName,titlebarHeight:36,titlebarContent:l.element,top:k,left:S,width:380,height:500,disableResize:!0,disableMaximize:!0,transprencyContent:!0}),n.addEventListener("dragend",d=>{x.setState({top:d.top,left:d.left})}),n.addEventListener("focus",()=>{s.focus()}),p("standard"),n.setContent(s);function p(d){switch(d){case"standard":s=h();break;case"scientific":s=f();break;case"programmer":s=u();break;default:s=h();break}}function a(d,t){const i={};return d.type==="command"&&d.value==="="&&(i.color="var(--accent-color)"),_("div",{className:"calculator-button flex flex-1 items-center content-center"+(d.type==="number"?" emphasis":""),onclick:t.bind(null,d.type,d.value),innerHTML:d.content,style:i})}function h(){let d,t,i,o="",r="",m="",g=48;function E(){let N;const F=parseFloat(o);let L=parseFloat(r);if(!(isNaN(F)||isNaN(L))){switch(m){case"+":N=F+L;break;case"-":N=F-L;break;case"x":N=F*L;break;case"/":N=F/L;break}r=N.toString(),m=null,o=""}}function T(){o="",m="",w()}function w(){r="0",t.style.removeProperty("font-size")}function y(N){const F=N.toString(),L=parseFloat(F.split(".")[0]),B=F.split(".")[1];let O;return isNaN(L)?O="":O=L.toLocaleString("en",{maximumFractionDigits:0}),B!=null?`${O}.${B}`:O}function M(N){N==="."&&r.includes(".")||(r=r.toString()+N.toString())}function I(N){r!==""&&(o!==""&&E(),m=N,o=r,r="")}function C(N){t.scrollWidth>t.offsetWidth&&(N-=2,t.style.fontSize=N+"px",C(N))}function D(){d.textContent=y(parseFloat(r)),C(g),G(m)?i.textContent=`${y(parseFloat(o))} ${m}`:i.textContent=""}function A(N,F){if(N==="number")M(F),D();else if(N==="operator")I(F),D();else if(N==="command"){switch(F){case"c":T();break;case"ce":w();break;case"=":E();break;case"sqrt":r=Math.sqrt(parseFloat(r)).toString();break;case"negative":r=(parseFloat(r)*-1).toString();break}D()}}function H(N){let F=/[0-9]/g,L=/[+\-*\/]/g;N.key.match(F)&&(N.preventDefault(),M(N.key),D()),N.key==="."&&(N.preventDefault(),M(N.key),D()),N.key.match(L)&&(N.preventDefault(),I(N.key),D()),(N.key==="Enter"||N.key==="=")&&(N.preventDefault(),E(),D()),N.key==="Backspace"&&(N.preventDefault(),w(),D()),N.key==="Delete"&&(N.preventDefault(),T(),D())}return _("div",{tabIndex:-1,className:"w-full h-full flex flex-col",onkeydown:H},[_("div",{className:"w-full calculator-display flex flex-col"},[i=_("div",{className:"calculator-display-input flex items-center content-end"}),t=_("div",{className:"calculator-display-result flex-1 flex items-center content-end no-scrollbar"},d=_("div",{className:"w-full"},"0"))]),_("div",{className:"w-full h-full calculator-buttons flex flex-col"},[_("div",{className:"w-full calculator-buttons-row flex flex-1"},[a({type:"command",value:"sqrt",content:'<svg class="svg-icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M277.7 843.7h-35.6L93.6 483.2h-76V445h105.6l132.6 330.4 159.6-635.1h37.8L277.7 843.7zM831.6 773.7L697.7 578.8 563.4 773.7h-45.1l155.4-223.6-148.1-212.5h46.8l125.3 183.7 124.9-183.7h47.2L722.2 549.2l157.1 224.4h-47.7z"  /><path d="M984.5 176h-568v-37.1h568V176z"  /></svg>'},A),a({type:"command",value:"ce",content:"CE"},A),a({type:"command",value:"c",content:"C"},A),a({type:"operator",value:"/",content:"/"},A)]),_("div",{className:"w-full calculator-buttons-row flex flex-1"},[a({type:"number",value:"7",content:"7"},A),a({type:"number",value:"8",content:"8"},A),a({type:"number",value:"9",content:"9"},A),a({type:"operator",value:"x",content:"&#215;"},A)]),_("div",{className:"w-full calculator-buttons-row flex flex-1"},[a({type:"number",value:"4",content:"4"},A),a({type:"number",value:"5",content:"5"},A),a({type:"number",value:"6",content:"6"},A),a({type:"operator",value:"-",content:"&#8722;"},A)]),_("div",{className:"w-full calculator-buttons-row flex flex-1"},[a({type:"number",value:"1",content:"1"},A),a({type:"number",value:"2",content:"2"},A),a({type:"number",value:"3",content:"3"},A),a({type:"operator",value:"+",content:"+"},A)]),_("div",{className:"w-full calculator-buttons-row flex flex-1"},[a({type:"command",value:"negative",content:"+/-"},A),a({type:"number",value:"0",content:"0"},A),a({type:"number",value:".",content:"."},A),a({type:"command",value:"=",content:"="},A)])])])}function f(){return _("div",{className:"w-full h-full flex content-center items-center"},_("h1",{},"Scientific Calculator"))}function u(){return _("div",{className:"w-full h-full flex content-center items-center"},_("h1",{},"Programmer Calculator"))}}var Yi={},Ya={get exports(){return Yi},set exports(e){Yi=e}};(function(e,c){(function(v,b){e.exports=b()})(self,()=>(()=>{var v={4567:function(S,n,s){var l=this&&this.__decorate||function(r,m,g,E){var T,w=arguments.length,y=w<3?m:E===null?E=Object.getOwnPropertyDescriptor(m,g):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(r,m,g,E);else for(var M=r.length-1;M>=0;M--)(T=r[M])&&(y=(w<3?T(y):w>3?T(m,g,y):T(m,g))||y);return w>3&&y&&Object.defineProperty(m,g,y),y},p=this&&this.__param||function(r,m){return function(g,E){m(g,E,r)}};Object.defineProperty(n,"__esModule",{value:!0}),n.AccessibilityManager=void 0;const a=s(9042),h=s(6114),f=s(9924),u=s(844),d=s(5596),t=s(4725),i=s(3656);let o=n.AccessibilityManager=class extends u.Disposable{constructor(r,m){super(),this._terminal=r,this._renderService=m,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let g=0;g<this._terminal.rows;g++)this._rowElements[g]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[g]);if(this._topBoundaryFocusListener=g=>this._handleBoundaryFocus(g,0),this._bottomBoundaryFocusListener=g=>this._handleBoundaryFocus(g,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new f.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(g=>this._handleResize(g.rows))),this.register(this._terminal.onRender(g=>this._refreshRows(g.start,g.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(g=>this._handleChar(g))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(g=>this._handleTab(g))),this.register(this._terminal.onKey(g=>this._handleKey(g.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new d.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,i.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,u.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(r){for(let m=0;m<r;m++)this._handleChar(" ")}_handleChar(r){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==r&&(this._charsToAnnounce+=r):this._charsToAnnounce+=r,r===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=a.tooMuchOutput)),h.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,h.isMac&&this._liveRegion.remove()}_handleKey(r){this._clearLiveRegion(),/\p{Control}/u.test(r)||this._charsToConsume.push(r)}_refreshRows(r,m){this._liveRegionDebouncer.refresh(r,m,this._terminal.rows)}_renderRows(r,m){const g=this._terminal.buffer,E=g.lines.length.toString();for(let T=r;T<=m;T++){const w=g.translateBufferLineToString(g.ydisp+T,!0),y=(g.ydisp+T+1).toString(),M=this._rowElements[T];M&&(w.length===0?M.innerText=" ":M.textContent=w,M.setAttribute("aria-posinset",y),M.setAttribute("aria-setsize",E))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(r,m){const g=r.target,E=this._rowElements[m===0?1:this._rowElements.length-2];if(g.getAttribute("aria-posinset")===(m===0?"1":`${this._terminal.buffer.lines.length}`)||r.relatedTarget!==E)return;let T,w;if(m===0?(T=g,w=this._rowElements.pop(),this._rowContainer.removeChild(w)):(T=this._rowElements.shift(),w=g,this._rowContainer.removeChild(T)),T.removeEventListener("focus",this._topBoundaryFocusListener),w.removeEventListener("focus",this._bottomBoundaryFocusListener),m===0){const y=this._createAccessibilityTreeNode();this._rowElements.unshift(y),this._rowContainer.insertAdjacentElement("afterbegin",y)}else{const y=this._createAccessibilityTreeNode();this._rowElements.push(y),this._rowContainer.appendChild(y)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(m===0?-1:1),this._rowElements[m===0?1:this._rowElements.length-2].focus(),r.preventDefault(),r.stopImmediatePropagation()}_handleResize(r){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let m=this._rowContainer.children.length;m<this._terminal.rows;m++)this._rowElements[m]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[m]);for(;this._rowElements.length>r;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const r=document.createElement("div");return r.setAttribute("role","listitem"),r.tabIndex=-1,this._refreshRowDimensions(r),r}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let r=0;r<this._terminal.rows;r++)this._refreshRowDimensions(this._rowElements[r])}}_refreshRowDimensions(r){r.style.height=`${this._renderService.dimensions.css.cell.height}px`}};n.AccessibilityManager=o=l([p(1,t.IRenderService)],o)},3614:(S,n)=>{function s(h){return h.replace(/\r?\n/g,"\r")}function l(h,f){return f?"\x1B[200~"+h+"\x1B[201~":h}function p(h,f,u,d){h=l(h=s(h),u.decPrivateModes.bracketedPasteMode&&d.rawOptions.ignoreBracketedPasteMode!==!0),u.triggerDataEvent(h,!0),f.value=""}function a(h,f,u){const d=u.getBoundingClientRect(),t=h.clientX-d.left-10,i=h.clientY-d.top-10;f.style.width="20px",f.style.height="20px",f.style.left=`${t}px`,f.style.top=`${i}px`,f.style.zIndex="1000",f.focus()}Object.defineProperty(n,"__esModule",{value:!0}),n.rightClickHandler=n.moveTextAreaUnderMouseCursor=n.paste=n.handlePasteEvent=n.copyHandler=n.bracketTextForPaste=n.prepareTextForTerminal=void 0,n.prepareTextForTerminal=s,n.bracketTextForPaste=l,n.copyHandler=function(h,f){h.clipboardData&&h.clipboardData.setData("text/plain",f.selectionText),h.preventDefault()},n.handlePasteEvent=function(h,f,u,d){h.stopPropagation(),h.clipboardData&&p(h.clipboardData.getData("text/plain"),f,u,d)},n.paste=p,n.moveTextAreaUnderMouseCursor=a,n.rightClickHandler=function(h,f,u,d,t){a(h,f,u),t&&d.rightClickSelect(h),f.value=d.selectionText,f.select()}},7239:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorContrastCache=void 0;const l=s(1505);n.ColorContrastCache=class{constructor(){this._color=new l.TwoKeyMap,this._css=new l.TwoKeyMap}setCss(p,a,h){this._css.set(p,a,h)}getCss(p,a){return this._css.get(p,a)}setColor(p,a,h){this._color.set(p,a,h)}getColor(p,a){return this._color.get(p,a)}clear(){this._color.clear(),this._css.clear()}}},3656:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.addDisposableDomListener=void 0,n.addDisposableDomListener=function(s,l,p,a){s.addEventListener(l,p,a);let h=!1;return{dispose:()=>{h||(h=!0,s.removeEventListener(l,p,a))}}}},6465:function(S,n,s){var l=this&&this.__decorate||function(t,i,o,r){var m,g=arguments.length,E=g<3?i:r===null?r=Object.getOwnPropertyDescriptor(i,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(t,i,o,r);else for(var T=t.length-1;T>=0;T--)(m=t[T])&&(E=(g<3?m(E):g>3?m(i,o,E):m(i,o))||E);return g>3&&E&&Object.defineProperty(i,o,E),E},p=this&&this.__param||function(t,i){return function(o,r){i(o,r,t)}};Object.defineProperty(n,"__esModule",{value:!0}),n.Linkifier2=void 0;const a=s(3656),h=s(8460),f=s(844),u=s(2585);let d=n.Linkifier2=class extends f.Disposable{get currentLink(){return this._currentLink}constructor(t){super(),this._bufferService=t,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new h.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new h.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,f.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,f.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}registerLinkProvider(t){return this._linkProviders.push(t),{dispose:()=>{const i=this._linkProviders.indexOf(t);i!==-1&&this._linkProviders.splice(i,1)}}}attachToDom(t,i,o){this._element=t,this._mouseService=i,this._renderService=o,this.register((0,a.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,a.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,a.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,a.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(t){if(this._lastMouseEvent=t,!this._element||!this._mouseService)return;const i=this._positionFromMouseEvent(t,this._element,this._mouseService);if(!i)return;this._isMouseOut=!1;const o=t.composedPath();for(let r=0;r<o.length;r++){const m=o[r];if(m.classList.contains("xterm"))break;if(m.classList.contains("xterm-hover"))return}this._lastBufferCell&&i.x===this._lastBufferCell.x&&i.y===this._lastBufferCell.y||(this._handleHover(i),this._lastBufferCell=i)}_handleHover(t){if(this._activeLine!==t.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(t,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,t)||(this._clearCurrentLink(),this._askForLink(t,!0))}_askForLink(t,i){var o,r;this._activeProviderReplies&&i||((o=this._activeProviderReplies)===null||o===void 0||o.forEach(g=>{g==null||g.forEach(E=>{E.link.dispose&&E.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=t.y);let m=!1;for(const[g,E]of this._linkProviders.entries())i?!((r=this._activeProviderReplies)===null||r===void 0)&&r.get(g)&&(m=this._checkLinkProviderResult(g,t,m)):E.provideLinks(t.y,T=>{var w,y;if(this._isMouseOut)return;const M=T==null?void 0:T.map(I=>({link:I}));(w=this._activeProviderReplies)===null||w===void 0||w.set(g,M),m=this._checkLinkProviderResult(g,t,m),((y=this._activeProviderReplies)===null||y===void 0?void 0:y.size)===this._linkProviders.length&&this._removeIntersectingLinks(t.y,this._activeProviderReplies)})}_removeIntersectingLinks(t,i){const o=new Set;for(let r=0;r<i.size;r++){const m=i.get(r);if(m)for(let g=0;g<m.length;g++){const E=m[g],T=E.link.range.start.y<t?0:E.link.range.start.x,w=E.link.range.end.y>t?this._bufferService.cols:E.link.range.end.x;for(let y=T;y<=w;y++){if(o.has(y)){m.splice(g--,1);break}o.add(y)}}}}_checkLinkProviderResult(t,i,o){var r;if(!this._activeProviderReplies)return o;const m=this._activeProviderReplies.get(t);let g=!1;for(let E=0;E<t;E++)this._activeProviderReplies.has(E)&&!this._activeProviderReplies.get(E)||(g=!0);if(!g&&m){const E=m.find(T=>this._linkAtPosition(T.link,i));E&&(o=!0,this._handleNewLink(E))}if(this._activeProviderReplies.size===this._linkProviders.length&&!o)for(let E=0;E<this._activeProviderReplies.size;E++){const T=(r=this._activeProviderReplies.get(E))===null||r===void 0?void 0:r.find(w=>this._linkAtPosition(w.link,i));if(T){o=!0,this._handleNewLink(T);break}}return o}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(t){if(!this._element||!this._mouseService||!this._currentLink)return;const i=this._positionFromMouseEvent(t,this._element,this._mouseService);i&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,i)&&this._currentLink.link.activate(t,this._currentLink.link.text)}_clearCurrentLink(t,i){this._element&&this._currentLink&&this._lastMouseEvent&&(!t||!i||this._currentLink.link.range.start.y>=t&&this._currentLink.link.range.end.y<=i)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,f.disposeArray)(this._linkCacheDisposables))}_handleNewLink(t){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const i=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);i&&this._linkAtPosition(t.link,i)&&(this._currentLink=t,this._currentLink.state={decorations:{underline:t.link.decorations===void 0||t.link.decorations.underline,pointerCursor:t.link.decorations===void 0||t.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,t.link,this._lastMouseEvent),t.link.decorations={},Object.defineProperties(t.link.decorations,{pointerCursor:{get:()=>{var o,r;return(r=(o=this._currentLink)===null||o===void 0?void 0:o.state)===null||r===void 0?void 0:r.decorations.pointerCursor},set:o=>{var r,m;!((r=this._currentLink)===null||r===void 0)&&r.state&&this._currentLink.state.decorations.pointerCursor!==o&&(this._currentLink.state.decorations.pointerCursor=o,this._currentLink.state.isHovered&&((m=this._element)===null||m===void 0||m.classList.toggle("xterm-cursor-pointer",o)))}},underline:{get:()=>{var o,r;return(r=(o=this._currentLink)===null||o===void 0?void 0:o.state)===null||r===void 0?void 0:r.decorations.underline},set:o=>{var r,m,g;!((r=this._currentLink)===null||r===void 0)&&r.state&&((g=(m=this._currentLink)===null||m===void 0?void 0:m.state)===null||g===void 0?void 0:g.decorations.underline)!==o&&(this._currentLink.state.decorations.underline=o,this._currentLink.state.isHovered&&this._fireUnderlineEvent(t.link,o))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(o=>{if(!this._currentLink)return;const r=o.start===0?0:o.start+1+this._bufferService.buffer.ydisp,m=this._bufferService.buffer.ydisp+1+o.end;if(this._currentLink.link.range.start.y>=r&&this._currentLink.link.range.end.y<=m&&(this._clearCurrentLink(r,m),this._lastMouseEvent&&this._element)){const g=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);g&&this._askForLink(g,!1)}})))}_linkHover(t,i,o){var r;!((r=this._currentLink)===null||r===void 0)&&r.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(i,!0),this._currentLink.state.decorations.pointerCursor&&t.classList.add("xterm-cursor-pointer")),i.hover&&i.hover(o,i.text)}_fireUnderlineEvent(t,i){const o=t.range,r=this._bufferService.buffer.ydisp,m=this._createLinkUnderlineEvent(o.start.x-1,o.start.y-r-1,o.end.x,o.end.y-r-1,void 0);(i?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(m)}_linkLeave(t,i,o){var r;!((r=this._currentLink)===null||r===void 0)&&r.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(i,!1),this._currentLink.state.decorations.pointerCursor&&t.classList.remove("xterm-cursor-pointer")),i.leave&&i.leave(o,i.text)}_linkAtPosition(t,i){const o=t.range.start.y*this._bufferService.cols+t.range.start.x,r=t.range.end.y*this._bufferService.cols+t.range.end.x,m=i.y*this._bufferService.cols+i.x;return o<=m&&m<=r}_positionFromMouseEvent(t,i,o){const r=o.getCoords(t,i,this._bufferService.cols,this._bufferService.rows);if(r)return{x:r[0],y:r[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(t,i,o,r,m){return{x1:t,y1:i,x2:o,y2:r,cols:this._bufferService.cols,fg:m}}};n.Linkifier2=d=l([p(0,u.IBufferService)],d)},9042:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.tooMuchOutput=n.promptLabel=void 0,n.promptLabel="Terminal input",n.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(S,n,s){var l=this&&this.__decorate||function(d,t,i,o){var r,m=arguments.length,g=m<3?t:o===null?o=Object.getOwnPropertyDescriptor(t,i):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(d,t,i,o);else for(var E=d.length-1;E>=0;E--)(r=d[E])&&(g=(m<3?r(g):m>3?r(t,i,g):r(t,i))||g);return m>3&&g&&Object.defineProperty(t,i,g),g},p=this&&this.__param||function(d,t){return function(i,o){t(i,o,d)}};Object.defineProperty(n,"__esModule",{value:!0}),n.OscLinkProvider=void 0;const a=s(511),h=s(2585);let f=n.OscLinkProvider=class{constructor(d,t,i){this._bufferService=d,this._optionsService=t,this._oscLinkService=i}provideLinks(d,t){var i;const o=this._bufferService.buffer.lines.get(d-1);if(!o)return void t(void 0);const r=[],m=this._optionsService.rawOptions.linkHandler,g=new a.CellData,E=o.getTrimmedLength();let T=-1,w=-1,y=!1;for(let M=0;M<E;M++)if(w!==-1||o.hasContent(M)){if(o.loadCell(M,g),g.hasExtendedAttrs()&&g.extended.urlId){if(w===-1){w=M,T=g.extended.urlId;continue}y=g.extended.urlId!==T}else w!==-1&&(y=!0);if(y||w!==-1&&M===E-1){const I=(i=this._oscLinkService.getLinkData(T))===null||i===void 0?void 0:i.uri;if(I){const C={start:{x:w+1,y:d},end:{x:M+(y||M!==E-1?0:1),y:d}};let D=!1;if(!(m!=null&&m.allowNonHttpProtocols))try{const A=new URL(I);["http:","https:"].includes(A.protocol)||(D=!0)}catch{D=!0}D||r.push({text:I,range:C,activate:(A,H)=>m?m.activate(A,H,C):u(0,H),hover:(A,H)=>{var N;return(N=m==null?void 0:m.hover)===null||N===void 0?void 0:N.call(m,A,H,C)},leave:(A,H)=>{var N;return(N=m==null?void 0:m.leave)===null||N===void 0?void 0:N.call(m,A,H,C)}})}y=!1,g.hasExtendedAttrs()&&g.extended.urlId?(w=M,T=g.extended.urlId):(w=-1,T=-1)}}t(r)}};function u(d,t){if(confirm(`Do you want to navigate to ${t}?

WARNING: This link could potentially be dangerous`)){const i=window.open();if(i){try{i.opener=null}catch{}i.location.href=t}else console.warn("Opening link blocked as opener could not be cleared")}}n.OscLinkProvider=f=l([p(0,h.IBufferService),p(1,h.IOptionsService),p(2,h.IOscLinkService)],f)},6193:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.RenderDebouncer=void 0,n.RenderDebouncer=class{constructor(s,l){this._parentWindow=s,this._renderCallback=l,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(s){return this._refreshCallbacks.push(s),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(s,l,p){this._rowCount=p,s=s!==void 0?s:0,l=l!==void 0?l:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,s):s,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,l):l,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const s=Math.max(this._rowStart,0),l=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(s,l),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const s of this._refreshCallbacks)s(0);this._refreshCallbacks=[]}}},5596:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ScreenDprMonitor=void 0;const l=s(844);class p extends l.Disposable{constructor(h){super(),this._parentWindow=h,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,l.toDisposable)(()=>{this.clearListener()}))}setListener(h){this._listener&&this.clearListener(),this._listener=h,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var h;this._outerListener&&((h=this._resolutionMediaMatchList)===null||h===void 0||h.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}n.ScreenDprMonitor=p},3236:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Terminal=void 0;const l=s(3614),p=s(3656),a=s(6465),h=s(9042),f=s(3730),u=s(1680),d=s(3107),t=s(5744),i=s(2950),o=s(1296),r=s(428),m=s(4269),g=s(5114),E=s(8934),T=s(3230),w=s(9312),y=s(4725),M=s(6731),I=s(8055),C=s(8969),D=s(8460),A=s(844),H=s(6114),N=s(8437),F=s(2584),L=s(7399),B=s(5941),O=s(9074),P=s(2585),z=s(5435),W=s(4567),U=typeof window<"u"?window.document:null;class j extends C.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(R={}){super(R),this.browser=H,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new A.MutableDisposable),this._onCursorMove=this.register(new D.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new D.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new D.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new D.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new D.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new D.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new D.EventEmitter),this._onBlur=this.register(new D.EventEmitter),this._onA11yCharEmitter=this.register(new D.EventEmitter),this._onA11yTabEmitter=this.register(new D.EventEmitter),this._onWillOpen=this.register(new D.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(a.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(f.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(O.DecorationService),this._instantiationService.setService(P.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows(($,q)=>this.refresh($,q))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport($=>this._reportWindowsOptions($))),this.register(this._inputHandler.onColor($=>this._handleColorEvent($))),this.register((0,D.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,D.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,D.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,D.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize($=>this._afterResize($.cols,$.rows))),this.register((0,A.toDisposable)(()=>{var $,q;this._customKeyEventHandler=void 0,(q=($=this.element)===null||$===void 0?void 0:$.parentNode)===null||q===void 0||q.removeChild(this.element)}))}_handleColorEvent(R){if(this._themeService)for(const $ of R){let q,X="";switch($.index){case 256:q="foreground",X="10";break;case 257:q="background",X="11";break;case 258:q="cursor",X="12";break;default:q="ansi",X="4;"+$.index}switch($.type){case 0:const se=I.color.toColorRGB(q==="ansi"?this._themeService.colors.ansi[$.index]:this._themeService.colors[q]);this.coreService.triggerDataEvent(`${F.C0.ESC}]${X};${(0,B.toRgbString)(se)}${F.C1_ESCAPED.ST}`);break;case 1:if(q==="ansi")this._themeService.modifyColors(V=>V.ansi[$.index]=I.rgba.toColor(...$.color));else{const V=q;this._themeService.modifyColors(he=>he[V]=I.rgba.toColor(...$.color))}break;case 2:this._themeService.restoreColor($.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(R){R?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(W.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(R){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(F.C0.ESC+"[I"),this.updateCursorStyle(R),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var R;return(R=this.textarea)===null||R===void 0?void 0:R.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(F.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const R=this.buffer.ybase+this.buffer.y,$=this.buffer.lines.get(R);if(!$)return;const q=Math.min(this.buffer.x,this.cols-1),X=this._renderService.dimensions.css.cell.height,se=$.getWidth(q),V=this._renderService.dimensions.css.cell.width*se,he=this.buffer.y*this._renderService.dimensions.css.cell.height,ke=q*this._renderService.dimensions.css.cell.width;this.textarea.style.left=ke+"px",this.textarea.style.top=he+"px",this.textarea.style.width=V+"px",this.textarea.style.height=X+"px",this.textarea.style.lineHeight=X+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,p.addDisposableDomListener)(this.element,"copy",$=>{this.hasSelection()&&(0,l.copyHandler)($,this._selectionService)}));const R=$=>(0,l.handlePasteEvent)($,this.textarea,this.coreService,this.optionsService);this.register((0,p.addDisposableDomListener)(this.textarea,"paste",R)),this.register((0,p.addDisposableDomListener)(this.element,"paste",R)),H.isFirefox?this.register((0,p.addDisposableDomListener)(this.element,"mousedown",$=>{$.button===2&&(0,l.rightClickHandler)($,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,p.addDisposableDomListener)(this.element,"contextmenu",$=>{(0,l.rightClickHandler)($,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),H.isLinux&&this.register((0,p.addDisposableDomListener)(this.element,"auxclick",$=>{$.button===1&&(0,l.moveTextAreaUnderMouseCursor)($,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,p.addDisposableDomListener)(this.textarea,"keyup",R=>this._keyUp(R),!0)),this.register((0,p.addDisposableDomListener)(this.textarea,"keydown",R=>this._keyDown(R),!0)),this.register((0,p.addDisposableDomListener)(this.textarea,"keypress",R=>this._keyPress(R),!0)),this.register((0,p.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,p.addDisposableDomListener)(this.textarea,"compositionupdate",R=>this._compositionHelper.compositionupdate(R))),this.register((0,p.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,p.addDisposableDomListener)(this.textarea,"input",R=>this._inputEvent(R),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(R){var $;if(!R)throw new Error("Terminal requires a parent element.");R.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=R.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),R.appendChild(this.element);const q=U.createDocumentFragment();this._viewportElement=U.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),q.appendChild(this._viewportElement),this._viewportScrollArea=U.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=U.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=U.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),q.appendChild(this.screenElement),this.textarea=U.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",h.promptLabel),H.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(g.CoreBrowserService,this.textarea,($=this._document.defaultView)!==null&&$!==void 0?$:window),this._instantiationService.setService(y.ICoreBrowserService,this._coreBrowserService),this.register((0,p.addDisposableDomListener)(this.textarea,"focus",X=>this._handleTextAreaFocus(X))),this.register((0,p.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(r.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(y.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(M.ThemeService),this._instantiationService.setService(y.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(m.CharacterJoinerService),this._instantiationService.setService(y.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(T.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(y.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(X=>this._onRender.fire(X))),this.onResize(X=>this._renderService.resize(X.cols,X.rows)),this._compositionView=U.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(i.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(q);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(E.MouseService),this._instantiationService.setService(y.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(u.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(X=>this.scrollLines(X.amount,X.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(w.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(y.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(X=>this.scrollLines(X.amount,X.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(X=>this._renderService.handleSelectionChanged(X.start,X.end,X.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(X=>{this.textarea.value=X,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(X=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,p.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(d.BufferDecorationRenderer,this.screenElement)),this.register((0,p.addDisposableDomListener)(this.element,"mousedown",X=>this._selectionService.handleMouseDown(X))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(W.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",X=>this._handleScreenReaderModeOptionChange(X))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(t.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",X=>{!this._overviewRulerRenderer&&X&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(t.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(o.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const R=this,$=this.element;function q(V){const he=R._mouseService.getMouseReportCoords(V,R.screenElement);if(!he)return!1;let ke,ee;switch(V.overrideType||V.type){case"mousemove":ee=32,V.buttons===void 0?(ke=3,V.button!==void 0&&(ke=V.button<3?V.button:3)):ke=1&V.buttons?0:4&V.buttons?1:2&V.buttons?2:3;break;case"mouseup":ee=0,ke=V.button<3?V.button:3;break;case"mousedown":ee=1,ke=V.button<3?V.button:3;break;case"wheel":if(R.viewport.getLinesScrolled(V)===0)return!1;ee=V.deltaY<0?0:1,ke=4;break;default:return!1}return!(ee===void 0||ke===void 0||ke>4)&&R.coreMouseService.triggerMouseEvent({col:he.col,row:he.row,x:he.x,y:he.y,button:ke,action:ee,ctrl:V.ctrlKey,alt:V.altKey,shift:V.shiftKey})}const X={mouseup:null,wheel:null,mousedrag:null,mousemove:null},se={mouseup:V=>(q(V),V.buttons||(this._document.removeEventListener("mouseup",X.mouseup),X.mousedrag&&this._document.removeEventListener("mousemove",X.mousedrag)),this.cancel(V)),wheel:V=>(q(V),this.cancel(V,!0)),mousedrag:V=>{V.buttons&&q(V)},mousemove:V=>{V.buttons||q(V)}};this.register(this.coreMouseService.onProtocolChange(V=>{V?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(V)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&V?X.mousemove||($.addEventListener("mousemove",se.mousemove),X.mousemove=se.mousemove):($.removeEventListener("mousemove",X.mousemove),X.mousemove=null),16&V?X.wheel||($.addEventListener("wheel",se.wheel,{passive:!1}),X.wheel=se.wheel):($.removeEventListener("wheel",X.wheel),X.wheel=null),2&V?X.mouseup||($.addEventListener("mouseup",se.mouseup),X.mouseup=se.mouseup):(this._document.removeEventListener("mouseup",X.mouseup),$.removeEventListener("mouseup",X.mouseup),X.mouseup=null),4&V?X.mousedrag||(X.mousedrag=se.mousedrag):(this._document.removeEventListener("mousemove",X.mousedrag),X.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,p.addDisposableDomListener)($,"mousedown",V=>{if(V.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(V))return q(V),X.mouseup&&this._document.addEventListener("mouseup",X.mouseup),X.mousedrag&&this._document.addEventListener("mousemove",X.mousedrag),this.cancel(V)})),this.register((0,p.addDisposableDomListener)($,"wheel",V=>{if(!X.wheel){if(!this.buffer.hasScrollback){const he=this.viewport.getLinesScrolled(V);if(he===0)return;const ke=F.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(V.deltaY<0?"A":"B");let ee="";for(let le=0;le<Math.abs(he);le++)ee+=ke;return this.coreService.triggerDataEvent(ee,!0),this.cancel(V,!0)}return this.viewport.handleWheel(V)?this.cancel(V):void 0}},{passive:!1})),this.register((0,p.addDisposableDomListener)($,"touchstart",V=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(V),this.cancel(V)},{passive:!0})),this.register((0,p.addDisposableDomListener)($,"touchmove",V=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(V)?void 0:this.cancel(V)},{passive:!1}))}refresh(R,$){var q;(q=this._renderService)===null||q===void 0||q.refreshRows(R,$)}updateCursorStyle(R){var $;!(($=this._selectionService)===null||$===void 0)&&$.shouldColumnSelect(R)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(R,$,q=0){var X;q===1?(super.scrollLines(R,$,q),this.refresh(0,this.rows-1)):(X=this.viewport)===null||X===void 0||X.scrollLines(R)}paste(R){(0,l.paste)(R,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(R){this._customKeyEventHandler=R}registerLinkProvider(R){return this.linkifier2.registerLinkProvider(R)}registerCharacterJoiner(R){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const $=this._characterJoinerService.register(R);return this.refresh(0,this.rows-1),$}deregisterCharacterJoiner(R){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(R)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(R){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+R)}registerDecoration(R){return this._decorationService.registerDecoration(R)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(R,$,q){this._selectionService.setSelection(R,$,q)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var R;(R=this._selectionService)===null||R===void 0||R.clearSelection()}selectAll(){var R;(R=this._selectionService)===null||R===void 0||R.selectAll()}selectLines(R,$){var q;(q=this._selectionService)===null||q===void 0||q.selectLines(R,$)}_keyDown(R){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(R)===!1)return!1;const $=this.browser.isMac&&this.options.macOptionIsMeta&&R.altKey;if(!$&&!this._compositionHelper.keydown(R))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;$||R.key!=="Dead"&&R.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const q=(0,L.evaluateKeyboardEvent)(R,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(R),q.type===3||q.type===2){const X=this.rows-1;return this.scrollLines(q.type===2?-X:X),this.cancel(R,!0)}return q.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,R)||(q.cancel&&this.cancel(R,!0),!q.key||!!(R.key&&!R.ctrlKey&&!R.altKey&&!R.metaKey&&R.key.length===1&&R.key.charCodeAt(0)>=65&&R.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(q.key!==F.C0.ETX&&q.key!==F.C0.CR||(this.textarea.value=""),this._onKey.fire({key:q.key,domEvent:R}),this._showCursor(),this.coreService.triggerDataEvent(q.key,!0),!this.optionsService.rawOptions.screenReaderMode||R.altKey||R.ctrlKey?this.cancel(R,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(R,$){const q=R.isMac&&!this.options.macOptionIsMeta&&$.altKey&&!$.ctrlKey&&!$.metaKey||R.isWindows&&$.altKey&&$.ctrlKey&&!$.metaKey||R.isWindows&&$.getModifierState("AltGraph");return $.type==="keypress"?q:q&&(!$.keyCode||$.keyCode>47)}_keyUp(R){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(R)===!1||(function($){return $.keyCode===16||$.keyCode===17||$.keyCode===18}(R)||this.focus(),this.updateCursorStyle(R),this._keyPressHandled=!1)}_keyPress(R){let $;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(R)===!1)return!1;if(this.cancel(R),R.charCode)$=R.charCode;else if(R.which===null||R.which===void 0)$=R.keyCode;else{if(R.which===0||R.charCode===0)return!1;$=R.which}return!(!$||(R.altKey||R.ctrlKey||R.metaKey)&&!this._isThirdLevelShift(this.browser,R)||($=String.fromCharCode($),this._onKey.fire({key:$,domEvent:R}),this._showCursor(),this.coreService.triggerDataEvent($,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(R){if(R.data&&R.inputType==="insertText"&&(!R.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const $=R.data;return this.coreService.triggerDataEvent($,!0),this.cancel(R),!0}return!1}resize(R,$){R!==this.cols||$!==this.rows?super.resize(R,$):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(R,$){var q,X;(q=this._charSizeService)===null||q===void 0||q.measure(),(X=this.viewport)===null||X===void 0||X.syncScrollArea(!0)}clear(){var R;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let $=1;$<this.rows;$++)this.buffer.lines.push(this.buffer.getBlankLine(N.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(R=this.viewport)===null||R===void 0||R.reset(),this.refresh(0,this.rows-1)}}reset(){var R,$;this.options.rows=this.rows,this.options.cols=this.cols;const q=this._customKeyEventHandler;this._setup(),super.reset(),(R=this._selectionService)===null||R===void 0||R.reset(),this._decorationService.reset(),($=this.viewport)===null||$===void 0||$.reset(),this._customKeyEventHandler=q,this.refresh(0,this.rows-1)}clearTextureAtlas(){var R;(R=this._renderService)===null||R===void 0||R.clearTextureAtlas()}_reportFocus(){var R;!((R=this.element)===null||R===void 0)&&R.classList.contains("focus")?this.coreService.triggerDataEvent(F.C0.ESC+"[I"):this.coreService.triggerDataEvent(F.C0.ESC+"[O")}_reportWindowsOptions(R){if(this._renderService)switch(R){case z.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const $=this._renderService.dimensions.css.canvas.width.toFixed(0),q=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${F.C0.ESC}[4;${q};${$}t`);break;case z.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const X=this._renderService.dimensions.css.cell.width.toFixed(0),se=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${F.C0.ESC}[6;${se};${X}t`)}}cancel(R,$){if(this.options.cancelEvents||$)return R.preventDefault(),R.stopPropagation(),!1}}n.Terminal=j},9924:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TimeBasedDebouncer=void 0,n.TimeBasedDebouncer=class{constructor(s,l=1e3){this._renderCallback=s,this._debounceThresholdMS=l,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(s,l,p){this._rowCount=p,s=s!==void 0?s:0,l=l!==void 0?l:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,s):s,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,l):l;const a=Date.now();if(a-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=a,this._innerRefresh();else if(!this._additionalRefreshRequested){const h=a-this._lastRefreshMs,f=this._debounceThresholdMS-h;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},f)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const s=Math.max(this._rowStart,0),l=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(s,l)}}},1680:function(S,n,s){var l=this&&this.__decorate||function(i,o,r,m){var g,E=arguments.length,T=E<3?o:m===null?m=Object.getOwnPropertyDescriptor(o,r):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(i,o,r,m);else for(var w=i.length-1;w>=0;w--)(g=i[w])&&(T=(E<3?g(T):E>3?g(o,r,T):g(o,r))||T);return E>3&&T&&Object.defineProperty(o,r,T),T},p=this&&this.__param||function(i,o){return function(r,m){o(r,m,i)}};Object.defineProperty(n,"__esModule",{value:!0}),n.Viewport=void 0;const a=s(3656),h=s(4725),f=s(8460),u=s(844),d=s(2585);let t=n.Viewport=class extends u.Disposable{constructor(i,o,r,m,g,E,T,w){super(),this._viewportElement=i,this._scrollArea=o,this._bufferService=r,this._optionsService=m,this._charSizeService=g,this._renderService=E,this._coreBrowserService=T,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new f.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,a.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(y=>this._activeBuffer=y.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(y=>this._renderDimensions=y)),this._handleThemeChange(w.colors),this.register(w.onChangeColors(y=>this._handleThemeChange(y))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(i){this._viewportElement.style.backgroundColor=i.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(i){if(i)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const o=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==o&&(this._lastRecordedBufferHeight=o,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const i=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==i&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=i),this._refreshAnimationFrame=null}syncScrollArea(i=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(i);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(i)}_handleScroll(i){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const o=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:o,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const i=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(i*(this._smoothScrollState.target-this._smoothScrollState.origin)),i<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(i,o){const r=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(o<0&&this._viewportElement.scrollTop!==0||o>0&&r<this._lastRecordedBufferHeight)||(i.cancelable&&i.preventDefault(),!1)}handleWheel(i){const o=this._getPixelsScrolled(i);return o!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+o:this._smoothScrollState.target+=o,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=o,this._bubbleScroll(i,o))}scrollLines(i){if(i!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const o=i*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+o,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:i,suppressScrollEvent:!1})}_getPixelsScrolled(i){if(i.deltaY===0||i.shiftKey)return 0;let o=this._applyScrollModifier(i.deltaY,i);return i.deltaMode===WheelEvent.DOM_DELTA_LINE?o*=this._currentRowHeight:i.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(o*=this._currentRowHeight*this._bufferService.rows),o}getBufferElements(i,o){var r;let m,g="";const E=[],T=o??this._bufferService.buffer.lines.length,w=this._bufferService.buffer.lines;for(let y=i;y<T;y++){const M=w.get(y);if(!M)continue;const I=(r=w.get(y+1))===null||r===void 0?void 0:r.isWrapped;if(g+=M.translateToString(!I),!I||y===w.length-1){const C=document.createElement("div");C.textContent=g,E.push(C),g.length>0&&(m=C),g=""}}return{bufferElements:E,cursorElement:m}}getLinesScrolled(i){if(i.deltaY===0||i.shiftKey)return 0;let o=this._applyScrollModifier(i.deltaY,i);return i.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(o/=this._currentRowHeight+0,this._wheelPartialScroll+=o,o=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):i.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(o*=this._bufferService.rows),o}_applyScrollModifier(i,o){const r=this._optionsService.rawOptions.fastScrollModifier;return r==="alt"&&o.altKey||r==="ctrl"&&o.ctrlKey||r==="shift"&&o.shiftKey?i*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:i*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(i){this._lastTouchY=i.touches[0].pageY}handleTouchMove(i){const o=this._lastTouchY-i.touches[0].pageY;return this._lastTouchY=i.touches[0].pageY,o!==0&&(this._viewportElement.scrollTop+=o,this._bubbleScroll(i,o))}};n.Viewport=t=l([p(2,d.IBufferService),p(3,d.IOptionsService),p(4,h.ICharSizeService),p(5,h.IRenderService),p(6,h.ICoreBrowserService),p(7,h.IThemeService)],t)},3107:function(S,n,s){var l=this&&this.__decorate||function(t,i,o,r){var m,g=arguments.length,E=g<3?i:r===null?r=Object.getOwnPropertyDescriptor(i,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(t,i,o,r);else for(var T=t.length-1;T>=0;T--)(m=t[T])&&(E=(g<3?m(E):g>3?m(i,o,E):m(i,o))||E);return g>3&&E&&Object.defineProperty(i,o,E),E},p=this&&this.__param||function(t,i){return function(o,r){i(o,r,t)}};Object.defineProperty(n,"__esModule",{value:!0}),n.BufferDecorationRenderer=void 0;const a=s(3656),h=s(4725),f=s(844),u=s(2585);let d=n.BufferDecorationRenderer=class extends f.Disposable{constructor(t,i,o,r){super(),this._screenElement=t,this._bufferService=i,this._decorationService=o,this._renderService=r,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,a.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(m=>this._removeDecoration(m))),this.register((0,f.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const t of this._decorationService.decorations)this._renderDecoration(t);this._dimensionsChanged=!1}_renderDecoration(t){this._refreshStyle(t),this._dimensionsChanged&&this._refreshXPosition(t)}_createElement(t){var i,o;const r=document.createElement("div");r.classList.add("xterm-decoration"),r.classList.toggle("xterm-decoration-top-layer",((i=t==null?void 0:t.options)===null||i===void 0?void 0:i.layer)==="top"),r.style.width=`${Math.round((t.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,r.style.height=(t.options.height||1)*this._renderService.dimensions.css.cell.height+"px",r.style.top=(t.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",r.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const m=(o=t.options.x)!==null&&o!==void 0?o:0;return m&&m>this._bufferService.cols&&(r.style.display="none"),this._refreshXPosition(t,r),r}_refreshStyle(t){const i=t.marker.line-this._bufferService.buffers.active.ydisp;if(i<0||i>=this._bufferService.rows)t.element&&(t.element.style.display="none",t.onRenderEmitter.fire(t.element));else{let o=this._decorationElements.get(t);o||(o=this._createElement(t),t.element=o,this._decorationElements.set(t,o),this._container.appendChild(o),t.onDispose(()=>{this._decorationElements.delete(t),o.remove()})),o.style.top=i*this._renderService.dimensions.css.cell.height+"px",o.style.display=this._altBufferIsActive?"none":"block",t.onRenderEmitter.fire(o)}}_refreshXPosition(t,i=t.element){var o;if(!i)return;const r=(o=t.options.x)!==null&&o!==void 0?o:0;(t.options.anchor||"left")==="right"?i.style.right=r?r*this._renderService.dimensions.css.cell.width+"px":"":i.style.left=r?r*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(t){var i;(i=this._decorationElements.get(t))===null||i===void 0||i.remove(),this._decorationElements.delete(t),t.dispose()}};n.BufferDecorationRenderer=d=l([p(1,u.IBufferService),p(2,u.IDecorationService),p(3,h.IRenderService)],d)},5871:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorZoneStore=void 0,n.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(s){if(s.options.overviewRulerOptions){for(const l of this._zones)if(l.color===s.options.overviewRulerOptions.color&&l.position===s.options.overviewRulerOptions.position){if(this._lineIntersectsZone(l,s.marker.line))return;if(this._lineAdjacentToZone(l,s.marker.line,s.options.overviewRulerOptions.position))return void this._addLineToZone(l,s.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=s.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=s.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=s.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=s.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:s.options.overviewRulerOptions.color,position:s.options.overviewRulerOptions.position,startBufferLine:s.marker.line,endBufferLine:s.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(s){this._linePadding=s}_lineIntersectsZone(s,l){return l>=s.startBufferLine&&l<=s.endBufferLine}_lineAdjacentToZone(s,l,p){return l>=s.startBufferLine-this._linePadding[p||"full"]&&l<=s.endBufferLine+this._linePadding[p||"full"]}_addLineToZone(s,l){s.startBufferLine=Math.min(s.startBufferLine,l),s.endBufferLine=Math.max(s.endBufferLine,l)}}},5744:function(S,n,s){var l=this&&this.__decorate||function(m,g,E,T){var w,y=arguments.length,M=y<3?g:T===null?T=Object.getOwnPropertyDescriptor(g,E):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(m,g,E,T);else for(var I=m.length-1;I>=0;I--)(w=m[I])&&(M=(y<3?w(M):y>3?w(g,E,M):w(g,E))||M);return y>3&&M&&Object.defineProperty(g,E,M),M},p=this&&this.__param||function(m,g){return function(E,T){g(E,T,m)}};Object.defineProperty(n,"__esModule",{value:!0}),n.OverviewRulerRenderer=void 0;const a=s(5871),h=s(3656),f=s(4725),u=s(844),d=s(2585),t={full:0,left:0,center:0,right:0},i={full:0,left:0,center:0,right:0},o={full:0,left:0,center:0,right:0};let r=n.OverviewRulerRenderer=class extends u.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(m,g,E,T,w,y,M){var I;super(),this._viewportElement=m,this._screenElement=g,this._bufferService=E,this._decorationService=T,this._renderService=w,this._optionsService=y,this._coreBrowseService=M,this._colorZoneStore=new a.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(I=this._viewportElement.parentElement)===null||I===void 0||I.insertBefore(this._canvas,this._viewportElement);const C=this._canvas.getContext("2d");if(!C)throw new Error("Ctx cannot be null");this._ctx=C,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,u.toDisposable)(()=>{var D;(D=this._canvas)===null||D===void 0||D.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,h.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const m=Math.floor(this._canvas.width/3),g=Math.ceil(this._canvas.width/3);i.full=this._canvas.width,i.left=m,i.center=g,i.right=m,this._refreshDrawHeightConstants(),o.full=0,o.left=0,o.center=i.left,o.right=i.left+i.center}_refreshDrawHeightConstants(){t.full=Math.round(2*this._coreBrowseService.dpr);const m=this._canvas.height/this._bufferService.buffer.lines.length,g=Math.round(Math.max(Math.min(m,12),6)*this._coreBrowseService.dpr);t.left=g,t.center=g,t.right=g}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const g of this._decorationService.decorations)this._colorZoneStore.addDecoration(g);this._ctx.lineWidth=1;const m=this._colorZoneStore.zones;for(const g of m)g.position!=="full"&&this._renderColorZone(g);for(const g of m)g.position==="full"&&this._renderColorZone(g);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(m){this._ctx.fillStyle=m.color,this._ctx.fillRect(o[m.position||"full"],Math.round((this._canvas.height-1)*(m.startBufferLine/this._bufferService.buffers.active.lines.length)-t[m.position||"full"]/2),i[m.position||"full"],Math.round((this._canvas.height-1)*((m.endBufferLine-m.startBufferLine)/this._bufferService.buffers.active.lines.length)+t[m.position||"full"]))}_queueRefresh(m,g){this._shouldUpdateDimensions=m||this._shouldUpdateDimensions,this._shouldUpdateAnchor=g||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};n.OverviewRulerRenderer=r=l([p(2,d.IBufferService),p(3,d.IDecorationService),p(4,f.IRenderService),p(5,d.IOptionsService),p(6,f.ICoreBrowserService)],r)},2950:function(S,n,s){var l=this&&this.__decorate||function(d,t,i,o){var r,m=arguments.length,g=m<3?t:o===null?o=Object.getOwnPropertyDescriptor(t,i):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(d,t,i,o);else for(var E=d.length-1;E>=0;E--)(r=d[E])&&(g=(m<3?r(g):m>3?r(t,i,g):r(t,i))||g);return m>3&&g&&Object.defineProperty(t,i,g),g},p=this&&this.__param||function(d,t){return function(i,o){t(i,o,d)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CompositionHelper=void 0;const a=s(4725),h=s(2585),f=s(2584);let u=n.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(d,t,i,o,r,m){this._textarea=d,this._compositionView=t,this._bufferService=i,this._optionsService=o,this._coreService=r,this._renderService=m,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(d){this._compositionView.textContent=d.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(d){if(this._isComposing||this._isSendingComposition){if(d.keyCode===229||d.keyCode===16||d.keyCode===17||d.keyCode===18)return!1;this._finalizeComposition(!1)}return d.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(d){if(this._compositionView.classList.remove("active"),this._isComposing=!1,d){const t={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let i;this._isSendingComposition=!1,t.start+=this._dataAlreadySent.length,i=this._isComposing?this._textarea.value.substring(t.start,t.end):this._textarea.value.substring(t.start),i.length>0&&this._coreService.triggerDataEvent(i,!0)}},0)}else{this._isSendingComposition=!1;const t=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(t,!0)}}_handleAnyTextareaChanges(){const d=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const t=this._textarea.value,i=t.replace(d,"");this._dataAlreadySent=i,t.length>d.length?this._coreService.triggerDataEvent(i,!0):t.length<d.length?this._coreService.triggerDataEvent(`${f.C0.DEL}`,!0):t.length===d.length&&t!==d&&this._coreService.triggerDataEvent(t,!0)}},0)}updateCompositionElements(d){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const t=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),i=this._renderService.dimensions.css.cell.height,o=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,r=t*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=r+"px",this._compositionView.style.top=o+"px",this._compositionView.style.height=i+"px",this._compositionView.style.lineHeight=i+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const m=this._compositionView.getBoundingClientRect();this._textarea.style.left=r+"px",this._textarea.style.top=o+"px",this._textarea.style.width=Math.max(m.width,1)+"px",this._textarea.style.height=Math.max(m.height,1)+"px",this._textarea.style.lineHeight=m.height+"px"}d||setTimeout(()=>this.updateCompositionElements(!0),0)}}};n.CompositionHelper=u=l([p(2,h.IBufferService),p(3,h.IOptionsService),p(4,h.ICoreService),p(5,a.IRenderService)],u)},9806:(S,n)=>{function s(l,p,a){const h=a.getBoundingClientRect(),f=l.getComputedStyle(a),u=parseInt(f.getPropertyValue("padding-left")),d=parseInt(f.getPropertyValue("padding-top"));return[p.clientX-h.left-u,p.clientY-h.top-d]}Object.defineProperty(n,"__esModule",{value:!0}),n.getCoords=n.getCoordsRelativeToElement=void 0,n.getCoordsRelativeToElement=s,n.getCoords=function(l,p,a,h,f,u,d,t,i){if(!u)return;const o=s(l,p,a);return o?(o[0]=Math.ceil((o[0]+(i?d/2:0))/d),o[1]=Math.ceil(o[1]/t),o[0]=Math.min(Math.max(o[0],1),h+(i?1:0)),o[1]=Math.min(Math.max(o[1],1),f),o):void 0}},9504:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.moveToCellSequence=void 0;const l=s(2584);function p(t,i,o,r){const m=t-a(t,o),g=i-a(i,o),E=Math.abs(m-g)-function(T,w,y){let M=0;const I=T-a(T,y),C=w-a(w,y);for(let D=0;D<Math.abs(I-C);D++){const A=h(T,w)==="A"?-1:1,H=y.buffer.lines.get(I+A*D);H!=null&&H.isWrapped&&M++}return M}(t,i,o);return d(E,u(h(t,i),r))}function a(t,i){let o=0,r=i.buffer.lines.get(t),m=r==null?void 0:r.isWrapped;for(;m&&t>=0&&t<i.rows;)o++,r=i.buffer.lines.get(--t),m=r==null?void 0:r.isWrapped;return o}function h(t,i){return t>i?"A":"B"}function f(t,i,o,r,m,g){let E=t,T=i,w="";for(;E!==o||T!==r;)E+=m?1:-1,m&&E>g.cols-1?(w+=g.buffer.translateBufferLineToString(T,!1,t,E),E=0,t=0,T++):!m&&E<0&&(w+=g.buffer.translateBufferLineToString(T,!1,0,t+1),E=g.cols-1,t=E,T--);return w+g.buffer.translateBufferLineToString(T,!1,t,E)}function u(t,i){const o=i?"O":"[";return l.C0.ESC+o+t}function d(t,i){t=Math.floor(t);let o="";for(let r=0;r<t;r++)o+=i;return o}n.moveToCellSequence=function(t,i,o,r){const m=o.buffer.x,g=o.buffer.y;if(!o.buffer.hasScrollback)return function(w,y,M,I,C,D){return p(y,I,C,D).length===0?"":d(f(w,y,w,y-a(y,C),!1,C).length,u("D",D))}(m,g,0,i,o,r)+p(g,i,o,r)+function(w,y,M,I,C,D){let A;A=p(y,I,C,D).length>0?I-a(I,C):y;const H=I,N=function(F,L,B,O,P,z){let W;return W=p(B,O,P,z).length>0?O-a(O,P):L,F<B&&W<=O||F>=B&&W<O?"C":"D"}(w,y,M,I,C,D);return d(f(w,A,M,H,N==="C",C).length,u(N,D))}(m,g,t,i,o,r);let E;if(g===i)return E=m>t?"D":"C",d(Math.abs(m-t),u(E,r));E=g>i?"D":"C";const T=Math.abs(g-i);return d(function(w,y){return y.cols-w}(g>i?t:m,o)+(T-1)*o.cols+1+((g>i?m:t)-1),u(E,r))}},1296:function(S,n,s){var l=this&&this.__decorate||function(C,D,A,H){var N,F=arguments.length,L=F<3?D:H===null?H=Object.getOwnPropertyDescriptor(D,A):H;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(C,D,A,H);else for(var B=C.length-1;B>=0;B--)(N=C[B])&&(L=(F<3?N(L):F>3?N(D,A,L):N(D,A))||L);return F>3&&L&&Object.defineProperty(D,A,L),L},p=this&&this.__param||function(C,D){return function(A,H){D(A,H,C)}};Object.defineProperty(n,"__esModule",{value:!0}),n.DomRenderer=void 0;const a=s(3787),h=s(2550),f=s(2223),u=s(6171),d=s(4725),t=s(8055),i=s(8460),o=s(844),r=s(2585),m="xterm-dom-renderer-owner-",g="xterm-rows",E="xterm-fg-",T="xterm-bg-",w="xterm-focus",y="xterm-selection";let M=1,I=n.DomRenderer=class extends o.Disposable{constructor(C,D,A,H,N,F,L,B,O,P){super(),this._element=C,this._screenElement=D,this._viewportElement=A,this._linkifier2=H,this._charSizeService=F,this._optionsService=L,this._bufferService=B,this._coreBrowserService=O,this._themeService=P,this._terminalClass=M++,this._rowElements=[],this.onRequestRedraw=this.register(new i.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add(g),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add(y),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,u.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(z=>this._injectCss(z))),this._injectCss(this._themeService.colors),this._rowFactory=N.createInstance(a.DomRendererRowFactory,document),this._element.classList.add(m+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(z=>this._handleLinkHover(z))),this.register(this._linkifier2.onHideLinkUnderline(z=>this._handleLinkLeave(z))),this.register((0,o.toDisposable)(()=>{this._element.classList.remove(m+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new h.WidthCache(document),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const C=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*C,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*C),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/C),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/C),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const A of this._rowElements)A.style.width=`${this.dimensions.css.canvas.width}px`,A.style.height=`${this.dimensions.css.cell.height}px`,A.style.lineHeight=`${this.dimensions.css.cell.height}px`,A.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const D=`${this._terminalSelector} .${g} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=D,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(C){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let D=`${this._terminalSelector} .${g} { color: ${C.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;D+=`${this._terminalSelector} .${g} .xterm-dim { color: ${t.color.multiplyOpacity(C.foreground,.5).css};}`,D+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`,D+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  border-bottom-style: hidden; }}",D+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${C.cursor.css};  color: ${C.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${C.cursor.css}; }}`,D+=`${this._terminalSelector} .${g}.${w} .xterm-cursor.xterm-cursor-blink:not(.xterm-cursor-block) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${g}.${w} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-block { background-color: ${C.cursor.css}; color: ${C.cursorAccent.css};}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${C.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${C.cursor.css} inset;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${C.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,D+=`${this._terminalSelector} .${y} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${y} div { position: absolute; background-color: ${C.selectionBackgroundOpaque.css};}${this._terminalSelector} .${y} div { position: absolute; background-color: ${C.selectionInactiveBackgroundOpaque.css};}`;for(const[A,H]of C.ansi.entries())D+=`${this._terminalSelector} .${E}${A} { color: ${H.css}; }${this._terminalSelector} .${E}${A}.xterm-dim { color: ${t.color.multiplyOpacity(H,.5).css}; }${this._terminalSelector} .${T}${A} { background-color: ${H.css}; }`;D+=`${this._terminalSelector} .${E}${f.INVERTED_DEFAULT_COLOR} { color: ${t.color.opaque(C.background).css}; }${this._terminalSelector} .${E}${f.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${t.color.multiplyOpacity(t.color.opaque(C.background),.5).css}; }${this._terminalSelector} .${T}${f.INVERTED_DEFAULT_COLOR} { background-color: ${C.foreground.css}; }`,this._themeStyleElement.textContent=D}_setDefaultSpacing(){const C=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${C}px`,this._rowFactory.defaultSpacing=C}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(C,D){for(let A=this._rowElements.length;A<=D;A++){const H=document.createElement("div");this._rowContainer.appendChild(H),this._rowElements.push(H)}for(;this._rowElements.length>D;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(C,D){this._refreshRowElements(C,D),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(w)}handleFocus(){this._rowContainer.classList.add(w),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(C,D,A){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(C,D,A),this.renderRows(0,this._bufferService.rows-1),!C||!D)return;const H=C[1]-this._bufferService.buffer.ydisp,N=D[1]-this._bufferService.buffer.ydisp,F=Math.max(H,0),L=Math.min(N,this._bufferService.rows-1);if(F>=this._bufferService.rows||L<0)return;const B=document.createDocumentFragment();if(A){const O=C[0]>D[0];B.appendChild(this._createSelectionElement(F,O?D[0]:C[0],O?C[0]:D[0],L-F+1))}else{const O=H===F?C[0]:0,P=F===N?D[0]:this._bufferService.cols;B.appendChild(this._createSelectionElement(F,O,P));const z=L-F-1;if(B.appendChild(this._createSelectionElement(F+1,0,this._bufferService.cols,z)),F!==L){const W=N===L?D[0]:this._bufferService.cols;B.appendChild(this._createSelectionElement(L,0,W))}}this._selectionContainer.appendChild(B)}_createSelectionElement(C,D,A,H=1){const N=document.createElement("div");return N.style.height=H*this.dimensions.css.cell.height+"px",N.style.top=C*this.dimensions.css.cell.height+"px",N.style.left=D*this.dimensions.css.cell.width+"px",N.style.width=this.dimensions.css.cell.width*(A-D)+"px",N}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const C of this._rowElements)C.replaceChildren()}renderRows(C,D){const A=this._bufferService.buffer,H=A.ybase+A.y,N=Math.min(A.x,this._bufferService.cols-1),F=this._optionsService.rawOptions.cursorBlink,L=this._optionsService.rawOptions.cursorStyle,B=this._optionsService.rawOptions.cursorInactiveStyle;for(let O=C;O<=D;O++){const P=O+A.ydisp,z=this._rowElements[O],W=A.lines.get(P);if(!z||!W)break;z.replaceChildren(...this._rowFactory.createRow(W,P,P===H,L,B,N,F,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${m}${this._terminalClass}`}_handleLinkHover(C){this._setCellUnderline(C.x1,C.x2,C.y1,C.y2,C.cols,!0)}_handleLinkLeave(C){this._setCellUnderline(C.x1,C.x2,C.y1,C.y2,C.cols,!1)}_setCellUnderline(C,D,A,H,N,F){A<0&&(C=0),H<0&&(D=0);const L=this._bufferService.rows-1;A=Math.max(Math.min(A,L),0),H=Math.max(Math.min(H,L),0),N=Math.min(N,this._bufferService.cols);const B=this._bufferService.buffer,O=B.ybase+B.y,P=Math.min(B.x,N-1),z=this._optionsService.rawOptions.cursorBlink,W=this._optionsService.rawOptions.cursorStyle,U=this._optionsService.rawOptions.cursorInactiveStyle;for(let j=A;j<=H;++j){const Y=j+B.ydisp,R=this._rowElements[j],$=B.lines.get(Y);if(!R||!$)break;R.replaceChildren(...this._rowFactory.createRow($,Y,Y===O,W,U,P,z,this.dimensions.css.cell.width,this._widthCache,F?j===A?C:0:-1,F?(j===H?D:N)-1:-1))}}};n.DomRenderer=I=l([p(4,r.IInstantiationService),p(5,d.ICharSizeService),p(6,r.IOptionsService),p(7,r.IBufferService),p(8,d.ICoreBrowserService),p(9,d.IThemeService)],I)},3787:function(S,n,s){var l=this&&this.__decorate||function(E,T,w,y){var M,I=arguments.length,C=I<3?T:y===null?y=Object.getOwnPropertyDescriptor(T,w):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(E,T,w,y);else for(var D=E.length-1;D>=0;D--)(M=E[D])&&(C=(I<3?M(C):I>3?M(T,w,C):M(T,w))||C);return I>3&&C&&Object.defineProperty(T,w,C),C},p=this&&this.__param||function(E,T){return function(w,y){T(w,y,E)}};Object.defineProperty(n,"__esModule",{value:!0}),n.DomRendererRowFactory=void 0;const a=s(2223),h=s(643),f=s(511),u=s(2585),d=s(8055),t=s(4725),i=s(4269),o=s(6171),r=s(3734);let m=n.DomRendererRowFactory=class{constructor(E,T,w,y,M,I,C){this._document=E,this._characterJoinerService=T,this._optionsService=w,this._coreBrowserService=y,this._coreService=M,this._decorationService=I,this._themeService=C,this._workCell=new f.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(E,T,w){this._selectionStart=E,this._selectionEnd=T,this._columnSelectMode=w}createRow(E,T,w,y,M,I,C,D,A,H,N){const F=[],L=this._characterJoinerService.getJoinedCharacters(T),B=this._themeService.colors;let O,P=E.getNoBgTrimmedLength();w&&P<I+1&&(P=I+1);let z=0,W="",U=0,j=0,Y=0,R=!1,$=0,q=!1,X=0;const se=[],V=H!==-1&&N!==-1;for(let he=0;he<P;he++){E.loadCell(he,this._workCell);let ke=this._workCell.getWidth();if(ke===0)continue;let ee=!1,le=he,Z=this._workCell;if(L.length>0&&he===L[0][0]){ee=!0;const ne=L.shift();Z=new i.JoinedCellData(this._workCell,E.translateToString(!0,ne[0],ne[1]),ne[1]-ne[0]),le=ne[1]-1,ke=Z.getWidth()}const de=this._isCellInSelection(he,T),_e=w&&he===I,we=V&&he>=H&&he<=N;let J=!1;this._decorationService.forEachDecorationAtCell(he,T,void 0,ne=>{J=!0});let oe=Z.getChars()||h.WHITESPACE_CELL_CHAR;if(oe===" "&&(Z.isUnderline()||Z.isOverline())&&(oe=" "),X=ke*D-A.get(oe,Z.isBold(),Z.isItalic()),O){if(z&&(de&&q||!de&&!q&&Z.bg===U)&&(de&&q&&B.selectionForeground||Z.fg===j)&&Z.extended.ext===Y&&we===R&&X===$&&!_e&&!ee&&!J){W+=oe,z++;continue}z&&(O.textContent=W),O=this._document.createElement("span"),z=0,W=""}else O=this._document.createElement("span");if(U=Z.bg,j=Z.fg,Y=Z.extended.ext,R=we,$=X,q=de,ee&&I>=he&&I<=le&&(I=he),!this._coreService.isCursorHidden&&_e){if(se.push("xterm-cursor"),this._coreBrowserService.isFocused)C&&se.push("xterm-cursor-blink"),se.push(y==="bar"?"xterm-cursor-bar":y==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(M)switch(M){case"outline":se.push("xterm-cursor-outline");break;case"block":se.push("xterm-cursor-block");break;case"bar":se.push("xterm-cursor-bar");break;case"underline":se.push("xterm-cursor-underline")}}if(Z.isBold()&&se.push("xterm-bold"),Z.isItalic()&&se.push("xterm-italic"),Z.isDim()&&se.push("xterm-dim"),W=Z.isInvisible()?h.WHITESPACE_CELL_CHAR:Z.getChars()||h.WHITESPACE_CELL_CHAR,Z.isUnderline()&&(se.push(`xterm-underline-${Z.extended.underlineStyle}`),W===" "&&(W=" "),!Z.isUnderlineColorDefault()))if(Z.isUnderlineColorRGB())O.style.textDecorationColor=`rgb(${r.AttributeData.toColorRGB(Z.getUnderlineColor()).join(",")})`;else{let ne=Z.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&Z.isBold()&&ne<8&&(ne+=8),O.style.textDecorationColor=B.ansi[ne].css}Z.isOverline()&&(se.push("xterm-overline"),W===" "&&(W=" ")),Z.isStrikethrough()&&se.push("xterm-strikethrough"),we&&(O.style.textDecoration="underline");let te=Z.getFgColor(),xe=Z.getFgColorMode(),ce=Z.getBgColor(),Pe=Z.getBgColorMode();const ve=!!Z.isInverse();if(ve){const ne=te;te=ce,ce=ne;const ue=xe;xe=Pe,Pe=ue}let ie,pe,me,Le=!1;switch(this._decorationService.forEachDecorationAtCell(he,T,void 0,ne=>{ne.options.layer!=="top"&&Le||(ne.backgroundColorRGB&&(Pe=50331648,ce=ne.backgroundColorRGB.rgba>>8&16777215,ie=ne.backgroundColorRGB),ne.foregroundColorRGB&&(xe=50331648,te=ne.foregroundColorRGB.rgba>>8&16777215,pe=ne.foregroundColorRGB),Le=ne.options.layer==="top")}),!Le&&de&&(ie=this._coreBrowserService.isFocused?B.selectionBackgroundOpaque:B.selectionInactiveBackgroundOpaque,ce=ie.rgba>>8&16777215,Pe=50331648,Le=!0,B.selectionForeground&&(xe=50331648,te=B.selectionForeground.rgba>>8&16777215,pe=B.selectionForeground)),Le&&se.push("xterm-decoration-top"),Pe){case 16777216:case 33554432:me=B.ansi[ce],se.push(`xterm-bg-${ce}`);break;case 50331648:me=d.rgba.toColor(ce>>16,ce>>8&255,255&ce),this._addStyle(O,`background-color:#${g((ce>>>0).toString(16),"0",6)}`);break;default:ve?(me=B.foreground,se.push(`xterm-bg-${a.INVERTED_DEFAULT_COLOR}`)):me=B.background}switch(ie||Z.isDim()&&(ie=d.color.multiplyOpacity(me,.5)),xe){case 16777216:case 33554432:Z.isBold()&&te<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(te+=8),this._applyMinimumContrast(O,me,B.ansi[te],Z,ie,void 0)||se.push(`xterm-fg-${te}`);break;case 50331648:const ne=d.rgba.toColor(te>>16&255,te>>8&255,255&te);this._applyMinimumContrast(O,me,ne,Z,ie,pe)||this._addStyle(O,`color:#${g(te.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(O,me,B.foreground,Z,ie,void 0)||ve&&se.push(`xterm-fg-${a.INVERTED_DEFAULT_COLOR}`)}se.length&&(O.className=se.join(" "),se.length=0),_e||ee||J?O.textContent=W:z++,X!==this.defaultSpacing&&(O.style.letterSpacing=`${X}px`),F.push(O),he=le}return O&&z&&(O.textContent=W),F}_applyMinimumContrast(E,T,w,y,M,I){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,o.excludeFromContrastRatioDemands)(y.getCode()))return!1;const C=this._getContrastCache(y);let D;if(M||I||(D=C.getColor(T.rgba,w.rgba)),D===void 0){const A=this._optionsService.rawOptions.minimumContrastRatio/(y.isDim()?2:1);D=d.color.ensureContrastRatio(M||T,I||w,A),C.setColor((M||T).rgba,(I||w).rgba,D??null)}return!!D&&(this._addStyle(E,`color:${D.css}`),!0)}_getContrastCache(E){return E.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(E,T){E.setAttribute("style",`${E.getAttribute("style")||""}${T};`)}_isCellInSelection(E,T){const w=this._selectionStart,y=this._selectionEnd;return!(!w||!y)&&(this._columnSelectMode?w[0]<=y[0]?E>=w[0]&&T>=w[1]&&E<y[0]&&T<=y[1]:E<w[0]&&T>=w[1]&&E>=y[0]&&T<=y[1]:T>w[1]&&T<y[1]||w[1]===y[1]&&T===w[1]&&E>=w[0]&&E<y[0]||w[1]<y[1]&&T===y[1]&&E<y[0]||w[1]<y[1]&&T===w[1]&&E>=w[0])}};function g(E,T,w){for(;E.length<w;)E=T+E;return E}n.DomRendererRowFactory=m=l([p(1,t.ICharacterJoinerService),p(2,u.IOptionsService),p(3,t.ICoreBrowserService),p(4,u.ICoreService),p(5,u.IDecorationService),p(6,t.IThemeService)],m)},2550:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WidthCache=void 0,n.WidthCache=class{constructor(s){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=s.createElement("div"),this._container.style.position="absolute",this._container.style.top="-50000px",this._container.style.width="50000px",this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const l=s.createElement("span"),p=s.createElement("span");p.style.fontWeight="bold";const a=s.createElement("span");a.style.fontStyle="italic";const h=s.createElement("span");h.style.fontWeight="bold",h.style.fontStyle="italic",this._measureElements=[l,p,a,h],this._container.appendChild(l),this._container.appendChild(p),this._container.appendChild(a),this._container.appendChild(h),s.body.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(s,l,p,a){s===this._font&&l===this._fontSize&&p===this._weight&&a===this._weightBold||(this._font=s,this._fontSize=l,this._weight=p,this._weightBold=a,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${p}`,this._measureElements[1].style.fontWeight=`${a}`,this._measureElements[2].style.fontWeight=`${p}`,this._measureElements[3].style.fontWeight=`${a}`,this.clear())}get(s,l,p){let a=0;if(!l&&!p&&s.length===1&&(a=s.charCodeAt(0))<256)return this._flat[a]!==-9999?this._flat[a]:this._flat[a]=this._measure(s,0);let h=s;l&&(h+="B"),p&&(h+="I");let f=this._holey.get(h);if(f===void 0){let u=0;l&&(u|=1),p&&(u|=2),f=this._measure(s,u),this._holey.set(h,f)}return f}_measure(s,l){const p=this._measureElements[l];return p.textContent=s.repeat(32),p.offsetWidth/32}}},2223:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TEXT_BASELINE=n.DIM_OPACITY=n.INVERTED_DEFAULT_COLOR=void 0;const l=s(6114);n.INVERTED_DEFAULT_COLOR=257,n.DIM_OPACITY=.5,n.TEXT_BASELINE=l.isFirefox||l.isLegacyEdge?"bottom":"ideographic"},6171:(S,n)=>{function s(l){return 57508<=l&&l<=57558}Object.defineProperty(n,"__esModule",{value:!0}),n.createRenderDimensions=n.excludeFromContrastRatioDemands=n.isRestrictedPowerlineGlyph=n.isPowerlineGlyph=n.throwIfFalsy=void 0,n.throwIfFalsy=function(l){if(!l)throw new Error("value must not be falsy");return l},n.isPowerlineGlyph=s,n.isRestrictedPowerlineGlyph=function(l){return 57520<=l&&l<=57527},n.excludeFromContrastRatioDemands=function(l){return s(l)||function(p){return 9472<=p&&p<=9631}(l)},n.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SelectionModel=void 0,n.SelectionModel=class{constructor(s){this._bufferService=s,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const s=this.selectionStart[0]+this.selectionStartLength;return s>this._bufferService.cols?s%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(s/this._bufferService.cols)-1]:[s%this._bufferService.cols,this.selectionStart[1]+Math.floor(s/this._bufferService.cols)]:[s,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const s=this.selectionStart[0]+this.selectionStartLength;return s>this._bufferService.cols?[s%this._bufferService.cols,this.selectionStart[1]+Math.floor(s/this._bufferService.cols)]:[Math.max(s,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const s=this.selectionStart,l=this.selectionEnd;return!(!s||!l)&&(s[1]>l[1]||s[1]===l[1]&&s[0]>l[0])}handleTrim(s){return this.selectionStart&&(this.selectionStart[1]-=s),this.selectionEnd&&(this.selectionEnd[1]-=s),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(S,n,s){var l=this&&this.__decorate||function(t,i,o,r){var m,g=arguments.length,E=g<3?i:r===null?r=Object.getOwnPropertyDescriptor(i,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(t,i,o,r);else for(var T=t.length-1;T>=0;T--)(m=t[T])&&(E=(g<3?m(E):g>3?m(i,o,E):m(i,o))||E);return g>3&&E&&Object.defineProperty(i,o,E),E},p=this&&this.__param||function(t,i){return function(o,r){i(o,r,t)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CharSizeService=void 0;const a=s(2585),h=s(8460),f=s(844);let u=n.CharSizeService=class extends f.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(t,i,o){super(),this._optionsService=o,this.width=0,this.height=0,this._onCharSizeChange=this.register(new h.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new d(t,i,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const t=this._measureStrategy.measure();t.width===this.width&&t.height===this.height||(this.width=t.width,this.height=t.height,this._onCharSizeChange.fire())}};n.CharSizeService=u=l([p(2,a.IOptionsService)],u);class d{constructor(i,o,r){this._document=i,this._parentElement=o,this._optionsService=r,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const i={height:Number(this._measureElement.offsetHeight),width:Number(this._measureElement.offsetWidth)};return i.width!==0&&i.height!==0&&(this._result.width=i.width/32,this._result.height=Math.ceil(i.height)),this._result}}},4269:function(S,n,s){var l=this&&this.__decorate||function(i,o,r,m){var g,E=arguments.length,T=E<3?o:m===null?m=Object.getOwnPropertyDescriptor(o,r):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(i,o,r,m);else for(var w=i.length-1;w>=0;w--)(g=i[w])&&(T=(E<3?g(T):E>3?g(o,r,T):g(o,r))||T);return E>3&&T&&Object.defineProperty(o,r,T),T},p=this&&this.__param||function(i,o){return function(r,m){o(r,m,i)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CharacterJoinerService=n.JoinedCellData=void 0;const a=s(3734),h=s(643),f=s(511),u=s(2585);class d extends a.AttributeData{constructor(o,r,m){super(),this.content=0,this.combinedData="",this.fg=o.fg,this.bg=o.bg,this.combinedData=r,this._width=m}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(o){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}n.JoinedCellData=d;let t=n.CharacterJoinerService=class kn{constructor(o){this._bufferService=o,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new f.CellData}register(o){const r={id:this._nextCharacterJoinerId++,handler:o};return this._characterJoiners.push(r),r.id}deregister(o){for(let r=0;r<this._characterJoiners.length;r++)if(this._characterJoiners[r].id===o)return this._characterJoiners.splice(r,1),!0;return!1}getJoinedCharacters(o){if(this._characterJoiners.length===0)return[];const r=this._bufferService.buffer.lines.get(o);if(!r||r.length===0)return[];const m=[],g=r.translateToString(!0);let E=0,T=0,w=0,y=r.getFg(0),M=r.getBg(0);for(let I=0;I<r.getTrimmedLength();I++)if(r.loadCell(I,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==y||this._workCell.bg!==M){if(I-E>1){const C=this._getJoinedRanges(g,w,T,r,E);for(let D=0;D<C.length;D++)m.push(C[D])}E=I,w=T,y=this._workCell.fg,M=this._workCell.bg}T+=this._workCell.getChars().length||h.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-E>1){const I=this._getJoinedRanges(g,w,T,r,E);for(let C=0;C<I.length;C++)m.push(I[C])}return m}_getJoinedRanges(o,r,m,g,E){const T=o.substring(r,m);let w=[];try{w=this._characterJoiners[0].handler(T)}catch(y){console.error(y)}for(let y=1;y<this._characterJoiners.length;y++)try{const M=this._characterJoiners[y].handler(T);for(let I=0;I<M.length;I++)kn._mergeRanges(w,M[I])}catch(M){console.error(M)}return this._stringRangesToCellRanges(w,g,E),w}_stringRangesToCellRanges(o,r,m){let g=0,E=!1,T=0,w=o[g];if(w){for(let y=m;y<this._bufferService.cols;y++){const M=r.getWidth(y),I=r.getString(y).length||h.WHITESPACE_CELL_CHAR.length;if(M!==0){if(!E&&w[0]<=T&&(w[0]=y,E=!0),w[1]<=T){if(w[1]=y,w=o[++g],!w)break;w[0]<=T?(w[0]=y,E=!0):E=!1}T+=I}}w&&(w[1]=this._bufferService.cols)}}static _mergeRanges(o,r){let m=!1;for(let g=0;g<o.length;g++){const E=o[g];if(m){if(r[1]<=E[0])return o[g-1][1]=r[1],o;if(r[1]<=E[1])return o[g-1][1]=Math.max(r[1],E[1]),o.splice(g,1),o;o.splice(g,1),g--}else{if(r[1]<=E[0])return o.splice(g,0,r),o;if(r[1]<=E[1])return E[0]=Math.min(r[0],E[0]),o;r[0]<E[1]&&(E[0]=Math.min(r[0],E[0]),m=!0)}}return m?o[o.length-1][1]=r[1]:o.push(r),o}};n.CharacterJoinerService=t=l([p(0,u.IBufferService)],t)},5114:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CoreBrowserService=void 0,n.CoreBrowserService=class{constructor(s,l){this._textarea=s,this.window=l,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(S,n,s){var l=this&&this.__decorate||function(u,d,t,i){var o,r=arguments.length,m=r<3?d:i===null?i=Object.getOwnPropertyDescriptor(d,t):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(u,d,t,i);else for(var g=u.length-1;g>=0;g--)(o=u[g])&&(m=(r<3?o(m):r>3?o(d,t,m):o(d,t))||m);return r>3&&m&&Object.defineProperty(d,t,m),m},p=this&&this.__param||function(u,d){return function(t,i){d(t,i,u)}};Object.defineProperty(n,"__esModule",{value:!0}),n.MouseService=void 0;const a=s(4725),h=s(9806);let f=n.MouseService=class{constructor(u,d){this._renderService=u,this._charSizeService=d}getCoords(u,d,t,i,o){return(0,h.getCoords)(window,u,d,t,i,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,o)}getMouseReportCoords(u,d){const t=(0,h.getCoordsRelativeToElement)(window,u,d);if(this._charSizeService.hasValidSize)return t[0]=Math.min(Math.max(t[0],0),this._renderService.dimensions.css.canvas.width-1),t[1]=Math.min(Math.max(t[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(t[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(t[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(t[0]),y:Math.floor(t[1])}}};n.MouseService=f=l([p(0,a.IRenderService),p(1,a.ICharSizeService)],f)},3230:function(S,n,s){var l=this&&this.__decorate||function(m,g,E,T){var w,y=arguments.length,M=y<3?g:T===null?T=Object.getOwnPropertyDescriptor(g,E):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(m,g,E,T);else for(var I=m.length-1;I>=0;I--)(w=m[I])&&(M=(y<3?w(M):y>3?w(g,E,M):w(g,E))||M);return y>3&&M&&Object.defineProperty(g,E,M),M},p=this&&this.__param||function(m,g){return function(E,T){g(E,T,m)}};Object.defineProperty(n,"__esModule",{value:!0}),n.RenderService=void 0;const a=s(3656),h=s(6193),f=s(5596),u=s(4725),d=s(8460),t=s(844),i=s(7226),o=s(2585);let r=n.RenderService=class extends t.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(m,g,E,T,w,y,M,I){if(super(),this._rowCount=m,this._charSizeService=T,this._renderer=this.register(new t.MutableDisposable),this._pausedResizeTask=new i.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new d.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new d.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new d.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new d.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new h.RenderDebouncer(M.window,(C,D)=>this._renderRows(C,D)),this.register(this._renderDebouncer),this._screenDprMonitor=new f.ScreenDprMonitor(M.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(y.onResize(()=>this._fullRefresh())),this.register(y.buffers.onBufferActivate(()=>{var C;return(C=this._renderer.value)===null||C===void 0?void 0:C.clear()})),this.register(E.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(w.onDecorationRegistered(()=>this._fullRefresh())),this.register(w.onDecorationRemoved(()=>this._fullRefresh())),this.register(E.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(y.cols,y.rows),this._fullRefresh()})),this.register(E.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(y.buffer.y,y.buffer.y,!0))),this.register((0,a.addDisposableDomListener)(M.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(I.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in M.window){const C=new M.window.IntersectionObserver(D=>this._handleIntersectionChange(D[D.length-1]),{threshold:0});C.observe(g),this.register({dispose:()=>C.disconnect()})}}_handleIntersectionChange(m){this._isPaused=m.isIntersecting===void 0?m.intersectionRatio===0:!m.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(m,g,E=!1){this._isPaused?this._needsFullRefresh=!0:(E||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(m,g,this._rowCount))}_renderRows(m,g){this._renderer.value&&(m=Math.min(m,this._rowCount-1),g=Math.min(g,this._rowCount-1),this._renderer.value.renderRows(m,g),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:m,end:g}),this._onRender.fire({start:m,end:g}),this._isNextRenderRedrawOnly=!0)}resize(m,g){this._rowCount=g,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(m){this._renderer.value=m,this._renderer.value.onRequestRedraw(g=>this.refreshRows(g.start,g.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(m){return this._renderDebouncer.addRefreshCallback(m)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var m,g;this._renderer.value&&((g=(m=this._renderer.value).clearTextureAtlas)===null||g===void 0||g.call(m),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(m,g){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value.handleResize(m,g)):this._renderer.value.handleResize(m,g),this._fullRefresh())}handleCharSizeChanged(){var m;(m=this._renderer.value)===null||m===void 0||m.handleCharSizeChanged()}handleBlur(){var m;(m=this._renderer.value)===null||m===void 0||m.handleBlur()}handleFocus(){var m;(m=this._renderer.value)===null||m===void 0||m.handleFocus()}handleSelectionChanged(m,g,E){var T;this._selectionState.start=m,this._selectionState.end=g,this._selectionState.columnSelectMode=E,(T=this._renderer.value)===null||T===void 0||T.handleSelectionChanged(m,g,E)}handleCursorMove(){var m;(m=this._renderer.value)===null||m===void 0||m.handleCursorMove()}clear(){var m;(m=this._renderer.value)===null||m===void 0||m.clear()}};n.RenderService=r=l([p(2,o.IOptionsService),p(3,u.ICharSizeService),p(4,o.IDecorationService),p(5,o.IBufferService),p(6,u.ICoreBrowserService),p(7,u.IThemeService)],r)},9312:function(S,n,s){var l=this&&this.__decorate||function(w,y,M,I){var C,D=arguments.length,A=D<3?y:I===null?I=Object.getOwnPropertyDescriptor(y,M):I;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(w,y,M,I);else for(var H=w.length-1;H>=0;H--)(C=w[H])&&(A=(D<3?C(A):D>3?C(y,M,A):C(y,M))||A);return D>3&&A&&Object.defineProperty(y,M,A),A},p=this&&this.__param||function(w,y){return function(M,I){y(M,I,w)}};Object.defineProperty(n,"__esModule",{value:!0}),n.SelectionService=void 0;const a=s(9806),h=s(9504),f=s(456),u=s(4725),d=s(8460),t=s(844),i=s(6114),o=s(4841),r=s(511),m=s(2585),g=String.fromCharCode(160),E=new RegExp(g,"g");let T=n.SelectionService=class extends t.Disposable{constructor(w,y,M,I,C,D,A,H,N){super(),this._element=w,this._screenElement=y,this._linkifier=M,this._bufferService=I,this._coreService=C,this._mouseService=D,this._optionsService=A,this._renderService=H,this._coreBrowserService=N,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new r.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new d.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new d.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new d.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new d.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=F=>this._handleMouseMove(F),this._mouseUpListener=F=>this._handleMouseUp(F),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(F=>this._handleTrim(F)),this.register(this._bufferService.buffers.onBufferActivate(F=>this._handleBufferActivate(F))),this.enable(),this._model=new f.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,t.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const w=this._model.finalSelectionStart,y=this._model.finalSelectionEnd;return!(!w||!y||w[0]===y[0]&&w[1]===y[1])}get selectionText(){const w=this._model.finalSelectionStart,y=this._model.finalSelectionEnd;if(!w||!y)return"";const M=this._bufferService.buffer,I=[];if(this._activeSelectionMode===3){if(w[0]===y[0])return"";const C=w[0]<y[0]?w[0]:y[0],D=w[0]<y[0]?y[0]:w[0];for(let A=w[1];A<=y[1];A++){const H=M.translateBufferLineToString(A,!0,C,D);I.push(H)}}else{const C=w[1]===y[1]?y[0]:void 0;I.push(M.translateBufferLineToString(w[1],!0,w[0],C));for(let D=w[1]+1;D<=y[1]-1;D++){const A=M.lines.get(D),H=M.translateBufferLineToString(D,!0);A!=null&&A.isWrapped?I[I.length-1]+=H:I.push(H)}if(w[1]!==y[1]){const D=M.lines.get(y[1]),A=M.translateBufferLineToString(y[1],!0,0,y[0]);D&&D.isWrapped?I[I.length-1]+=A:I.push(A)}}return I.map(C=>C.replace(E," ")).join(i.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(w){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),i.isLinux&&w&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(w){const y=this._getMouseBufferCoords(w),M=this._model.finalSelectionStart,I=this._model.finalSelectionEnd;return!!(M&&I&&y)&&this._areCoordsInSelection(y,M,I)}isCellInSelection(w,y){const M=this._model.finalSelectionStart,I=this._model.finalSelectionEnd;return!(!M||!I)&&this._areCoordsInSelection([w,y],M,I)}_areCoordsInSelection(w,y,M){return w[1]>y[1]&&w[1]<M[1]||y[1]===M[1]&&w[1]===y[1]&&w[0]>=y[0]&&w[0]<M[0]||y[1]<M[1]&&w[1]===M[1]&&w[0]<M[0]||y[1]<M[1]&&w[1]===y[1]&&w[0]>=y[0]}_selectWordAtCursor(w,y){var M,I;const C=(I=(M=this._linkifier.currentLink)===null||M===void 0?void 0:M.link)===null||I===void 0?void 0:I.range;if(C)return this._model.selectionStart=[C.start.x-1,C.start.y-1],this._model.selectionStartLength=(0,o.getRangeLength)(C,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const D=this._getMouseBufferCoords(w);return!!D&&(this._selectWordAt(D,y),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(w,y){this._model.clearSelection(),w=Math.max(w,0),y=Math.min(y,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,w],this._model.selectionEnd=[this._bufferService.cols,y],this.refresh(),this._onSelectionChange.fire()}_handleTrim(w){this._model.handleTrim(w)&&this.refresh()}_getMouseBufferCoords(w){const y=this._mouseService.getCoords(w,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(y)return y[0]--,y[1]--,y[1]+=this._bufferService.buffer.ydisp,y}_getMouseEventScrollAmount(w){let y=(0,a.getCoordsRelativeToElement)(this._coreBrowserService.window,w,this._screenElement)[1];const M=this._renderService.dimensions.css.canvas.height;return y>=0&&y<=M?0:(y>M&&(y-=M),y=Math.min(Math.max(y,-50),50),y/=50,y/Math.abs(y)+Math.round(14*y))}shouldForceSelection(w){return i.isMac?w.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:w.shiftKey}handleMouseDown(w){if(this._mouseDownTimeStamp=w.timeStamp,(w.button!==2||!this.hasSelection)&&w.button===0){if(!this._enabled){if(!this.shouldForceSelection(w))return;w.stopPropagation()}w.preventDefault(),this._dragScrollAmount=0,this._enabled&&w.shiftKey?this._handleIncrementalClick(w):w.detail===1?this._handleSingleClick(w):w.detail===2?this._handleDoubleClick(w):w.detail===3&&this._handleTripleClick(w),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(w){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(w))}_handleSingleClick(w){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(w)?3:0,this._model.selectionStart=this._getMouseBufferCoords(w),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const y=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);y&&y.length!==this._model.selectionStart[0]&&y.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(w){this._selectWordAtCursor(w,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(w){const y=this._getMouseBufferCoords(w);y&&(this._activeSelectionMode=2,this._selectLineAt(y[1]))}shouldColumnSelect(w){return w.altKey&&!(i.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(w){if(w.stopImmediatePropagation(),!this._model.selectionStart)return;const y=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(w),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(w),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const M=this._bufferService.buffer;if(this._model.selectionEnd[1]<M.lines.length){const I=M.lines.get(this._model.selectionEnd[1]);I&&I.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}y&&y[0]===this._model.selectionEnd[0]&&y[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const w=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(w.ydisp+this._bufferService.rows,w.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=w.ydisp),this.refresh()}}_handleMouseUp(w){const y=w.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&y<500&&w.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const M=this._mouseService.getCoords(w,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(M&&M[0]!==void 0&&M[1]!==void 0){const I=(0,h.moveToCellSequence)(M[0]-1,M[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(I,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const w=this._model.finalSelectionStart,y=this._model.finalSelectionEnd,M=!(!w||!y||w[0]===y[0]&&w[1]===y[1]);M?w&&y&&(this._oldSelectionStart&&this._oldSelectionEnd&&w[0]===this._oldSelectionStart[0]&&w[1]===this._oldSelectionStart[1]&&y[0]===this._oldSelectionEnd[0]&&y[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(w,y,M)):this._oldHasSelection&&this._fireOnSelectionChange(w,y,M)}_fireOnSelectionChange(w,y,M){this._oldSelectionStart=w,this._oldSelectionEnd=y,this._oldHasSelection=M,this._onSelectionChange.fire()}_handleBufferActivate(w){this.clearSelection(),this._trimListener.dispose(),this._trimListener=w.activeBuffer.lines.onTrim(y=>this._handleTrim(y))}_convertViewportColToCharacterIndex(w,y){let M=y;for(let I=0;y>=I;I++){const C=w.loadCell(I,this._workCell).getChars().length;this._workCell.getWidth()===0?M--:C>1&&y!==I&&(M+=C-1)}return M}setSelection(w,y,M){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[w,y],this._model.selectionStartLength=M,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(w){this._isClickInSelection(w)||(this._selectWordAtCursor(w,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(w,y,M=!0,I=!0){if(w[0]>=this._bufferService.cols)return;const C=this._bufferService.buffer,D=C.lines.get(w[1]);if(!D)return;const A=C.translateBufferLineToString(w[1],!1);let H=this._convertViewportColToCharacterIndex(D,w[0]),N=H;const F=w[0]-H;let L=0,B=0,O=0,P=0;if(A.charAt(H)===" "){for(;H>0&&A.charAt(H-1)===" ";)H--;for(;N<A.length&&A.charAt(N+1)===" ";)N++}else{let U=w[0],j=w[0];D.getWidth(U)===0&&(L++,U--),D.getWidth(j)===2&&(B++,j++);const Y=D.getString(j).length;for(Y>1&&(P+=Y-1,N+=Y-1);U>0&&H>0&&!this._isCharWordSeparator(D.loadCell(U-1,this._workCell));){D.loadCell(U-1,this._workCell);const R=this._workCell.getChars().length;this._workCell.getWidth()===0?(L++,U--):R>1&&(O+=R-1,H-=R-1),H--,U--}for(;j<D.length&&N+1<A.length&&!this._isCharWordSeparator(D.loadCell(j+1,this._workCell));){D.loadCell(j+1,this._workCell);const R=this._workCell.getChars().length;this._workCell.getWidth()===2?(B++,j++):R>1&&(P+=R-1,N+=R-1),N++,j++}}N++;let z=H+F-L+O,W=Math.min(this._bufferService.cols,N-H+L+B-O-P);if(y||A.slice(H,N).trim()!==""){if(M&&z===0&&D.getCodePoint(0)!==32){const U=C.lines.get(w[1]-1);if(U&&D.isWrapped&&U.getCodePoint(this._bufferService.cols-1)!==32){const j=this._getWordAt([this._bufferService.cols-1,w[1]-1],!1,!0,!1);if(j){const Y=this._bufferService.cols-j.start;z-=Y,W+=Y}}}if(I&&z+W===this._bufferService.cols&&D.getCodePoint(this._bufferService.cols-1)!==32){const U=C.lines.get(w[1]+1);if(U!=null&&U.isWrapped&&U.getCodePoint(0)!==32){const j=this._getWordAt([0,w[1]+1],!1,!1,!0);j&&(W+=j.length)}}return{start:z,length:W}}}_selectWordAt(w,y){const M=this._getWordAt(w,y);if(M){for(;M.start<0;)M.start+=this._bufferService.cols,w[1]--;this._model.selectionStart=[M.start,w[1]],this._model.selectionStartLength=M.length}}_selectToWordAt(w){const y=this._getWordAt(w,!0);if(y){let M=w[1];for(;y.start<0;)y.start+=this._bufferService.cols,M--;if(!this._model.areSelectionValuesReversed())for(;y.start+y.length>this._bufferService.cols;)y.length-=this._bufferService.cols,M++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?y.start:y.start+y.length,M]}}_isCharWordSeparator(w){return w.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(w.getChars())>=0}_selectLineAt(w){const y=this._bufferService.buffer.getWrappedRangeForLine(w),M={start:{x:0,y:y.first},end:{x:this._bufferService.cols-1,y:y.last}};this._model.selectionStart=[0,y.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,o.getRangeLength)(M,this._bufferService.cols)}};n.SelectionService=T=l([p(3,m.IBufferService),p(4,m.ICoreService),p(5,u.IMouseService),p(6,m.IOptionsService),p(7,u.IRenderService),p(8,u.ICoreBrowserService)],T)},4725:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.IThemeService=n.ICharacterJoinerService=n.ISelectionService=n.IRenderService=n.IMouseService=n.ICoreBrowserService=n.ICharSizeService=void 0;const l=s(8343);n.ICharSizeService=(0,l.createDecorator)("CharSizeService"),n.ICoreBrowserService=(0,l.createDecorator)("CoreBrowserService"),n.IMouseService=(0,l.createDecorator)("MouseService"),n.IRenderService=(0,l.createDecorator)("RenderService"),n.ISelectionService=(0,l.createDecorator)("SelectionService"),n.ICharacterJoinerService=(0,l.createDecorator)("CharacterJoinerService"),n.IThemeService=(0,l.createDecorator)("ThemeService")},6731:function(S,n,s){var l=this&&this.__decorate||function(T,w,y,M){var I,C=arguments.length,D=C<3?w:M===null?M=Object.getOwnPropertyDescriptor(w,y):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(T,w,y,M);else for(var A=T.length-1;A>=0;A--)(I=T[A])&&(D=(C<3?I(D):C>3?I(w,y,D):I(w,y))||D);return C>3&&D&&Object.defineProperty(w,y,D),D},p=this&&this.__param||function(T,w){return function(y,M){w(y,M,T)}};Object.defineProperty(n,"__esModule",{value:!0}),n.ThemeService=n.DEFAULT_ANSI_COLORS=void 0;const a=s(7239),h=s(8055),f=s(8460),u=s(844),d=s(2585),t=h.css.toColor("#ffffff"),i=h.css.toColor("#000000"),o=h.css.toColor("#ffffff"),r=h.css.toColor("#000000"),m={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};n.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const T=[h.css.toColor("#2e3436"),h.css.toColor("#cc0000"),h.css.toColor("#4e9a06"),h.css.toColor("#c4a000"),h.css.toColor("#3465a4"),h.css.toColor("#75507b"),h.css.toColor("#06989a"),h.css.toColor("#d3d7cf"),h.css.toColor("#555753"),h.css.toColor("#ef2929"),h.css.toColor("#8ae234"),h.css.toColor("#fce94f"),h.css.toColor("#729fcf"),h.css.toColor("#ad7fa8"),h.css.toColor("#34e2e2"),h.css.toColor("#eeeeec")],w=[0,95,135,175,215,255];for(let y=0;y<216;y++){const M=w[y/36%6|0],I=w[y/6%6|0],C=w[y%6];T.push({css:h.channels.toCss(M,I,C),rgba:h.channels.toRgba(M,I,C)})}for(let y=0;y<24;y++){const M=8+10*y;T.push({css:h.channels.toCss(M,M,M),rgba:h.channels.toRgba(M,M,M)})}return T})());let g=n.ThemeService=class extends u.Disposable{get colors(){return this._colors}constructor(T){super(),this._optionsService=T,this._contrastCache=new a.ColorContrastCache,this._halfContrastCache=new a.ColorContrastCache,this._onChangeColors=this.register(new f.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:t,background:i,cursor:o,cursorAccent:r,selectionForeground:void 0,selectionBackgroundTransparent:m,selectionBackgroundOpaque:h.color.blend(i,m),selectionInactiveBackgroundTransparent:m,selectionInactiveBackgroundOpaque:h.color.blend(i,m),ansi:n.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(T={}){const w=this._colors;if(w.foreground=E(T.foreground,t),w.background=E(T.background,i),w.cursor=E(T.cursor,o),w.cursorAccent=E(T.cursorAccent,r),w.selectionBackgroundTransparent=E(T.selectionBackground,m),w.selectionBackgroundOpaque=h.color.blend(w.background,w.selectionBackgroundTransparent),w.selectionInactiveBackgroundTransparent=E(T.selectionInactiveBackground,w.selectionBackgroundTransparent),w.selectionInactiveBackgroundOpaque=h.color.blend(w.background,w.selectionInactiveBackgroundTransparent),w.selectionForeground=T.selectionForeground?E(T.selectionForeground,h.NULL_COLOR):void 0,w.selectionForeground===h.NULL_COLOR&&(w.selectionForeground=void 0),h.color.isOpaque(w.selectionBackgroundTransparent)&&(w.selectionBackgroundTransparent=h.color.opacity(w.selectionBackgroundTransparent,.3)),h.color.isOpaque(w.selectionInactiveBackgroundTransparent)&&(w.selectionInactiveBackgroundTransparent=h.color.opacity(w.selectionInactiveBackgroundTransparent,.3)),w.ansi=n.DEFAULT_ANSI_COLORS.slice(),w.ansi[0]=E(T.black,n.DEFAULT_ANSI_COLORS[0]),w.ansi[1]=E(T.red,n.DEFAULT_ANSI_COLORS[1]),w.ansi[2]=E(T.green,n.DEFAULT_ANSI_COLORS[2]),w.ansi[3]=E(T.yellow,n.DEFAULT_ANSI_COLORS[3]),w.ansi[4]=E(T.blue,n.DEFAULT_ANSI_COLORS[4]),w.ansi[5]=E(T.magenta,n.DEFAULT_ANSI_COLORS[5]),w.ansi[6]=E(T.cyan,n.DEFAULT_ANSI_COLORS[6]),w.ansi[7]=E(T.white,n.DEFAULT_ANSI_COLORS[7]),w.ansi[8]=E(T.brightBlack,n.DEFAULT_ANSI_COLORS[8]),w.ansi[9]=E(T.brightRed,n.DEFAULT_ANSI_COLORS[9]),w.ansi[10]=E(T.brightGreen,n.DEFAULT_ANSI_COLORS[10]),w.ansi[11]=E(T.brightYellow,n.DEFAULT_ANSI_COLORS[11]),w.ansi[12]=E(T.brightBlue,n.DEFAULT_ANSI_COLORS[12]),w.ansi[13]=E(T.brightMagenta,n.DEFAULT_ANSI_COLORS[13]),w.ansi[14]=E(T.brightCyan,n.DEFAULT_ANSI_COLORS[14]),w.ansi[15]=E(T.brightWhite,n.DEFAULT_ANSI_COLORS[15]),T.extendedAnsi){const y=Math.min(w.ansi.length-16,T.extendedAnsi.length);for(let M=0;M<y;M++)w.ansi[M+16]=E(T.extendedAnsi[M],n.DEFAULT_ANSI_COLORS[M+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(T){this._restoreColor(T),this._onChangeColors.fire(this.colors)}_restoreColor(T){if(T!==void 0)switch(T){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[T]=this._restoreColors.ansi[T]}else for(let w=0;w<this._restoreColors.ansi.length;++w)this._colors.ansi[w]=this._restoreColors.ansi[w]}modifyColors(T){T(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function E(T,w){if(T!==void 0)try{return h.css.toColor(T)}catch{}return w}n.ThemeService=g=l([p(0,d.IOptionsService)],g)},6349:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CircularList=void 0;const l=s(8460),p=s(844);class a extends p.Disposable{constructor(f){super(),this._maxLength=f,this.onDeleteEmitter=this.register(new l.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new l.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new l.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(f){if(this._maxLength===f)return;const u=new Array(f);for(let d=0;d<Math.min(f,this.length);d++)u[d]=this._array[this._getCyclicIndex(d)];this._array=u,this._maxLength=f,this._startIndex=0}get length(){return this._length}set length(f){if(f>this._length)for(let u=this._length;u<f;u++)this._array[u]=void 0;this._length=f}get(f){return this._array[this._getCyclicIndex(f)]}set(f,u){this._array[this._getCyclicIndex(f)]=u}push(f){this._array[this._getCyclicIndex(this._length)]=f,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(f,u,...d){if(u){for(let t=f;t<this._length-u;t++)this._array[this._getCyclicIndex(t)]=this._array[this._getCyclicIndex(t+u)];this._length-=u,this.onDeleteEmitter.fire({index:f,amount:u})}for(let t=this._length-1;t>=f;t--)this._array[this._getCyclicIndex(t+d.length)]=this._array[this._getCyclicIndex(t)];for(let t=0;t<d.length;t++)this._array[this._getCyclicIndex(f+t)]=d[t];if(d.length&&this.onInsertEmitter.fire({index:f,amount:d.length}),this._length+d.length>this._maxLength){const t=this._length+d.length-this._maxLength;this._startIndex+=t,this._length=this._maxLength,this.onTrimEmitter.fire(t)}else this._length+=d.length}trimStart(f){f>this._length&&(f=this._length),this._startIndex+=f,this._length-=f,this.onTrimEmitter.fire(f)}shiftElements(f,u,d){if(!(u<=0)){if(f<0||f>=this._length)throw new Error("start argument out of range");if(f+d<0)throw new Error("Cannot shift elements in list beyond index 0");if(d>0){for(let i=u-1;i>=0;i--)this.set(f+i+d,this.get(f+i));const t=f+u+d-this._length;if(t>0)for(this._length+=t;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let t=0;t<u;t++)this.set(f+t+d,this.get(f+t))}}_getCyclicIndex(f){return(this._startIndex+f)%this._maxLength}}n.CircularList=a},1439:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.clone=void 0,n.clone=function s(l,p=5){if(typeof l!="object")return l;const a=Array.isArray(l)?[]:{};for(const h in l)a[h]=p<=1?l[h]:l[h]&&s(l[h],p-1);return a}},8055:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.contrastRatio=n.toPaddedHex=n.rgba=n.rgb=n.css=n.color=n.channels=n.NULL_COLOR=void 0;const l=s(6114);let p=0,a=0,h=0,f=0;var u,d,t,i,o;function r(g){const E=g.toString(16);return E.length<2?"0"+E:E}function m(g,E){return g<E?(E+.05)/(g+.05):(g+.05)/(E+.05)}n.NULL_COLOR={css:"#00000000",rgba:0},function(g){g.toCss=function(E,T,w,y){return y!==void 0?`#${r(E)}${r(T)}${r(w)}${r(y)}`:`#${r(E)}${r(T)}${r(w)}`},g.toRgba=function(E,T,w,y=255){return(E<<24|T<<16|w<<8|y)>>>0}}(u||(n.channels=u={})),function(g){function E(T,w){return f=Math.round(255*w),[p,a,h]=o.toChannels(T.rgba),{css:u.toCss(p,a,h,f),rgba:u.toRgba(p,a,h,f)}}g.blend=function(T,w){if(f=(255&w.rgba)/255,f===1)return{css:w.css,rgba:w.rgba};const y=w.rgba>>24&255,M=w.rgba>>16&255,I=w.rgba>>8&255,C=T.rgba>>24&255,D=T.rgba>>16&255,A=T.rgba>>8&255;return p=C+Math.round((y-C)*f),a=D+Math.round((M-D)*f),h=A+Math.round((I-A)*f),{css:u.toCss(p,a,h),rgba:u.toRgba(p,a,h)}},g.isOpaque=function(T){return(255&T.rgba)==255},g.ensureContrastRatio=function(T,w,y){const M=o.ensureContrastRatio(T.rgba,w.rgba,y);if(M)return o.toColor(M>>24&255,M>>16&255,M>>8&255)},g.opaque=function(T){const w=(255|T.rgba)>>>0;return[p,a,h]=o.toChannels(w),{css:u.toCss(p,a,h),rgba:w}},g.opacity=E,g.multiplyOpacity=function(T,w){return f=255&T.rgba,E(T,f*w/255)},g.toColorRGB=function(T){return[T.rgba>>24&255,T.rgba>>16&255,T.rgba>>8&255]}}(d||(n.color=d={})),function(g){let E,T;if(!l.isNode){const w=document.createElement("canvas");w.width=1,w.height=1;const y=w.getContext("2d",{willReadFrequently:!0});y&&(E=y,E.globalCompositeOperation="copy",T=E.createLinearGradient(0,0,1,1))}g.toColor=function(w){if(w.match(/#[\da-f]{3,8}/i))switch(w.length){case 4:return p=parseInt(w.slice(1,2).repeat(2),16),a=parseInt(w.slice(2,3).repeat(2),16),h=parseInt(w.slice(3,4).repeat(2),16),o.toColor(p,a,h);case 5:return p=parseInt(w.slice(1,2).repeat(2),16),a=parseInt(w.slice(2,3).repeat(2),16),h=parseInt(w.slice(3,4).repeat(2),16),f=parseInt(w.slice(4,5).repeat(2),16),o.toColor(p,a,h,f);case 7:return{css:w,rgba:(parseInt(w.slice(1),16)<<8|255)>>>0};case 9:return{css:w,rgba:parseInt(w.slice(1),16)>>>0}}const y=w.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(y)return p=parseInt(y[1]),a=parseInt(y[2]),h=parseInt(y[3]),f=Math.round(255*(y[5]===void 0?1:parseFloat(y[5]))),o.toColor(p,a,h,f);if(!E||!T)throw new Error("css.toColor: Unsupported css format");if(E.fillStyle=T,E.fillStyle=w,typeof E.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(E.fillRect(0,0,1,1),[p,a,h,f]=E.getImageData(0,0,1,1).data,f!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:u.toRgba(p,a,h,f),css:w}}}(t||(n.css=t={})),function(g){function E(T,w,y){const M=T/255,I=w/255,C=y/255;return .2126*(M<=.03928?M/12.92:Math.pow((M+.055)/1.055,2.4))+.7152*(I<=.03928?I/12.92:Math.pow((I+.055)/1.055,2.4))+.0722*(C<=.03928?C/12.92:Math.pow((C+.055)/1.055,2.4))}g.relativeLuminance=function(T){return E(T>>16&255,T>>8&255,255&T)},g.relativeLuminance2=E}(i||(n.rgb=i={})),function(g){function E(w,y,M){const I=w>>24&255,C=w>>16&255,D=w>>8&255;let A=y>>24&255,H=y>>16&255,N=y>>8&255,F=m(i.relativeLuminance2(A,H,N),i.relativeLuminance2(I,C,D));for(;F<M&&(A>0||H>0||N>0);)A-=Math.max(0,Math.ceil(.1*A)),H-=Math.max(0,Math.ceil(.1*H)),N-=Math.max(0,Math.ceil(.1*N)),F=m(i.relativeLuminance2(A,H,N),i.relativeLuminance2(I,C,D));return(A<<24|H<<16|N<<8|255)>>>0}function T(w,y,M){const I=w>>24&255,C=w>>16&255,D=w>>8&255;let A=y>>24&255,H=y>>16&255,N=y>>8&255,F=m(i.relativeLuminance2(A,H,N),i.relativeLuminance2(I,C,D));for(;F<M&&(A<255||H<255||N<255);)A=Math.min(255,A+Math.ceil(.1*(255-A))),H=Math.min(255,H+Math.ceil(.1*(255-H))),N=Math.min(255,N+Math.ceil(.1*(255-N))),F=m(i.relativeLuminance2(A,H,N),i.relativeLuminance2(I,C,D));return(A<<24|H<<16|N<<8|255)>>>0}g.ensureContrastRatio=function(w,y,M){const I=i.relativeLuminance(w>>8),C=i.relativeLuminance(y>>8);if(m(I,C)<M){if(C<I){const H=E(w,y,M),N=m(I,i.relativeLuminance(H>>8));if(N<M){const F=T(w,y,M);return N>m(I,i.relativeLuminance(F>>8))?H:F}return H}const D=T(w,y,M),A=m(I,i.relativeLuminance(D>>8));if(A<M){const H=E(w,y,M);return A>m(I,i.relativeLuminance(H>>8))?D:H}return D}},g.reduceLuminance=E,g.increaseLuminance=T,g.toChannels=function(w){return[w>>24&255,w>>16&255,w>>8&255,255&w]},g.toColor=function(w,y,M,I){return{css:u.toCss(w,y,M,I),rgba:u.toRgba(w,y,M,I)}}}(o||(n.rgba=o={})),n.toPaddedHex=r,n.contrastRatio=m},8969:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CoreTerminal=void 0;const l=s(844),p=s(2585),a=s(4348),h=s(7866),f=s(744),u=s(7302),d=s(6975),t=s(8460),i=s(1753),o=s(1480),r=s(7994),m=s(9282),g=s(5435),E=s(5981),T=s(2660);let w=!1;class y extends l.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new t.EventEmitter),this._onScroll.event(I=>{var C;(C=this._onScrollApi)===null||C===void 0||C.fire(I.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(I){for(const C in I)this.optionsService.options[C]=I[C]}constructor(I){super(),this._windowsWrappingHeuristics=this.register(new l.MutableDisposable),this._onBinary=this.register(new t.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new t.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new t.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new t.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new t.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new t.EventEmitter),this._instantiationService=new a.InstantiationService,this.optionsService=this.register(new u.OptionsService(I)),this._instantiationService.setService(p.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(f.BufferService)),this._instantiationService.setService(p.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(h.LogService)),this._instantiationService.setService(p.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(d.CoreService)),this._instantiationService.setService(p.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(i.CoreMouseService)),this._instantiationService.setService(p.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(o.UnicodeService)),this._instantiationService.setService(p.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(r.CharsetService),this._instantiationService.setService(p.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(T.OscLinkService),this._instantiationService.setService(p.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new g.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,t.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,t.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,t.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,t.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(C=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(C=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new E.WriteBuffer((C,D)=>this._inputHandler.parse(C,D))),this.register((0,t.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(I,C){this._writeBuffer.write(I,C)}writeSync(I,C){this._logService.logLevel<=p.LogLevelEnum.WARN&&!w&&(this._logService.warn("writeSync is unreliable and will be removed soon."),w=!0),this._writeBuffer.writeSync(I,C)}resize(I,C){isNaN(I)||isNaN(C)||(I=Math.max(I,f.MINIMUM_COLS),C=Math.max(C,f.MINIMUM_ROWS),this._bufferService.resize(I,C))}scroll(I,C=!1){this._bufferService.scroll(I,C)}scrollLines(I,C,D){this._bufferService.scrollLines(I,C,D)}scrollPages(I){this.scrollLines(I*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(I){const C=I-this._bufferService.buffer.ydisp;C!==0&&this.scrollLines(C)}registerEscHandler(I,C){return this._inputHandler.registerEscHandler(I,C)}registerDcsHandler(I,C){return this._inputHandler.registerDcsHandler(I,C)}registerCsiHandler(I,C){return this._inputHandler.registerCsiHandler(I,C)}registerOscHandler(I,C){return this._inputHandler.registerOscHandler(I,C)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let I=!1;const C=this.optionsService.rawOptions.windowsPty;C&&C.buildNumber!==void 0&&C.buildNumber!==void 0?I=C.backend==="conpty"&&C.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(I=!0),I?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const I=[];I.push(this.onLineFeed(m.updateWindowsModeWrappedState.bind(null,this._bufferService))),I.push(this.registerCsiHandler({final:"H"},()=>((0,m.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,l.toDisposable)(()=>{for(const C of I)C.dispose()})}}}n.CoreTerminal=y},8460:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.forwardEvent=n.EventEmitter=void 0,n.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=s=>(this._listeners.push(s),{dispose:()=>{if(!this._disposed){for(let l=0;l<this._listeners.length;l++)if(this._listeners[l]===s)return void this._listeners.splice(l,1)}}})),this._event}fire(s,l){const p=[];for(let a=0;a<this._listeners.length;a++)p.push(this._listeners[a]);for(let a=0;a<p.length;a++)p[a].call(void 0,s,l)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},n.forwardEvent=function(s,l){return s(p=>l.fire(p))}},5435:function(S,n,s){var l=this&&this.__decorate||function(F,L,B,O){var P,z=arguments.length,W=z<3?L:O===null?O=Object.getOwnPropertyDescriptor(L,B):O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")W=Reflect.decorate(F,L,B,O);else for(var U=F.length-1;U>=0;U--)(P=F[U])&&(W=(z<3?P(W):z>3?P(L,B,W):P(L,B))||W);return z>3&&W&&Object.defineProperty(L,B,W),W},p=this&&this.__param||function(F,L){return function(B,O){L(B,O,F)}};Object.defineProperty(n,"__esModule",{value:!0}),n.InputHandler=n.WindowsOptionsReportType=void 0;const a=s(2584),h=s(7116),f=s(2015),u=s(844),d=s(482),t=s(8437),i=s(8460),o=s(643),r=s(511),m=s(3734),g=s(2585),E=s(6242),T=s(6351),w=s(5941),y={"(":0,")":1,"*":2,"+":3,"-":1,".":2},M=131072;function I(F,L){if(F>24)return L.setWinLines||!1;switch(F){case 1:return!!L.restoreWin;case 2:return!!L.minimizeWin;case 3:return!!L.setWinPosition;case 4:return!!L.setWinSizePixels;case 5:return!!L.raiseWin;case 6:return!!L.lowerWin;case 7:return!!L.refreshWin;case 8:return!!L.setWinSizeChars;case 9:return!!L.maximizeWin;case 10:return!!L.fullscreenWin;case 11:return!!L.getWinState;case 13:return!!L.getWinPosition;case 14:return!!L.getWinSizePixels;case 15:return!!L.getScreenSizePixels;case 16:return!!L.getCellSizePixels;case 18:return!!L.getWinSizeChars;case 19:return!!L.getScreenSizeChars;case 20:return!!L.getIconTitle;case 21:return!!L.getWinTitle;case 22:return!!L.pushTitle;case 23:return!!L.popTitle;case 24:return!!L.setWinLines}return!1}var C;(function(F){F[F.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",F[F.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(C||(n.WindowsOptionsReportType=C={}));let D=0;class A extends u.Disposable{getAttrData(){return this._curAttrData}constructor(L,B,O,P,z,W,U,j,Y=new f.EscapeSequenceParser){super(),this._bufferService=L,this._charsetService=B,this._coreService=O,this._logService=P,this._optionsService=z,this._oscLinkService=W,this._coreMouseService=U,this._unicodeService=j,this._parser=Y,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new d.StringToUtf32,this._utf8Decoder=new d.Utf8ToUtf32,this._workCell=new r.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=t.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new i.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new i.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new i.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new i.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new i.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new i.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new i.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new i.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new i.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new i.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new i.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new i.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new i.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new H(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(R=>this._activeBuffer=R.activeBuffer)),this._parser.setCsiHandlerFallback((R,$)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(R),params:$.toArray()})}),this._parser.setEscHandlerFallback(R=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(R)})}),this._parser.setExecuteHandlerFallback(R=>{this._logService.debug("Unknown EXECUTE code: ",{code:R})}),this._parser.setOscHandlerFallback((R,$,q)=>{this._logService.debug("Unknown OSC code: ",{identifier:R,action:$,data:q})}),this._parser.setDcsHandlerFallback((R,$,q)=>{$==="HOOK"&&(q=q.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(R),action:$,payload:q})}),this._parser.setPrintHandler((R,$,q)=>this.print(R,$,q)),this._parser.registerCsiHandler({final:"@"},R=>this.insertChars(R)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},R=>this.scrollLeft(R)),this._parser.registerCsiHandler({final:"A"},R=>this.cursorUp(R)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},R=>this.scrollRight(R)),this._parser.registerCsiHandler({final:"B"},R=>this.cursorDown(R)),this._parser.registerCsiHandler({final:"C"},R=>this.cursorForward(R)),this._parser.registerCsiHandler({final:"D"},R=>this.cursorBackward(R)),this._parser.registerCsiHandler({final:"E"},R=>this.cursorNextLine(R)),this._parser.registerCsiHandler({final:"F"},R=>this.cursorPrecedingLine(R)),this._parser.registerCsiHandler({final:"G"},R=>this.cursorCharAbsolute(R)),this._parser.registerCsiHandler({final:"H"},R=>this.cursorPosition(R)),this._parser.registerCsiHandler({final:"I"},R=>this.cursorForwardTab(R)),this._parser.registerCsiHandler({final:"J"},R=>this.eraseInDisplay(R,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},R=>this.eraseInDisplay(R,!0)),this._parser.registerCsiHandler({final:"K"},R=>this.eraseInLine(R,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},R=>this.eraseInLine(R,!0)),this._parser.registerCsiHandler({final:"L"},R=>this.insertLines(R)),this._parser.registerCsiHandler({final:"M"},R=>this.deleteLines(R)),this._parser.registerCsiHandler({final:"P"},R=>this.deleteChars(R)),this._parser.registerCsiHandler({final:"S"},R=>this.scrollUp(R)),this._parser.registerCsiHandler({final:"T"},R=>this.scrollDown(R)),this._parser.registerCsiHandler({final:"X"},R=>this.eraseChars(R)),this._parser.registerCsiHandler({final:"Z"},R=>this.cursorBackwardTab(R)),this._parser.registerCsiHandler({final:"`"},R=>this.charPosAbsolute(R)),this._parser.registerCsiHandler({final:"a"},R=>this.hPositionRelative(R)),this._parser.registerCsiHandler({final:"b"},R=>this.repeatPrecedingCharacter(R)),this._parser.registerCsiHandler({final:"c"},R=>this.sendDeviceAttributesPrimary(R)),this._parser.registerCsiHandler({prefix:">",final:"c"},R=>this.sendDeviceAttributesSecondary(R)),this._parser.registerCsiHandler({final:"d"},R=>this.linePosAbsolute(R)),this._parser.registerCsiHandler({final:"e"},R=>this.vPositionRelative(R)),this._parser.registerCsiHandler({final:"f"},R=>this.hVPosition(R)),this._parser.registerCsiHandler({final:"g"},R=>this.tabClear(R)),this._parser.registerCsiHandler({final:"h"},R=>this.setMode(R)),this._parser.registerCsiHandler({prefix:"?",final:"h"},R=>this.setModePrivate(R)),this._parser.registerCsiHandler({final:"l"},R=>this.resetMode(R)),this._parser.registerCsiHandler({prefix:"?",final:"l"},R=>this.resetModePrivate(R)),this._parser.registerCsiHandler({final:"m"},R=>this.charAttributes(R)),this._parser.registerCsiHandler({final:"n"},R=>this.deviceStatus(R)),this._parser.registerCsiHandler({prefix:"?",final:"n"},R=>this.deviceStatusPrivate(R)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},R=>this.softReset(R)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},R=>this.setCursorStyle(R)),this._parser.registerCsiHandler({final:"r"},R=>this.setScrollRegion(R)),this._parser.registerCsiHandler({final:"s"},R=>this.saveCursor(R)),this._parser.registerCsiHandler({final:"t"},R=>this.windowOptions(R)),this._parser.registerCsiHandler({final:"u"},R=>this.restoreCursor(R)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},R=>this.insertColumns(R)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},R=>this.deleteColumns(R)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},R=>this.selectProtected(R)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},R=>this.requestMode(R,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},R=>this.requestMode(R,!1)),this._parser.setExecuteHandler(a.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(a.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(a.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(a.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(a.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(a.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(a.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(a.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(a.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(a.C1.IND,()=>this.index()),this._parser.setExecuteHandler(a.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(a.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new E.OscHandler(R=>(this.setTitle(R),this.setIconName(R),!0))),this._parser.registerOscHandler(1,new E.OscHandler(R=>this.setIconName(R))),this._parser.registerOscHandler(2,new E.OscHandler(R=>this.setTitle(R))),this._parser.registerOscHandler(4,new E.OscHandler(R=>this.setOrReportIndexedColor(R))),this._parser.registerOscHandler(8,new E.OscHandler(R=>this.setHyperlink(R))),this._parser.registerOscHandler(10,new E.OscHandler(R=>this.setOrReportFgColor(R))),this._parser.registerOscHandler(11,new E.OscHandler(R=>this.setOrReportBgColor(R))),this._parser.registerOscHandler(12,new E.OscHandler(R=>this.setOrReportCursorColor(R))),this._parser.registerOscHandler(104,new E.OscHandler(R=>this.restoreIndexedColor(R))),this._parser.registerOscHandler(110,new E.OscHandler(R=>this.restoreFgColor(R))),this._parser.registerOscHandler(111,new E.OscHandler(R=>this.restoreBgColor(R))),this._parser.registerOscHandler(112,new E.OscHandler(R=>this.restoreCursorColor(R))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const R in h.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:R},()=>this.selectCharset("("+R)),this._parser.registerEscHandler({intermediates:")",final:R},()=>this.selectCharset(")"+R)),this._parser.registerEscHandler({intermediates:"*",final:R},()=>this.selectCharset("*"+R)),this._parser.registerEscHandler({intermediates:"+",final:R},()=>this.selectCharset("+"+R)),this._parser.registerEscHandler({intermediates:"-",final:R},()=>this.selectCharset("-"+R)),this._parser.registerEscHandler({intermediates:".",final:R},()=>this.selectCharset("."+R)),this._parser.registerEscHandler({intermediates:"/",final:R},()=>this.selectCharset("/"+R));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(R=>(this._logService.error("Parsing error: ",R),R)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new T.DcsHandler((R,$)=>this.requestStatusString(R,$)))}_preserveStack(L,B,O,P){this._parseStack.paused=!0,this._parseStack.cursorStartX=L,this._parseStack.cursorStartY=B,this._parseStack.decodedLength=O,this._parseStack.position=P}_logSlowResolvingAsync(L){this._logService.logLevel<=g.LogLevelEnum.WARN&&Promise.race([L,new Promise((B,O)=>setTimeout(()=>O("#SLOW_TIMEOUT"),5e3))]).catch(B=>{if(B!=="#SLOW_TIMEOUT")throw B;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(L,B){let O,P=this._activeBuffer.x,z=this._activeBuffer.y,W=0;const U=this._parseStack.paused;if(U){if(O=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,B))return this._logSlowResolvingAsync(O),O;P=this._parseStack.cursorStartX,z=this._parseStack.cursorStartY,this._parseStack.paused=!1,L.length>M&&(W=this._parseStack.position+M)}if(this._logService.logLevel<=g.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof L=="string"?` "${L}"`:` "${Array.prototype.map.call(L,j=>String.fromCharCode(j)).join("")}"`),typeof L=="string"?L.split("").map(j=>j.charCodeAt(0)):L),this._parseBuffer.length<L.length&&this._parseBuffer.length<M&&(this._parseBuffer=new Uint32Array(Math.min(L.length,M))),U||this._dirtyRowTracker.clearRange(),L.length>M)for(let j=W;j<L.length;j+=M){const Y=j+M<L.length?j+M:L.length,R=typeof L=="string"?this._stringDecoder.decode(L.substring(j,Y),this._parseBuffer):this._utf8Decoder.decode(L.subarray(j,Y),this._parseBuffer);if(O=this._parser.parse(this._parseBuffer,R))return this._preserveStack(P,z,R,j),this._logSlowResolvingAsync(O),O}else if(!U){const j=typeof L=="string"?this._stringDecoder.decode(L,this._parseBuffer):this._utf8Decoder.decode(L,this._parseBuffer);if(O=this._parser.parse(this._parseBuffer,j))return this._preserveStack(P,z,j,0),this._logSlowResolvingAsync(O),O}this._activeBuffer.x===P&&this._activeBuffer.y===z||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(L,B,O){let P,z;const W=this._charsetService.charset,U=this._optionsService.rawOptions.screenReaderMode,j=this._bufferService.cols,Y=this._coreService.decPrivateModes.wraparound,R=this._coreService.modes.insertMode,$=this._curAttrData;let q=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&O-B>0&&q.getWidth(this._activeBuffer.x-1)===2&&q.setCellFromCodePoint(this._activeBuffer.x-1,0,1,$.fg,$.bg,$.extended);for(let X=B;X<O;++X){if(P=L[X],z=this._unicodeService.wcwidth(P),P<127&&W){const se=W[String.fromCharCode(P)];se&&(P=se.charCodeAt(0))}if(U&&this._onA11yChar.fire((0,d.stringFromCodePoint)(P)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),z||!this._activeBuffer.x){if(this._activeBuffer.x+z-1>=j){if(Y){for(;this._activeBuffer.x<j;)q.setCellFromCodePoint(this._activeBuffer.x++,0,1,$.fg,$.bg,$.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),q=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=j-1,z===2)continue}if(R&&(q.insertCells(this._activeBuffer.x,z,this._activeBuffer.getNullCell($),$),q.getWidth(j-1)===2&&q.setCellFromCodePoint(j-1,o.NULL_CELL_CODE,o.NULL_CELL_WIDTH,$.fg,$.bg,$.extended)),q.setCellFromCodePoint(this._activeBuffer.x++,P,z,$.fg,$.bg,$.extended),z>0)for(;--z;)q.setCellFromCodePoint(this._activeBuffer.x++,0,0,$.fg,$.bg,$.extended)}else q.getWidth(this._activeBuffer.x-1)?q.addCodepointToCell(this._activeBuffer.x-1,P):q.addCodepointToCell(this._activeBuffer.x-2,P)}O-B>0&&(q.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<j&&O-B>0&&q.getWidth(this._activeBuffer.x)===0&&!q.hasContent(this._activeBuffer.x)&&q.setCellFromCodePoint(this._activeBuffer.x,0,1,$.fg,$.bg,$.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(L,B){return L.final!=="t"||L.prefix||L.intermediates?this._parser.registerCsiHandler(L,B):this._parser.registerCsiHandler(L,O=>!I(O.params[0],this._optionsService.rawOptions.windowOptions)||B(O))}registerDcsHandler(L,B){return this._parser.registerDcsHandler(L,new T.DcsHandler(B))}registerEscHandler(L,B){return this._parser.registerEscHandler(L,B)}registerOscHandler(L,B){return this._parser.registerOscHandler(L,new E.OscHandler(B))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var L;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||L===void 0)&&L.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);B.hasWidth(this._activeBuffer.x)&&!B.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const L=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-L),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(L=this._bufferService.cols-1){this._activeBuffer.x=Math.min(L,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(L,B){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=L,this._activeBuffer.y=this._activeBuffer.scrollTop+B):(this._activeBuffer.x=L,this._activeBuffer.y=B),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(L,B){this._restrictCursor(),this._setCursor(this._activeBuffer.x+L,this._activeBuffer.y+B)}cursorUp(L){const B=this._activeBuffer.y-this._activeBuffer.scrollTop;return B>=0?this._moveCursor(0,-Math.min(B,L.params[0]||1)):this._moveCursor(0,-(L.params[0]||1)),!0}cursorDown(L){const B=this._activeBuffer.scrollBottom-this._activeBuffer.y;return B>=0?this._moveCursor(0,Math.min(B,L.params[0]||1)):this._moveCursor(0,L.params[0]||1),!0}cursorForward(L){return this._moveCursor(L.params[0]||1,0),!0}cursorBackward(L){return this._moveCursor(-(L.params[0]||1),0),!0}cursorNextLine(L){return this.cursorDown(L),this._activeBuffer.x=0,!0}cursorPrecedingLine(L){return this.cursorUp(L),this._activeBuffer.x=0,!0}cursorCharAbsolute(L){return this._setCursor((L.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(L){return this._setCursor(L.length>=2?(L.params[1]||1)-1:0,(L.params[0]||1)-1),!0}charPosAbsolute(L){return this._setCursor((L.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(L){return this._moveCursor(L.params[0]||1,0),!0}linePosAbsolute(L){return this._setCursor(this._activeBuffer.x,(L.params[0]||1)-1),!0}vPositionRelative(L){return this._moveCursor(0,L.params[0]||1),!0}hVPosition(L){return this.cursorPosition(L),!0}tabClear(L){const B=L.params[0];return B===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:B===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(L){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let B=L.params[0]||1;for(;B--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(L){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let B=L.params[0]||1;for(;B--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(L){const B=L.params[0];return B===1&&(this._curAttrData.bg|=536870912),B!==2&&B!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(L,B,O,P=!1,z=!1){const W=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);W.replaceCells(B,O,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),z),P&&(W.isWrapped=!1)}_resetBufferLine(L,B=!1){const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);O&&(O.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),B),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+L),O.isWrapped=!1)}eraseInDisplay(L,B=!1){let O;switch(this._restrictCursor(this._bufferService.cols),L.params[0]){case 0:for(O=this._activeBuffer.y,this._dirtyRowTracker.markDirty(O),this._eraseInBufferLine(O++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,B);O<this._bufferService.rows;O++)this._resetBufferLine(O,B);this._dirtyRowTracker.markDirty(O);break;case 1:for(O=this._activeBuffer.y,this._dirtyRowTracker.markDirty(O),this._eraseInBufferLine(O,0,this._activeBuffer.x+1,!0,B),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(O+1).isWrapped=!1);O--;)this._resetBufferLine(O,B);this._dirtyRowTracker.markDirty(0);break;case 2:for(O=this._bufferService.rows,this._dirtyRowTracker.markDirty(O-1);O--;)this._resetBufferLine(O,B);this._dirtyRowTracker.markDirty(0);break;case 3:const P=this._activeBuffer.lines.length-this._bufferService.rows;P>0&&(this._activeBuffer.lines.trimStart(P),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-P,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-P,0),this._onScroll.fire(0))}return!0}eraseInLine(L,B=!1){switch(this._restrictCursor(this._bufferService.cols),L.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,B);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,B);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,B)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(L){this._restrictCursor();let B=L.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=this._activeBuffer.ybase+this._activeBuffer.y,P=this._bufferService.rows-1-this._activeBuffer.scrollBottom,z=this._bufferService.rows-1+this._activeBuffer.ybase-P+1;for(;B--;)this._activeBuffer.lines.splice(z-1,1),this._activeBuffer.lines.splice(O,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(L){this._restrictCursor();let B=L.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=this._activeBuffer.ybase+this._activeBuffer.y;let P;for(P=this._bufferService.rows-1-this._activeBuffer.scrollBottom,P=this._bufferService.rows-1+this._activeBuffer.ybase-P;B--;)this._activeBuffer.lines.splice(O,1),this._activeBuffer.lines.splice(P,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(L){this._restrictCursor();const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return B&&(B.insertCells(this._activeBuffer.x,L.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(L){this._restrictCursor();const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return B&&(B.deleteCells(this._activeBuffer.x,L.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(L){let B=L.params[0]||1;for(;B--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(L){let B=L.params[0]||1;for(;B--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(t.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=L.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);P.deleteCells(0,B,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=L.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);P.insertCells(0,B,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=L.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);P.insertCells(this._activeBuffer.x,B,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=L.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);P.deleteCells(this._activeBuffer.x,B,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(L){this._restrictCursor();const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return B&&(B.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(L.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(L){if(!this._parser.precedingCodepoint)return!0;const B=L.params[0]||1,O=new Uint32Array(B);for(let P=0;P<B;++P)O[P]=this._parser.precedingCodepoint;return this.print(O,0,O.length),!0}sendDeviceAttributesPrimary(L){return L.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(a.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(a.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(L){return L.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(a.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(a.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(L.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(a.C0.ESC+"[>83;40003;0c")),!0}_is(L){return(this._optionsService.rawOptions.termName+"").indexOf(L)===0}setMode(L){for(let B=0;B<L.length;B++)switch(L.params[B]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(L){for(let B=0;B<L.length;B++)switch(L.params[B]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,h.DEFAULT_CHARSET),this._charsetService.setgCharset(1,h.DEFAULT_CHARSET),this._charsetService.setgCharset(2,h.DEFAULT_CHARSET),this._charsetService.setgCharset(3,h.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(L){for(let B=0;B<L.length;B++)switch(L.params[B]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(L){for(let B=0;B<L.length;B++)switch(L.params[B]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),L.params[B]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(L,B){const O=this._coreService.decPrivateModes,{activeProtocol:P,activeEncoding:z}=this._coreMouseService,W=this._coreService,{buffers:U,cols:j}=this._bufferService,{active:Y,alt:R}=U,$=this._optionsService.rawOptions,q=he=>he?1:2,X=L.params[0];return se=X,V=B?X===2?4:X===4?q(W.modes.insertMode):X===12?3:X===20?q($.convertEol):0:X===1?q(O.applicationCursorKeys):X===3?$.windowOptions.setWinLines?j===80?2:j===132?1:0:0:X===6?q(O.origin):X===7?q(O.wraparound):X===8?3:X===9?q(P==="X10"):X===12?q($.cursorBlink):X===25?q(!W.isCursorHidden):X===45?q(O.reverseWraparound):X===66?q(O.applicationKeypad):X===67?4:X===1e3?q(P==="VT200"):X===1002?q(P==="DRAG"):X===1003?q(P==="ANY"):X===1004?q(O.sendFocus):X===1005?4:X===1006?q(z==="SGR"):X===1015?4:X===1016?q(z==="SGR_PIXELS"):X===1048?1:X===47||X===1047||X===1049?q(Y===R):X===2004?q(O.bracketedPasteMode):0,W.triggerDataEvent(`${a.C0.ESC}[${B?"":"?"}${se};${V}$y`),!0;var se,V}_updateAttrColor(L,B,O,P,z){return B===2?(L|=50331648,L&=-16777216,L|=m.AttributeData.fromColorRGB([O,P,z])):B===5&&(L&=-50331904,L|=33554432|255&O),L}_extractColor(L,B,O){const P=[0,0,-1,0,0,0];let z=0,W=0;do{if(P[W+z]=L.params[B+W],L.hasSubParams(B+W)){const U=L.getSubParams(B+W);let j=0;do P[1]===5&&(z=1),P[W+j+1+z]=U[j];while(++j<U.length&&j+W+1+z<P.length);break}if(P[1]===5&&W+z>=2||P[1]===2&&W+z>=5)break;P[1]&&(z=1)}while(++W+B<L.length&&W+z<P.length);for(let U=2;U<P.length;++U)P[U]===-1&&(P[U]=0);switch(P[0]){case 38:O.fg=this._updateAttrColor(O.fg,P[1],P[3],P[4],P[5]);break;case 48:O.bg=this._updateAttrColor(O.bg,P[1],P[3],P[4],P[5]);break;case 58:O.extended=O.extended.clone(),O.extended.underlineColor=this._updateAttrColor(O.extended.underlineColor,P[1],P[3],P[4],P[5])}return W}_processUnderline(L,B){B.extended=B.extended.clone(),(!~L||L>5)&&(L=1),B.extended.underlineStyle=L,B.fg|=268435456,L===0&&(B.fg&=-268435457),B.updateExtended()}_processSGR0(L){L.fg=t.DEFAULT_ATTR_DATA.fg,L.bg=t.DEFAULT_ATTR_DATA.bg,L.extended=L.extended.clone(),L.extended.underlineStyle=0,L.extended.underlineColor&=-67108864,L.updateExtended()}charAttributes(L){if(L.length===1&&L.params[0]===0)return this._processSGR0(this._curAttrData),!0;const B=L.length;let O;const P=this._curAttrData;for(let z=0;z<B;z++)O=L.params[z],O>=30&&O<=37?(P.fg&=-50331904,P.fg|=16777216|O-30):O>=40&&O<=47?(P.bg&=-50331904,P.bg|=16777216|O-40):O>=90&&O<=97?(P.fg&=-50331904,P.fg|=16777224|O-90):O>=100&&O<=107?(P.bg&=-50331904,P.bg|=16777224|O-100):O===0?this._processSGR0(P):O===1?P.fg|=134217728:O===3?P.bg|=67108864:O===4?(P.fg|=268435456,this._processUnderline(L.hasSubParams(z)?L.getSubParams(z)[0]:1,P)):O===5?P.fg|=536870912:O===7?P.fg|=67108864:O===8?P.fg|=1073741824:O===9?P.fg|=2147483648:O===2?P.bg|=134217728:O===21?this._processUnderline(2,P):O===22?(P.fg&=-134217729,P.bg&=-134217729):O===23?P.bg&=-67108865:O===24?(P.fg&=-268435457,this._processUnderline(0,P)):O===25?P.fg&=-536870913:O===27?P.fg&=-67108865:O===28?P.fg&=-1073741825:O===29?P.fg&=2147483647:O===39?(P.fg&=-67108864,P.fg|=16777215&t.DEFAULT_ATTR_DATA.fg):O===49?(P.bg&=-67108864,P.bg|=16777215&t.DEFAULT_ATTR_DATA.bg):O===38||O===48||O===58?z+=this._extractColor(L,z,P):O===53?P.bg|=1073741824:O===55?P.bg&=-1073741825:O===59?(P.extended=P.extended.clone(),P.extended.underlineColor=-1,P.updateExtended()):O===100?(P.fg&=-67108864,P.fg|=16777215&t.DEFAULT_ATTR_DATA.fg,P.bg&=-67108864,P.bg|=16777215&t.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",O);return!0}deviceStatus(L){switch(L.params[0]){case 5:this._coreService.triggerDataEvent(`${a.C0.ESC}[0n`);break;case 6:const B=this._activeBuffer.y+1,O=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${a.C0.ESC}[${B};${O}R`)}return!0}deviceStatusPrivate(L){if(L.params[0]===6){const B=this._activeBuffer.y+1,O=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${a.C0.ESC}[?${B};${O}R`)}return!0}softReset(L){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(L){const B=L.params[0]||1;switch(B){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const O=B%2==1;return this._optionsService.options.cursorBlink=O,!0}setScrollRegion(L){const B=L.params[0]||1;let O;return(L.length<2||(O=L.params[1])>this._bufferService.rows||O===0)&&(O=this._bufferService.rows),O>B&&(this._activeBuffer.scrollTop=B-1,this._activeBuffer.scrollBottom=O-1,this._setCursor(0,0)),!0}windowOptions(L){if(!I(L.params[0],this._optionsService.rawOptions.windowOptions))return!0;const B=L.length>1?L.params[1]:0;switch(L.params[0]){case 14:B!==2&&this._onRequestWindowsOptionsReport.fire(C.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(C.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${a.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:B!==0&&B!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),B!==0&&B!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:B!==0&&B!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),B!==0&&B!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(L){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(L){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(L){return this._windowTitle=L,this._onTitleChange.fire(L),!0}setIconName(L){return this._iconName=L,!0}setOrReportIndexedColor(L){const B=[],O=L.split(";");for(;O.length>1;){const P=O.shift(),z=O.shift();if(/^\d+$/.exec(P)){const W=parseInt(P);if(N(W))if(z==="?")B.push({type:0,index:W});else{const U=(0,w.parseColor)(z);U&&B.push({type:1,index:W,color:U})}}}return B.length&&this._onColor.fire(B),!0}setHyperlink(L){const B=L.split(";");return!(B.length<2)&&(B[1]?this._createHyperlink(B[0],B[1]):!B[0]&&this._finishHyperlink())}_createHyperlink(L,B){this._getCurrentLinkId()&&this._finishHyperlink();const O=L.split(":");let P;const z=O.findIndex(W=>W.startsWith("id="));return z!==-1&&(P=O[z].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:P,uri:B}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(L,B){const O=L.split(";");for(let P=0;P<O.length&&!(B>=this._specialColors.length);++P,++B)if(O[P]==="?")this._onColor.fire([{type:0,index:this._specialColors[B]}]);else{const z=(0,w.parseColor)(O[P]);z&&this._onColor.fire([{type:1,index:this._specialColors[B],color:z}])}return!0}setOrReportFgColor(L){return this._setOrReportSpecialColor(L,0)}setOrReportBgColor(L){return this._setOrReportSpecialColor(L,1)}setOrReportCursorColor(L){return this._setOrReportSpecialColor(L,2)}restoreIndexedColor(L){if(!L)return this._onColor.fire([{type:2}]),!0;const B=[],O=L.split(";");for(let P=0;P<O.length;++P)if(/^\d+$/.exec(O[P])){const z=parseInt(O[P]);N(z)&&B.push({type:2,index:z})}return B.length&&this._onColor.fire(B),!0}restoreFgColor(L){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(L){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(L){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,h.DEFAULT_CHARSET),!0}selectCharset(L){return L.length!==2?(this.selectDefaultCharset(),!0):(L[0]==="/"||this._charsetService.setgCharset(y[L[0]],h.CHARSETS[L[1]]||h.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const L=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,L,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=t.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(L){return this._charsetService.setgLevel(L),!0}screenAlignmentPattern(){const L=new r.CellData;L.content=4194304|"E".charCodeAt(0),L.fg=this._curAttrData.fg,L.bg=this._curAttrData.bg,this._setCursor(0,0);for(let B=0;B<this._bufferService.rows;++B){const O=this._activeBuffer.ybase+this._activeBuffer.y+B,P=this._activeBuffer.lines.get(O);P&&(P.fill(L),P.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(L,B){const O=this._bufferService.buffer,P=this._optionsService.rawOptions;return(z=>(this._coreService.triggerDataEvent(`${a.C0.ESC}${z}${a.C0.ESC}\\`),!0))(L==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:L==='"p'?'P1$r61;1"p':L==="r"?`P1$r${O.scrollTop+1};${O.scrollBottom+1}r`:L==="m"?"P1$r0m":L===" q"?`P1$r${{block:2,underline:4,bar:6}[P.cursorStyle]-(P.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(L,B){this._dirtyRowTracker.markRangeDirty(L,B)}}n.InputHandler=A;let H=class{constructor(F){this._bufferService=F,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(F){F<this.start?this.start=F:F>this.end&&(this.end=F)}markRangeDirty(F,L){F>L&&(D=F,F=L,L=D),F<this.start&&(this.start=F),L>this.end&&(this.end=L)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function N(F){return 0<=F&&F<256}H=l([p(0,g.IBufferService)],H)},844:(S,n)=>{function s(l){for(const p of l)p.dispose();l.length=0}Object.defineProperty(n,"__esModule",{value:!0}),n.getDisposeArrayDisposable=n.disposeArray=n.toDisposable=n.MutableDisposable=n.Disposable=void 0,n.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const l of this._disposables)l.dispose();this._disposables.length=0}register(l){return this._disposables.push(l),l}unregister(l){const p=this._disposables.indexOf(l);p!==-1&&this._disposables.splice(p,1)}},n.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(l){var p;this._isDisposed||l===this._value||((p=this._value)===null||p===void 0||p.dispose(),this._value=l)}clear(){this.value=void 0}dispose(){var l;this._isDisposed=!0,(l=this._value)===null||l===void 0||l.dispose(),this._value=void 0}},n.toDisposable=function(l){return{dispose:l}},n.disposeArray=s,n.getDisposeArrayDisposable=function(l){return{dispose:()=>s(l)}}},1505:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FourKeyMap=n.TwoKeyMap=void 0;class s{constructor(){this._data={}}set(p,a,h){this._data[p]||(this._data[p]={}),this._data[p][a]=h}get(p,a){return this._data[p]?this._data[p][a]:void 0}clear(){this._data={}}}n.TwoKeyMap=s,n.FourKeyMap=class{constructor(){this._data=new s}set(l,p,a,h,f){this._data.get(l,p)||this._data.set(l,p,new s),this._data.get(l,p).set(a,h,f)}get(l,p,a,h){var f;return(f=this._data.get(l,p))===null||f===void 0?void 0:f.get(a,h)}clear(){this._data.clear()}}},6114:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isChromeOS=n.isLinux=n.isWindows=n.isIphone=n.isIpad=n.isMac=n.getSafariVersion=n.isSafari=n.isLegacyEdge=n.isFirefox=n.isNode=void 0,n.isNode=typeof navigator>"u";const s=n.isNode?"node":navigator.userAgent,l=n.isNode?"node":navigator.platform;n.isFirefox=s.includes("Firefox"),n.isLegacyEdge=s.includes("Edge"),n.isSafari=/^((?!chrome|android).)*safari/i.test(s),n.getSafariVersion=function(){if(!n.isSafari)return 0;const p=s.match(/Version\/(\d+)/);return p===null||p.length<2?0:parseInt(p[1])},n.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(l),n.isIpad=l==="iPad",n.isIphone=l==="iPhone",n.isWindows=["Windows","Win16","Win32","WinCE"].includes(l),n.isLinux=l.indexOf("Linux")>=0,n.isChromeOS=/\bCrOS\b/.test(s)},6106:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SortedList=void 0;let s=0;n.SortedList=class{constructor(l){this._getKey=l,this._array=[]}clear(){this._array.length=0}insert(l){this._array.length!==0?(s=this._search(this._getKey(l)),this._array.splice(s,0,l)):this._array.push(l)}delete(l){if(this._array.length===0)return!1;const p=this._getKey(l);if(p===void 0||(s=this._search(p),s===-1)||this._getKey(this._array[s])!==p)return!1;do if(this._array[s]===l)return this._array.splice(s,1),!0;while(++s<this._array.length&&this._getKey(this._array[s])===p);return!1}*getKeyIterator(l){if(this._array.length!==0&&(s=this._search(l),!(s<0||s>=this._array.length)&&this._getKey(this._array[s])===l))do yield this._array[s];while(++s<this._array.length&&this._getKey(this._array[s])===l)}forEachByKey(l,p){if(this._array.length!==0&&(s=this._search(l),!(s<0||s>=this._array.length)&&this._getKey(this._array[s])===l))do p(this._array[s]);while(++s<this._array.length&&this._getKey(this._array[s])===l)}values(){return[...this._array].values()}_search(l){let p=0,a=this._array.length-1;for(;a>=p;){let h=p+a>>1;const f=this._getKey(this._array[h]);if(f>l)a=h-1;else{if(!(f<l)){for(;h>0&&this._getKey(this._array[h-1])===l;)h--;return h}p=h+1}}return p}}},7226:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DebouncedIdleTask=n.IdleTaskQueue=n.PriorityTaskQueue=void 0;const l=s(6114);class p{constructor(){this._tasks=[],this._i=0}enqueue(f){this._tasks.push(f),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(f){this._idleCallback=void 0;let u=0,d=0,t=f.timeRemaining(),i=0;for(;this._i<this._tasks.length;){if(u=Date.now(),this._tasks[this._i]()||this._i++,u=Math.max(1,Date.now()-u),d=Math.max(u,d),i=f.timeRemaining(),1.5*d>i)return t-u<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(t-u))}ms`),void this._start();t=i}this.clear()}}class a extends p{_requestCallback(f){return setTimeout(()=>f(this._createDeadline(16)))}_cancelCallback(f){clearTimeout(f)}_createDeadline(f){const u=Date.now()+f;return{timeRemaining:()=>Math.max(0,u-Date.now())}}}n.PriorityTaskQueue=a,n.IdleTaskQueue=!l.isNode&&"requestIdleCallback"in window?class extends p{_requestCallback(h){return requestIdleCallback(h)}_cancelCallback(h){cancelIdleCallback(h)}}:a,n.DebouncedIdleTask=class{constructor(){this._queue=new n.IdleTaskQueue}set(h){this._queue.clear(),this._queue.enqueue(h)}flush(){this._queue.flush()}}},9282:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.updateWindowsModeWrappedState=void 0;const l=s(643);n.updateWindowsModeWrappedState=function(p){const a=p.buffer.lines.get(p.buffer.ybase+p.buffer.y-1),h=a==null?void 0:a.get(p.cols-1),f=p.buffer.lines.get(p.buffer.ybase+p.buffer.y);f&&h&&(f.isWrapped=h[l.CHAR_DATA_CODE_INDEX]!==l.NULL_CELL_CODE&&h[l.CHAR_DATA_CODE_INDEX]!==l.WHITESPACE_CELL_CODE)}},3734:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ExtendedAttrs=n.AttributeData=void 0;class s{constructor(){this.fg=0,this.bg=0,this.extended=new l}static toColorRGB(a){return[a>>>16&255,a>>>8&255,255&a]}static fromColorRGB(a){return(255&a[0])<<16|(255&a[1])<<8|255&a[2]}clone(){const a=new s;return a.fg=this.fg,a.bg=this.bg,a.extended=this.extended.clone(),a}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}n.AttributeData=s;class l{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(a){this._ext=a}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(a){this._ext&=-469762049,this._ext|=a<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(a){this._ext&=-67108864,this._ext|=67108863&a}get urlId(){return this._urlId}set urlId(a){this._urlId=a}constructor(a=0,h=0){this._ext=0,this._urlId=0,this._ext=a,this._urlId=h}clone(){return new l(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}n.ExtendedAttrs=l},9092:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Buffer=n.MAX_BUFFER_SIZE=void 0;const l=s(6349),p=s(7226),a=s(3734),h=s(8437),f=s(4634),u=s(511),d=s(643),t=s(4863),i=s(7116);n.MAX_BUFFER_SIZE=4294967295,n.Buffer=class{constructor(o,r,m){this._hasScrollback=o,this._optionsService=r,this._bufferService=m,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=h.DEFAULT_ATTR_DATA.clone(),this.savedCharset=i.DEFAULT_CHARSET,this.markers=[],this._nullCell=u.CellData.fromCharData([0,d.NULL_CELL_CHAR,d.NULL_CELL_WIDTH,d.NULL_CELL_CODE]),this._whitespaceCell=u.CellData.fromCharData([0,d.WHITESPACE_CELL_CHAR,d.WHITESPACE_CELL_WIDTH,d.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new p.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new l.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(o){return o?(this._nullCell.fg=o.fg,this._nullCell.bg=o.bg,this._nullCell.extended=o.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new a.ExtendedAttrs),this._nullCell}getWhitespaceCell(o){return o?(this._whitespaceCell.fg=o.fg,this._whitespaceCell.bg=o.bg,this._whitespaceCell.extended=o.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new a.ExtendedAttrs),this._whitespaceCell}getBlankLine(o,r){return new h.BufferLine(this._bufferService.cols,this.getNullCell(o),r)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const o=this.ybase+this.y-this.ydisp;return o>=0&&o<this._rows}_getCorrectBufferLength(o){if(!this._hasScrollback)return o;const r=o+this._optionsService.rawOptions.scrollback;return r>n.MAX_BUFFER_SIZE?n.MAX_BUFFER_SIZE:r}fillViewportRows(o){if(this.lines.length===0){o===void 0&&(o=h.DEFAULT_ATTR_DATA);let r=this._rows;for(;r--;)this.lines.push(this.getBlankLine(o))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new l.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(o,r){const m=this.getNullCell(h.DEFAULT_ATTR_DATA);let g=0;const E=this._getCorrectBufferLength(r);if(E>this.lines.maxLength&&(this.lines.maxLength=E),this.lines.length>0){if(this._cols<o)for(let w=0;w<this.lines.length;w++)g+=+this.lines.get(w).resize(o,m);let T=0;if(this._rows<r)for(let w=this._rows;w<r;w++)this.lines.length<r+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new h.BufferLine(o,m)):this.ybase>0&&this.lines.length<=this.ybase+this.y+T+1?(this.ybase--,T++,this.ydisp>0&&this.ydisp--):this.lines.push(new h.BufferLine(o,m)));else for(let w=this._rows;w>r;w--)this.lines.length>r+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(E<this.lines.maxLength){const w=this.lines.length-E;w>0&&(this.lines.trimStart(w),this.ybase=Math.max(this.ybase-w,0),this.ydisp=Math.max(this.ydisp-w,0),this.savedY=Math.max(this.savedY-w,0)),this.lines.maxLength=E}this.x=Math.min(this.x,o-1),this.y=Math.min(this.y,r-1),T&&(this.y+=T),this.savedX=Math.min(this.savedX,o-1),this.scrollTop=0}if(this.scrollBottom=r-1,this._isReflowEnabled&&(this._reflow(o,r),this._cols>o))for(let T=0;T<this.lines.length;T++)g+=+this.lines.get(T).resize(o,m);this._cols=o,this._rows=r,this._memoryCleanupQueue.clear(),g>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let o=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,o=!1);let r=0;for(;this._memoryCleanupPosition<this.lines.length;)if(r+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),r>100)return!0;return o}get _isReflowEnabled(){const o=this._optionsService.rawOptions.windowsPty;return o&&o.buildNumber?this._hasScrollback&&o.backend==="conpty"&&o.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(o,r){this._cols!==o&&(o>this._cols?this._reflowLarger(o,r):this._reflowSmaller(o,r))}_reflowLarger(o,r){const m=(0,f.reflowLargerGetLinesToRemove)(this.lines,this._cols,o,this.ybase+this.y,this.getNullCell(h.DEFAULT_ATTR_DATA));if(m.length>0){const g=(0,f.reflowLargerCreateNewLayout)(this.lines,m);(0,f.reflowLargerApplyNewLayout)(this.lines,g.layout),this._reflowLargerAdjustViewport(o,r,g.countRemoved)}}_reflowLargerAdjustViewport(o,r,m){const g=this.getNullCell(h.DEFAULT_ATTR_DATA);let E=m;for(;E-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<r&&this.lines.push(new h.BufferLine(o,g))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-m,0)}_reflowSmaller(o,r){const m=this.getNullCell(h.DEFAULT_ATTR_DATA),g=[];let E=0;for(let T=this.lines.length-1;T>=0;T--){let w=this.lines.get(T);if(!w||!w.isWrapped&&w.getTrimmedLength()<=o)continue;const y=[w];for(;w.isWrapped&&T>0;)w=this.lines.get(--T),y.unshift(w);const M=this.ybase+this.y;if(M>=T&&M<T+y.length)continue;const I=y[y.length-1].getTrimmedLength(),C=(0,f.reflowSmallerGetNewLineLengths)(y,this._cols,o),D=C.length-y.length;let A;A=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+D):Math.max(0,this.lines.length-this.lines.maxLength+D);const H=[];for(let P=0;P<D;P++){const z=this.getBlankLine(h.DEFAULT_ATTR_DATA,!0);H.push(z)}H.length>0&&(g.push({start:T+y.length+E,newLines:H}),E+=H.length),y.push(...H);let N=C.length-1,F=C[N];F===0&&(N--,F=C[N]);let L=y.length-D-1,B=I;for(;L>=0;){const P=Math.min(B,F);if(y[N]===void 0)break;if(y[N].copyCellsFrom(y[L],B-P,F-P,P,!0),F-=P,F===0&&(N--,F=C[N]),B-=P,B===0){L--;const z=Math.max(L,0);B=(0,f.getWrappedLineTrimmedLength)(y,z,this._cols)}}for(let P=0;P<y.length;P++)C[P]<o&&y[P].setCell(C[P],m);let O=D-A;for(;O-- >0;)this.ybase===0?this.y<r-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+E)-r&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+D,this.ybase+r-1)}if(g.length>0){const T=[],w=[];for(let N=0;N<this.lines.length;N++)w.push(this.lines.get(N));const y=this.lines.length;let M=y-1,I=0,C=g[I];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+E);let D=0;for(let N=Math.min(this.lines.maxLength-1,y+E-1);N>=0;N--)if(C&&C.start>M+D){for(let F=C.newLines.length-1;F>=0;F--)this.lines.set(N--,C.newLines[F]);N++,T.push({index:M+1,amount:C.newLines.length}),D+=C.newLines.length,C=g[++I]}else this.lines.set(N,w[M--]);let A=0;for(let N=T.length-1;N>=0;N--)T[N].index+=A,this.lines.onInsertEmitter.fire(T[N]),A+=T[N].amount;const H=Math.max(0,y+E-this.lines.maxLength);H>0&&this.lines.onTrimEmitter.fire(H)}}translateBufferLineToString(o,r,m=0,g){const E=this.lines.get(o);return E?E.translateToString(r,m,g):""}getWrappedRangeForLine(o){let r=o,m=o;for(;r>0&&this.lines.get(r).isWrapped;)r--;for(;m+1<this.lines.length&&this.lines.get(m+1).isWrapped;)m++;return{first:r,last:m}}setupTabStops(o){for(o!=null?this.tabs[o]||(o=this.prevStop(o)):(this.tabs={},o=0);o<this._cols;o+=this._optionsService.rawOptions.tabStopWidth)this.tabs[o]=!0}prevStop(o){for(o==null&&(o=this.x);!this.tabs[--o]&&o>0;);return o>=this._cols?this._cols-1:o<0?0:o}nextStop(o){for(o==null&&(o=this.x);!this.tabs[++o]&&o<this._cols;);return o>=this._cols?this._cols-1:o<0?0:o}clearMarkers(o){this._isClearing=!0;for(let r=0;r<this.markers.length;r++)this.markers[r].line===o&&(this.markers[r].dispose(),this.markers.splice(r--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let o=0;o<this.markers.length;o++)this.markers[o].dispose(),this.markers.splice(o--,1);this._isClearing=!1}addMarker(o){const r=new t.Marker(o);return this.markers.push(r),r.register(this.lines.onTrim(m=>{r.line-=m,r.line<0&&r.dispose()})),r.register(this.lines.onInsert(m=>{r.line>=m.index&&(r.line+=m.amount)})),r.register(this.lines.onDelete(m=>{r.line>=m.index&&r.line<m.index+m.amount&&r.dispose(),r.line>m.index&&(r.line-=m.amount)})),r.register(r.onDispose(()=>this._removeMarker(r))),r}_removeMarker(o){this._isClearing||this.markers.splice(this.markers.indexOf(o),1)}}},8437:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferLine=n.DEFAULT_ATTR_DATA=void 0;const l=s(3734),p=s(511),a=s(643),h=s(482);n.DEFAULT_ATTR_DATA=Object.freeze(new l.AttributeData);let f=0;class u{constructor(t,i,o=!1){this.isWrapped=o,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*t);const r=i||p.CellData.fromCharData([0,a.NULL_CELL_CHAR,a.NULL_CELL_WIDTH,a.NULL_CELL_CODE]);for(let m=0;m<t;++m)this.setCell(m,r);this.length=t}get(t){const i=this._data[3*t+0],o=2097151&i;return[this._data[3*t+1],2097152&i?this._combined[t]:o?(0,h.stringFromCodePoint)(o):"",i>>22,2097152&i?this._combined[t].charCodeAt(this._combined[t].length-1):o]}set(t,i){this._data[3*t+1]=i[a.CHAR_DATA_ATTR_INDEX],i[a.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[t]=i[1],this._data[3*t+0]=2097152|t|i[a.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*t+0]=i[a.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|i[a.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(t){return this._data[3*t+0]>>22}hasWidth(t){return 12582912&this._data[3*t+0]}getFg(t){return this._data[3*t+1]}getBg(t){return this._data[3*t+2]}hasContent(t){return 4194303&this._data[3*t+0]}getCodePoint(t){const i=this._data[3*t+0];return 2097152&i?this._combined[t].charCodeAt(this._combined[t].length-1):2097151&i}isCombined(t){return 2097152&this._data[3*t+0]}getString(t){const i=this._data[3*t+0];return 2097152&i?this._combined[t]:2097151&i?(0,h.stringFromCodePoint)(2097151&i):""}isProtected(t){return 536870912&this._data[3*t+2]}loadCell(t,i){return f=3*t,i.content=this._data[f+0],i.fg=this._data[f+1],i.bg=this._data[f+2],2097152&i.content&&(i.combinedData=this._combined[t]),268435456&i.bg&&(i.extended=this._extendedAttrs[t]),i}setCell(t,i){2097152&i.content&&(this._combined[t]=i.combinedData),268435456&i.bg&&(this._extendedAttrs[t]=i.extended),this._data[3*t+0]=i.content,this._data[3*t+1]=i.fg,this._data[3*t+2]=i.bg}setCellFromCodePoint(t,i,o,r,m,g){268435456&m&&(this._extendedAttrs[t]=g),this._data[3*t+0]=i|o<<22,this._data[3*t+1]=r,this._data[3*t+2]=m}addCodepointToCell(t,i){let o=this._data[3*t+0];2097152&o?this._combined[t]+=(0,h.stringFromCodePoint)(i):(2097151&o?(this._combined[t]=(0,h.stringFromCodePoint)(2097151&o)+(0,h.stringFromCodePoint)(i),o&=-2097152,o|=2097152):o=i|4194304,this._data[3*t+0]=o)}insertCells(t,i,o,r){if((t%=this.length)&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs),i<this.length-t){const m=new p.CellData;for(let g=this.length-t-i-1;g>=0;--g)this.setCell(t+i+g,this.loadCell(t+g,m));for(let g=0;g<i;++g)this.setCell(t+g,o)}else for(let m=t;m<this.length;++m)this.setCell(m,o);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs)}deleteCells(t,i,o,r){if(t%=this.length,i<this.length-t){const m=new p.CellData;for(let g=0;g<this.length-t-i;++g)this.setCell(t+g,this.loadCell(t+i+g,m));for(let g=this.length-i;g<this.length;++g)this.setCell(g,o)}else for(let m=t;m<this.length;++m)this.setCell(m,o);t&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs),this.getWidth(t)!==0||this.hasContent(t)||this.setCellFromCodePoint(t,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs)}replaceCells(t,i,o,r,m=!1){if(m)for(t&&this.getWidth(t-1)===2&&!this.isProtected(t-1)&&this.setCellFromCodePoint(t-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs),i<this.length&&this.getWidth(i-1)===2&&!this.isProtected(i)&&this.setCellFromCodePoint(i,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs);t<i&&t<this.length;)this.isProtected(t)||this.setCell(t,o),t++;else for(t&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs),i<this.length&&this.getWidth(i-1)===2&&this.setCellFromCodePoint(i,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs);t<i&&t<this.length;)this.setCell(t++,o)}resize(t,i){if(t===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const o=3*t;if(t>this.length){if(this._data.buffer.byteLength>=4*o)this._data=new Uint32Array(this._data.buffer,0,o);else{const r=new Uint32Array(o);r.set(this._data),this._data=r}for(let r=this.length;r<t;++r)this.setCell(r,i)}else{this._data=this._data.subarray(0,o);const r=Object.keys(this._combined);for(let g=0;g<r.length;g++){const E=parseInt(r[g],10);E>=t&&delete this._combined[E]}const m=Object.keys(this._extendedAttrs);for(let g=0;g<m.length;g++){const E=parseInt(m[g],10);E>=t&&delete this._extendedAttrs[E]}}return this.length=t,4*o*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const t=new Uint32Array(this._data.length);return t.set(this._data),this._data=t,1}return 0}fill(t,i=!1){if(i)for(let o=0;o<this.length;++o)this.isProtected(o)||this.setCell(o,t);else{this._combined={},this._extendedAttrs={};for(let o=0;o<this.length;++o)this.setCell(o,t)}}copyFrom(t){this.length!==t.length?this._data=new Uint32Array(t._data):this._data.set(t._data),this.length=t.length,this._combined={};for(const i in t._combined)this._combined[i]=t._combined[i];this._extendedAttrs={};for(const i in t._extendedAttrs)this._extendedAttrs[i]=t._extendedAttrs[i];this.isWrapped=t.isWrapped}clone(){const t=new u(0);t._data=new Uint32Array(this._data),t.length=this.length;for(const i in this._combined)t._combined[i]=this._combined[i];for(const i in this._extendedAttrs)t._extendedAttrs[i]=this._extendedAttrs[i];return t.isWrapped=this.isWrapped,t}getTrimmedLength(){for(let t=this.length-1;t>=0;--t)if(4194303&this._data[3*t+0])return t+(this._data[3*t+0]>>22);return 0}getNoBgTrimmedLength(){for(let t=this.length-1;t>=0;--t)if(4194303&this._data[3*t+0]||50331648&this._data[3*t+2])return t+(this._data[3*t+0]>>22);return 0}copyCellsFrom(t,i,o,r,m){const g=t._data;if(m)for(let T=r-1;T>=0;T--){for(let w=0;w<3;w++)this._data[3*(o+T)+w]=g[3*(i+T)+w];268435456&g[3*(i+T)+2]&&(this._extendedAttrs[o+T]=t._extendedAttrs[i+T])}else for(let T=0;T<r;T++){for(let w=0;w<3;w++)this._data[3*(o+T)+w]=g[3*(i+T)+w];268435456&g[3*(i+T)+2]&&(this._extendedAttrs[o+T]=t._extendedAttrs[i+T])}const E=Object.keys(t._combined);for(let T=0;T<E.length;T++){const w=parseInt(E[T],10);w>=i&&(this._combined[w-i+o]=t._combined[w])}}translateToString(t=!1,i=0,o=this.length){t&&(o=Math.min(o,this.getTrimmedLength()));let r="";for(;i<o;){const m=this._data[3*i+0],g=2097151&m;r+=2097152&m?this._combined[i]:g?(0,h.stringFromCodePoint)(g):a.WHITESPACE_CELL_CHAR,i+=m>>22||1}return r}}n.BufferLine=u},4841:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getRangeLength=void 0,n.getRangeLength=function(s,l){if(s.start.y>s.end.y)throw new Error(`Buffer range end (${s.end.x}, ${s.end.y}) cannot be before start (${s.start.x}, ${s.start.y})`);return l*(s.end.y-s.start.y)+(s.end.x-s.start.x+1)}},4634:(S,n)=>{function s(l,p,a){if(p===l.length-1)return l[p].getTrimmedLength();const h=!l[p].hasContent(a-1)&&l[p].getWidth(a-1)===1,f=l[p+1].getWidth(0)===2;return h&&f?a-1:a}Object.defineProperty(n,"__esModule",{value:!0}),n.getWrappedLineTrimmedLength=n.reflowSmallerGetNewLineLengths=n.reflowLargerApplyNewLayout=n.reflowLargerCreateNewLayout=n.reflowLargerGetLinesToRemove=void 0,n.reflowLargerGetLinesToRemove=function(l,p,a,h,f){const u=[];for(let d=0;d<l.length-1;d++){let t=d,i=l.get(++t);if(!i.isWrapped)continue;const o=[l.get(d)];for(;t<l.length&&i.isWrapped;)o.push(i),i=l.get(++t);if(h>=d&&h<t){d+=o.length-1;continue}let r=0,m=s(o,r,p),g=1,E=0;for(;g<o.length;){const w=s(o,g,p),y=w-E,M=a-m,I=Math.min(y,M);o[r].copyCellsFrom(o[g],E,m,I,!1),m+=I,m===a&&(r++,m=0),E+=I,E===w&&(g++,E=0),m===0&&r!==0&&o[r-1].getWidth(a-1)===2&&(o[r].copyCellsFrom(o[r-1],a-1,m++,1,!1),o[r-1].setCell(a-1,f))}o[r].replaceCells(m,a,f);let T=0;for(let w=o.length-1;w>0&&(w>r||o[w].getTrimmedLength()===0);w--)T++;T>0&&(u.push(d+o.length-T),u.push(T)),d+=o.length-1}return u},n.reflowLargerCreateNewLayout=function(l,p){const a=[];let h=0,f=p[h],u=0;for(let d=0;d<l.length;d++)if(f===d){const t=p[++h];l.onDeleteEmitter.fire({index:d-u,amount:t}),d+=t-1,u+=t,f=p[++h]}else a.push(d);return{layout:a,countRemoved:u}},n.reflowLargerApplyNewLayout=function(l,p){const a=[];for(let h=0;h<p.length;h++)a.push(l.get(p[h]));for(let h=0;h<a.length;h++)l.set(h,a[h]);l.length=p.length},n.reflowSmallerGetNewLineLengths=function(l,p,a){const h=[],f=l.map((i,o)=>s(l,o,p)).reduce((i,o)=>i+o);let u=0,d=0,t=0;for(;t<f;){if(f-t<a){h.push(f-t);break}u+=a;const i=s(l,d,p);u>i&&(u-=i,d++);const o=l[d].getWidth(u-1)===2;o&&u--;const r=o?a-1:a;h.push(r),t+=r}return h},n.getWrappedLineTrimmedLength=s},5295:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferSet=void 0;const l=s(8460),p=s(844),a=s(9092);class h extends p.Disposable{constructor(u,d){super(),this._optionsService=u,this._bufferService=d,this._onBufferActivate=this.register(new l.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new a.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new a.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(u){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(u),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(u,d){this._normal.resize(u,d),this._alt.resize(u,d),this.setupTabStops(u)}setupTabStops(u){this._normal.setupTabStops(u),this._alt.setupTabStops(u)}}n.BufferSet=h},511:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CellData=void 0;const l=s(482),p=s(643),a=s(3734);class h extends a.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new a.ExtendedAttrs,this.combinedData=""}static fromCharData(u){const d=new h;return d.setFromCharData(u),d}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,l.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(u){this.fg=u[p.CHAR_DATA_ATTR_INDEX],this.bg=0;let d=!1;if(u[p.CHAR_DATA_CHAR_INDEX].length>2)d=!0;else if(u[p.CHAR_DATA_CHAR_INDEX].length===2){const t=u[p.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=t&&t<=56319){const i=u[p.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=i&&i<=57343?this.content=1024*(t-55296)+i-56320+65536|u[p.CHAR_DATA_WIDTH_INDEX]<<22:d=!0}else d=!0}else this.content=u[p.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|u[p.CHAR_DATA_WIDTH_INDEX]<<22;d&&(this.combinedData=u[p.CHAR_DATA_CHAR_INDEX],this.content=2097152|u[p.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}n.CellData=h},643:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WHITESPACE_CELL_CODE=n.WHITESPACE_CELL_WIDTH=n.WHITESPACE_CELL_CHAR=n.NULL_CELL_CODE=n.NULL_CELL_WIDTH=n.NULL_CELL_CHAR=n.CHAR_DATA_CODE_INDEX=n.CHAR_DATA_WIDTH_INDEX=n.CHAR_DATA_CHAR_INDEX=n.CHAR_DATA_ATTR_INDEX=n.DEFAULT_EXT=n.DEFAULT_ATTR=n.DEFAULT_COLOR=void 0,n.DEFAULT_COLOR=0,n.DEFAULT_ATTR=256|n.DEFAULT_COLOR<<9,n.DEFAULT_EXT=0,n.CHAR_DATA_ATTR_INDEX=0,n.CHAR_DATA_CHAR_INDEX=1,n.CHAR_DATA_WIDTH_INDEX=2,n.CHAR_DATA_CODE_INDEX=3,n.NULL_CELL_CHAR="",n.NULL_CELL_WIDTH=1,n.NULL_CELL_CODE=0,n.WHITESPACE_CELL_CHAR=" ",n.WHITESPACE_CELL_WIDTH=1,n.WHITESPACE_CELL_CODE=32},4863:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Marker=void 0;const l=s(8460),p=s(844);class a{get id(){return this._id}constructor(f){this.line=f,this.isDisposed=!1,this._disposables=[],this._id=a._nextId++,this._onDispose=this.register(new l.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,p.disposeArray)(this._disposables),this._disposables.length=0)}register(f){return this._disposables.push(f),f}}n.Marker=a,a._nextId=1},7116:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DEFAULT_CHARSET=n.CHARSETS=void 0,n.CHARSETS={},n.DEFAULT_CHARSET=n.CHARSETS.B,n.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},n.CHARSETS.A={"#":"£"},n.CHARSETS.B=void 0,n.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},n.CHARSETS.C=n.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},n.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},n.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},n.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},n.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},n.CHARSETS.E=n.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},n.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},n.CHARSETS.H=n.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},n.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(S,n)=>{var s,l,p;Object.defineProperty(n,"__esModule",{value:!0}),n.C1_ESCAPED=n.C1=n.C0=void 0,function(a){a.NUL="\0",a.SOH="",a.STX="",a.ETX="",a.EOT="",a.ENQ="",a.ACK="",a.BEL="\x07",a.BS="\b",a.HT="	",a.LF=`
`,a.VT="\v",a.FF="\f",a.CR="\r",a.SO="",a.SI="",a.DLE="",a.DC1="",a.DC2="",a.DC3="",a.DC4="",a.NAK="",a.SYN="",a.ETB="",a.CAN="",a.EM="",a.SUB="",a.ESC="\x1B",a.FS="",a.GS="",a.RS="",a.US="",a.SP=" ",a.DEL=""}(s||(n.C0=s={})),function(a){a.PAD="",a.HOP="",a.BPH="",a.NBH="",a.IND="",a.NEL="",a.SSA="",a.ESA="",a.HTS="",a.HTJ="",a.VTS="",a.PLD="",a.PLU="",a.RI="",a.SS2="",a.SS3="",a.DCS="",a.PU1="",a.PU2="",a.STS="",a.CCH="",a.MW="",a.SPA="",a.EPA="",a.SOS="",a.SGCI="",a.SCI="",a.CSI="",a.ST="",a.OSC="",a.PM="",a.APC=""}(l||(n.C1=l={})),function(a){a.ST=`${s.ESC}\\`}(p||(n.C1_ESCAPED=p={}))},7399:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.evaluateKeyboardEvent=void 0;const l=s(2584),p={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};n.evaluateKeyboardEvent=function(a,h,f,u){const d={type:0,cancel:!1,key:void 0},t=(a.shiftKey?1:0)|(a.altKey?2:0)|(a.ctrlKey?4:0)|(a.metaKey?8:0);switch(a.keyCode){case 0:a.key==="UIKeyInputUpArrow"?d.key=h?l.C0.ESC+"OA":l.C0.ESC+"[A":a.key==="UIKeyInputLeftArrow"?d.key=h?l.C0.ESC+"OD":l.C0.ESC+"[D":a.key==="UIKeyInputRightArrow"?d.key=h?l.C0.ESC+"OC":l.C0.ESC+"[C":a.key==="UIKeyInputDownArrow"&&(d.key=h?l.C0.ESC+"OB":l.C0.ESC+"[B");break;case 8:if(a.altKey){d.key=l.C0.ESC+l.C0.DEL;break}d.key=l.C0.DEL;break;case 9:if(a.shiftKey){d.key=l.C0.ESC+"[Z";break}d.key=l.C0.HT,d.cancel=!0;break;case 13:d.key=a.altKey?l.C0.ESC+l.C0.CR:l.C0.CR,d.cancel=!0;break;case 27:d.key=l.C0.ESC,a.altKey&&(d.key=l.C0.ESC+l.C0.ESC),d.cancel=!0;break;case 37:if(a.metaKey)break;t?(d.key=l.C0.ESC+"[1;"+(t+1)+"D",d.key===l.C0.ESC+"[1;3D"&&(d.key=l.C0.ESC+(f?"b":"[1;5D"))):d.key=h?l.C0.ESC+"OD":l.C0.ESC+"[D";break;case 39:if(a.metaKey)break;t?(d.key=l.C0.ESC+"[1;"+(t+1)+"C",d.key===l.C0.ESC+"[1;3C"&&(d.key=l.C0.ESC+(f?"f":"[1;5C"))):d.key=h?l.C0.ESC+"OC":l.C0.ESC+"[C";break;case 38:if(a.metaKey)break;t?(d.key=l.C0.ESC+"[1;"+(t+1)+"A",f||d.key!==l.C0.ESC+"[1;3A"||(d.key=l.C0.ESC+"[1;5A")):d.key=h?l.C0.ESC+"OA":l.C0.ESC+"[A";break;case 40:if(a.metaKey)break;t?(d.key=l.C0.ESC+"[1;"+(t+1)+"B",f||d.key!==l.C0.ESC+"[1;3B"||(d.key=l.C0.ESC+"[1;5B")):d.key=h?l.C0.ESC+"OB":l.C0.ESC+"[B";break;case 45:a.shiftKey||a.ctrlKey||(d.key=l.C0.ESC+"[2~");break;case 46:d.key=t?l.C0.ESC+"[3;"+(t+1)+"~":l.C0.ESC+"[3~";break;case 36:d.key=t?l.C0.ESC+"[1;"+(t+1)+"H":h?l.C0.ESC+"OH":l.C0.ESC+"[H";break;case 35:d.key=t?l.C0.ESC+"[1;"+(t+1)+"F":h?l.C0.ESC+"OF":l.C0.ESC+"[F";break;case 33:a.shiftKey?d.type=2:a.ctrlKey?d.key=l.C0.ESC+"[5;"+(t+1)+"~":d.key=l.C0.ESC+"[5~";break;case 34:a.shiftKey?d.type=3:a.ctrlKey?d.key=l.C0.ESC+"[6;"+(t+1)+"~":d.key=l.C0.ESC+"[6~";break;case 112:d.key=t?l.C0.ESC+"[1;"+(t+1)+"P":l.C0.ESC+"OP";break;case 113:d.key=t?l.C0.ESC+"[1;"+(t+1)+"Q":l.C0.ESC+"OQ";break;case 114:d.key=t?l.C0.ESC+"[1;"+(t+1)+"R":l.C0.ESC+"OR";break;case 115:d.key=t?l.C0.ESC+"[1;"+(t+1)+"S":l.C0.ESC+"OS";break;case 116:d.key=t?l.C0.ESC+"[15;"+(t+1)+"~":l.C0.ESC+"[15~";break;case 117:d.key=t?l.C0.ESC+"[17;"+(t+1)+"~":l.C0.ESC+"[17~";break;case 118:d.key=t?l.C0.ESC+"[18;"+(t+1)+"~":l.C0.ESC+"[18~";break;case 119:d.key=t?l.C0.ESC+"[19;"+(t+1)+"~":l.C0.ESC+"[19~";break;case 120:d.key=t?l.C0.ESC+"[20;"+(t+1)+"~":l.C0.ESC+"[20~";break;case 121:d.key=t?l.C0.ESC+"[21;"+(t+1)+"~":l.C0.ESC+"[21~";break;case 122:d.key=t?l.C0.ESC+"[23;"+(t+1)+"~":l.C0.ESC+"[23~";break;case 123:d.key=t?l.C0.ESC+"[24;"+(t+1)+"~":l.C0.ESC+"[24~";break;default:if(!a.ctrlKey||a.shiftKey||a.altKey||a.metaKey)if(f&&!u||!a.altKey||a.metaKey)!f||a.altKey||a.ctrlKey||a.shiftKey||!a.metaKey?a.key&&!a.ctrlKey&&!a.altKey&&!a.metaKey&&a.keyCode>=48&&a.key.length===1?d.key=a.key:a.key&&a.ctrlKey&&(a.key==="_"&&(d.key=l.C0.US),a.key==="@"&&(d.key=l.C0.NUL)):a.keyCode===65&&(d.type=1);else{const i=p[a.keyCode],o=i==null?void 0:i[a.shiftKey?1:0];if(o)d.key=l.C0.ESC+o;else if(a.keyCode>=65&&a.keyCode<=90){const r=a.ctrlKey?a.keyCode-64:a.keyCode+32;let m=String.fromCharCode(r);a.shiftKey&&(m=m.toUpperCase()),d.key=l.C0.ESC+m}else if(a.keyCode===32)d.key=l.C0.ESC+(a.ctrlKey?l.C0.NUL:" ");else if(a.key==="Dead"&&a.code.startsWith("Key")){let r=a.code.slice(3,4);a.shiftKey||(r=r.toLowerCase()),d.key=l.C0.ESC+r,d.cancel=!0}}else a.keyCode>=65&&a.keyCode<=90?d.key=String.fromCharCode(a.keyCode-64):a.keyCode===32?d.key=l.C0.NUL:a.keyCode>=51&&a.keyCode<=55?d.key=String.fromCharCode(a.keyCode-51+27):a.keyCode===56?d.key=l.C0.DEL:a.keyCode===219?d.key=l.C0.ESC:a.keyCode===220?d.key=l.C0.FS:a.keyCode===221&&(d.key=l.C0.GS)}return d}},482:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Utf8ToUtf32=n.StringToUtf32=n.utf32ToString=n.stringFromCodePoint=void 0,n.stringFromCodePoint=function(s){return s>65535?(s-=65536,String.fromCharCode(55296+(s>>10))+String.fromCharCode(s%1024+56320)):String.fromCharCode(s)},n.utf32ToString=function(s,l=0,p=s.length){let a="";for(let h=l;h<p;++h){let f=s[h];f>65535?(f-=65536,a+=String.fromCharCode(55296+(f>>10))+String.fromCharCode(f%1024+56320)):a+=String.fromCharCode(f)}return a},n.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(s,l){const p=s.length;if(!p)return 0;let a=0,h=0;if(this._interim){const f=s.charCodeAt(h++);56320<=f&&f<=57343?l[a++]=1024*(this._interim-55296)+f-56320+65536:(l[a++]=this._interim,l[a++]=f),this._interim=0}for(let f=h;f<p;++f){const u=s.charCodeAt(f);if(55296<=u&&u<=56319){if(++f>=p)return this._interim=u,a;const d=s.charCodeAt(f);56320<=d&&d<=57343?l[a++]=1024*(u-55296)+d-56320+65536:(l[a++]=u,l[a++]=d)}else u!==65279&&(l[a++]=u)}return a}},n.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(s,l){const p=s.length;if(!p)return 0;let a,h,f,u,d=0,t=0,i=0;if(this.interim[0]){let m=!1,g=this.interim[0];g&=(224&g)==192?31:(240&g)==224?15:7;let E,T=0;for(;(E=63&this.interim[++T])&&T<4;)g<<=6,g|=E;const w=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,y=w-T;for(;i<y;){if(i>=p)return 0;if(E=s[i++],(192&E)!=128){i--,m=!0;break}this.interim[T++]=E,g<<=6,g|=63&E}m||(w===2?g<128?i--:l[d++]=g:w===3?g<2048||g>=55296&&g<=57343||g===65279||(l[d++]=g):g<65536||g>1114111||(l[d++]=g)),this.interim.fill(0)}const o=p-4;let r=i;for(;r<p;){for(;!(!(r<o)||128&(a=s[r])||128&(h=s[r+1])||128&(f=s[r+2])||128&(u=s[r+3]));)l[d++]=a,l[d++]=h,l[d++]=f,l[d++]=u,r+=4;if(a=s[r++],a<128)l[d++]=a;else if((224&a)==192){if(r>=p)return this.interim[0]=a,d;if(h=s[r++],(192&h)!=128){r--;continue}if(t=(31&a)<<6|63&h,t<128){r--;continue}l[d++]=t}else if((240&a)==224){if(r>=p)return this.interim[0]=a,d;if(h=s[r++],(192&h)!=128){r--;continue}if(r>=p)return this.interim[0]=a,this.interim[1]=h,d;if(f=s[r++],(192&f)!=128){r--;continue}if(t=(15&a)<<12|(63&h)<<6|63&f,t<2048||t>=55296&&t<=57343||t===65279)continue;l[d++]=t}else if((248&a)==240){if(r>=p)return this.interim[0]=a,d;if(h=s[r++],(192&h)!=128){r--;continue}if(r>=p)return this.interim[0]=a,this.interim[1]=h,d;if(f=s[r++],(192&f)!=128){r--;continue}if(r>=p)return this.interim[0]=a,this.interim[1]=h,this.interim[2]=f,d;if(u=s[r++],(192&u)!=128){r--;continue}if(t=(7&a)<<18|(63&h)<<12|(63&f)<<6|63&u,t<65536||t>1114111)continue;l[d++]=t}}return d}}},225:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeV6=void 0;const s=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],l=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let p;n.UnicodeV6=class{constructor(){if(this.version="6",!p){p=new Uint8Array(65536),p.fill(1),p[0]=0,p.fill(0,1,32),p.fill(0,127,160),p.fill(2,4352,4448),p[9001]=2,p[9002]=2,p.fill(2,11904,42192),p[12351]=1,p.fill(2,44032,55204),p.fill(2,63744,64256),p.fill(2,65040,65050),p.fill(2,65072,65136),p.fill(2,65280,65377),p.fill(2,65504,65511);for(let a=0;a<s.length;++a)p.fill(0,s[a][0],s[a][1]+1)}}wcwidth(a){return a<32?0:a<127?1:a<65536?p[a]:function(h,f){let u,d=0,t=f.length-1;if(h<f[0][0]||h>f[t][1])return!1;for(;t>=d;)if(u=d+t>>1,h>f[u][1])d=u+1;else{if(!(h<f[u][0]))return!0;t=u-1}return!1}(a,l)?0:a>=131072&&a<=196605||a>=196608&&a<=262141?2:1}}},5981:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WriteBuffer=void 0;const l=s(8460),p=s(844);class a extends p.Disposable{constructor(f){super(),this._action=f,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new l.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(f,u){if(u!==void 0&&this._syncCalls>u)return void(this._syncCalls=0);if(this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let d;for(this._isSyncWriting=!0;d=this._writeBuffer.shift();){this._action(d);const t=this._callbacks.shift();t&&t()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(f,u){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(u),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(u)}_innerWrite(f=0,u=!0){const d=f||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const t=this._writeBuffer[this._bufferOffset],i=this._action(t,u);if(i){const r=m=>Date.now()-d>=12?setTimeout(()=>this._innerWrite(0,m)):this._innerWrite(d,m);return void i.catch(m=>(queueMicrotask(()=>{throw m}),Promise.resolve(!1))).then(r)}const o=this._callbacks[this._bufferOffset];if(o&&o(),this._bufferOffset++,this._pendingData-=t.length,Date.now()-d>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}n.WriteBuffer=a},5941:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.toRgbString=n.parseColor=void 0;const s=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,l=/^[\da-f]+$/;function p(a,h){const f=a.toString(16),u=f.length<2?"0"+f:f;switch(h){case 4:return f[0];case 8:return u;case 12:return(u+u).slice(0,3);default:return u+u}}n.parseColor=function(a){if(!a)return;let h=a.toLowerCase();if(h.indexOf("rgb:")===0){h=h.slice(4);const f=s.exec(h);if(f){const u=f[1]?15:f[4]?255:f[7]?4095:65535;return[Math.round(parseInt(f[1]||f[4]||f[7]||f[10],16)/u*255),Math.round(parseInt(f[2]||f[5]||f[8]||f[11],16)/u*255),Math.round(parseInt(f[3]||f[6]||f[9]||f[12],16)/u*255)]}}else if(h.indexOf("#")===0&&(h=h.slice(1),l.exec(h)&&[3,6,9,12].includes(h.length))){const f=h.length/3,u=[0,0,0];for(let d=0;d<3;++d){const t=parseInt(h.slice(f*d,f*d+f),16);u[d]=f===1?t<<4:f===2?t:f===3?t>>4:t>>8}return u}},n.toRgbString=function(a,h=16){const[f,u,d]=a;return`rgb:${p(f,h)}/${p(u,h)}/${p(d,h)}`}},5770:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PAYLOAD_LIMIT=void 0,n.PAYLOAD_LIMIT=1e7},6351:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DcsHandler=n.DcsParser=void 0;const l=s(482),p=s(8742),a=s(5770),h=[];n.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=h,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=h}registerHandler(u,d){this._handlers[u]===void 0&&(this._handlers[u]=[]);const t=this._handlers[u];return t.push(d),{dispose:()=>{const i=t.indexOf(d);i!==-1&&t.splice(i,1)}}}clearHandler(u){this._handlers[u]&&delete this._handlers[u]}setHandlerFallback(u){this._handlerFb=u}reset(){if(this._active.length)for(let u=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;u>=0;--u)this._active[u].unhook(!1);this._stack.paused=!1,this._active=h,this._ident=0}hook(u,d){if(this.reset(),this._ident=u,this._active=this._handlers[u]||h,this._active.length)for(let t=this._active.length-1;t>=0;t--)this._active[t].hook(d);else this._handlerFb(this._ident,"HOOK",d)}put(u,d,t){if(this._active.length)for(let i=this._active.length-1;i>=0;i--)this._active[i].put(u,d,t);else this._handlerFb(this._ident,"PUT",(0,l.utf32ToString)(u,d,t))}unhook(u,d=!0){if(this._active.length){let t=!1,i=this._active.length-1,o=!1;if(this._stack.paused&&(i=this._stack.loopPosition-1,t=d,o=this._stack.fallThrough,this._stack.paused=!1),!o&&t===!1){for(;i>=0&&(t=this._active[i].unhook(u),t!==!0);i--)if(t instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=i,this._stack.fallThrough=!1,t;i--}for(;i>=0;i--)if(t=this._active[i].unhook(!1),t instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=i,this._stack.fallThrough=!0,t}else this._handlerFb(this._ident,"UNHOOK",u);this._active=h,this._ident=0}};const f=new p.Params;f.addParam(0),n.DcsHandler=class{constructor(u){this._handler=u,this._data="",this._params=f,this._hitLimit=!1}hook(u){this._params=u.length>1||u.params[0]?u.clone():f,this._data="",this._hitLimit=!1}put(u,d,t){this._hitLimit||(this._data+=(0,l.utf32ToString)(u,d,t),this._data.length>a.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(u){let d=!1;if(this._hitLimit)d=!1;else if(u&&(d=this._handler(this._data,this._params),d instanceof Promise))return d.then(t=>(this._params=f,this._data="",this._hitLimit=!1,t));return this._params=f,this._data="",this._hitLimit=!1,d}}},2015:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.EscapeSequenceParser=n.VT500_TRANSITION_TABLE=n.TransitionTable=void 0;const l=s(844),p=s(8742),a=s(6242),h=s(6351);class f{constructor(i){this.table=new Uint8Array(i)}setDefault(i,o){this.table.fill(i<<4|o)}add(i,o,r,m){this.table[o<<8|i]=r<<4|m}addMany(i,o,r,m){for(let g=0;g<i.length;g++)this.table[o<<8|i[g]]=r<<4|m}}n.TransitionTable=f;const u=160;n.VT500_TRANSITION_TABLE=function(){const t=new f(4095),i=Array.apply(null,Array(256)).map((T,w)=>w),o=(T,w)=>i.slice(T,w),r=o(32,127),m=o(0,24);m.push(25),m.push.apply(m,o(28,32));const g=o(0,14);let E;for(E in t.setDefault(1,0),t.addMany(r,0,2,0),g)t.addMany([24,26,153,154],E,3,0),t.addMany(o(128,144),E,3,0),t.addMany(o(144,152),E,3,0),t.add(156,E,0,0),t.add(27,E,11,1),t.add(157,E,4,8),t.addMany([152,158,159],E,0,7),t.add(155,E,11,3),t.add(144,E,11,9);return t.addMany(m,0,3,0),t.addMany(m,1,3,1),t.add(127,1,0,1),t.addMany(m,8,0,8),t.addMany(m,3,3,3),t.add(127,3,0,3),t.addMany(m,4,3,4),t.add(127,4,0,4),t.addMany(m,6,3,6),t.addMany(m,5,3,5),t.add(127,5,0,5),t.addMany(m,2,3,2),t.add(127,2,0,2),t.add(93,1,4,8),t.addMany(r,8,5,8),t.add(127,8,5,8),t.addMany([156,27,24,26,7],8,6,0),t.addMany(o(28,32),8,0,8),t.addMany([88,94,95],1,0,7),t.addMany(r,7,0,7),t.addMany(m,7,0,7),t.add(156,7,0,0),t.add(127,7,0,7),t.add(91,1,11,3),t.addMany(o(64,127),3,7,0),t.addMany(o(48,60),3,8,4),t.addMany([60,61,62,63],3,9,4),t.addMany(o(48,60),4,8,4),t.addMany(o(64,127),4,7,0),t.addMany([60,61,62,63],4,0,6),t.addMany(o(32,64),6,0,6),t.add(127,6,0,6),t.addMany(o(64,127),6,0,0),t.addMany(o(32,48),3,9,5),t.addMany(o(32,48),5,9,5),t.addMany(o(48,64),5,0,6),t.addMany(o(64,127),5,7,0),t.addMany(o(32,48),4,9,5),t.addMany(o(32,48),1,9,2),t.addMany(o(32,48),2,9,2),t.addMany(o(48,127),2,10,0),t.addMany(o(48,80),1,10,0),t.addMany(o(81,88),1,10,0),t.addMany([89,90,92],1,10,0),t.addMany(o(96,127),1,10,0),t.add(80,1,11,9),t.addMany(m,9,0,9),t.add(127,9,0,9),t.addMany(o(28,32),9,0,9),t.addMany(o(32,48),9,9,12),t.addMany(o(48,60),9,8,10),t.addMany([60,61,62,63],9,9,10),t.addMany(m,11,0,11),t.addMany(o(32,128),11,0,11),t.addMany(o(28,32),11,0,11),t.addMany(m,10,0,10),t.add(127,10,0,10),t.addMany(o(28,32),10,0,10),t.addMany(o(48,60),10,8,10),t.addMany([60,61,62,63],10,0,11),t.addMany(o(32,48),10,9,12),t.addMany(m,12,0,12),t.add(127,12,0,12),t.addMany(o(28,32),12,0,12),t.addMany(o(32,48),12,9,12),t.addMany(o(48,64),12,0,11),t.addMany(o(64,127),12,12,13),t.addMany(o(64,127),10,12,13),t.addMany(o(64,127),9,12,13),t.addMany(m,13,13,13),t.addMany(r,13,13,13),t.add(127,13,0,13),t.addMany([27,156,24,26],13,14,0),t.add(u,0,2,0),t.add(u,8,5,8),t.add(u,6,0,6),t.add(u,11,0,11),t.add(u,13,13,13),t}();class d extends l.Disposable{constructor(i=n.VT500_TRANSITION_TABLE){super(),this._transitions=i,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new p.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(o,r,m)=>{},this._executeHandlerFb=o=>{},this._csiHandlerFb=(o,r)=>{},this._escHandlerFb=o=>{},this._errorHandlerFb=o=>o,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,l.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new a.OscParser),this._dcsParser=this.register(new h.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(i,o=[64,126]){let r=0;if(i.prefix){if(i.prefix.length>1)throw new Error("only one byte as prefix supported");if(r=i.prefix.charCodeAt(0),r&&60>r||r>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(i.intermediates){if(i.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let g=0;g<i.intermediates.length;++g){const E=i.intermediates.charCodeAt(g);if(32>E||E>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");r<<=8,r|=E}}if(i.final.length!==1)throw new Error("final must be a single byte");const m=i.final.charCodeAt(0);if(o[0]>m||m>o[1])throw new Error(`final must be in range ${o[0]} .. ${o[1]}`);return r<<=8,r|=m,r}identToString(i){const o=[];for(;i;)o.push(String.fromCharCode(255&i)),i>>=8;return o.reverse().join("")}setPrintHandler(i){this._printHandler=i}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(i,o){const r=this._identifier(i,[48,126]);this._escHandlers[r]===void 0&&(this._escHandlers[r]=[]);const m=this._escHandlers[r];return m.push(o),{dispose:()=>{const g=m.indexOf(o);g!==-1&&m.splice(g,1)}}}clearEscHandler(i){this._escHandlers[this._identifier(i,[48,126])]&&delete this._escHandlers[this._identifier(i,[48,126])]}setEscHandlerFallback(i){this._escHandlerFb=i}setExecuteHandler(i,o){this._executeHandlers[i.charCodeAt(0)]=o}clearExecuteHandler(i){this._executeHandlers[i.charCodeAt(0)]&&delete this._executeHandlers[i.charCodeAt(0)]}setExecuteHandlerFallback(i){this._executeHandlerFb=i}registerCsiHandler(i,o){const r=this._identifier(i);this._csiHandlers[r]===void 0&&(this._csiHandlers[r]=[]);const m=this._csiHandlers[r];return m.push(o),{dispose:()=>{const g=m.indexOf(o);g!==-1&&m.splice(g,1)}}}clearCsiHandler(i){this._csiHandlers[this._identifier(i)]&&delete this._csiHandlers[this._identifier(i)]}setCsiHandlerFallback(i){this._csiHandlerFb=i}registerDcsHandler(i,o){return this._dcsParser.registerHandler(this._identifier(i),o)}clearDcsHandler(i){this._dcsParser.clearHandler(this._identifier(i))}setDcsHandlerFallback(i){this._dcsParser.setHandlerFallback(i)}registerOscHandler(i,o){return this._oscParser.registerHandler(i,o)}clearOscHandler(i){this._oscParser.clearHandler(i)}setOscHandlerFallback(i){this._oscParser.setHandlerFallback(i)}setErrorHandler(i){this._errorHandler=i}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(i,o,r,m,g){this._parseStack.state=i,this._parseStack.handlers=o,this._parseStack.handlerPos=r,this._parseStack.transition=m,this._parseStack.chunkPos=g}parse(i,o,r){let m,g=0,E=0,T=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,T=this._parseStack.chunkPos+1;else{if(r===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const w=this._parseStack.handlers;let y=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(r===!1&&y>-1){for(;y>=0&&(m=w[y](this._params),m!==!0);y--)if(m instanceof Promise)return this._parseStack.handlerPos=y,m}this._parseStack.handlers=[];break;case 4:if(r===!1&&y>-1){for(;y>=0&&(m=w[y](),m!==!0);y--)if(m instanceof Promise)return this._parseStack.handlerPos=y,m}this._parseStack.handlers=[];break;case 6:if(g=i[this._parseStack.chunkPos],m=this._dcsParser.unhook(g!==24&&g!==26,r),m)return m;g===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(g=i[this._parseStack.chunkPos],m=this._oscParser.end(g!==24&&g!==26,r),m)return m;g===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,T=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let w=T;w<o;++w){switch(g=i[w],E=this._transitions.table[this.currentState<<8|(g<160?g:u)],E>>4){case 2:for(let D=w+1;;++D){if(D>=o||(g=i[D])<32||g>126&&g<u){this._printHandler(i,w,D),w=D-1;break}if(++D>=o||(g=i[D])<32||g>126&&g<u){this._printHandler(i,w,D),w=D-1;break}if(++D>=o||(g=i[D])<32||g>126&&g<u){this._printHandler(i,w,D),w=D-1;break}if(++D>=o||(g=i[D])<32||g>126&&g<u){this._printHandler(i,w,D),w=D-1;break}}break;case 3:this._executeHandlers[g]?this._executeHandlers[g]():this._executeHandlerFb(g),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:w,code:g,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const y=this._csiHandlers[this._collect<<8|g];let M=y?y.length-1:-1;for(;M>=0&&(m=y[M](this._params),m!==!0);M--)if(m instanceof Promise)return this._preserveStack(3,y,M,E,w),m;M<0&&this._csiHandlerFb(this._collect<<8|g,this._params),this.precedingCodepoint=0;break;case 8:do switch(g){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(g-48)}while(++w<o&&(g=i[w])>47&&g<60);w--;break;case 9:this._collect<<=8,this._collect|=g;break;case 10:const I=this._escHandlers[this._collect<<8|g];let C=I?I.length-1:-1;for(;C>=0&&(m=I[C](),m!==!0);C--)if(m instanceof Promise)return this._preserveStack(4,I,C,E,w),m;C<0&&this._escHandlerFb(this._collect<<8|g),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|g,this._params);break;case 13:for(let D=w+1;;++D)if(D>=o||(g=i[D])===24||g===26||g===27||g>127&&g<u){this._dcsParser.put(i,w,D),w=D-1;break}break;case 14:if(m=this._dcsParser.unhook(g!==24&&g!==26),m)return this._preserveStack(6,[],0,E,w),m;g===27&&(E|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let D=w+1;;D++)if(D>=o||(g=i[D])<32||g>127&&g<u){this._oscParser.put(i,w,D),w=D-1;break}break;case 6:if(m=this._oscParser.end(g!==24&&g!==26),m)return this._preserveStack(5,[],0,E,w),m;g===27&&(E|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&E}}}n.EscapeSequenceParser=d},6242:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OscHandler=n.OscParser=void 0;const l=s(5770),p=s(482),a=[];n.OscParser=class{constructor(){this._state=0,this._active=a,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(h,f){this._handlers[h]===void 0&&(this._handlers[h]=[]);const u=this._handlers[h];return u.push(f),{dispose:()=>{const d=u.indexOf(f);d!==-1&&u.splice(d,1)}}}clearHandler(h){this._handlers[h]&&delete this._handlers[h]}setHandlerFallback(h){this._handlerFb=h}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=a}reset(){if(this._state===2)for(let h=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;h>=0;--h)this._active[h].end(!1);this._stack.paused=!1,this._active=a,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||a,this._active.length)for(let h=this._active.length-1;h>=0;h--)this._active[h].start();else this._handlerFb(this._id,"START")}_put(h,f,u){if(this._active.length)for(let d=this._active.length-1;d>=0;d--)this._active[d].put(h,f,u);else this._handlerFb(this._id,"PUT",(0,p.utf32ToString)(h,f,u))}start(){this.reset(),this._state=1}put(h,f,u){if(this._state!==3){if(this._state===1)for(;f<u;){const d=h[f++];if(d===59){this._state=2,this._start();break}if(d<48||57<d)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+d-48}this._state===2&&u-f>0&&this._put(h,f,u)}}end(h,f=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let u=!1,d=this._active.length-1,t=!1;if(this._stack.paused&&(d=this._stack.loopPosition-1,u=f,t=this._stack.fallThrough,this._stack.paused=!1),!t&&u===!1){for(;d>=0&&(u=this._active[d].end(h),u!==!0);d--)if(u instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=d,this._stack.fallThrough=!1,u;d--}for(;d>=0;d--)if(u=this._active[d].end(!1),u instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=d,this._stack.fallThrough=!0,u}else this._handlerFb(this._id,"END",h);this._active=a,this._id=-1,this._state=0}}},n.OscHandler=class{constructor(h){this._handler=h,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(h,f,u){this._hitLimit||(this._data+=(0,p.utf32ToString)(h,f,u),this._data.length>l.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(h){let f=!1;if(this._hitLimit)f=!1;else if(h&&(f=this._handler(this._data),f instanceof Promise))return f.then(u=>(this._data="",this._hitLimit=!1,u));return this._data="",this._hitLimit=!1,f}}},8742:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Params=void 0;const s=2147483647;class l{static fromArray(a){const h=new l;if(!a.length)return h;for(let f=Array.isArray(a[0])?1:0;f<a.length;++f){const u=a[f];if(Array.isArray(u))for(let d=0;d<u.length;++d)h.addSubParam(u[d]);else h.addParam(u)}return h}constructor(a=32,h=32){if(this.maxLength=a,this.maxSubParamsLength=h,h>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(a),this.length=0,this._subParams=new Int32Array(h),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(a),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const a=new l(this.maxLength,this.maxSubParamsLength);return a.params.set(this.params),a.length=this.length,a._subParams.set(this._subParams),a._subParamsLength=this._subParamsLength,a._subParamsIdx.set(this._subParamsIdx),a._rejectDigits=this._rejectDigits,a._rejectSubDigits=this._rejectSubDigits,a._digitIsSub=this._digitIsSub,a}toArray(){const a=[];for(let h=0;h<this.length;++h){a.push(this.params[h]);const f=this._subParamsIdx[h]>>8,u=255&this._subParamsIdx[h];u-f>0&&a.push(Array.prototype.slice.call(this._subParams,f,u))}return a}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(a){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(a<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=a>s?s:a}}addSubParam(a){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(a<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=a>s?s:a,this._subParamsIdx[this.length-1]++}}hasSubParams(a){return(255&this._subParamsIdx[a])-(this._subParamsIdx[a]>>8)>0}getSubParams(a){const h=this._subParamsIdx[a]>>8,f=255&this._subParamsIdx[a];return f-h>0?this._subParams.subarray(h,f):null}getSubParamsAll(){const a={};for(let h=0;h<this.length;++h){const f=this._subParamsIdx[h]>>8,u=255&this._subParamsIdx[h];u-f>0&&(a[h]=this._subParams.slice(f,u))}return a}addDigit(a){let h;if(this._rejectDigits||!(h=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const f=this._digitIsSub?this._subParams:this.params,u=f[h-1];f[h-1]=~u?Math.min(10*u+a,s):a}}n.Params=l},5741:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AddonManager=void 0,n.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let s=this._addons.length-1;s>=0;s--)this._addons[s].instance.dispose()}loadAddon(s,l){const p={instance:l,dispose:l.dispose,isDisposed:!1};this._addons.push(p),l.dispose=()=>this._wrappedAddonDispose(p),l.activate(s)}_wrappedAddonDispose(s){if(s.isDisposed)return;let l=-1;for(let p=0;p<this._addons.length;p++)if(this._addons[p]===s){l=p;break}if(l===-1)throw new Error("Could not dispose an addon that has not been loaded");s.isDisposed=!0,s.dispose.apply(s.instance),this._addons.splice(l,1)}}},8771:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferApiView=void 0;const l=s(3785),p=s(511);n.BufferApiView=class{constructor(a,h){this._buffer=a,this.type=h}init(a){return this._buffer=a,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(a){const h=this._buffer.lines.get(a);if(h)return new l.BufferLineApiView(h)}getNullCell(){return new p.CellData}}},3785:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferLineApiView=void 0;const l=s(511);n.BufferLineApiView=class{constructor(p){this._line=p}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(p,a){if(!(p<0||p>=this._line.length))return a?(this._line.loadCell(p,a),a):this._line.loadCell(p,new l.CellData)}translateToString(p,a,h){return this._line.translateToString(p,a,h)}}},8285:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferNamespaceApi=void 0;const l=s(8771),p=s(8460),a=s(844);class h extends a.Disposable{constructor(u){super(),this._core=u,this._onBufferChange=this.register(new p.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new l.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new l.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}n.BufferNamespaceApi=h},7975:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ParserApi=void 0,n.ParserApi=class{constructor(s){this._core=s}registerCsiHandler(s,l){return this._core.registerCsiHandler(s,p=>l(p.toArray()))}addCsiHandler(s,l){return this.registerCsiHandler(s,l)}registerDcsHandler(s,l){return this._core.registerDcsHandler(s,(p,a)=>l(p,a.toArray()))}addDcsHandler(s,l){return this.registerDcsHandler(s,l)}registerEscHandler(s,l){return this._core.registerEscHandler(s,l)}addEscHandler(s,l){return this.registerEscHandler(s,l)}registerOscHandler(s,l){return this._core.registerOscHandler(s,l)}addOscHandler(s,l){return this.registerOscHandler(s,l)}}},7090:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeApi=void 0,n.UnicodeApi=class{constructor(s){this._core=s}register(s){this._core.unicodeService.register(s)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(s){this._core.unicodeService.activeVersion=s}}},744:function(S,n,s){var l=this&&this.__decorate||function(t,i,o,r){var m,g=arguments.length,E=g<3?i:r===null?r=Object.getOwnPropertyDescriptor(i,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(t,i,o,r);else for(var T=t.length-1;T>=0;T--)(m=t[T])&&(E=(g<3?m(E):g>3?m(i,o,E):m(i,o))||E);return g>3&&E&&Object.defineProperty(i,o,E),E},p=this&&this.__param||function(t,i){return function(o,r){i(o,r,t)}};Object.defineProperty(n,"__esModule",{value:!0}),n.BufferService=n.MINIMUM_ROWS=n.MINIMUM_COLS=void 0;const a=s(8460),h=s(844),f=s(5295),u=s(2585);n.MINIMUM_COLS=2,n.MINIMUM_ROWS=1;let d=n.BufferService=class extends h.Disposable{get buffer(){return this.buffers.active}constructor(t){super(),this.isUserScrolling=!1,this._onResize=this.register(new a.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new a.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(t.rawOptions.cols||0,n.MINIMUM_COLS),this.rows=Math.max(t.rawOptions.rows||0,n.MINIMUM_ROWS),this.buffers=this.register(new f.BufferSet(t,this))}resize(t,i){this.cols=t,this.rows=i,this.buffers.resize(t,i),this._onResize.fire({cols:t,rows:i})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(t,i=!1){const o=this.buffer;let r;r=this._cachedBlankLine,r&&r.length===this.cols&&r.getFg(0)===t.fg&&r.getBg(0)===t.bg||(r=o.getBlankLine(t,i),this._cachedBlankLine=r),r.isWrapped=i;const m=o.ybase+o.scrollTop,g=o.ybase+o.scrollBottom;if(o.scrollTop===0){const E=o.lines.isFull;g===o.lines.length-1?E?o.lines.recycle().copyFrom(r):o.lines.push(r.clone()):o.lines.splice(g+1,0,r.clone()),E?this.isUserScrolling&&(o.ydisp=Math.max(o.ydisp-1,0)):(o.ybase++,this.isUserScrolling||o.ydisp++)}else{const E=g-m+1;o.lines.shiftElements(m+1,E-1,-1),o.lines.set(g,r.clone())}this.isUserScrolling||(o.ydisp=o.ybase),this._onScroll.fire(o.ydisp)}scrollLines(t,i,o){const r=this.buffer;if(t<0){if(r.ydisp===0)return;this.isUserScrolling=!0}else t+r.ydisp>=r.ybase&&(this.isUserScrolling=!1);const m=r.ydisp;r.ydisp=Math.max(Math.min(r.ydisp+t,r.ybase),0),m!==r.ydisp&&(i||this._onScroll.fire(r.ydisp))}};n.BufferService=d=l([p(0,u.IOptionsService)],d)},7994:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CharsetService=void 0,n.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(s){this.glevel=s,this.charset=this._charsets[s]}setgCharset(s,l){this._charsets[s]=l,this.glevel===s&&(this.charset=l)}}},1753:function(S,n,s){var l=this&&this.__decorate||function(r,m,g,E){var T,w=arguments.length,y=w<3?m:E===null?E=Object.getOwnPropertyDescriptor(m,g):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(r,m,g,E);else for(var M=r.length-1;M>=0;M--)(T=r[M])&&(y=(w<3?T(y):w>3?T(m,g,y):T(m,g))||y);return w>3&&y&&Object.defineProperty(m,g,y),y},p=this&&this.__param||function(r,m){return function(g,E){m(g,E,r)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CoreMouseService=void 0;const a=s(2585),h=s(8460),f=s(844),u={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:r=>r.button!==4&&r.action===1&&(r.ctrl=!1,r.alt=!1,r.shift=!1,!0)},VT200:{events:19,restrict:r=>r.action!==32},DRAG:{events:23,restrict:r=>r.action!==32||r.button!==3},ANY:{events:31,restrict:r=>!0}};function d(r,m){let g=(r.ctrl?16:0)|(r.shift?4:0)|(r.alt?8:0);return r.button===4?(g|=64,g|=r.action):(g|=3&r.button,4&r.button&&(g|=64),8&r.button&&(g|=128),r.action===32?g|=32:r.action!==0||m||(g|=3)),g}const t=String.fromCharCode,i={DEFAULT:r=>{const m=[d(r,!1)+32,r.col+32,r.row+32];return m[0]>255||m[1]>255||m[2]>255?"":`\x1B[M${t(m[0])}${t(m[1])}${t(m[2])}`},SGR:r=>{const m=r.action===0&&r.button!==4?"m":"M";return`\x1B[<${d(r,!0)};${r.col};${r.row}${m}`},SGR_PIXELS:r=>{const m=r.action===0&&r.button!==4?"m":"M";return`\x1B[<${d(r,!0)};${r.x};${r.y}${m}`}};let o=n.CoreMouseService=class extends f.Disposable{constructor(r,m){super(),this._bufferService=r,this._coreService=m,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new h.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const g of Object.keys(u))this.addProtocol(g,u[g]);for(const g of Object.keys(i))this.addEncoding(g,i[g]);this.reset()}addProtocol(r,m){this._protocols[r]=m}addEncoding(r,m){this._encodings[r]=m}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(r){if(!this._protocols[r])throw new Error(`unknown protocol "${r}"`);this._activeProtocol=r,this._onProtocolChange.fire(this._protocols[r].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(r){if(!this._encodings[r])throw new Error(`unknown encoding "${r}"`);this._activeEncoding=r}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(r){if(r.col<0||r.col>=this._bufferService.cols||r.row<0||r.row>=this._bufferService.rows||r.button===4&&r.action===32||r.button===3&&r.action!==32||r.button!==4&&(r.action===2||r.action===3)||(r.col++,r.row++,r.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,r,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(r))return!1;const m=this._encodings[this._activeEncoding](r);return m&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(m):this._coreService.triggerDataEvent(m,!0)),this._lastEvent=r,!0}explainEvents(r){return{down:!!(1&r),up:!!(2&r),drag:!!(4&r),move:!!(8&r),wheel:!!(16&r)}}_equalEvents(r,m,g){if(g){if(r.x!==m.x||r.y!==m.y)return!1}else if(r.col!==m.col||r.row!==m.row)return!1;return r.button===m.button&&r.action===m.action&&r.ctrl===m.ctrl&&r.alt===m.alt&&r.shift===m.shift}};n.CoreMouseService=o=l([p(0,a.IBufferService),p(1,a.ICoreService)],o)},6975:function(S,n,s){var l=this&&this.__decorate||function(o,r,m,g){var E,T=arguments.length,w=T<3?r:g===null?g=Object.getOwnPropertyDescriptor(r,m):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(o,r,m,g);else for(var y=o.length-1;y>=0;y--)(E=o[y])&&(w=(T<3?E(w):T>3?E(r,m,w):E(r,m))||w);return T>3&&w&&Object.defineProperty(r,m,w),w},p=this&&this.__param||function(o,r){return function(m,g){r(m,g,o)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CoreService=void 0;const a=s(1439),h=s(8460),f=s(844),u=s(2585),d=Object.freeze({insertMode:!1}),t=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let i=n.CoreService=class extends f.Disposable{constructor(o,r,m){super(),this._bufferService=o,this._logService=r,this._optionsService=m,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new h.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new h.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new h.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new h.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,a.clone)(d),this.decPrivateModes=(0,a.clone)(t)}reset(){this.modes=(0,a.clone)(d),this.decPrivateModes=(0,a.clone)(t)}triggerDataEvent(o,r=!1){if(this._optionsService.rawOptions.disableStdin)return;const m=this._bufferService.buffer;r&&this._optionsService.rawOptions.scrollOnUserInput&&m.ybase!==m.ydisp&&this._onRequestScrollToBottom.fire(),r&&this._onUserInput.fire(),this._logService.debug(`sending data "${o}"`,()=>o.split("").map(g=>g.charCodeAt(0))),this._onData.fire(o)}triggerBinaryEvent(o){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${o}"`,()=>o.split("").map(r=>r.charCodeAt(0))),this._onBinary.fire(o))}};n.CoreService=i=l([p(0,u.IBufferService),p(1,u.ILogService),p(2,u.IOptionsService)],i)},9074:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DecorationService=void 0;const l=s(8055),p=s(8460),a=s(844),h=s(6106);let f=0,u=0;class d extends a.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new h.SortedList(o=>o==null?void 0:o.marker.line),this._onDecorationRegistered=this.register(new p.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new p.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,a.toDisposable)(()=>this.reset()))}registerDecoration(o){if(o.marker.isDisposed)return;const r=new t(o);if(r){const m=r.marker.onDispose(()=>r.dispose());r.onDispose(()=>{r&&(this._decorations.delete(r)&&this._onDecorationRemoved.fire(r),m.dispose())}),this._decorations.insert(r),this._onDecorationRegistered.fire(r)}return r}reset(){for(const o of this._decorations.values())o.dispose();this._decorations.clear()}*getDecorationsAtCell(o,r,m){var g,E,T;let w=0,y=0;for(const M of this._decorations.getKeyIterator(r))w=(g=M.options.x)!==null&&g!==void 0?g:0,y=w+((E=M.options.width)!==null&&E!==void 0?E:1),o>=w&&o<y&&(!m||((T=M.options.layer)!==null&&T!==void 0?T:"bottom")===m)&&(yield M)}forEachDecorationAtCell(o,r,m,g){this._decorations.forEachByKey(r,E=>{var T,w,y;f=(T=E.options.x)!==null&&T!==void 0?T:0,u=f+((w=E.options.width)!==null&&w!==void 0?w:1),o>=f&&o<u&&(!m||((y=E.options.layer)!==null&&y!==void 0?y:"bottom")===m)&&g(E)})}}n.DecorationService=d;class t extends a.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=l.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=l.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(o){super(),this.options=o,this.onRenderEmitter=this.register(new p.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new p.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=o.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.InstantiationService=n.ServiceCollection=void 0;const l=s(2585),p=s(8343);class a{constructor(...f){this._entries=new Map;for(const[u,d]of f)this.set(u,d)}set(f,u){const d=this._entries.get(f);return this._entries.set(f,u),d}forEach(f){for(const[u,d]of this._entries.entries())f(u,d)}has(f){return this._entries.has(f)}get(f){return this._entries.get(f)}}n.ServiceCollection=a,n.InstantiationService=class{constructor(){this._services=new a,this._services.set(l.IInstantiationService,this)}setService(h,f){this._services.set(h,f)}getService(h){return this._services.get(h)}createInstance(h,...f){const u=(0,p.getServiceDependencies)(h).sort((i,o)=>i.index-o.index),d=[];for(const i of u){const o=this._services.get(i.id);if(!o)throw new Error(`[createInstance] ${h.name} depends on UNKNOWN service ${i.id}.`);d.push(o)}const t=u.length>0?u[0].index:f.length;if(f.length!==t)throw new Error(`[createInstance] First service dependency of ${h.name} at position ${t+1} conflicts with ${f.length} static arguments`);return new h(...f,...d)}}},7866:function(S,n,s){var l=this&&this.__decorate||function(t,i,o,r){var m,g=arguments.length,E=g<3?i:r===null?r=Object.getOwnPropertyDescriptor(i,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(t,i,o,r);else for(var T=t.length-1;T>=0;T--)(m=t[T])&&(E=(g<3?m(E):g>3?m(i,o,E):m(i,o))||E);return g>3&&E&&Object.defineProperty(i,o,E),E},p=this&&this.__param||function(t,i){return function(o,r){i(o,r,t)}};Object.defineProperty(n,"__esModule",{value:!0}),n.traceCall=n.setTraceLogger=n.LogService=void 0;const a=s(844),h=s(2585),f={trace:h.LogLevelEnum.TRACE,debug:h.LogLevelEnum.DEBUG,info:h.LogLevelEnum.INFO,warn:h.LogLevelEnum.WARN,error:h.LogLevelEnum.ERROR,off:h.LogLevelEnum.OFF};let u,d=n.LogService=class extends a.Disposable{get logLevel(){return this._logLevel}constructor(t){super(),this._optionsService=t,this._logLevel=h.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),u=this}_updateLogLevel(){this._logLevel=f[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(t){for(let i=0;i<t.length;i++)typeof t[i]=="function"&&(t[i]=t[i]())}_log(t,i,o){this._evalLazyOptionalParams(o),t.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+i,...o)}trace(t,...i){var o,r;this._logLevel<=h.LogLevelEnum.TRACE&&this._log((r=(o=this._optionsService.options.logger)===null||o===void 0?void 0:o.trace.bind(this._optionsService.options.logger))!==null&&r!==void 0?r:console.log,t,i)}debug(t,...i){var o,r;this._logLevel<=h.LogLevelEnum.DEBUG&&this._log((r=(o=this._optionsService.options.logger)===null||o===void 0?void 0:o.debug.bind(this._optionsService.options.logger))!==null&&r!==void 0?r:console.log,t,i)}info(t,...i){var o,r;this._logLevel<=h.LogLevelEnum.INFO&&this._log((r=(o=this._optionsService.options.logger)===null||o===void 0?void 0:o.info.bind(this._optionsService.options.logger))!==null&&r!==void 0?r:console.info,t,i)}warn(t,...i){var o,r;this._logLevel<=h.LogLevelEnum.WARN&&this._log((r=(o=this._optionsService.options.logger)===null||o===void 0?void 0:o.warn.bind(this._optionsService.options.logger))!==null&&r!==void 0?r:console.warn,t,i)}error(t,...i){var o,r;this._logLevel<=h.LogLevelEnum.ERROR&&this._log((r=(o=this._optionsService.options.logger)===null||o===void 0?void 0:o.error.bind(this._optionsService.options.logger))!==null&&r!==void 0?r:console.error,t,i)}};n.LogService=d=l([p(0,h.IOptionsService)],d),n.setTraceLogger=function(t){u=t},n.traceCall=function(t,i,o){if(typeof o.value!="function")throw new Error("not supported");const r=o.value;o.value=function(...m){if(u.logLevel!==h.LogLevelEnum.TRACE)return r.apply(this,m);u.trace(`GlyphRenderer#${r.name}(${m.map(E=>JSON.stringify(E)).join(", ")})`);const g=r.apply(this,m);return u.trace(`GlyphRenderer#${r.name} return`,g),g}}},7302:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OptionsService=n.DEFAULT_OPTIONS=void 0;const l=s(8460),p=s(844),a=s(6114);n.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:a.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const h=["normal","bold","100","200","300","400","500","600","700","800","900"];class f extends p.Disposable{constructor(d){super(),this._onOptionChange=this.register(new l.EventEmitter),this.onOptionChange=this._onOptionChange.event;const t=Object.assign({},n.DEFAULT_OPTIONS);for(const i in d)if(i in t)try{const o=d[i];t[i]=this._sanitizeAndValidateOption(i,o)}catch(o){console.error(o)}this.rawOptions=t,this.options=Object.assign({},t),this._setupOptions()}onSpecificOptionChange(d,t){return this.onOptionChange(i=>{i===d&&t(this.rawOptions[d])})}onMultipleOptionChange(d,t){return this.onOptionChange(i=>{d.indexOf(i)!==-1&&t()})}_setupOptions(){const d=i=>{if(!(i in n.DEFAULT_OPTIONS))throw new Error(`No option with key "${i}"`);return this.rawOptions[i]},t=(i,o)=>{if(!(i in n.DEFAULT_OPTIONS))throw new Error(`No option with key "${i}"`);o=this._sanitizeAndValidateOption(i,o),this.rawOptions[i]!==o&&(this.rawOptions[i]=o,this._onOptionChange.fire(i))};for(const i in this.rawOptions){const o={get:d.bind(this,i),set:t.bind(this,i)};Object.defineProperty(this.options,i,o)}}_sanitizeAndValidateOption(d,t){switch(d){case"cursorStyle":if(t||(t=n.DEFAULT_OPTIONS[d]),!function(i){return i==="block"||i==="underline"||i==="bar"}(t))throw new Error(`"${t}" is not a valid value for ${d}`);break;case"wordSeparator":t||(t=n.DEFAULT_OPTIONS[d]);break;case"fontWeight":case"fontWeightBold":if(typeof t=="number"&&1<=t&&t<=1e3)break;t=h.includes(t)?t:n.DEFAULT_OPTIONS[d];break;case"cursorWidth":t=Math.floor(t);case"lineHeight":case"tabStopWidth":if(t<1)throw new Error(`${d} cannot be less than 1, value: ${t}`);break;case"minimumContrastRatio":t=Math.max(1,Math.min(21,Math.round(10*t)/10));break;case"scrollback":if((t=Math.min(t,4294967295))<0)throw new Error(`${d} cannot be less than 0, value: ${t}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(t<=0)throw new Error(`${d} cannot be less than or equal to 0, value: ${t}`);break;case"rows":case"cols":if(!t&&t!==0)throw new Error(`${d} must be numeric, value: ${t}`);break;case"windowsPty":t=t??{}}return t}}n.OptionsService=f},2660:function(S,n,s){var l=this&&this.__decorate||function(f,u,d,t){var i,o=arguments.length,r=o<3?u:t===null?t=Object.getOwnPropertyDescriptor(u,d):t;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(f,u,d,t);else for(var m=f.length-1;m>=0;m--)(i=f[m])&&(r=(o<3?i(r):o>3?i(u,d,r):i(u,d))||r);return o>3&&r&&Object.defineProperty(u,d,r),r},p=this&&this.__param||function(f,u){return function(d,t){u(d,t,f)}};Object.defineProperty(n,"__esModule",{value:!0}),n.OscLinkService=void 0;const a=s(2585);let h=n.OscLinkService=class{constructor(f){this._bufferService=f,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(f){const u=this._bufferService.buffer;if(f.id===void 0){const m=u.addMarker(u.ybase+u.y),g={data:f,id:this._nextId++,lines:[m]};return m.onDispose(()=>this._removeMarkerFromLink(g,m)),this._dataByLinkId.set(g.id,g),g.id}const d=f,t=this._getEntryIdKey(d),i=this._entriesWithId.get(t);if(i)return this.addLineToLink(i.id,u.ybase+u.y),i.id;const o=u.addMarker(u.ybase+u.y),r={id:this._nextId++,key:this._getEntryIdKey(d),data:d,lines:[o]};return o.onDispose(()=>this._removeMarkerFromLink(r,o)),this._entriesWithId.set(r.key,r),this._dataByLinkId.set(r.id,r),r.id}addLineToLink(f,u){const d=this._dataByLinkId.get(f);if(d&&d.lines.every(t=>t.line!==u)){const t=this._bufferService.buffer.addMarker(u);d.lines.push(t),t.onDispose(()=>this._removeMarkerFromLink(d,t))}}getLinkData(f){var u;return(u=this._dataByLinkId.get(f))===null||u===void 0?void 0:u.data}_getEntryIdKey(f){return`${f.id};;${f.uri}`}_removeMarkerFromLink(f,u){const d=f.lines.indexOf(u);d!==-1&&(f.lines.splice(d,1),f.lines.length===0&&(f.data.id!==void 0&&this._entriesWithId.delete(f.key),this._dataByLinkId.delete(f.id)))}};n.OscLinkService=h=l([p(0,a.IBufferService)],h)},8343:(S,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createDecorator=n.getServiceDependencies=n.serviceRegistry=void 0;const s="di$target",l="di$dependencies";n.serviceRegistry=new Map,n.getServiceDependencies=function(p){return p[l]||[]},n.createDecorator=function(p){if(n.serviceRegistry.has(p))return n.serviceRegistry.get(p);const a=function(h,f,u){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(d,t,i){t[s]===t?t[l].push({id:d,index:i}):(t[l]=[{id:d,index:i}],t[s]=t)})(a,h,u)};return a.toString=()=>p,n.serviceRegistry.set(p,a),a}},2585:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.IDecorationService=n.IUnicodeService=n.IOscLinkService=n.IOptionsService=n.ILogService=n.LogLevelEnum=n.IInstantiationService=n.ICharsetService=n.ICoreService=n.ICoreMouseService=n.IBufferService=void 0;const l=s(8343);var p;n.IBufferService=(0,l.createDecorator)("BufferService"),n.ICoreMouseService=(0,l.createDecorator)("CoreMouseService"),n.ICoreService=(0,l.createDecorator)("CoreService"),n.ICharsetService=(0,l.createDecorator)("CharsetService"),n.IInstantiationService=(0,l.createDecorator)("InstantiationService"),function(a){a[a.TRACE=0]="TRACE",a[a.DEBUG=1]="DEBUG",a[a.INFO=2]="INFO",a[a.WARN=3]="WARN",a[a.ERROR=4]="ERROR",a[a.OFF=5]="OFF"}(p||(n.LogLevelEnum=p={})),n.ILogService=(0,l.createDecorator)("LogService"),n.IOptionsService=(0,l.createDecorator)("OptionsService"),n.IOscLinkService=(0,l.createDecorator)("OscLinkService"),n.IUnicodeService=(0,l.createDecorator)("UnicodeService"),n.IDecorationService=(0,l.createDecorator)("DecorationService")},1480:(S,n,s)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeService=void 0;const l=s(8460),p=s(225);n.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new l.EventEmitter,this.onChange=this._onChange.event;const a=new p.UnicodeV6;this.register(a),this._active=a.version,this._activeProvider=a}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(a){if(!this._providers[a])throw new Error(`unknown Unicode version "${a}"`);this._active=a,this._activeProvider=this._providers[a],this._onChange.fire(a)}register(a){this._providers[a.version]=a}wcwidth(a){return this._activeProvider.wcwidth(a)}getStringCellWidth(a){let h=0;const f=a.length;for(let u=0;u<f;++u){let d=a.charCodeAt(u);if(55296<=d&&d<=56319){if(++u>=f)return h+this.wcwidth(d);const t=a.charCodeAt(u);56320<=t&&t<=57343?d=1024*(d-55296)+t-56320+65536:h+=this.wcwidth(t)}h+=this.wcwidth(d)}return h}}}},b={};function x(S){var n=b[S];if(n!==void 0)return n.exports;var s=b[S]={exports:{}};return v[S].call(s.exports,s,s.exports,x),s.exports}var k={};return(()=>{var S=k;Object.defineProperty(S,"__esModule",{value:!0}),S.Terminal=void 0;const n=x(9042),s=x(3236),l=x(844),p=x(5741),a=x(8285),h=x(7975),f=x(7090),u=["cols","rows"];class d extends l.Disposable{constructor(i){super(),this._core=this.register(new s.Terminal(i)),this._addonManager=this.register(new p.AddonManager),this._publicOptions=Object.assign({},this._core.options);const o=m=>this._core.options[m],r=(m,g)=>{this._checkReadonlyOptions(m),this._core.options[m]=g};for(const m in this._core.options){const g={get:o.bind(this,m),set:r.bind(this,m)};Object.defineProperty(this._publicOptions,m,g)}}_checkReadonlyOptions(i){if(u.includes(i))throw new Error(`Option "${i}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new h.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new f.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new a.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const i=this._core.coreService.decPrivateModes;let o="none";switch(this._core.coreMouseService.activeProtocol){case"X10":o="x10";break;case"VT200":o="vt200";break;case"DRAG":o="drag";break;case"ANY":o="any"}return{applicationCursorKeysMode:i.applicationCursorKeys,applicationKeypadMode:i.applicationKeypad,bracketedPasteMode:i.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:o,originMode:i.origin,reverseWraparoundMode:i.reverseWraparound,sendFocusMode:i.sendFocus,wraparoundMode:i.wraparound}}get options(){return this._publicOptions}set options(i){for(const o in i)this._publicOptions[o]=i[o]}blur(){this._core.blur()}focus(){this._core.focus()}resize(i,o){this._verifyIntegers(i,o),this._core.resize(i,o)}open(i){this._core.open(i)}attachCustomKeyEventHandler(i){this._core.attachCustomKeyEventHandler(i)}registerLinkProvider(i){return this._core.registerLinkProvider(i)}registerCharacterJoiner(i){return this._checkProposedApi(),this._core.registerCharacterJoiner(i)}deregisterCharacterJoiner(i){this._checkProposedApi(),this._core.deregisterCharacterJoiner(i)}registerMarker(i=0){return this._verifyIntegers(i),this._core.registerMarker(i)}registerDecoration(i){var o,r,m;return this._checkProposedApi(),this._verifyPositiveIntegers((o=i.x)!==null&&o!==void 0?o:0,(r=i.width)!==null&&r!==void 0?r:0,(m=i.height)!==null&&m!==void 0?m:0),this._core.registerDecoration(i)}hasSelection(){return this._core.hasSelection()}select(i,o,r){this._verifyIntegers(i,o,r),this._core.select(i,o,r)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(i,o){this._verifyIntegers(i,o),this._core.selectLines(i,o)}dispose(){super.dispose()}scrollLines(i){this._verifyIntegers(i),this._core.scrollLines(i)}scrollPages(i){this._verifyIntegers(i),this._core.scrollPages(i)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(i){this._verifyIntegers(i),this._core.scrollToLine(i)}clear(){this._core.clear()}write(i,o){this._core.write(i,o)}writeln(i,o){this._core.write(i),this._core.write(`\r
`,o)}paste(i){this._core.paste(i)}refresh(i,o){this._verifyIntegers(i,o),this._core.refresh(i,o)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(i){this._addonManager.loadAddon(this,i)}static get strings(){return n}_verifyIntegers(...i){for(const o of i)if(o===1/0||isNaN(o)||o%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...i){for(const o of i)if(o&&(o===1/0||isNaN(o)||o%1!=0||o<0))throw new Error("This API only accepts positive integers")}}S.Terminal=d})(),k})())})(Ya);var Ji={},Ja={get exports(){return Ji},set exports(e){Ji=e}};(function(e,c){(function(v,b){e.exports=b()})(self,()=>(()=>{var v={};return(()=>{var b=v;Object.defineProperty(b,"__esModule",{value:!0}),b.FitAddon=void 0,b.FitAddon=class{activate(x){this._terminal=x}dispose(){}fit(){const x=this.proposeDimensions();if(!x||!this._terminal||isNaN(x.cols)||isNaN(x.rows))return;const k=this._terminal._core;this._terminal.rows===x.rows&&this._terminal.cols===x.cols||(k._renderService.clear(),this._terminal.resize(x.cols,x.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const x=this._terminal._core,k=x._renderService.dimensions;if(k.css.cell.width===0||k.css.cell.height===0)return;const S=this._terminal.options.scrollback===0?0:x.viewport.scrollBarWidth,n=window.getComputedStyle(this._terminal.element.parentElement),s=parseInt(n.getPropertyValue("height")),l=Math.max(0,parseInt(n.getPropertyValue("width"))),p=window.getComputedStyle(this._terminal.element),a=s-(parseInt(p.getPropertyValue("padding-top"))+parseInt(p.getPropertyValue("padding-bottom"))),h=l-(parseInt(p.getPropertyValue("padding-right"))+parseInt(p.getPropertyValue("padding-left")))-S;return{cols:Math.max(2,Math.floor(h/k.css.cell.width)),rows:Math.max(1,Math.floor(a/k.css.cell.height))}}}})(),v})())})(Ja);const En="10.0.24223.355",Fs={RESET:"\x1B[0m",BLACK:"\x1B[30m",RED:"\x1B[31m",GREEN:"\x1B[32m",LIGHT_YELLOW:"\x1B[93m",YELLOW:"\x1B[33m",YELLOW_BACKGROUND:"\x1B[43m",BLUE:"\x1B[34m",PURPLE:"\x1B[35m",CYAN:"\x1B[36m",WHITE:"\x1B[37m",BOLD:"\x1B[1m",UNBOLD:"\x1B[21m",UNDERLINE:"\x1B[4m",STOP_UNDERLINE:"\x1B[24m",BLINK:"\x1B[5m"};function Za(e){const c=v=>{const b=rt.getState("USER_HOME").USER_HOME;let x=b,k="",S=0,n="",s=navigator.clipboard,l="",p=0,a=[],h=0;function f(C){x=C.replace(/\\+/g,"/"),k=x+">",S=k.length}f(b),G(e)&&f(e),fe.readFile(b+"/.cmdHistory",(C,D)=>{!C&&G(D)&&D.text().then(A=>{try{a=JSON.parse(A),h=a.length-1}catch{}})});const u=new Yi.Terminal({cursorBlink:!0,cursorStyle:"underline",allowTransparency:!0,fontFamily:"Consolas"}),d=new Ji.FitAddon;u.loadAddon(d);let t;t=_("div",{className:"w-full h-full",onmousedown:w}),u.open(t);const i={cls:"Clears the screen.",dir:"Displays a list of files and subdirectories in a directory.",cd:"Displays the name of or changes the current directory.",mkdir:"Creates a directory.",rm:"Removes a directory.",print:"Prints a text file.",help:"Provides Help information for Windows commands.",exit:"Quits"};function o(){Object.keys(i).forEach(C=>{u.write(`\r
`+C+"	"+i[C])}),u.write(`\r
`),g()}const r=`[Version ${En}]`;function m(){return Fs.GREEN+k+Fs.WHITE}function g(){u.write(`\r
`+m())}r.split(`
`).map(C=>u.writeln(C)),g(),u.onKey(({key:C,domEvent:D})=>{const A=D.key;if(!/^(?!F[0-9]).*/g.test(A))return;const H=!D.altKey&&!D.ctrlKey&&!D.metaKey;if(D.ctrlKey){const N=A.toLowerCase();N==="l"?u.clear():N==="a"?u.selectAll():N==="c"?u.hasSelection()?E():(l="",g()):N==="v"&&T();return}if(A===Be.ArrowLeft)u.buffer.active.cursorX>S&&u.write("\x1B[1D");else if(A===Be.ArrowRight)u.buffer.active.cursorX<l.length+S&&u.write("\x1B[1C");else if(A===Be.ArrowUp)a.length>0&&(l=a[h],u.write("\x1B[2K\r"+m()+l),h>0&&(h-=1));else if(A===Be.ArrowDown)h+1<a.length&&(h+=1,l=a[h],u.write("\x1B[2K\r"+m()+l));else if(A===Be.BackSpace){if(u.buffer.active.cursorX>S)if(u.buffer.active.cursorX===S+l.length)l=l.slice(0,-1),u.write("\b \b");else{const N=l.slice(0,u.buffer.active.cursorX-S-1),F=l.slice(u.buffer.active.cursorX-S);l=N+F,p=S+l.length-u.buffer.active.cursorX+1,u.write("\x1B[2K\r"+m()+l+"\x1B["+p+"D")}}else if(A===Be.Delete){if(u.buffer.active.cursorX>=S&&u.buffer.active.cursorX<S+l.length){const N=k+l,F=N.slice(S,u.buffer.active.cursorX),L=N.slice(u.buffer.active.cursorX+1,N.length);l=F+L,p=S+l.length-u.buffer.active.cursorX,u.write("\x1B[2K\r"+m()+l+(L.length>0?"\x1B["+p+"D":""))}}else if(A===Be.Home)u.buffer.active.cursorX>S&&(p=u.buffer.active.cursorX-S,u.write("\x1B["+p+"D"));else if(A===Be.End){const N=k+l;u.buffer.active.cursorX<N.length&&(p=N.length-u.buffer.active.cursorX,u.write("\x1B["+p+"C"))}else{if(A===Be.Insert)return;if(A===Be.Enter)l.replace(/^\s+|\s+$/g,"").length!=0?M(l):g(),l="";else{if(A===Be.Tab)return;if(H){if(u.buffer.active.cursorX===S+l.length)l+=C,u.write(C);else if(u.buffer.active.cursorX<S+l.length){const N=k+l,F=N.slice(S,u.buffer.active.cursorX),L=N.slice(u.buffer.active.cursorX,N.length);l=F+C+L,p=S+l.length-u.buffer.active.cursorX-1,u.write("\x1B[2K\r"+m()+l+(L.length>0?"\x1B["+p+"D":""))}}}}});function E(){n=u.getSelection(),s.writeText(n)}function T(){s.readText().then(C=>{if(u.buffer.active.cursorX===S+l.length)u.write(C),l=l+C;else if(u.buffer.active.cursorX<S+l.length){const D=k+l,A=D.slice(S,u.buffer.active.cursorX),H=D.slice(u.buffer.active.cursorX,D.length);l=A+C+H,p=S+l.length-u.buffer.active.cursorX,u.write("\x1B[2K\r"+m()+l+(H.length>0?"\x1B["+p+"D":""))}})}function w(C){C.button===2&&(u.hasSelection()?(E(),u.clearSelection()):T())}function y(C){const D=C.replace(/\\+/g,"/").replace(/\/+/g,"/").split("/").filter(H=>H!=="");let A=x.split("/").filter(H=>H!=="");for(let H of D)H==="~"?A=b.split("/").filter(N=>N!==""):H===".."?A.length-1>0&&A.splice(A.length-1,1):A.push(H);return A.join("/")}function M(C){d.fit(),h=a.push(C)-1,fe.writeFile(b+"/.cmdHistory",new Blob([JSON.stringify(a)]));let D=[];if(C.indexOf('"')>-1?D=C.split('"'):C.indexOf("'")>-1?D=C.split("'"):D=C.split(" "),D=D.filter(N=>N!==""),!D.length)return;const A=D[0].replace(/\s+/g,"");let H=D[1];if(G(i[A])){if(A==="dir"){let N=function(){u.write(`\r
The system cannot find the path specified.
`),g()},F=function(L){fe.readFolder(L,(B,O)=>{if(B)I(B);else{u.write(`\r
Directory of `+L+`
`);const P=O.some(j=>j.type!=="folder"),z=O.some(j=>j.type==="folder"),W=O.every(j=>j.type!=="folder"),U=O.every(j=>j.type==="folder");O.forEach(j=>{const Y=new Date(j.mdate);u.write(`\r
`+Ui(Y)+"  "+It(Y)+"	"+(P&&z?(j.type==="folder"?"<DIR> 	 	":" 	")+(ji(j.size)?j.size.toPrecision()+"	":""):(U&&j.type==="folder"?"<DIR>	":"")+(W&&ji(j.size)?j.size.toPrecision()+"		":""))+j.name)}),u.write(`\r
`),g()}})};if(H||(H=x),Xe(H)||St(H))F(H);else if(qt(H)){const L=y(H);F(L)}else N()}else if(A==="exit")g(),setTimeout(()=>{v.close()},200);else if(A==="cls")u.clear(),l="",u.write("\x1B[2K\r"+m());else if(A==="help")o();else if(A==="cd"){let N=function(){u.write(`\r
The system cannot find the path specified.
`),g()};if(!H)N();else if(Xe(H)||St(H))fe.stats(H,F=>{F?(u.write(`\r
`+F.message),N()):(f(H),g())});else if(qt(H)){const F=y(H);fe.stats(F,L=>{L?N():(f(F),g())})}else N()}else if(A==="mkdir"){let N=function(F){F?u.write(`\r
`+F+`
`):u.write(`\r
The system cannot find the path specified.
`),g()};if(!H)N();else if(Xe(H))fe.createFolder(H,F=>{F?N(F.message):g()});else if(qt(H)){const F=y(H);fe.createFolder(F,L=>{L?N(L.message):g()})}else St(H)?(u.write(`\r
Folder already exisist!`),g()):N()}else if(A==="rm"){let N=function(F){F?u.write(`\r
`+F+`
`):u.write(`\r
The system cannot find the path specified.
`),g()};if(!H)N();else{let F=function(L,B,O=0){const P=B[O];if(!G(P)){g();return}fe.unlink(L+"/"+P.name,z=>{z?(N(z.message),g()):F(L,B,O+1)})};if(H=H.trim(),H==="*")fe.readFolder(x,(L,B)=>{L?(N(L.message),g()):F(x,B),g()});else if(Xe(H)){const L=H.replace(/\\+/g,"/").replace(/\/+/g,"/");if(x.indexOf(L)>-1){N("Can not execute this action!");return}fe.unlink(L,B=>{B?N(B.message):g()})}else if(qt(H)){const L=y(H);if(x.indexOf(L)>-1){N("Can not execute this action!");return}fe.unlink(L,B=>{B?N(B.message):g()})}else N()}}else if(A==="print"){let N=function(L){L?u.write(`\r
`+L+`
`):u.write(`\r
The system cannot find the path specified.
`),g()},F=function(L){if(x.indexOf(L)>-1){N("Can not execute this action!");return}fe.readFile(L,(B,O)=>{B?N(B.message):G(O)?O.size>1e4?(u.write(`\r
Name: `+(O.name||Qe(L))+" Size: "+O.size),g()):O.text().then(P=>{const z=P.split(`
`);for(let W of z)u.write(`\r
`+W);u.write(`\r
`),g()}):N()})};if(!H)N();else if(Xe(H)){const L=H.replace(/\\+/g,"/").replace(/\/+/g,"/");F(L)}else if(qt(H)){const L=y(H);F(L)}else N()}}else G(ki[A])?(g(),ki[A](H)):(u.write(`\r
"`+A+`" is not recognized as an internal or external command, operable program or batch file.
`),u.write(`\r
Type "help" for available commands
`),g())}function I(C){u.write(`\r
`+C.message+`
`),g()}return v.addEventListener("focus",()=>{u.focus()}),v.addEventListener("close",()=>{u.dispose()}),v.addEventListener("passiveResize",Jo(()=>{d.fit()},200)),v.addEventListener("ready",()=>{d.fit()}),t};lt({icon:Q.cmd.icon,name:Q.cmd.name,title:Q.cmd.productName,top:100,left:100,width:800,height:450,center:!0,content:c,className:"cmd-app",extendContextMenu:[{divider:!0},{text:"Properties"}]})}function Qa(e){lt({args:e,icon:yt.mediaPlayer.icon,hideIcon:!0,name:yt.mediaPlayer.name,title:yt.mediaPlayer.productName,autoHideTitleBar:!0,top:50,left:50,width:800,height:480,minWidth:300,minHeight:100,center:!0,singleInstance:!0,content:c=>{let v;function b(x){const k=gt(x);if(Mi(k)){const S=_("div",{className:"w-full h-full relative"},[_("video",{className:"w-full h-full",controls:!0,autoplay:!0,style:{objectFit:"contain"},mySrc:x})]);return c.setSize({width:800,height:480}),c.setTitle(Qe(x)),S}if(Fo(k)){const S=_("div",{className:"w-full h-full relative p-20"},[_("audio",{className:"w-full h-full",controls:!0,autoplay:!0,mySrc:x})]);return c.setSize({width:800,height:124}),c.setTitle(Qe(x)),S}return _("div",{},"Not supported file")}return c.addEventListener("secondInstance",x=>{v=b(x),c.setContent(v),c.isVisible()||c.show(),c.focus()}),c.addEventListener("ready",()=>{v=b(e),c.setContent(v)}),null}})}function el(e){if(!G(e)){Fe("photos");return}lt({args:e,icon:yt.photoViewer.icon,hideIcon:!0,name:yt.photoViewer.name,title:yt.photoViewer.productName,hideTitle:!0,top:50,left:50,width:800,height:480,minWidth:580,minHeight:200,center:!0,singleInstance:!0,titlebarHeight:40,stretchTitlebarContent:!0,transprencyContent:!0,content:c=>{let v,b,x,k,S,n,s,l,p=0,a=0,h=0,f=0,u=0,d=0,t=0,i=0,o,r=0,m=0,g=0,E=0;b=_("div",{className:"photo-viewer-titlebar-content w-full h-full flex items-center"},[_("div",{className:"flex items-center flex-1 h-full"},[_("div",{className:"photo-viewer-titlebar-home flex items-center content-center flex-shrink-0",style:{width:"40px",height:"40px"},innerHTML:Zs(20),onclick(){Fe("photos")}}),_("div",{["drag-region"]:"drag",className:"w-full h-full flex items-center",style:{padding:"0 10px"}},x=_("div",{className:"text-ellipsis line-clamp-1"}))]),_("div",{className:"flex items-center content-center h-full"},[_("div",{title:"Edit Image",className:"photo-viewer-titlebar-content-button",innerHTML:Pr()}),_("div",{title:"Rotate",className:"photo-viewer-titlebar-content-button",innerHTML:gr}),_("div",{title:"Delete",className:"photo-viewer-titlebar-content-button",innerHTML:Ur()}),_("div",{title:"Add to favorites",className:"photo-viewer-titlebar-content-button",innerHTML:jr()}),_("div",{title:"Print",className:"photo-viewer-titlebar-content-button",innerHTML:Vr()}),_("div",{title:"Share",className:"photo-viewer-titlebar-content-button",innerHTML:Kr()}),_("div",{title:"More options",className:"photo-viewer-titlebar-content-button",innerHTML:Js(),onclick(W){const U=W.currentTarget,j=U.getBoundingClientRect();jt({top:j.top+j.height,left:j.left},U,[{text:"Set as desktop wallpaper",onClick(){Xe(l)?cs(l,(R,$)=>{R||Y(URL.createObjectURL($))}):Y(l);function Y(R){os(R,($,q)=>{const X=Qe(l),V=rt.getState("USER_HOME").USER_HOME+"/AppData/Microsoft/Windows/Desktop/Background/"+"Thumbnails/"+X;fe.writeFile(V,q,()=>{$e.setBackgroundImage({name:X,path:l,thumbnailPath:V})})})}c.focus()}},{text:"Resize image",onClick(){c.focus()}},{text:"Copy as path",onClick(){c.focus()}},{text:"Settings",onClick(){c.focus()}}],!1)}})]),_("div",{["drag-region"]:"drag",className:"flex items-center flex-1 h-full"})]),c.titlebar.setTitlebarContent(b),v=_("div",{className:"w-full h-full",style:{position:"relative",paddingBottom:"40px"}},[S=_("div",{className:"w-full h-full flex items-center content-center",style:{position:"relative",overflow:"hidden"},onwheel:I},k=_("div",{className:"photo-viewer-container w-full h-full",onmousedown:w})),_("div",{className:"photo-viewer-bottom flex items-center"},[_("div",{}),_("div",{className:"flex items-center",style:{marginLeft:"auto"}},[n=_("div",{style:{paddingRight:"10px"}}),_("div",{title:"Zoom out",className:"photo-viewer-bottom-button",innerHTML:Fr(18),onclick:()=>{F(-1)}}),_("div",{title:"Zoom in",className:"photo-viewer-bottom-button",innerHTML:Or(18),onclick:()=>{F(1)}}),_("div",{title:"Zoom to fit",className:"photo-viewer-bottom-button",innerHTML:zr(18),onclick:H}),_("div",{title:"Zoom to actual size",className:"photo-viewer-bottom-button",innerHTML:Wr(18),onclick:N}),_("div",{title:"Fullscreen",className:"photo-viewer-bottom-button",innerHTML:$r(14),onclick:()=>{c.toggleFullscreen()}})])])]);function T(W){const U=gt(W);if(!Di(U)){k.textContent="Not supported file";return}Oo(W,Y=>{G(Y)&&(l=W,k.textContent="",k.style.myBackgroundImage=W,o=Y,D(),(o.width>s.width||o.height>s.height)&&H(),o.width<s.width&&o.height<s.height&&A())});const j=Qe(W);c.setTitle(j),x.textContent=j}function w(W){W.button===0&&(W.preventDefault(),g=W.clientX,E=W.clientY,document.onmouseup=M,document.onmousemove=y)}function y(W){r=g-W.clientX,m=E-W.clientY,g=W.clientX,E=W.clientY;const U=k.offsetTop-m,j=k.offsetLeft-r;h>s.width&&(j>0?a=0:j+h<s.width?a=s.width-h:a=j,k.style.left=a+"px"),f>s.height&&(U>0?p=0:U+f<s.height?p=s.height-f:p=U,k.style.top=p+"px")}function M(){document.onmouseup=null,document.onmousemove=null}function I(W){let U=W.deltaY>0?-1:1;t=W.offsetX,i=W.offsetY,F(U)}function C(){s={width:S.offsetWidth,height:S.offsetHeight}}function D(){if(O())d=100;else{const W=s.width/s.height;let U=0;W<o.ratio?U=s.width:U=s.height*o.ratio,d=U/o.width*100}}function A(){p=(s.height-o.height)/2,a=(s.width-o.width)/2,h=o.width,f=o.height,d=100,u=100,ge(k,{top:p+"px",left:a+"px",width:h+"px",height:f+"px"}),B()}function H(){C();const W=s.width/s.height,U={};if(W<o.ratio){const j=s.width/o.ratio;p=(s.height-j)/2,a=0,h=s.width,f=j}else{const j=s.height*o.ratio,Y=(s.width-j)/2;p=0,a=Y,h=j,f=s.height}u=h/o.width*100,h<s.width&&f<s.height?d=100:d=u,U.top=p+"px",U.left=a+"px",U.width=h+"px",U.height=f+"px",B(),ge(k,U)}function N(){L(100)}function F(W){h<s.width&&(t=h/2),f<s.height&&(i=f/2);let U=h+h*.1*W;(h<o.width&&o.width<U||h>o.width&&o.width>U)&&(U=o.width);let j=t/h,Y=i/f,R=U/o.width*100;R<d&&(R=d,U=R*o.width/100),R>5e3&&(R=5e3,U=R*o.width/100),u=R,h=U,f=h/o.ratio;let $=j*h-t,q=Y*f-i;a-=$,p-=q,W===-1&&(h>s.width?(a>0&&(a=0),a+h<s.width&&(a=s.width-h)):a=(s.width-h)/2,f>s.height?(p>0&&(p=0),p+f<s.height&&(p=s.height-f)):p=(s.height-f)/2),h<s.width&&f<s.height&&(p=(s.height-f)/2,a=(s.width-h)/2),ge(k,{width:h+"px",height:f+"px",top:p+"px",left:a+"px"}),B()}function L(W){const U=W*o.width/100,j=U/o.ratio,Y=.5*U-h/2,R=.5*j-f/2;u=W,p-=R,a-=Y,h=U,f=j,ge(k,{top:p+"px",left:a+"px",width:h+"px",height:f+"px"}),B()}function B(){n.textContent=Math.round(u)+" %"}function O(){return C(),o.width<s.width&&o.height<s.height}function P(){u===d?O()?A():H():u>d&&(D(),a>0&&(a=0,k.style.left=a+"px"),h+a<s.width&&(a=(s.width-h)/2,k.style.left=a+"px"),p>0&&(p=0,k.style.top=p+"px"),f+p<s.height&&(p=(s.height-f)/2,k.style.top=p+"px"))}function z(){setTimeout(()=>{P()},250)}return c.addEventListener("resize",Ge(()=>{P()},50)),c.addEventListener("maximize",()=>{z()}),c.addEventListener("unmaximize",()=>{z()}),c.addEventListener("snap",()=>{z()}),c.addEventListener("unSnap",()=>{z()}),c.addEventListener("restore",()=>{z()}),c.addEventListener("fullscreen",()=>{z()}),c.addEventListener("secondInstance",W=>{c.isVisible()||c.show(),c.focus(),T(W)}),c.addEventListener("ready",()=>{c.setContent(v),T(e)}),null}})}const ki={settings:Xa,explorer:pa,notepad:va,word:()=>{qe(Q.word)},powerpoint:()=>{qe(Q.powerpoint)},onenote:()=>{qe(Q.onenote)},mail:()=>{qe(Q.mail)},todo:()=>{qe(Q.todo)},store:()=>{qe(Q.store)},photos:Da,photoViewer:el,mediaPlayer:Qa,yourphone:()=>{qe(Q.yourphone)},whiteboard:()=>{qe(Q.whiteboard)},calculator:Ga,spotify:()=>{qe(Q.spotify)},twitter:()=>{qe(Q.twitter)},vscode:()=>{qe(Q.vscode)},terminal:()=>{qe(Q.terminal)},cmd:Za,github:()=>{qe(Q.github)},discord:()=>{qe(Q.discord)}};String.prototype.toFirstUpperCase=function(){return this.charAt(0).toUpperCase()+this.substring(1,this.length)};const tl=localStorage.getItem("OS_VERSION");G(tl)||(Se.reset(),localStorage.setItem("OS_VERSION",En));Go&&document.documentElement.classList.add("isWebkit");document.documentElement.style.setProperty("--taskbar-height",We.toString()+"px");document.addEventListener("dragover",e=>{e.preventDefault()});document.addEventListener("drop",e=>{e.preventDefault()});document.addEventListener("contextmenu",e=>{e.preventDefault()});const Ye=Se.getState();Ye.recentImages||(Ye.recentImages=[Ue[15],Ue[9],Ue[21],Ue[0],Ue[8]]);let Ei=Ye.themeIndex>-1?Ye.themes[Ye.themeIndex]:Ye.customTheme;G(Ei)||(Ei=Ye.themes[0],Se.setState({themeIndex:0}));G(Ye.brightness)&&ri.setBrightness(Ye.brightness);Ye.nightlight&&ri.setNightLight(Ye.nightlight);Ki(Ye.roundedCorner);hn(Ye.useBorder);fn(Ei);un(Ei.background.thumbnailPath);function _i(e,c){const v=ki[e];G(v)?ki[e](c):Xo()}function il(e){if(e.type==="link")window.open(e.args,"_blank");else if(e.type==="app")_i(e.name,e.args);else if(e.type==="file"){const c=$t(Yo(e.args));_i(c.appName,e.args)}else e.type==="folder"&&_i(Q.explorer.name,e.args)}Ne(ae.createWindow,"index",({appName:e,args:c})=>{_i(e,c)});Ne(ae.startProcess,"index",e=>{il(e)});Ne(ae.backgroundImageChange,"index",e=>{un(e.thumbnailPath)});fe.addEventListener("ready","index",()=>{fe.addEventListener("removed","index",e=>{oi.removeThumbnail(e)})});

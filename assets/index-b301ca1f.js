var Yn=Object.defineProperty;var Jn=(e,c,v)=>c in e?Yn(e,c,{enumerable:!0,configurable:!0,writable:!0,value:v}):e[c]=v;var Nt=(e,c,v)=>(Jn(e,typeof c!="symbol"?c+"":c,v),v);(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))b(x);new MutationObserver(x=>{for(const E of x)if(E.type==="childList")for(const C of E.addedNodes)C.tagName==="LINK"&&C.rel==="modulepreload"&&b(C)}).observe(document,{childList:!0,subtree:!0});function v(x){const E={};return x.integrity&&(E.integrity=x.integrity),x.referrerpolicy&&(E.referrerPolicy=x.referrerpolicy),x.crossorigin==="use-credentials"?E.credentials="include":x.crossorigin==="anonymous"?E.credentials="omit":E.credentials="same-origin",E}function b(x){if(x.ep)return;x.ep=!0;const E=v(x);fetch(x.href,E)}})();const Zn="imgs/icons/Apps/";function Re(e){return Zn+e}const Q={settings:{name:"settings",productName:"Settings",icon:Re("settings.png")},notepad:{name:"notepad",productName:"NotePad",icon:Re("notepad.png")},explorer:{name:"explorer",productName:"File Explorer",icon:Re("explorer.png")},word:{name:"word",productName:"Word",icon:Re("word.png")},powerpoint:{name:"powerpoint",productName:"PowerPoint",icon:Re("powerpoint.png")},onenote:{name:"onenote",productName:"OneNote",icon:Re("onenote.png")},mail:{name:"mail",productName:"Mail",icon:Re("mail.png")},todo:{name:"todo",productName:"To Do",icon:Re("todo.png")},store:{name:"store",productName:"Store",icon:Re("store.png")},photos:{name:"photos",productName:"Photos (Demo)",icon:Re("photos.png")},yourphone:{name:"yourphone",productName:"Your Phone",icon:Re("yourphone.png")},whiteboard:{name:"whiteboard",productName:"White Board",icon:Re("whiteboard.png")},calculator:{name:"calculator",productName:"Calculator",icon:Re("calculator.png")},spotify:{name:"spotify",productName:"Spotify",icon:Re("spotify.png")},twitter:{name:"twitter",productName:"Twitter",icon:Re("twitter.png")},vscode:{name:"vscode",productName:"VS Code",icon:Re("vscode.png")},terminal:{name:"terminal",productName:"Terminal",icon:Re("terminal.png")},cmd:{name:"cmd",productName:"Command Promt",icon:Re("terminal.png")},github:{name:"github",productName:"GitHub",icon:Re("github.png")},discord:{name:"discord",productName:"Discord",icon:Re("discord.png")}},Qn=Object.keys(Q).map(e=>Q[e]);function er(e,c){return e.name>c.name?1:e.name<c.name?-1:0}function tr(){const e=Qn.sort(er),c={},v=e.length;for(let b=0;b<v;b++){const x=e[b];let E=x.name.substring(0,1).toUpperCase();/[A-Z]/.test(E)||(/[0-9]/.test(E)?E="#":E="&"),c[E]||(c[E]=[]),c[E].push(x)}return c}const yt={photoViewer:{name:"photoViewer",productName:"Photos Viewer",icon:Re("photos.png")},mediaPlayer:{name:"mediaPlayer",productName:"Media Player",icon:Re("media-player.png")}};function st(e,c){typeof c>"u"||c===null||(c instanceof HTMLElement?e.appendChild(c):c instanceof Array?Dt(e,c):e.appendChild(document.createTextNode(c.toString())))}function Dt(e,c){c instanceof Array?c.forEach(v=>{st(e,v)}):st(e,c)}function ge(e,c){for(let v in c)v.indexOf("-")>-1?e.style.setProperty(v,c[v]):v==="myBackgroundImage"?Fi(c[v],b=>{e.style.backgroundImage=`url(${b})`}):e.style[v]=c[v]}function Fs(e){for(let c of e){if(c.children.length>0){const v=Array.from(c.children);Fs(v)}ye(c.onBeforeRemove)&&c.onBeforeRemove()}}Element.prototype.remove=function(){var v;const e=Array.from(this.children);Fs(e);const c=this;ye(c.onBeforeRemove)&&c.onBeforeRemove(),(v=this.parentElement)==null||v.removeChild(this)};function _(e,c,v){let b=document.createElement(e);function x(E){Fi(E,C=>{b.src=C})}if((e==="img"||e==="audio"||e==="video")&&Object.defineProperty(b,"mySrc",{set:function(E){x(E)}}),c){const E=c;for(let C in E)if(C==="style"){const n=E[C];ge(b,n)}else if(C==="mySrc"){const n=E[C];x(n)}else if(C.indexOf("-")>-1||C.indexOf(":")>-1){const n=E[C];b.setAttribute(C,n)}else b[C]=E[C]}return v&&Dt(b,v),Object.defineProperty(b.style,"myBackgroundImage",{set:function(E){Fi(E,C=>{b.style.backgroundImage=`url(${C})`})}}),b}function at(e){let c=e.firstChild;for(;c;)c.remove(),c=e.firstChild}function Fi(e,c){Xe(e)?ls(e,(v,b)=>{if(v)c(null);else{const x=URL.createObjectURL(b);c(x)}}):c(e)}function ir(e){let c;const v=Object.create(null);v.width=0,e.color&&(v.backgroundColor=e.color);let b=_("div",{className:"progress"},c=_("div",{className:"progress-value",style:v}));function x(E){c.style.width=E/e.maxValue*100+"%"}return{element:b,setValue:x}}const zs=`
<svg aria-hidden="true" version="1.1" viewbox="0 0 10 10" width="10" height="10" class="svg-fill">
<path d="M 0,5 10,5 10,6 0,6 Z"></path>
</svg>
`,zi=`
<svg aria-hidden="true" version="1.1" viewbox="0 0 10 10" width="10" height="10" class="svg-fill">
<path d="m 2,1e-5 0,2 -2,0 0,8 8,0 0,-2 2,0 0,-8 z m 1,1 6,0 0,6 -1,0 0,-5 -5,0 z m -2,2 6,0 0,6 -6,0 z"></path>
</svg>
`,Wi=`
<svg aria-hidden="true" version="1.1" viewbox="0 0 10 10" width="10" height="10" class="svg-fill">
<path d="M 0,0 0,10 10,10 10,0 Z M 1,1 9,1 9,9 1,9 Z"></path>
</svg>
`,Ws=`
<svg aria-hidden="true" version="1.1" viewbox="0 0 10 10" width="10" height="10" class="svg-fill">
<path d="M 0,0 0,0.7 4.3,5 0,9.3 0,10 0.7,10 5,5.7 9.3,10 10,10 10,9.3 5.7,5 10,0.7 10,0 9.3,0 5,4.3 0.7,0 Z"></path>
</svg>
`;function sr(e){const c={};e&&(c.backgroundImage=`url("${e}")`);let v=_("div",{className:"window-titlebar-icon flex content-center items-center flex-shrink-0",style:c});function b(x){G(x)&&(v.style.backgroundImage=`url("${x}")`)}return{element:v,setWindowIcon:b}}const nr={window:{titlebar:{buttons:{minimize:"Minimize",maximize:"Restore Down",maximizeDown:"Maximize",close:"Close"}}}},rr={window:{titlebar:{buttons:{minimize:"Thu gọn",maximize:"Thu nhỏ",maximizeDown:"Phóng to",close:"Đóng"}}}},or={"en-us":nr,"vi-vn":rr};function ar(e){return or[e]}function lr(e,c){const v=ar("en-us");let b=n(e.isMaximized),x=_("div",{title:b.title,className:"window-titlebar-button window-titlebar-maximize-button flex items-center content-center"+(e.disableMaximize?" disabled":""),innerHTML:b.icon,onclick:c.onMaximizeButtonClick}),E=_("div",{className:"window-titlebar-buttons flex"},[_("div",{title:v.window.titlebar.buttons.minimize,className:"window-titlebar-button window-titlebar-minimize-button flex items-center content-center",innerHTML:zs,onclick:c.onMinimizeButtonClick}),x,_("div",{title:v.window.titlebar.buttons.close,className:"window-titlebar-button window-titlebar-close-button flex items-center content-center",innerHTML:Ws,onclick:c.onCloseButtonClick})]);function C(i){let l=n(i);x.title=l.title,x.innerHTML=i?zi:Wi}function n(i){return{title:i?v.window.titlebar.buttons.maximize:v.window.titlebar.buttons.maximizeDown,icon:i?zi:Wi}}return{element:E,setMaximize:C}}function cr(e,c,v,b){let x,E,C=_("div",{tabIndex:-1,className:"window-title h-full flex items-center"+(e.stretchTitlebarContent?" stretch":""),onfocus:b,oncontextmenu:v,ondblclick:e.disableMaximize?null:c},[_("div",{["drag-region"]:"drag",className:"absolute w-full h-full top left-0"}),e.hideTitle?null:_("div",{className:"window-title-text h-full flex items-center"},x=_("div",{title:e.title,className:"text-ellipsis"},e.title)),E=_("div",{className:"window-titlebar-content flex-1 h-full flex items-center relative"+(G(e.content)?"":" hide")},G(e.content)&&ye(e.content)?e.content():e.content)]);function n(l){G(x)&&(x.title=l,x.textContent=l)}function i(l){at(E),E.classList.remove("hide"),E.appendChild(ye(l)?l():l)}return{element:C,setTitle:n,setContent:i}}function hr(e,c){let v=sr(e.icon),b=cr({title:e.title,hideTitle:e.hideTitle,disableMaximize:e.disableMaximize,content:e.content,stretchTitlebarContent:e.stretchTitlebarContent},c.onDoubleClick,c.onContextMenu,c.onTitleFocus),x=lr({isMaximized:e.maximized,disableMaximize:e.disableMaximize},{onMinimizeButtonClick:c.onMinimizeButtonClick,onMaximizeButtonClick:c.onMaximizeButtonClick,onCloseButtonClick:c.onCloseButtonClick}),E,C=!1;E=_("div",{className:"window-titlebar flex items-center"+(e.hideIcon?" no-icon":"")+(e.hideTitle?" no-title":"")},[v.element,b.element,x.element]),e.autoHide&&(E.addEventListener("mouseover",()=>{C=!0},!1),E.addEventListener("mouseout",()=>{C=!1},!1));function n(p){p?(E.classList.remove("titlebar-fade-in"),C||(E.classList.add("titlebar-fade-out"),c.onHidden&&c.onHidden())):(E.classList.add("titlebar-fade-in"),E.classList.remove("titlebar-fade-out"),c.onVisible&&c.onVisible())}function i(p){C=p}function l(p){p?E.classList.remove("hidden"):E.classList.add("hidden")}return{element:E,titleElem:b.element,setIcon:v.setWindowIcon,setTitle:b.setTitle,setTitlebarContent:b.setContent,setMaximize:x.setMaximize,setVisible:l,setAutoHide:n,setPreventHide:i}}function $s(e,c,v){var b=0,x=0,E=0,C=0;c?c.onmousedown=i:e.onmousedown=i;let n=!1;function i(a){a.button===0&&(a.preventDefault(),E=a.clientX,C=a.clientY,document.onmouseup=p,document.onmousemove=l,G(v)&&ye(v.onDragStart)&&v.onDragStart())}function l(a){b=E-a.clientX,x=C-a.clientY,E=a.clientX,C=a.clientY;let h=e.offsetTop-x,f=e.offsetLeft-b;n=Math.abs(f)>0||Math.abs(h)>0,e.style.top=h+"px",e.style.left=f+"px",G(v)&&ye(v.onDrag)&&v.onDrag({x:a.clientX,y:a.clientY},{top:h,left:f})}function p(){n&&G(v)&&ye(v.onDragEnd)&&v.onDragEnd(e),n=!1,document.onmouseup=null,document.onmousemove=null}}function Ze(e,c,v,b,x){let E=v,C=b,n="default",i="";c.addEventListener("mousedown",D,!1);let l=0,p=0,a=0,h=0,f=0,d=0,u=0,t=0,s=0,o=0,r,m,g,k;function D(y){let T=window.getComputedStyle(e);a=parseInt(T.left),h=parseInt(T.top),f=e.offsetWidth,d=e.offsetHeight,s=parseInt(T.minHeight),o=parseInt(T.minWidth),l=y.clientX,p=y.clientY,window.addEventListener("mousemove",w,!1),window.addEventListener("mouseup",S,!1);var A=y.currentTarget;i=A.dataset.resize,G(x)&&ye(x.onResizeStart)&&x.onResizeStart()}function w(y){let T=y.clientX-l+u,A=y.clientY-p+t;u=0,t=0,l=y.clientX,p=y.clientY;var H=A,P=T;i==="t"?(n="ns-resize",d-H<s?t=H-(A=d-s):h+H<g&&(t=H-(A=g-h)),h+=A,d-=A,E&&(f=Math.round(d*C))):i==="l"?(n="ew-resize",f-P<o?u=P-(T=f-o):a+P<r&&(u=P-(T=r-a)),a+=T,f-=T,E&&(d=Math.round(f/C))):i==="tl"?(n="nw-resize",f-P<o?u=P-(T=f-o):a+P<r&&(u=P-(T=r-a)),a+=T,f-=T,d-H<s?t=H-(A=d-s):h+H<g&&(t=H-(A=g-h)),h+=A,E?Math.abs(T)>Math.abs(A)?d=Math.round(f/C):f=Math.round(d*C):d-=A):i==="b"?(n="ns-resize",d+H<s?t=H-(A=s-d):h+d+H>k&&(t=H-(A=k-h-d)),d+=A,E&&(f=Math.round(d*C))):i==="bl"?(n="ne-resize",f-P<o?u=P-(T=f-o):a+P<r&&(u=P-(T=r-a)),a+=T,f-=T,E?d=Math.round(f/C):(d+H<s?t=H-(A=s-d):h+d+H>k&&(t=H-(A=k-h-d)),d+=A)):i==="r"?(n="ew-resize",f+P<o?u=P-(T=o-f):a+f+P>m&&(u=P-(T=m-a-f)),f+=T,E&&(d=Math.round(f/C))):i==="tr"?(n="ne-resize",f+P<o?u=P-(T=o-f):a+f+P>m&&(u=P-(T=m-a-f)),f+=T,d-H<s?t=H-(A=d-s):h+H<g&&(t=H-(A=g-h)),h+=A,d-=A,E&&(f=Math.round(d*C))):i==="br"&&(n="nw-resize",f+P<o?u=P-(T=o-f):a+f+P>m&&(u=P-(T=m-a-f)),f+=T,d+H<s?t=H-(A=s-d):h+d+H>k&&(t=H-(A=k-h-d)),d+=A,E&&(f=Math.round(d*C))),e.style.top=h+"px",e.style.left=a+"px",e.style.width=f+"px",e.style.height=d+"px",document.body.style.pointerEvents="none",document.documentElement.style.cursor=n,G(x)&&ye(x.onResize)&&x.onResize({top:h,left:a,width:f,height:d})}function S(){u=0,t=0,G(x)&&ye(x.onResizeEnd)&&x.onResizeEnd(),document.body.style.pointerEvents="initial",document.documentElement.style.cursor="default",window.removeEventListener("mousemove",w,!1),window.removeEventListener("mouseup",S,!1)}function M(y){C=y}function I(y){E=y}return{setAspectRatio:M,setKeepAspectRatio:I}}const Zi=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dr=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],$i=["January","February","March","April","May","June","July","August","September","October","November","December"],Mt=30,bt=38,We=46,ur="imgs/user.gif",Ee={top:"top",left:"left",right:"right",topLeft:"topLeft",bottomLeft:"bottomLeft",bottomRight:"bottomRight",topRight:"topRight"},Te=()=>"var(--window-icon-color)",fr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
<path
  d="M 3 3 L 11 3 L 11 11 L 3 11 L 3 3 z M 11 13 L 11 21 L 3 21 V 13 L 11 13 z M 13 3 L 21 3 V 11 L 13 11 V 3 z M 21 13 L 21 21 L 13 21 L 13 13 L 21 13 z" />
</svg>
`,Qi=`
<svg xmlns="http://www.w3.org/2000/svg" class="svg-stroke" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" />
  <circle cx="12" cy="12" r="3" />
</svg>
`,mr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="${Te()}"><path d="M20 5h-9.586L8.707 3.293A.997.997 0 0 0 8 3H4c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V7c0-1.103-.897-2-2-2z"></path></svg>
`,Us=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="${Te()}" fill="none" stroke-linecap="round">
  <circle cx="12" cy="17" r="1" style="fill: ${Te()}" />
  <path d="M9.172 14a4 4 0 0 1 5.656 0" />
  <path d="M6.343 12a8 8 0 0 1 11.314 0" />
  <path d="M3.515 9.5c4.686 -4.687 12.284 -4.687 17 0" />
</svg>
`,js=`
<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" stroke="${Te()}"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
`,Vs=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" fill="none" stroke-linejoin="round">
<rect x="5.5" y="7.5" width="14" height="9" stroke="${Te()}"/>
<rect x="7" y="9" width="11" height="6" fill="${Te()}"/>
<rect x="19.5" y="10" width="1.5" height="4" fill="${Te()}"/>
</svg>
`,Ks=`
<svg aria-hidden="true" version="1.1" width="10" height="10">
<path d="M 0,0 0,0.7 4.3,5 0,9.3 0,10 0.7,10 5,5.7 9.3,10 10,10 10,9.3 5.7,5 10,0.7 10,0 9.3,0 5,4.3 0.7,0 Z"></path>
</svg>
`,qs=`
<svg class="svg-stroke" width="14" height="14" viewBox="0 0 24 24" stroke-width="2" stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <line x1="18" y1="6" x2="6" y2="18" />
  <line x1="6" y1="6" x2="18" y2="18" />
</svg>
`,pr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" fill="none" stroke="${Te()}" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<path d="M7 6a7.75 7.75 0 1 0 10 0" />
<line x1="12" y1="4" x2="12" y2="12" />
</svg>
`,gr=`
 <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"  stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
 <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
 <path d="M19.95 11a8 8 0 1 0 -.5 4m.5 5v-5h-5" />
</svg>
`,Xs=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<polyline points="6 15 12 9 18 15" />
</svg>
`,$t=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke="${Te()}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round" class="svg-stroke">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<polyline points="9 6 15 12 9 18" />
</svg>
 `,vr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<polyline points="7 8 17 16 12 20 12 4 17 8 7 16" />
</svg>
`,_r=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<path d="M16 10h4a2 2 0 0 1 0 4h-4l-4 7h-3l2 -7h-4l-2 2h-3l2 -4l-2 -4h3l2 2h4l-2 -7h3z" />
</svg>
`,wr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
</svg>
`,br=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<path d="M5 12l5 5l10 -10" />
</svg>
`,Gs=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<circle cx="10" cy="10" r="7" />
<line x1="21" y1="21" x2="15" y2="15" />
</svg>
`,yr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Te()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<circle cx="12" cy="12" r="4" style="fill: ${Te()}"/>
<circle cx="12" cy="12" r="9"/>
</svg>
`,Sr=`
<svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" class="no-stroke">
  <circle cx="12" cy="12" r="9" fill="#000" />
  <circle cx="12" cy="12" r="8" fill="#fff" />
  <path d="M12 21A2 2 1 0 1 12 3" fill="#000" />
</svg>
`,xr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${Te()}"
  stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
  <circle cx="12" cy="12" r="3"></circle>
  <line x1="12" y1="1" x2="12" y2="5"></line>
  <line x1="12" y1="19" x2="12" y2="23"></line>
  <line x1="4" y1="4" x2="7" y2="7"></line>
  <line x1="17" y1="17" x2="20" y2="20"></line>
  <line x1="1" y1="12" x2="5" y2="12"></line>
  <line x1="19" y1="12" x2="23" y2="12"></line>
  <line x1="4" y1="20" x2="7" y2="17"></line>
  <line x1="17" y1="7" x2="20" y2="4"></line>
</svg>
`,Cr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${Te()}"
stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
<circle cx="12" cy="12" r="5"></circle>
<circle cx="10" cy="11" r="2" fill="${Te()}"></circle>
<line x1="12" y1="1" x2="12" y2="3"></line>
<line x1="12" y1="21" x2="12" y2="23"></line>
<line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
<line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
<line x1="1" y1="12" x2="3" y2="12"></line>
<line x1="21" y1="12" x2="23" y2="12"></line>
<line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
<line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>
`,kr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
stroke="${Te()}" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
<path d="M2 16.1A5 5 0 0 1 5.9 20M2 12.05A9 9 0 0 1 9.95 20M2 8V6a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-6">
</path>
<line x1="2" y1="20" x2="2.01" y2="20"></line>
</svg>
`,Er=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" fill="none" stroke="${Te()}">
<rect x="3" y="3" width="18" height="18" />
<line x1="6" x2="10" y1="10" y2="6" />
<line x1="6" x2="18" y1="18" y2="6" />
<line x1="14" x2="18" y1="18" y2="14" />
</svg>
`;function es(e=24,c=1.5,v=Te()){return`
<svg xmlns="http://www.w3.org/2000/svg" class="svg-stroke" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="${v}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<line x1="12" y1="5" x2="12" y2="19" />
<line x1="5" y1="12" x2="19" y2="12" />
</svg>
`}function Lr(e=20,c="var(--window-icon-color)"){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" stroke="${c}"
"><rect x="1" y="1" width="22" height="14" style="" stroke-width="2"></rect><path d="M8.5 1L8.5 15.5M11.5 15.5L11.5 20.5L2.5 20.5M11.5 20.5L21.5 20.5"></path></svg>`}function Tr(e=24,c="var(--window-icon-color)"){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="1.5" stroke="${c}" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(60 12 12)"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(120 12 12)"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(180 12 12)"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(240 12 12)"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(300 12 12)"></path>
</svg>`}function Dr(e=24){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="1.5" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l14 0" />
  <path d="M5 12l6 6" />
  <path d="M5 12l6 -6" />
</svg>`}function Mr(e=24){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="1.5" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l14 0" />
  <path d="M13 18l6 -6" />
  <path d="M13 6l6 6" />
</svg>`}function Ir(e=24){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="1.5" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M12 5l0 14" />
  <path d="M18 11l-6 -6" />
  <path d="M6 11l6 -6" />
</svg>`}function Br(e=24){return`<svg xmlns="http://www.w3.org/2000/svg"width="${e}" height="${e} "viewBox="0 0 24 24" stroke-width="1" stroke="var(--window-icon-color)" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M3.5 5.5l1.5 1.5l2.5 -2.5" />
  <path d="M3.5 11.5l1.5 1.5l2.5 -2.5" />
  <path d="M3.5 17.5l1.5 1.5l2.5 -2.5" />
  <path d="M11.5 6.5l9.5 0" />
  <path d="M11.5 12.5l9.5 0" />
  <path d="M11.5 18.5l9.5 0" />
</svg>`}function Rr(e=24){return`<svg xmlns="http://www.w3.org/2000/svg"width="${e}" height="${e} "viewBox="0 0 24 24" stroke-width="1" stroke="var(--window-icon-color)" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M15 8h.01" />
  <path d="M12.5 21h-6.5a3 3 0 0 1 -3 -3v-12a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v6.5" />
  <path d="M3 16l5 -5c.928 -.893 2.072 -.893 3 0l4 4" />
  <path d="M14 14l1 -1c.653 -.629 1.413 -.815 2.13 -.559" />
  <path d="M19 16v6" />
  <path d="M22 19l-3 3l-3 -3" />
</svg>`}function Ar(e=24){return`<svg xmlns="http://www.w3.org/2000/svg"width="${e}" height="${e} "viewBox="0 0 24 24" stroke-width="1" stroke="var(--window-icon-color)" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M15 8h.01" />
  <path d="M12.5 21h-6.5a3 3 0 0 1 -3 -3v-12a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v6.5" />
  <path d="M3 16l5 -5c.928 -.893 2.072 -.893 3 0l4 4" />
  <path d="M14 14l1 -1c.67 -.644 1.45 -.824 2.182 -.54" />
  <path d="M16 19h6" />
  <path d="M19 16v6" />
</svg>`}function Nr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e} " viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M19.933 13.041a8 8 0 1 1 -9.925 -8.788c3.899 -1 7.935 1.007 9.425 4.747"></path>
   <path d="M20 4v5h-5"></path>
</svg>`}function Ys(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
  <path d="M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
  <path d="M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
</svg>`}function Js(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path d="M15 8h.01" />
  <path d="M3 6a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3v-12z" />
  <path d="M3 16l5 -5c.928 -.893 2.072 -.893 3 0l5 5" />
  <path d="M14 14l1 -1c.928 -.893 2.072 -.893 3 0l3 3" />
</svg>`}function Pr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M15 8h.01" />
  <path d="M11 20h-4a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v4" />
  <path d="M4 15l4 -4c.928 -.893 2.072 -.893 3 0l3 3" />
  <path d="M14 14l1 -1c.31 -.298 .644 -.497 .987 -.596" />
  <path d="M18.42 15.61a2.1 2.1 0 0 1 2.97 2.97l-3.39 3.42h-3v-3l3.42 -3.39z" />
</svg>`}function Hr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <rect x="1" y="3" width="4" height="4"/>
  <path d="M10 5h10" />
  <rect x="1" y="10" width="4" height="4"/>
  <path d="M10 12h10" />
  <rect x="1" y="17" width="4" height="4"/>
  <path d="M10 19h10" />
</svg>`}function Or(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
  <path d="M7 10l6 0" />
  <path d="M10 7l0 6" />
  <path d="M21 21l-6 -6" />
</svg>`}function Fr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
  <path d="M7 10l6 0" />
  <path d="M21 21l-6 -6" />
</svg>`}function zr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 16" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path d="M.5.5h23v15H.5z" />
  <path d="M3.5 6.5v-3h3m14 3v-3h-3m3 6v3h-3m-11 0h-3v-3" />
</svg>`}function Wr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 16" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path d="M.5.5h23v15H.5zM6.5 4.5v7m11-7v7" />
  <circle cx="12" cy="5.5" r=".5" />
  <circle cx="12" cy="10.5" r=".5" />
</svg>`}function $r(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path d="M15 1h8v8m0-8L1 23v-8m0 8h8" />
</svg>`}function Ur(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 7l16 0" />
  <path d="M10 11l0 6" />
  <path d="M14 11l0 6" />
  <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" />
  <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" />
</svg>`}function jr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M19.5 12.572l-7.5 7.428l-7.5 -7.428a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572" />
</svg>`}function Vr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M17 17h2a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2h-14a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h2" />
  <path d="M17 9v-4a2 2 0 0 0 -2 -2h-6a2 2 0 0 0 -2 2v4" />
  <path d="M7 13m0 2a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2v4a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2z" />
</svg>`}function Kr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M13 4v4c-6.575 1.028 -9.02 6.788 -10 12c-.037 .206 5.384 -5.962 10 -6v4l8 -7l-8 -7z" />
</svg>`}const Tt={};function Ne(e,c,v){typeof Tt[e]>"u"&&(Tt[e]=Object.create(null)),Tt[e][c]=v}function Me(e,c){if(!(typeof Tt[e]>"u"))for(let v in Tt[e])Tt[e][v](c)}function ii(e,c){delete Tt[e][c]}const oe={backgroundImageChange:"background-image-change",backgroundImageStyleChange:"background-image-style-change",themeChange:"theme-change",blurChange:"blur-change",nightLightChange:"night-light-change",closePopup:"close-popup",showPopup:"show-popup",hidePopup:"hide-popup",createWindow:"create-window",startProcess:"start-process",viewWindow:"view-window",restoreView:"restore-view",showDesktopHover:"show-desktop-hover",showDesktopOut:"show-desktop-out",showDesktop:"show-desktop",blurAllWindow:"blur-all-window",brightnessChange:"brightness-change",transparentChange:"transparency-change",customThemeChange:"custom-theme-change"};function Fe(e,c){Me(oe.createWindow,{appName:e,args:c})}function si(e){Me(oe.startProcess,e)}let Ve,Qt;function qr(){return Ve}function Xr(e,c){if(Ve instanceof HTMLDivElement){Ve.innerHTML="",i();return}function v(){return e.map(l=>{const p=parseInt(l.element.style.width),a=parseInt(l.element.style.height),h=Array.from(l.element.getElementsByTagName("video")),f=l.element.cloneNode(!0),d=Array.from(f.getElementsByTagName("video")),u=Array.from(f.getElementsByTagName("audio"));for(let s=0;s<d.length;s++){const o=d[s];o.muted=!0,o.pause(),o.controls=!1,o.currentTime=h[s].currentTime}for(let s of u)s.muted=!0,s.pause(),s.controls=!1;f.style.pointerEvents="none",f.classList.add("taskbar-app-thumbnail-content");let t=120/a;return t*p>200&&(t=200/p),f.className.indexOf("fluid")===-1&&(f.style.height=a-Mt+"px"),f.style.transform=`scale(${t})`,{container:_("div",{title:l.getTitle(),className:"taskbar-app-thumbnail"+(l.isFocused()?" active":""),onmouseover:b.bind(null,l.id),onmouseout:x.bind(null,l.id)},[_("div",{className:"taskbar-app-thumbnail-inner relative w-full h-full fade-in",onclick:C.bind(null,l)},[_("div",{className:"taskbar-app-thumbnail-heading flex items-center"},[_("div",{className:"taskbar-app-thumbnail-icon image-cover flex-shrink-0",style:{backgroundImage:`url("${l.icon}")`}}),_("div",{className:"taskbar-app-thumbnail-title"},_("div",{className:"text-ellipsis"},l.getTitle())),_("div",{title:"Close",className:"taskbar-app-thumbnail-close-button flex content-center items-center flex-shrink-0",innerHTML:Ks,onclick:()=>{l.close(),_i(),E()}})]),_("div",{className:"taskbar-app-thumbnail-container"},f)])]),thumbnail:f}})}function b(l){Me(oe.viewWindow,{id:l}),Me(oe.hidePopup)}function x(l){E(l),Me(oe.showPopup)}function E(l){Me(oe.restoreView,{id:l})}function C(l){l.show(),l.focus(),_i(),E()}function n(l){if(Ve){const p=Ve.getBoundingClientRect(),a=Math.round(c.left+c.width/2-p.width/2);Ve.style.left=a+"px",Ve.style.height=l+62+"px"}}function i(){const l=v();Ve&&Dt(Ve,l.map(a=>a.container));let p=0;l.forEach(a=>{const h=a.thumbnail.getBoundingClientRect();a.container.style.width=h.width+"px",a.container.style.height=h.height+32+"px",h.height>p&&(p=h.height)}),n(p),setTimeout(()=>{ge(Ve,{visibility:"visible"})},50)}Ve=_("div",{className:"taskbar-app-thumbnails flex",style:{visibility:"hidden"},onmouseover:Zs,onmouseleave:Qs}),document.body.appendChild(Ve),i()}function Zs(){Qt&&clearTimeout(Qt)}function Qs(){Qt&&clearTimeout(Qt),Qt=setTimeout(()=>{_i()},500)}function _i(){Ve==null||Ve.remove(),Ve=void 0}function en(e,c){const v=Object.create(null);return v.className="taskbar-app-item-icon w-full h-full flex items-center content-center",c==="svg"?v.innerHTML=e:(v.className+=" image-icon",v.style||(v.style=Object.create(null)),v.style.backgroundImage=`url("${e}")`,v.style.pointerEvents="none"),v}function Gr(e,c,v){let b;const x=Object.create(null);x.title=e.productName,x.className="taskbar-item taskbar-app-item";const E=en(e.icon,e.iconType);return x.onmousedown=C=>C.stopImmediatePropagation(),x.onclick=c==null?void 0:c.onclick,x.oncontextmenu=c==null?void 0:c.oncontextmenu,b=_("div",x,_("div",E)),G(v)&&b.style.setProperty("--window-icon-color",v),{element:b}}function _t(e,c){let v;const b=[],x=Object.create(null);x.className="taskbar-item taskbar-app-item";const E=en(e.icon,e.iconType);let C;x.onmousedown=r=>{vt(),r.stopPropagation(),Me(oe.closePopup),C&&clearTimeout(C)},x.oncontextmenu=r=>{r.stopPropagation(),r.preventDefault(),vt(),typeof c.oncontextmenu=="function"&&c.oncontextmenu(r)};function n(){const r=b.map(m=>m.app);Xr(r,v.getBoundingClientRect())}x.onmouseover=()=>{b.length&&(Zs(),C&&clearTimeout(C),qr()?n():C=setTimeout(()=>{n()},500))},x.onmouseleave=()=>{C&&clearTimeout(C),b.length&&Qs()},x.onclick=i;function i(){if(b.length===0)Fe(e.name);else if(b.length===1){_i();const r=b[0];r.app.isVisible()?r.app.isFocused()?r.app.hide():r.app.focus():(r.app.show(),r.app.focus())}else b.length>1&&n()}let l;v=_("div",x,[_("div",E),l=_("div",{className:"taskbar-app-item-status"})]),v.addEventListener("customdragover",p,!1),v.addEventListener("customdrop",a,!1);function p(r){}function a(r){}function h(){b.length?l.classList.add("active"):l.classList.remove("active")}function f(r,m){b.push({name:r,active:!0,app:m}),h()}function d(r){const m=b.findIndex(g=>g.name===r);m>-1&&(b.splice(m,1),b.length===0&&c!=null&&c.onRemove&&c.onRemove()),h()}function u(r){setTimeout(()=>{v.classList.add("active")},10)}function t(r){setTimeout(()=>{v.classList.remove("active")},0)}function s(){return b}function o(){v.remove()}return{element:v,addInstance:f,removeInstance:d,getInstances:s,setActive:u,removeActive:t,remove:o}}function Bt(e,c,v){const b="popup"+Mi(32);let x="popup dropdown-box"+(e.noBorder?" no-border":""),E=!1,C={};e.className&&(x+=" "+e.className),G(e.top)&&(C.top=e.top+"px"),G(e.left)&&(C.left=e.left+"px"),G(e.width)&&(C.width=e.width+"px"),G(e.height)&&(C.height=e.height+"px");let n=_("div");function i(t){n=_("div",{tabIndex:-1,className:x,style:C},_("div",{className:"popup-inner relative w-full h-full"},t)),st(document.body,n),Me(oe.blurAllWindow),n.focus(),document.addEventListener("mousedown",f,!1)}function l(t){ge(n,t)}function p(t){i(c),G(t)&&(G(t.top)&&(n.style.top=t.top+"px"),G(t.left)&&(n.style.left=t.left+"px"),G(t.width)&&(n.style.width=t.width+"px"),G(t.height)&&(n.style.height=t.height+"px")),E=!0,v&&v.onShow&&v.onShow()}function a(){n.remove(),document.removeEventListener("mousedown",f,!1),E=!1,v&&v.onHide&&v.onHide()}function h(t){E?a():p(t)}function f(t){const s=t.target;n.contains(s)||a()}function d(){n&&n.classList.add("hidden")}function u(){n&&n.classList.remove("hidden")}return Ne(oe.closePopup,b,t=>{E&&b!==t&&a()}),Ne(oe.showPopup,b,()=>{u()}),Ne(oe.hidePopup,b,()=>{d()}),{element:n,id:b,show:p,close:a,visible:u,hide:d,toggleShow:h,setStyle:l}}let Gt=class{constructor({startDate:c=null,endDate:v=null,siblingMonths:b=!1,weekNumbers:x=!1,weekStart:E=0}={}){Nt(this,"startDate");Nt(this,"endDate");Nt(this,"siblingMonths");Nt(this,"weekNumbers");Nt(this,"weekStart");this.startDate=c,this.endDate=v,this.siblingMonths=b,this.weekNumbers=x,this.weekStart=E}getCalendar(c,v){const b=new Date(Date.UTC(c,v,1,0,0,0,0));c=b.getUTCFullYear(),v=b.getUTCMonth();const x=[],E=b.getUTCDay(),C=-((7-this.weekStart+E)%7),n=Gt.daysInMonth(c,v),i=(n-C)%7,l=Gt.daysInMonth(c,v-1);let p=C,a,h,f=!1,d=null,u,t;const s=n-p+(i!==0?7-i:0)+C;for(;p<s;)h=p+1,a=((p<1?7+p:p)+E)%7,h<1||h>n?this.siblingMonths?(h<1?(u=v-1,t=c,u<0&&(u=11,t--),h=l+h):h>n&&(u=v+1,t=c,u>11&&(u=0,t++),h=p-n+1),u!==void 0&&t!==void 0&&(f={day:h,weekDay:a,month:u,year:t,siblingMonth:!0})):f=!1:f={day:h,weekDay:a,month:v,year:c},f&&this.weekNumbers&&(d===null?d=Gt.calculateWeekNumber(f):a===1&&d===52?d=1:a===1&&d++,f.weekNumber=d),f&&this.startDate&&(f.selected=this.isDateSelected(f)),x.push(f),p++;return x}isDateSelected(c){return this.startDate?c.year===this.startDate.year&&c.month===this.startDate.month&&c.day===this.startDate.day?!0:!(!this.endDate||c.year===this.startDate.year&&c.month===this.startDate.month&&c.day<this.startDate.day||c.year===this.endDate.year&&c.month===this.endDate.month&&c.day>this.endDate.day||c.year===this.startDate.year&&c.month<this.startDate.month||c.year===this.endDate.year&&c.month>this.endDate.month||c.year<this.startDate.year||c.year>this.endDate.year):!1}setStartDate(c){this.startDate=c}setEndDate(c){this.endDate=c}setDate(c){return this.setStartDate(c)}static diff(c,v){const b=new Date(Date.UTC(c.year,c.month,c.day,0,0,0,0)),x=new Date(Date.UTC(v.year,v.month,v.day,0,0,0,0));return Math.ceil((b.getTime()-x.getTime())/864e5)}static interval(c,v){return Math.abs(Gt.diff(c,v))+1}static compare(c,v){if(typeof c!="object"||typeof v!="object"||c===null||v===null)throw new TypeError("dates must be objects");return c.year<v.year?-1:c.year>v.year?1:c.month<v.month?-1:c.month>v.month?1:c.day<v.day?-1:c.day>v.day?1:0}static daysInMonth(c,v){return new Date(c,v+1,0).getDate()}static isLeapYear(c){return c%4===0&&c%100!==0||c%400===0}static calculateWeekNumber(c){const v=new Date(Date.UTC(c.year,c.month,c.day,0,0,0,0)),b=new Date(v.valueOf()),x=(v.getUTCDay()+6)%7;b.setUTCDate(b.getUTCDate()-x+3);const E=b.valueOf();return b.setUTCMonth(0,1),b.getUTCDay()!==4&&b.setUTCMonth(0,1+(4-b.getUTCDay()+7)%7),1+Math.ceil((E-b.getTime())/6048e5)}};function Yr(){let e,c,v=new Date().getDate(),b;const x=new Gt({siblingMonths:!0});function E(){c.innerHTML="";const l=new Date;e.innerHTML=$i[l.getUTCMonth()];const p=Zi.map(a=>a.substring(0,2));for(let a=0;a<p.length;a++){const h=p[a];c.appendChild(_("div",{className:"calendar-day -weekday"},_("div",{className:"w-full h-full flex items-center content-center"},h)))}x.getCalendar(l.getUTCFullYear(),l.getUTCMonth()).forEach(a=>{const h=_("div",{className:"calendar-day"+(a&&a.siblingMonth?" -sibling-month":"")},_("div",{"data-date":a?a.day:"",className:"calendar-day-inner w-full h-full flex items-center content-center"+(a&&l.getDate()===a.day&&!a.siblingMonth?" active":"")},a?a.day.toString():""));c.appendChild(h)})}function C(){const l=new Date,p=l.getDate();if(v!==p){const a=c.querySelector(`[data-date="${v}"`);a instanceof HTMLDivElement&&a.classList.remove("active");const h=c.querySelector(`[data-date="${p}"`);h instanceof HTMLDivElement&&h.classList.add("active"),v=p,e.innerHTML=$i[l.getUTCMonth()]}}function n(){E(),b=setInterval(()=>{C()},1e3)}function i(){clearInterval(b)}return Bt({className:"calendar-popup"},_("div",{className:"calendar-content"},[e=_("div",{className:"calendar-month"}),c=_("div",{className:"calendar-items"})]),{onShow:n,onHide:i})}const ws=Yr();function Jr(){function e(){vt(),Me(oe.closePopup,ws.id),ws.toggleShow()}const c=_("div",{className:"taskbar-item taskbar-date-time taskbar-date h-full flex items-center flex-shrink-0",onclick:e,onmousedown:v=>v.stopPropagation()},Ui(new Date));return setInterval(()=>{c.textContent=Ui(new Date)},500),{element:c}}function Zr(){let e,c,v,b,x;function E(){const i=new Date,l=i.getSeconds(),p=l/60*360+90;e.style.transform=`rotate(${p}deg)`;const a=i.getMinutes(),h=a/60*360+l/60*6+90;c.style.transform=`rotate(${h}deg)`;const d=i.getHours()/12*360+a/60*30+90;v.style.transform=`rotate(${d}deg)`,b.textContent=It(i,!0)}function C(){E(),setInterval(E,500)}function n(){clearInterval(x)}return Bt({className:"clock-popup"},_("div",{className:"clock-container flex"},[_("div",{className:"clock-inner"},[_("div",{className:"clock"},[_("div",{className:"outer-clock-face"},[_("div",{className:"clock-marking clock-marking-one"}),_("div",{className:"clock-marking clock-marking-two"}),_("div",{className:"clock-marking clock-marking-three"}),_("div",{className:"clock-marking clock-marking-four"}),_("div",{className:"inner-clock-face"},[v=_("div",{className:"clock-hand clock-hour-hand"}),c=_("div",{className:"clock-hand clock-min-hand"}),e=_("div",{className:"clock-hand clock-second-hand"})])])]),b=_("div",{className:"clock-time"})]),_("div",{className:"clock-divider"}),_("div",{className:"alarm-container flex flex-col flex-1 w-full"},[_("div",{className:"alarm-heading"},"Alarms"),_("div",{className:"alarm-items flex items-center content-center flex-1"},"No alarms")])]),{onShow:C,onHide:n})}const bs=Zr();function Qr(){const e=_("div",{className:"taskbar-item taskbar-date-time taskbar-time h-full flex items-center",onclick:()=>{vt(),Me(oe.closePopup,bs.id),bs.toggleShow({left:Math.round(e.getBoundingClientRect().left)})},onmousedown:c=>c.stopPropagation()},It(new Date));return setInterval(()=>{e.textContent=It(new Date)},500),{element:e}}function eo(){let e,c;function v(){c=setInterval(()=>{e.textContent=It(new Date)},500)}function b(){clearInterval(c)}function x(C,n){return _("div",{},[_("div",{},C),_("div",{style:{fontSize:"16px"}},n)])}return Bt({className:"weather-popup"},_("div",{className:"weather-container w-full h-full p-20"},[_("div",{className:"flex"},[e=_("div",{className:"weather-popup-time flex items-center"},It(new Date)),_("div",{className:"flex items-center",style:{fontWeight:"bold",marginLeft:"auto"}},[_("div",{style:{marginRight:"10px"}},"Somewhere"),_("div",{className:"flex items-center",innerHTML:Qi})])]),_("div",{className:"flex items-center",style:{paddingBlock:"20px"}},[_("div",{style:{width:"80px",height:"80px",backgroundImage:'url("imgs/icons/Weather/sunny snow.png")',backgroundRepeat:"no-repeat",backgroundSize:"contain"}}),_("div",{className:"weather-popup-temperature",style:{marginLeft:"20px",fontSize:"32px"}},"-37°C"),_("div",{style:{marginLeft:"20px"}},[_("div",{style:{fontWeight:"bold",fontSize:"14px"}},"Snow"),_("div",{className:"flex",style:{marginTop:"10px"}},[_("div",{},"Feel like"),_("div",{style:{marginLeft:"10px",fontWeight:"bold",fontSize:"14px"}},"-37°C")])])]),_("div",{className:"weather-popup-index"},[x("Air quality","60"),x("Winds","4 km/h"),x("Humidity","50 %"),x("Visibility","10 km"),x("Pressure","1021 mb"),x("Dew point","10°")])]),{onShow:v,onHide:b})}function to(){const e=eo(),c=_("div",{title:"Somewhere, -37°C, Snow",className:"taskbar-item taskbar-weather h-full flex items-center",onclick:()=>{vt(),Me(oe.closePopup,e.id),e.toggleShow({left:Math.round(c.getBoundingClientRect().left)})},onmousedown:v=>v.stopPropagation()},[_("div",{style:{height:"20px"},innerHTML:Tr(20,"var(--accent-color)")}),_("div",{style:{marginLeft:"5px"}},"-37°C")]);return{element:c}}const Ue=[];for(let e=0;e<6;e++){const c="IMG"+e+".jpg";Ue.push({name:c,path:"imgs/Wallpapers/"+c,thumbnailPath:"imgs/Wallpapers/Thumbnails/"+c})}const Ht={useTitleBarAccentColor:!1,useTaskbarAndStartMenuAccentColor:!1,useWindowBorderAccentColor:!1},io={name:"Default Light",background:Ue[0],accentColor:{h:200,s:100,l:50},dark:!1,transparency:!0,backgroundImageStyle:"Fill",...Ht},so={name:"Default Dark",background:Ue[1],backgroundImageStyle:"Fill",accentColor:{h:200,s:100,l:50},dark:!0,transparency:!0,...Ht},no=[{name:"Spring",background:Ue[2],backgroundImageStyle:"Fill",accentColor:{h:120,s:100,l:40},dark:!1,transparency:!0,...Ht},{name:"Summer",background:Ue[3],backgroundImageStyle:"Fill",accentColor:{h:48,s:100,l:49},dark:!1,transparency:!0,...Ht},{name:"Autumn",background:Ue[4],backgroundImageStyle:"Fill",accentColor:{h:356,s:98,l:69},dark:!1,transparency:!0,...Ht},{name:"Winter",background:Ue[5],backgroundImageStyle:"Fill",accentColor:{h:215,s:50,l:40},dark:!0,transparency:!1,...Ht}],ro=[io,so].concat(no),tn={showDesktopIcons:!0,volume:100,brightness:100,nightlight:!1,themes:ro,themeIndex:0,recentImages:[Ue[0],Ue[2],Ue[3],Ue[4],Ue[5]],roundedCorner:!0,useBorder:!1},Se=ts("preferences",tn);function ts(e,c={}){let v={};try{const C=localStorage.getItem(e);C?v=mn(JSON.parse(C),c):v=c}catch{}function b(C){if(typeof C=="string")return{[C]:v[C]};if(C instanceof Array){const n={};for(let i=0;i<C.length;i++){const l=C[i];n[l]=v[l]}return n}return v}function x(C){v={...v,...C},localStorage.setItem(e,JSON.stringify(v))}function E(){v=tn,localStorage.setItem(e,JSON.stringify(v))}return{getState:b,setState:x,reset:E}}function oo(){let{nightlight:e}=Se.getState("nightlight"),c,v,b=_("div",{className:"screen"},[c=_("div",{className:"screen-bright-overlay w-full h-full"}),v=_("div",{className:"screen-nightlight w-full h-full"+(e?" active":"")})]);st(document.body,b);function x(n){let i=Jt(.7-n/100*.7,2);c.style.opacity=i.toString(),Me(oe.brightnessChange,n)}function E(n,i=!0){e=n,v.classList[e?"add":"remove"]("active"),i&&Se.setState({nightlight:e}),Me(oe.nightLightChange,e)}function C(){E(!e)}return{setBrightness:x,setNightLight:E,toogleNightLight:C}}const ni=oo();function ys(e){let c,v,b,x,E,C,n=!1,i={top:0,left:0,width:0,height:0};function l(){i=b.getBoundingClientRect()}function p(r,m){let g=r-i.left;g<0?g=0:g>i.width&&(g=i.width);let k=g/i.width*100;m(k)}function a(r){typeof r=="number"&&p(r,m=>{c=m,x.style.width=m+"%",E.style.width=m+"%",typeof e.onChange=="function"?e.onChange(m,g=>{e.showBagde&&(C.textContent=g.toString())}):e.showBagde&&(C.textContent=Math.round(m).toString())})}function h(r){n=!0,v.classList.add("hoding"),l(),a(r.x),typeof e.onHoding=="function"&&e.onHoding(),document.addEventListener("mousemove",f,!1),document.addEventListener("mouseup",d,!1)}function f(r){n&&a(r.x)}function d(){n=!1,v.classList.remove("hoding"),typeof e.onRelease=="function"&&e.onRelease(c),document.removeEventListener("mousemove",f,!1),document.removeEventListener("mouseup",d,!1)}function u(){l()}function t(r){n||p(r.x,m=>{m||(m=0),E.style.width=m+"%",typeof e.onHoverMove=="function"?e.onHoverMove(m,g=>{e.showBagde&&(C.textContent=g.toString())}):e.showBagde&&(C.textContent=Math.round(m).toString())})}function s(){E.style.width="0%"}v=_("div",{className:"slider",onmousedown:h,onmouseover:u,onmousemove:t,onmouseleave:s},b=_("div",{className:"slider-inner"},[x=_("div",{className:"slider-thumb-primary"},_("div",{className:"slider-thumb-primary-inner"})),E=_("div",{className:"slider-thumb-secondary"},_("div",{className:"slider-thumb-secondary-inner"},e.showBagde?C=_("div",{className:"slider-thumb-secondary-text"}):null))]));function o(r){r>100&&(r=100),n||(x.style.width=r+"%")}return{element:v,update:o}}function ht(e){let c=e.active,v=_("div",{className:"action-center-button"+(c?" active":"")},[_("div",{className:"action-center-button-icon",innerHTML:e.icon,onclick:b}),_("div",{className:"action-center-button-text"},e.text)]);function b(){e.disableActiveOnClick||(c=!c,typeof e.onclick=="function"&&e.onclick(c))}function x(C){v.classList[C?"add":"remove"]("active")}function E(C){c=C,x(C)}return{element:v,setActive:E}}function ao(){const{themes:e,themeIndex:c,customTheme:v,nightlight:b,brightness:x,volume:E}=Se.getState(["themes","themeIndex","customTheme","nightlight","brightness","volume"]),C=c>-1?e[c]:v,n=C.dark,i=C.transparency,l=ht({icon:Us,text:"Wifi"}),p=ht({icon:vr,text:"Bluetooth"}),a=ht({icon:_r,text:"Airplan Mode"}),h=ht({active:n,icon:Sr,text:"Dark Theme",onclick:g=>{os(g)}}),f=ht({icon:wr,text:"Focus Assist"}),d=ht({icon:yr,text:"Location"}),u=ht({active:b,icon:Cr,text:"Night Light",onclick:()=>{ni.toogleNightLight()}}),t=ht({icon:kr,text:"Connect"}),s=ht({active:i,icon:Er,text:"Transparency",onclick:g=>{as(g)}});Ne(oe.themeChange,"actionCenter",g=>{h.setActive(g)});let o=!1;const r=ys({showBagde:!0,onHoding:()=>{o=!0},onChange:(g,k)=>{ni.setBrightness(g),k(Math.round(g))},onRelease:g=>{o=!1,Se.setState({brightness:Math.round(g)})}});r.update(x);const m=ys({showBagde:!0,onRelease:g=>{Se.setState({volume:Math.round(g)})}});return m.update(E),Ne(oe.nightLightChange,"actionCenter",g=>{u.setActive(g)}),Ne(oe.brightnessChange,"actionCenter",g=>{o||r.update(g)}),Ne(oe.transparentChange,"actionCenter",g=>{s.setActive(g)}),Bt({className:"action-center"},[_("div",{className:"action-center-top"},[_("div",{className:"action-center-buttons"},[l.element,p.element,a.element,h.element,f.element,d.element,u.element,t.element,s.element]),_("div",{className:"action-center-sliders"},[_("div",{className:"action-center-slider w-full flex items-center"},[_("div",{className:"action-center-slider-icon",innerHTML:xr}),r.element]),_("div",{className:"action-center-slider w-full flex items-center"},[_("div",{className:"action-center-slider-icon",innerHTML:js}),m.element])])]),_("div",{className:"action-center-footer flex items-center"},[_("div",{className:"action-center-footer-item action-center-batery flex items-center"},[_("div",{className:"action-center-batery-icon flex items-center",innerHTML:Vs}),_("div",{className:"action-center-batery-text"},"100%")]),_("div",{title:"Open Settings",className:"action-center-footer-item action-center-config",innerHTML:Qi,onclick:()=>{Me(oe.closePopup),Fe("settings")}})])])}const Ss=ao(),Be={Tab:"Tab",Enter:"Enter",ArrowLeft:"ArrowLeft",ArrowRight:"ArrowRight",ArrowUp:"ArrowUp",ArrowDown:"ArrowDown",Escape:"Escape",Space:" ",BackSpace:"Backspace",Delete:"Delete",Home:"Home",End:"End",Insert:"Insert"};function sn(e=16,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <polyline points="6 15 12 9 18 15" />
</svg>`}function Ei(e=16,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <polyline points="6 9 12 15 18 9" />
</svg>`}function nn(e=16,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round" class="svg-stroke">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l5 5l10 -10" />
</svg>`}function rn(e,c,v){const b=typeof e.children<"u"&&e.children!==null&&e.children instanceof Array&&e.children.length>0;let x=_("div",{onBeforeRemove(){x=null}});x.className="menu-item",x.tabIndex=-1,e.disabled?x.classList.add("disabled"):(x.onclick=a,x.onkeydown=l),x.onfocus=p,x.onmouseenter=n;let E=document.createElement("div");E.className="menu-item-icon",e.checked?(x.classList.add("checked"),E.innerHTML=nn()):e.icon&&(!e.iconType&&!(e.icon instanceof Node)||e.iconType==="svg"?E.innerHTML=e.icon:e.iconType==="image"?E.style.backgroundImage=`url("${e.icon}")`:(e.icon instanceof Node||e.iconType==="element")&&E.appendChild(e.icon)),e.emphasis&&x.classList.add("emphasis"),x.appendChild(E);let C=document.createElement("div");if(C.className="menu-item-text",C.textContent=e.text||"",x.appendChild(C),e.shortcut){let f=document.createElement("div");f.className="menu-item-shortcut",f.textContent=e.shortcut,x.appendChild(f)}if(b){let f=document.createElement("div");f.className="menu-item-arrow flex items-center",f.innerHTML=$t,x.appendChild(f)}function n(f){f.stopPropagation(),f.currentTarget.focus(),v.onHover(c)}function i(){b||v.onEnter(e),typeof e.onClick=="function"&&e.onClick()}function l(f){f.key===Be.Enter&&(f.stopPropagation(),i())}function p(f){f.stopPropagation(),v.onFocus(c)}function a(f){f.stopPropagation(),i()}function h(f){x.classList[f?"add":"remove"]("active")}return{element:x,setActive:h}}function wi(e,c){let v;e.addEventListener("mouseenter",b,!1);function b(){v=requestAnimationFrame(E),e.addEventListener("mouseleave",x,!1)}function x(){cancelAnimationFrame(v),setTimeout(()=>{cancelAnimationFrame(v)},50),e.removeEventListener("mouseleave",x,!1)}function E(){v=requestAnimationFrame(E),typeof c=="function"&&c()}}const Lt=6;function on(e,c,v,b,x){const E=v.length;let C=0,n=[],i=-1,l,p={close:M},a=!1,h=document.createElement("div");h.className="sub-menu";let f=document.createElement("div");f.className="context-menu-scroll-button top",f.innerHTML=sn(),h.appendChild(f);let d=document.createElement("div");d.className="context-menu-scroll-button bottom",d.innerHTML=Ei(),h.appendChild(d);let u=document.createElement("div");u.tabIndex=-1,u.className="context-menu-inner",u.onkeydown=g,u.addEventListener("scroll",()=>{t()},!1);function t(){u.scrollTop<=10?f.classList.remove("show"):f.classList.add("show"),u.scrollTop+u.getBoundingClientRect().height>=u.scrollHeight-10?d.classList.remove("show"):d.classList.add("show")}function s(){u.scrollTop+=4}function o(){u.scrollTop-=4}wi(f,o),wi(d,s),h.appendChild(u),c.element.appendChild(h);for(let I=0;I<E;I++){const y=v[I];if(!a&&G(y.shortcut)&&(a=!0),y.divider){let T=document.createElement("div");T.className="menu-item-divider",u.appendChild(T)}else{let T=rn(y,C,{onEnter:b,onFocus:k,onHover:m});u.appendChild(T.element),typeof y.children<"u"&&y.children!==null&&y.children instanceof Array&&y.children.length>0&&!y.disabled&&on(h,T,y.children,b,r),n.push(T),C+=1}}a&&h.classList.add("has-shortcut");function r(I){l=I}function m(){S()}c.element.addEventListener("keydown",I=>{(I.key===Be.ArrowRight||I.key===Be.Enter)&&(I.stopPropagation(),w(!0))},!1),c.element.addEventListener("mouseenter",I=>{I.stopPropagation(),w(!1)},!1);function g(I){if(I.key===Be.ArrowLeft&&(I.stopPropagation(),h.classList.remove("show"),c.setActive(!1),c.element.focus()),I.key===Be.ArrowRight)I.stopPropagation(),i===-1&&(i=0,n[i].element.focus());else if(I.key===Be.ArrowUp){if(I.stopPropagation(),I.preventDefault(),i===-1)i=n.length-1,n[i].element.focus();else{let y=n[i-1];y?y.element.focus():n[n.length-1].element.focus()}S()}else if(I.key===Be.ArrowDown){if(I.stopPropagation(),I.preventDefault(),i===-1)i=0,n[i].element.focus();else{let y=n[i+1];y?y.element.focus():n[0].element.focus()}S()}}function k(I){i=I}let D;function w(I){const y=window.innerWidth,T=window.innerHeight;c.setActive(!0),h.classList.add("show");const A=e.getBoundingClientRect(),H=c.element.getBoundingClientRect();let P=A.left+A.width-Lt,F=H.top+2,L=h.getBoundingClientRect();D||(D=L);let B=u.getBoundingClientRect();A.left+A.width+L.width>y&&(P=A.left-L.width+Lt),F+L.height>=T?F=T-L.height-Lt/2:F-=Lt,B.height>=T&&(F=Lt,h.style.height=T-20+"px"),B=u.getBoundingClientRect(),u.scrollHeight>B.height&&(h.style.width=D.width+"px",u.style.width=D.width+20+"px"),h.style.top=F+"px",h.style.left=P+"px",t(),I&&n[0].element.focus(),x(p)}function S(){l&&l.close()}function M(){c.setActive(!1),h.classList.remove("show"),S()}return p}function Ut(e,c,v=[],b=!1,x,E=!0,C){window.lastContextMenu&&window.lastContextMenu.close(),window.contextMenuDirectionLTR=!0;const n=window.innerWidth,i=window.innerHeight;let l=!1,p,a=[],h=-1,f,d=0;const u=v.length;function t(L){if(L.key===Be.ArrowRight)h===-1&&(h=0,a[h].element.focus());else if(L.key===Be.ArrowUp){if(L.preventDefault(),h===-1)h=a.length-1,a[h].element.focus();else{let B=a[h-1];B?B.element.focus():a[a.length-1].element.focus()}o()}else if(L.key===Be.ArrowDown){if(L.preventDefault(),h===-1)h=0,a[h].element.focus();else{let B=a[h+1];B?B.element.focus():a[0].element.focus()}o()}else L.key===Be.Escape&&P()}function s(L){h=L}function o(){f&&f.close()}function r(){o()}let m=_("div",{className:"context-menu-scroll-button top",innerHTML:sn()}),g=_("div",{className:"context-menu-scroll-button bottom",innerHTML:Ei()});p=_("div",{tabIndex:-1,className:"context-menu"+(G(C)?" "+C:"")},[m,g]);let k=_("div",{tabIndex:-1,className:"context-menu-inner",onkeydown:t,onscroll:()=>{D()}});function D(){k.scrollTop<=10?m.classList.remove("show"):m.classList.add("show");let L=k.getBoundingClientRect();k.scrollTop+L.height>=k.scrollHeight-10?g.classList.remove("show"):g.classList.add("show")}function w(){k.scrollTop+=4}function S(){k.scrollTop-=4}wi(m,S),wi(g,w),p.appendChild(k),document.body.appendChild(p),p.focus();for(let L=0;L<u;L++){const B=v[L];if(!l&&G(B.shortcut)&&(l=!0),B.divider){let O=_("div",{className:"menu-item-divider"});k.appendChild(O)}else{let O=rn(B,d,{onEnter:T,onFocus:s,onHover:r});k.appendChild(O.element),typeof B.children<"u"&&B.children!==null&&B.children instanceof Array&&B.children.length>0&&!B.disabled&&on(p,O,B.children,T,F),a.push(O),d+=1}}l&&p.classList.add("has-shortcut"),setTimeout(()=>{b?a[0].element.focus():k.focus()},0);let M={top:e.top,left:e.left};const I=p.getBoundingClientRect();let y=k.getBoundingClientRect();M.left+I.width>n&&(M.left=M.left-I.width),M.top+I.height>i&&(M.top=i-I.height-Lt/2),y.height>i&&(M.top=Lt,p.style.height=i-20+"px"),y=k.getBoundingClientRect(),k.scrollHeight>y.height&&(p.style.width=I.width+"px",k.style.width=I.width+20+"px"),p.style.left=M.left+"px",p.style.top=M.top+"px",D();function T(){P()}function A(){P()}window.addEventListener("resize",A,!1),document.addEventListener("mousedown",H,!1);function H(L){p.contains(L.target)||P()}function P(){window.removeEventListener("scroll",A,!1),document.removeEventListener("mousedown",H,!1),p.remove(),E&&c.focus(),window.lastContextMenu=null,x&&x()}function F(L){f=L}window.lastContextMenu={close:P}}const nt=ts("env",{USER_NAME:"User 1",USER_HOME:"c:/Users/User 1",VERSION:"10.0.23711.1466"}),dt="imgs/icons/",Ae={thisPC:dt+"Computer.png",driverC:dt+"Drives/Hardrive%20Windows.png",user:dt+"User.png",desktop:dt+"Desktop.png",document:dt+"Folder%20Documents.png",download:dt+"Folder%20Downloads.png",pictures:dt+"Folder%20Pictures.png",music:dt+"Folder%20Music.png",videos:dt+"Folder%20Videos.png"},mt="imgs/icons/Folder.png",{USER_HOME:Vt}=nt.getState("USER_HOME"),lo=[{text:"Documents",icon:"imgs/icons/Folder%20Documents.png",iconType:"image",onclick:()=>{Fe("explorer",`${Vt}/Documents`)}},{text:"Downloads",icon:"imgs/icons/Folder%20Downloads.png",iconType:"image",onclick:()=>{Fe("explorer",`${Vt}/Downloads`)}},{text:"Music",icon:"imgs/icons/Library%20Music.png",iconType:"image",onclick:()=>{Fe("explorer",`${Vt}/Music`)}},{text:"Pictures",icon:"imgs/icons/Libray%20Pictures.png",iconType:"image",onclick:()=>{Fe("explorer",`${Vt}/Pictures`)}},{text:"Videos",icon:"imgs/icons/Library%20Videos.png",iconType:"image",onclick:()=>{Fe("explorer",`${Vt}/Videos`)}}],co=[{text:"Accounts",icon:"imgs/user.gif",iconType:"image",onclick:()=>{si({type:"app",...Q.settings,args:"accounts"})}},{text:"Settings",icon:Qi,onclick:()=>{Fe("settings")}},{text:"Power",icon:pr,preventClose:!0,onclick:e=>{Ut({top:e.y,left:e.x},e.currentTarget,[{text:"Sleep"},{text:"Restart"},{text:"Shutdown"}])}}];function ho(e){return _("div",{className:"start-menu-column start-menu-actions h-full flex flex-col scrollable scroll-y"},[_("div",{className:"start-menu-action-list start-menu-actions-top"},lo.map(c=>{const v={className:"start-menu-action-item-icon",style:{},innerHTML:""};return c.iconType==="image"?v.style.backgroundImage=`url(${c.icon})`:v.innerHTML=c.icon,_("div",{className:"start-menu-action-item flex items-center",onclick:()=>{c.onclick(),G(e)&&e(c)}},[_("div",v),_("div",null,c.text)])})),_("div",{className:"start-menu-action-list start-menu-actions-bottom"},co.map(c=>{const v={className:"start-menu-action-item-icon",style:{},innerHTML:""};return c.iconType==="image"?v.style.backgroundImage=`url(${c.icon})`:v.innerHTML=c.icon,_("div",{className:"start-menu-action-item flex items-center",onclick:b=>{c.onclick(b),G(e)&&e(c)}},[_("div",v),_("div",null,c.text)])}))])}function uo(e){const c=tr();return _("div",{className:"start-menu-column  start-menu-apps-list-container w-full h-full flex flex-col flex-1"},[_("div",{className:"start-menu-apps-list w-full h-full scrollable scroll-y"},Object.keys(c).map((b,x)=>_("div",{key:"app-item"+x,className:"start-menu-apps-list-section"},[_("div",{className:"start-menu-apps-list-label flex items-center"},b),_("div",{className:"start-menu-apps-list-items"},c[b].map((E,C)=>_("div",{key:"app-item"+C,className:"start-menu-apps-list-item flex items-center",onclick:e.bind(null,E)},[_("div",{className:"start-menu-apps-list-item-icon flex-shrink-0",style:{backgroundImage:`url(${E.icon})`}}),_("div",{className:"start-menu-apps-list-item-name"},_("div",{className:"text-ellipsis"},E.productName))])))])))])}function fo(e){let c;function v(E){c.toggleShow(),Fe(E.name)}function b(){}function x(E){G(E)&&!E.preventClose&&c.toggleShow()}return c=Bt({noBorder:!0,width:524,height:(e==null?void 0:e.height)||540,className:"start-menu"},_("div",{className:"w-full h-full flex"},[ho(x),uo(v)]),{onHide:b}),c}const xs=fo();function mo(){let e=_("div",{className:"window-container",style:{position:"fixed",top:0,left:0}});document.body.appendChild(e);function c(E){e.appendChild(E)}function v(){e.style.display="none"}function b(){e.style.removeProperty("display")}function x(E){e.classList[E?"add":"remove"]("fullscreen")}return{addWindow:c,show:b,hide:v,toogleFullScreen:x}}const bi=mo();function po(e){let c;function v(E){const C=E.target;c!=null&&c.contains(C)||(x(),e.onClose&&e.onClose())}function b(){bi.hide(),$e.showDesktopIcons(!1);const E=Co().toReversed();c=_("div",{className:"taskview flex flex-col",style:{transform:"scale(1.2)"},onclick(){x()}},[_("div",{className:"taskview-header flex-shrink-0 flex items-center",style:{paddingInline:"40px"}},[_("div",{className:"taskview-header-button flex items-center",onclick(C){C.stopPropagation()}},[_("div",{className:"taskview-header-button-icon flex items-center content-center",innerHTML:es(),style:{width:"24px",height:"24px"}}),_("div",{className:"taskview-header-button-text",style:{marginLeft:"10px"}},"New windows group")])]),_("div",{className:"taskview-app-items flex-1"},E.map(C=>{const n=parseInt(C.element.style.width),i=parseInt(C.element.style.height),l=C.element.cloneNode(!0);l.classList.add("taskbar-app-item-window"),l.style.pointerEvents="none";const p=Array.from(C.element.getElementsByTagName("video")),a=Array.from(l.getElementsByTagName("video")),h=Array.from(l.getElementsByTagName("audio"));for(let s=0;s<a.length;s++){const o=a[s];o.muted=!0,o.pause(),o.controls=!1,o.currentTime=p[s].currentTime}for(let s of h)s.muted=!0,s.pause(),s.controls=!1;let f=160/i,d=!1;f*n>=400&&(d=!0,f=400/n);const u=Math.round(f*n);l.style.transform=`scale(${f})`;const t={width:u+"px"};return d&&(t.height=Math.round(f*i)+"px"),_("div",{className:"taskview-app-item",onclick(s){s.stopPropagation(),C.show(),C.focus(),x()}},[_("div",{className:"taskview-app-item-header flex",style:{marginBottom:"5px",width:u+"px"}},[_("div",{className:"taskview-app-item-icon flex-shrink-0",style:{width:"32px",height:"32px",backgroundImage:`url(${C.icon})`,backgroundRepeat:"no-repeat",backgroundSize:"24px",backgroundPosition:"center"}}),_("div",{className:"taskview-app-item-text flex items-center"},_("div",{title:C.title,className:"text-ellipsis line-clamp-1"},C.title)),_("div",{title:"Close",className:"taskview-app-item-close flex items-center content-center flex-shrink-0",style:{width:"32px",height:"32px",marginLeft:"auto"},innerHTML:qs,onclick(s){s.stopPropagation(),C.close(),x()}})]),_("div",{className:"taskview-app-thumbnail",style:t},l)])}))]),document.body.appendChild(c),document.addEventListener("click",v,!1),setTimeout(()=>{c.style.transform="scale(1)"},0),e.onShow&&e.onShow()}function x(){document.removeEventListener("click",v,!1),G(c)&&ge(c,{transform:"scale(1.5)",opacity:"0"}),bi.show(),Se.getState("showDesktopIcons").showDesktopIcons&&$e.showDesktopIcons(!0),setTimeout(()=>{c==null||c.remove(),c=null,e.onClose&&e.onClose()},150)}return{element:c,show:b,close:x}}function go(){let e=!1,c=po({onClose:v});function v(){e=!1}return{element:_("div",{title:"Task View",className:"taskbar-item h-full flex-shrink-0",onclick:x=>{x.stopPropagation(),vt(),Me(oe.closePopup),e?(e=!1,c.close()):(e=!0,c.show())},onmousedown:x=>x.stopPropagation()},_("div",{className:"taskbar-item-button flex items-center content-center h-full",style:{width:"40px"},innerHTML:Lr(20)}))}}function an(e){let c,v;const b={};e.width&&(b.width=ji(e.width)?e.width+"px":e.width.toString());function x(a){a.preventDefault(),v.classList.add("focus")}function E(){v.classList.remove("focus")}v=_("div",{className:"textbox flex items-center",style:b},[c=_("input",{name:"search-input",autocomplete:"off",type:e.type||"text",className:"textbox-input",placeholder:e.placeholder,oninput:C,onfocus:x,onblur:E}),typeof e.optional=="function"?e.optional(e):e.optional]);function C(a){a.preventDefault(),typeof e.onChange=="function"&&e.onChange(c.value)}function n(a){c.value=a}function i(a){c.placeholder=a}function l(){c.focus()}function p(){c.value=""}return{element:v,setValue:n,setPlaceHolder:i,focus:l,clear:p}}function Li(e){const c=an({placeholder:e.placeholder,value:e.value,onChange:e.onChange,optional:()=>_("div",{className:"search-box-icon flex items-center content-center",innerHTML:Gs}),...e});return{element:c.element,setPlaceHolder:c.setPlaceHolder,focus:c.focus,clear:c.clear}}function vo(){let e=Li({placeholder:"Type here to search"});const c=[Q.settings,Q.notepad,Q.explorer,Q.photos,Q.calculator];function v(){e.focus()}function b(){e.clear()}let x=Bt({className:"search-popup"},_("div",{className:"search-container flex flex-col p-20"},[_("div",{className:"search-popup-top flex-1"},[_("div",{style:{fontWeight:"bold"}},"Top Apps"),_("div",{className:"search-popup-apps"},[c.map(E=>_("div",{className:"search-popup-app-item",onclick(){x.close(),si({...E,type:"app"})}},[_("div",{className:"search-popup-app-item-icon",style:{backgroundImage:`url(${E.icon})`}}),_("div",{className:"search-popup-app-item-text"},E.productName)]))])]),_("div",{className:"search-popup-bottom"},[_("div",{className:"search-popup-filter flex"},[_("div",{className:"search-popup-filter-item selected"},"All"),_("div",{className:"search-popup-filter-item"},"Apps"),_("div",{className:"search-popup-filter-item"},"Settings"),_("div",{className:"search-popup-filter-item"},"Folders"),_("div",{className:"search-popup-filter-item"},"Documents"),_("div",{className:"search-popup-filter-item"},"Web"),_("div",{className:"search-popup-filter-item"},"Photos"),_("div",{className:"search-popup-filter-item"},"Music"),_("div",{className:"search-popup-filter-item"},"Videos")]),_("div",{className:"search-popup-input"},e.element)])]),{onShow:v,onHide:b});return x}function _o(){let e=vo();const c=_("div",{title:"Search",className:"taskbar-item h-full flex-shrink-0",onclick:()=>{vt(),Me(oe.closePopup,e.id),e.toggleShow({left:Math.round(c.getBoundingClientRect().left)})},onmousedown:v=>v.stopPropagation()},_("div",{className:"taskbar-item-button taskbar-item-button-search flex items-center content-center h-full",style:{width:"40px"},innerHTML:Gs}));return{element:c}}function wo(){Me(oe.showDesktopHover)}function bo(){Me(oe.showDesktopOut)}function ln(){Me(oe.showDesktop)}function yo(){function e(){vt(),Me(oe.closePopup,xs.id),xs.toggleShow()}function c(x){x.stopPropagation(),x.preventDefault(),Ut({top:x.y,left:x.x},x.currentTarget,[{text:"Apps and Features",onClick:()=>{Fe(Q.settings.name,"apps")}},{text:"Mobility Center"},{text:"Power Options"},{text:"Event Viewer"},{text:"System"},{text:"Device Manager"},{text:"Network Connection"},{text:"Disk Management"},{text:"Computer Management"},{text:"Command Prompt(Admin)",onClick:()=>{Fe(Q.terminal.name)}},{divider:!0},{text:"Task Manager"},{text:"Settings",onClick:()=>{Fe(Q.settings.name)}},{text:"File Explorer",onClick:()=>{Fe(Q.explorer.name)}},{text:"Search"},{text:"Run"},{divider:!0},{text:"Shutdown or signout",children:[{text:"Sign out"},{text:"Sleep"},{text:"Shut down"},{text:"Restart"}]},{text:"Desktop",onClick:()=>{ln()}}])}const b=[{name:"startMenu",item:Gr({isSystemApp:!0,name:"start-menu",productName:"Start",icon:fr,iconType:"svg"},{onclick:e,oncontextmenu:c})}].map(x=>x.item.element);return _("div",{className:"taskbar-app-items h-full flex flex-shrink-0 items-center content-center"},b)}function So(){let e=[],c=localStorage.getItem("taskbarItems");if(typeof c>"u"||c===null)e=[{name:"explorer",item:_t(Q.explorer,{onRemove:x}),pinned:!0},{name:"settings",item:_t(Q.settings,{onRemove:x}),pinned:!0},{name:"notepad",item:_t(Q.notepad,{onRemove:x}),pinned:!0},{name:"calculator",item:_t(Q.calculator,{onRemove:x}),pinned:!0},{name:"photos",item:_t(Q.photos,{onRemove:x}),pinned:!0},{name:"cmd",item:_t(Q.cmd,{onRemove:x}),pinned:!0}];else try{c&&(c=JSON.parse(c),c instanceof Array&&(e=c.map(d=>({name:d,item:_t(Q[d],{onRemove:x}),pinned:!0}))))}catch{}let v;const b=_("div",{className:"w-full h-full flex content-center"},[v=_("div",{className:"taskbar-app-items h-full flex items-center content-center"},e.map(d=>d.item.element))]);function x(){}function E(d){return e.find(u=>u.name===d)}function C(d,u){const t={name:d,item:u};return e.push(t),v.appendChild(u.element),t}function n(d){e=e.filter(u=>u.name!==d)}function i(d,u,t){d.item.addInstance&&d.item.addInstance(u,t)}function l(d,u,t){const s=E(d);if(s)i(s,u,t);else{let o=_t({name:t.name,productName:t.productName,icon:t.icon});const r=C(d,o);i(r,u,t),e.push({name:d,item:o})}}function p(d,u){const t=E(d);t&&(t.item.removeInstance(u),t.item.getInstances().length||(t.pinned?t.item.removeActive(u):(t.item.remove(),n(d))))}function a(d,u){const t=E(d);t&&t.item.setActive(u)}function h(d,u){const t=E(d);t&&t.item.removeActive(u)}function f(d){return E(d).item.element.getBoundingClientRect()}return{element:b,addInstance:l,removeAppItem:n,removeInstance:p,setActiveWindow:a,removeActiveWindow:h,getAppItemBounds:f}}function xo(){const e=So(),c=_("div",{className:"taskbar fixed bottom w-full",style:{height:We+"px"}},_("div",{className:"taskbar-inner flex h-full",oncontextmenu:v},[_("div",{className:"taskbar-left h-full flex-1 flex-shrink-0 flex items-center"},[yo(),Qr().element,to().element,go().element,_o().element]),_("div",{className:"taskbar-center flex-2 h-full"},e.element),_("div",{className:"taskbar-right h-full flex-1 flex-shrink-0 relative flex items-center content-end",style:{paddingRight:"6px"}},[_("div",{title:"Show hidden icons",className:"taskbar-item flex items-center content-center flex-shrink-0 taskbar-item-more",innerHTML:Xs}),_("div",{className:"taskbar-item flex items-center content-center flex-shrink-0",onmousedown:b=>b.stopPropagation(),onclick:()=>{vt(),Me(oe.closePopup,Ss.id),Ss.toggleShow()}},[_("div",{className:"taskbar-item-button flex items-center content-center h-full flex-shrink-0",style:{width:We+"px"},innerHTML:js}),_("div",{className:"taskbar-item-button flex items-center content-center h-full flex-shrink-0",style:{width:We+"px"},innerHTML:Us}),_("div",{className:"taskbar-item-button flex items-center content-center h-full flex-shrink-0",style:{width:We+"px"},innerHTML:Vs})]),Jr().element,_("div",{className:"show-desktop flex-shrink-0",onmouseover:wo,onmouseout:bo,onclick:ln})])]));function v(b){Ut({top:b.y,left:b.x},b.currentTarget,[{text:"Taskbar Settings",onClick:()=>{Fe("settings","personalization/taskbar")}},{text:"Lock the taskbar",checked:!0,onClick:()=>{console.log("Lock taskbar")}}])}return st(document.body,c),e}const Ot=xo(),ze=[],tt=[];let ei=[],fi=!1;function Co(){return tt}function ko(e){const c=ei.findIndex(v=>v.window.id===e);c>-1&&ei.splice(c,1)}function Eo(e){const c=tt.findIndex(v=>v.id===e.id);c>-1&&tt.splice(c,1),tt.push(e)}function Lo(e){const c=tt.findIndex(v=>v.id===e);if(c>-1&&(tt.splice(c,1),tt.length>0)){const v=tt[tt.length-1];v.isVisible()&&v.focus()}}function is(e){const c=ze.length;for(let v=0;v<c;v++)e(ze[v])}function ss(e){return ze.find(c=>c.appName===e)}function To(e,c,v){fi=!1;const b=ze.length;for(let x=0;x<b;x++){const E=ze[x];E.window.decrementZIndex(),E.window.blur()}ze.push({appName:e,id:c,window:v}),Ot.addInstance(e,c,v)}function Do(e,c){const v=ze.findIndex(b=>b.id===c);v>-1&&(ze.splice(v,1),Ot.removeInstance(e,c)),Lo(c),ko(c)}function Mo(e,c,v){v.restoreZIndex(),Eo(v);const b=ze.length;for(let x=0;x<b;x++){const E=ze[x];E.id!==c&&(E.window.decrementZIndex(),E.window.blur())}}function Io(e){const c=ze.length;for(let v=0;v<c;v++){const b=ze[v];b.id!==e?b.window.isVisible()&&b.window.makeTransparent():b.window.element.classList.add("top-view")}}function Bo(e){if(e){const c=ze.length;for(let v=0;v<c;v++){const b=ze[v];b.id!==e?b.window.isVisible()&&b.window.removeTransparent():b.window.element.classList.remove("top-view")}}else{const c=ze.length;for(let v=0;v<c;v++){const b=ze[v];b.window.isVisible()&&b.window.removeTransparent()}}}function Ro(){is(e=>{e.window.blur()})}function Ao(){const e=ze.some(c=>c.window.isFullScreen);bi.toogleFullScreen(e)}window.addEventListener("resize",()=>{const e=ze.length;for(let c=0;c<e;c++){const v=ze[c];v.window.isMaximized()&&v.window.maximize()}},!1);function No(){if(!fi)ei=ze.filter(e=>e.window.isVisible()),ei.forEach(e=>{e.window.removeTransparent(),e.window.hide()});else{ei.forEach(c=>{c.window.removeTransparent(),c.window.show()});const e=tt[tt.length-1];e&&e.isVisible()&&e.focus()}fi=!fi}Ne(oe.viewWindow,"window-manager",e=>{Io(e.id)});Ne(oe.restoreView,"window-manager",e=>{Bo(e.id)});Ne(oe.showDesktopHover,"window-manager",()=>{is(e=>{e.window.isVisible()&&e.window.makeTransparent()})});Ne(oe.showDesktopOut,"window-manager",()=>{is(e=>{e.window.isVisible()&&e.window.removeTransparent()})});Ne(oe.showDesktop,"window-manager",()=>{No()});Ne(oe.blurAllWindow,"window-manager",()=>{Ro()});function Po(){let e=0,c=0;function v(){e=window.innerWidth,c=window.innerHeight}return v(),window.addEventListener("resize",v,!1),{get width(){return e},get height(){return c}}}let Ce=Po();const Cs=1e6,Ke=30;function lt(e){let c={...e};const v={};if(e.singleInstance){let K=ss(e.name);if(K)return K.window.executeListeners("secondInstance",e.args),K.window}let b,x=Cs;const E=Mi(32);let C,n=!1,i=!1,l=!1,p=!1,a=!1,h=!1,f="",d=!1,u=!1,t=!1,s,o=!1;function r(K,re){v[K]||(v[K]=[]),v[K].push(re)}function m(K,re){const Ie=v[K];if(Ie)for(let Je=0;Je<Ie.length;Je++)Ie[Je](re)}function g(K,re){if(G(v[K])){const Ie=v[K].findIndex(Je=>Je.name===re.name);Ie>-1&&v[K].splice(Ie,1)}}let k=e.title||"",D=hr({icon:e.icon,hideIcon:e.hideIcon,title:e.title,hideTitle:e.hideTitle,disableMaximize:e.disableMaximize,maximized:e.maximized,autoHide:e.autoHideTitleBar,content:e.titlebarContent,stretchTitlebarContent:e.stretchTitlebarContent},{onMinimizeButtonClick:fe,onMaximizeButtonClick:be,onCloseButtonClick:Wn,onVisible:()=>m("ontitlebarshow"),onHidden:()=>m("ontitlebarhide")}),w={top:0,left:0,width:0,height:0};const S={zIndex:x.toString()};let M=0,I=0,y=300,T=200,A=300,H=200,P=!1,F=0;e.keepAspectRatio&&(P=e.keepAspectRatio),e.minWidth&&(A=e.minWidth),e.minHeight&&(H=e.minHeight),e.top&&(M=Number(e.top)),e.left&&(I=Number(e.left)),e.width&&(y=Number(e.width),y<A&&(y=A)),e.height&&(T=Number(e.height),T<H&&(T=H)),e.center&&(M=Math.round((window.innerHeight-T-We)/2),I=Math.round((window.innerWidth-y)/2)),P&&(F=y/T),S.top=M+"px",S.left=I+"px",S.minWidth=A+"px",S.width=y+"px",S.height=T+"px",S.minHeight=H+"px",w={top:M,left:I,width:y,height:T};let L="";e.noBorder&&(L+=" no-border"),e.className&&(L+=" "+e.className);let B="window-content";e.fluidContent&&(B+=" fluid"),e.transprencyContent||(B+=" theme-background");let O,N,z,W,U,j,Y,R,$,q,X,se,V,he={top:!1,left:!1,right:!1,topLeft:!1,topRight:!1,bottomLeft:!1,bottomRight:!1},ke=!0;const ee=()=>{let re=[{text:"Restore",icon:_("i",{className:"window-titlebar-context-icon",innerHTML:zi}),disabled:!i,onClick:()=>{At()},emphasis:i},{text:"Move",disabled:!0},{text:"Size",disabled:!0},{text:"Minimize",icon:_("i",{className:"window-titlebar-context-icon",innerHTML:zs}),onClick:()=>{li()}},{text:"Maximize",icon:_("i",{className:"window-titlebar-context-icon",innerHTML:Wi}),onClick:()=>{At()},disabled:e.disableMaximize||i},{divider:!0},{text:"Close",icon:_("i",{className:"window-titlebar-context-icon",innerHTML:Ws}),onClick:()=>{Ai()},shortcut:"Alt+X"}];return G(e.extendContextMenu)&&(re=re.concat(e.extendContextMenu)),re},ae=e.disableResize?" disabled":"";V=_("div",{tabIndex:-1,className:"window"+L,style:S,id:E},[_("div",{className:"window-background absolute w-full h-full"}),_("div",{className:"window-inner relative w-full h-full"},[D.element,C=_("div",{className:B})]),O=_("div",{"data-resize":"t",className:"window-resize-handle window-resize-horizontal window-resize-top"+ae}),z=_("div",{"data-resize":"b",className:"window-resize-handle window-resize-horizontal window-resize-bottom"+ae}),N=_("div",{"data-resize":"l",className:"window-resize-handle window-resize-vertical window-resize-left"+ae}),W=_("div",{"data-resize":"r",className:"window-resize-handle window-resize-vertical window-resize-right"+ae}),U=_("div",{"data-resize":"tl",className:"window-resize-handle window-resize-conner window-resize-nw window-resize-tl window-resize-tl-v"+ae}),j=_("div",{"data-resize":"tl",className:"window-resize-handle window-resize-conner window-resize-nw window-resize-tl window-resize-tl-h"+ae}),$=_("div",{"data-resize":"br",className:"window-resize-handle window-resize-conner window-resize-nw window-resize-br window-resize-br-v"+ae}),q=_("div",{"data-resize":"br",className:"window-resize-handle window-resize-conner window-resize-nw window-resize-br window-resize-br-h"+ae}),Y=_("div",{"data-resize":"bl",className:"window-resize-handle window-resize-conner window-resize-ne window-resize-bl window-resize-bl-v"+ae}),R=_("div",{"data-resize":"bl",className:"window-resize-handle window-resize-conner window-resize-ne window-resize-bl window-resize-bl-h"+ae}),X=_("div",{"data-resize":"tr",className:"window-resize-handle window-resize-conner window-resize-ne window-resize-tr window-resize-tr-v"+ae}),se=_("div",{"data-resize":"tr",className:"window-resize-handle window-resize-conner window-resize-ne window-resize-tr window-resize-tr-h"+ae})]),V.addEventListener("customdrop",K=>{m("customdrop",K.detail)},!1),typeof e.titlebarHeight=="number"&&e.titlebarHeight>0&&Z(e.titlebarHeight);function Z(K){V.style.setProperty("--titlebar-height",K+"px")}bi.addWindow(V);let de=!1;V.addEventListener("animationend",()=>{de||(m("ready"),de=!0),m("animationend")});let _e=new ResizeObserver(K=>{if(!o&&!u){if(i||h){const re=K[0].contentRect;M=re.top,I=re.left,y=re.width,T=re.height}l||m("passiveResize")}});_e.observe(V);let we;e.autoHideTitleBar&&(V.addEventListener("mouseover",J,!1),V.addEventListener("mouseout",te,!1),V.addEventListener("mousemove",le,!1)),V.addEventListener("mousedown",pe,!1);function J(){we&&clearTimeout(we),D.setAutoHide(!1),t&&D.setAutoHide(!0)}function le(){we&&clearTimeout(we),D.setAutoHide(!1),we=setTimeout(()=>{t&&D.setAutoHide(!0)},100)}function te(){we&&clearTimeout(we),t&&D.setAutoHide(!0)}function xe(K){t=K,D.setAutoHide(K)}function ce(K){at(C),st(C,K),ct()}function Pe(K,re){let Ie=[Ze(K,O,P,F,re),Ze(K,z,P,F,re),Ze(K,N,P,F,re),Ze(K,W,P,F,re),Ze(K,U,P,F,re),Ze(K,j,P,F,re),Ze(K,Y,P,F,re),Ze(K,R,P,F,re),Ze(K,$,P,F,re),Ze(K,q,P,F,re),Ze(K,X,P,F,re),Ze(K,se,P,F,re)];function Je(Pi){for(let kt=0;kt<Ie.length;kt++)Ie[kt].setAspectRatio(Pi)}function Ni(Pi){for(let kt=0;kt<Ie.length;kt++)Ie[kt].setKeepAspectRatio(Pi)}return{setAspectRatio:Je,setKeepAspectRatio:Ni}}function ve(){o=!1,w=Ct(),m("resizeend"),ds()}e.disableResize||(s=Pe(V,{onResizeStart:()=>m("resizestart"),onResize:K=>{o=!0,M=K.top,I=K.left,y=K.width,T=K.height,m("resize",{width:y,height:T})},onResizeEnd:ve})),document.addEventListener("mousedown",ie,!1);function ie(K){const re=K.target;V.contains(re)||ps()}function pe(){jt()}function fe(){li()}function Le(){m("minimize")}function ne(){m("maximize")}function ue(){V.offsetWidth,i||V.classList.remove("window-maximized"),m("restore")}function be(){At()}function ct(){Array.from(V.querySelectorAll("[drag-region=drag]")).forEach(re=>{re.oncontextmenu=An,re.ondblclick=Rn,$s(V,re,{onDragStart:()=>m("dragstart"),onDrag:Tn,onDragEnd:ds})})}ct();function ot(K,re){he[K]||(he[K]=!0,V.classList.add("max-z-index"),Object.keys(he).forEach(Ie=>{Ie!==K&&(he[Ie]=!1)}),ke=!1,re())}function Ln(K){ke||(ke=!0,V.classList.remove("max-z-index"),Object.keys(he).forEach(re=>{he[re]=!1}),K())}function Tn(K,re){M=re.top,I=re.left,hs(K),m("drag",K)}function hs(K){setTimeout(()=>{if(i||d){const re=Ct(),Ie=Math.round((K.x-re.left)/re.width*w.width),Je=K.x-Ie;let Ni=K.y-re.top;Qe({...w,top:i?0:K.y-Ni,left:Je}),d&&(d=!1,In()),i&&(i=!1,D.setMaximize(i),V.classList.remove("window-maximized"),m("unmaximize"))}},0),e.disableResize||(K.y<=0&&K.x<=Ke||K.x<=0&&K.y<=Ke?ot(Ee.topLeft,()=>{f=Ee.topLeft,$e.showShape(Ee.topLeft,w)}):K.y<=0&&K.x>=Ce.width-Ke||K.x>=Ce.width-1&&K.y<=Ke?ot(Ee.topRight,()=>{f=Ee.topRight,$e.showShape(Ee.topRight,w)}):K.y>=Ce.height-We&&K.x<=Ke||K.x<=0&&K.y>=Ce.height-We-Ke?ot(Ee.bottomLeft,()=>{f=Ee.bottomLeft,$e.showShape(Ee.bottomLeft,w)}):K.y>=Ce.height-We&&K.x>=Ce.width-Ke||K.x>=Ce.width-1&&K.y>=Ce.height-We-Ke?ot(Ee.bottomRight,()=>{f=Ee.bottomRight,$e.showShape(Ee.bottomRight,w)}):K.y<=0&&K.x>Ke&&K.x<Ce.width-Ke?ot(Ee.top,()=>{f=Ee.top,$e.showShape(Ee.top,w)}):K.x<=0&&K.y>Ke&&K.y<Ce.height-We-Ke?ot(Ee.left,()=>{f=Ee.left,$e.showShape(Ee.left,w)}):K.x>=Ce.width-1&&K.y>Ke&&K.y<Ce.height-We-Ke?ot(Ee.right,()=>{f=Ee.right,$e.showShape(Ee.right,w)}):Ln(()=>{f="",$e.removeShape()}))}function Dn(){V.classList.add("window-restore-down"),setTimeout(()=>{V.classList.remove("window-restore-down")},100),m("unmaximize")}function Mn(){V.offsetTop<0&&(V.style.top=0+"px"),window.innerHeight-V.offsetTop<We+Mt&&(V.style.top=window.innerHeight-(We+Mt)+"px"),V.offsetLeft+V.offsetWidth<30&&(V.style.left=-100+"px"),window.innerWidth-V.offsetLeft<30&&(V.style.left=window.innerWidth-100+"px")}function Rt(){V.classList.add("win-snap")}function In(){V.classList.remove("win-snap"),m("unSnap")}function ds(){us(),m("dragend",w)}function us(){if(!i&&!c.disableMaximize&&!c.disableResize){if(f!==""&&!e.disableMaximize){d=!0;let K=Math.floor(Ce.width/2),re=Ce.height-We,Ie=Math.floor(re/2),Je=re-Ie;K=Math.max(K,A),Ie=Math.max(Ie,H),f===Ee.top?At(!0):f===Ee.left?(Qe({top:0,left:0,width:K,height:re}),Rt()):f===Ee.right?(Qe({top:0,left:Ce.width-K,width:K,height:re}),Rt()):f===Ee.topLeft?(Qe({top:0,left:0,width:K,height:Ie}),Rt()):f===Ee.bottomLeft?(Qe({top:Ie,left:0,width:K,height:Je}),Rt()):f===Ee.bottomRight?(Qe({top:Ie,left:Ce.width-K,width:K,height:Je}),Rt()):f===Ee.topRight&&(Qe({top:0,left:Ce.width-K,width:K,height:Ie}),Rt()),m("snap")}else w=Ct(),Mn();for(let K in he)if(he[K]){$e.removeShape();break}}}function Ii(){f="",i=!0,e.disableMaximize||(Qe({top:0,left:0,width:window.innerWidth,height:window.innerHeight-We}),V.classList.add("window-maximized"),ne())}function Bn(){i=!1,e.disableMaximize||(Qe(w),V.classList.remove("window-maximized"),Dn())}function At(K){e.disableMaximize||(i=!i,i?(!K&&!d&&(w=Ct()),w.top<0&&(w.top=0),Ii()):Bn(),D.setMaximize(i),V.focus())}function Rn(){At()}function An(K){K.preventDefault(),jt(),Ut({top:K.y,left:K.x},K.currentTarget,ee(),!1,()=>{setTimeout(()=>{V&&!l&&jt()},10)},!1)}function Qe(K){G(K.top)&&(M=K.top,V.style.top=K.top+"px"),G(K.left)&&(I=K.left,V.style.left=K.left+"px"),G(K.width)&&(y=K.width,V.style.width=K.width+"px"),G(K.height)&&(T=K.height,V.style.height=K.height+"px"),e.disableResize||s.setAspectRatio(y/T)}function Ct(){const K=V.getBoundingClientRect();return{top:K.top,left:K.left,width:K.width,height:K.height}}function Nn(K){y=K.width,T=K.height,V.style.width=K.width+"px",V.style.height=K.height+"px",e.disableResize||s.setAspectRatio(y/T)}function fs(){V.style.zIndex=x.toString()}function Pn(){x-=1,fs()}function ms(){x=Cs,fs()}function Bi(){V.classList.remove("top-view")}function jt(){p||(V.focus(),V.classList.add("focus"),Bi(),Mo(b.name,E,b),Ot.setActiveWindow(b.name,E),p=!0),setTimeout(()=>{m("focus",p)},0)}function ps(){p=!1,V.classList.remove("focus"),Ot.removeActiveWindow(b.name,E),m("blur")}function gs(){V.classList.add("transparent"),n=!0}function vs(){V.classList.remove("transparent"),n=!1}function Hn(){n?vs():gs()}function On(){h=!h,h?(!i&&!d&&(w=Ct()),V.classList.add("fullscreen"),D.setVisible(!1)):(i||Qe(w),D.setVisible(!0),V.classList.remove("fullscreen")),Ao(),m("fullscreen",h)}function Fn(){return i}function _s(){u=!1,V.classList.remove("show"),V.removeEventListener("animationend",_s,!1)}function Ri(){V.classList.remove("minimized"),Bi(),l?(V.classList.add("window-restored"),V.style.transform="translate3d(0px,0px,0px)",setTimeout(()=>{ue(),V.classList.remove("window-restored"),V.style.removeProperty("transform")},300)):a||(u=!0,V.classList.add("show"),V.addEventListener("animationend",_s,!1)),a=!0,l=!1,ms(),i&&Ii()}function li(){Bi();const K=Ot.getAppItemBounds(e.name);V.classList.remove("window-restored"),V.classList.remove("show"),V.classList.remove("focus"),V.classList.add("minimized");const re=Ct();setTimeout(()=>{V.style.transform=`translate3d(${K.left-re.left}px, ${K.top}px, 0) scale(0.2)`},0),a=!1,p=!1,l=!0,e.name,Ot.removeActiveWindow(e.name,E),Le()}function zn(){a?li():Ri()}function Wn(){Ai()}function Ai(){_e.disconnect(),document.removeEventListener("mousedown",ie,!1),G(V)&&(V.className="window closing",m("close"),u=!0,V.addEventListener("animationend",()=>{u=!1,D.element.remove(),V.remove(),V=void 0,Do(e.name,E)}))}function $n(){return a}function Un(){return p}function jn(K){c.icon=K,D.setIcon(K)}function Vn(K){k=K,D.setTitle(K)}function Kn(){return k}function qn(K){V.style.top=K.top+"px",V.style.left=K.left+"px"}function Xn(){let K=Math.round((window.innerHeight-T-We)/2),re=Math.round((window.innerWidth-y)/2);qn({top:K,left:re})}function Gn(K){C.classList[K?"add":"remove"]("fluid")}return b={id:E,get icon(){return c.icon},get name(){return c.name},get productName(){return c.productName},get title(){return k},get isFullScreen(){return h},element:V,setContent:ce,show:Ri,hide:li,titlebar:D,setAutoHideTitleBar:xe,setIcon:jn,setTitle:Vn,getTitle:Kn,setMaximize:D.setMaximize,toggleMaximize:At,maximize:Ii,decrementZIndex:Pn,restoreZIndex:ms,focus:jt,blur:ps,makeTransparent:gs,removeTransparent:vs,toggleTransprent:Hn,toggleFullscreen:On,isMaximized:Fn,close:Ai,toggleShow:zn,isVisible:$n,isFocused:Un,getBounds:Ct,setBounds:Qe,setSize:Nn,makeCenter:Xn,addEventListener:r,executeListeners:m,removeListeners:g,updateDragHandle:ct,setTitlebarHeight:Z,checkWindowSnap:hs,setWindowSnap:us,setFluidContent:Gn},ye(e.content)&&ce(e.content(b)),To(e.name,E,b),Ri(),setTimeout(()=>{jt()},0),b}function cn(e){let c;const v=ir({maxValue:e.maxValue,color:"#00b521"}),b=lt({name:"explorer-transfer",title:"Copying...",icon:Q.explorer.icon,width:500,height:120,minHeight:100,center:!0,disableMaximize:!0,disableResize:!0,content:()=>_("div",{className:"p-20 w-full h-full"},[c=_("div",{style:{marginBottom:"10px"},innerHTML:e.description}),_("div",{className:"w-full"},v.element)])});function x(i){v.setValue(i)}function E(i){b.setTitle(i)}function C(i){c.innerHTML=i}function n(){b.close()}return{setTitle:E,setDescription:C,setValue:x,close:n}}function ns(e){let c,v,b,x=!0;function E(){const h={maxWidth:e.width+"px",maxHeight:e.height+"px",width:"100%",height:"100%"};if(G(e.parent)){const f=e.parent.getBoundingClientRect();h.top=Math.round((f.height-e.height)/2)+"px",h.left=Math.round((f.width-e.width)/2)+"px"}else h.top=Math.round((Ce.height-Mt)/2-Math.round(e.height/2))+"px",h.left=Ce.width/2-Math.round(e.width/2)+"px";c=_("div",{className:"dialog-content zoom-in focus relative flex flex-col",style:h},[_("div",{className:"dialog-titlebar flex"},[b=_("div",{className:"dialog-titlebar-text w-full flex items-center"},_("div",{className:"text-ellipsis line-clamp-1"},e.title)),_("div",{className:"dialog-titlebar-buttons flex-shrink-0 flex items-center",style:{marginLeft:"auto"}},[_("div",{title:"Close",className:"window-titlebar-button window-titlebar-close-button flex items-center content-center",innerHTML:Ks,onclick:l})])]),_("div",{className:"w-full flex-1"},e.content),e.hideButtons?null:_("div",{className:"dialog-footer flex"},[_("button",{className:"dialog-footer-button button",onclick(){ye(e.onOK)&&e.onOK(),a()}},"OK"),v=_("button",{className:"dialog-footer-button button",onclick:()=>{a()}},"Cancel")])]),st(G(e.parent)?e.parent:document.body,c),e.hideButtons||v.focus(),$s(c,b),document.addEventListener("mousedown",C,!1)}E();function C(h){const f=h.target;c.contains(f)?x||(x=!0,n()):i()}function n(){c.classList.add("focus")}function i(){x=!1,c.classList.remove("focus")}function l(){a()}function p(){c.remove()}function a(){c.classList.add("closing"),document.removeEventListener("mousedown",C,!1),x=!1,c.addEventListener("animationend",p,!1)}return{element:c,close:a}}function Ho(e){return ns({title:e.title,width:e.width||300,height:e.height||160,content:e.content,onOK:e.onOK})}function Ui(e){let c=e.getDate().toString();return e.getDate()<10&&(c="0"+c),`${Zi[e.getDay()]}, ${dr[e.getMonth()]} ${c}, ${e.getFullYear()}`}function It(e,c=!1){let v=e.getHours(),b=e.getMinutes(),x=e.getSeconds(),E=v>=12?"PM":"AM";return v=v%12,v=v||12,b=b<10?"0"+b:b,x=x<10?"0"+x:x,v+":"+b+(c?":"+x:"")+" "+E}function vt(){window.lastContextMenu&&window.lastContextMenu.close()}function Oo(e,c){const v=_("img");v.onload=()=>{const b=v.naturalWidth,x=v.naturalHeight,E=b/x;c({width:b,height:x,ratio:E})},v.onerror=()=>{c()},Xe(e)?v.mySrc=e:v.src=e}function Ti(e){switch(e){case".jpg":case".png":case".webp":case".jfif":case".jpeg":return!0;default:return!1}}function Fo(e){switch(e){case".mp3":case".aac":case".m4a":case".ogg":case".flac":case".wav":return!0;default:return!1}}function Di(e){switch(e){case".mp4":case".mkv":case".webm":case".ogv":return!0;default:return!1}}function rs(e,c,v=200){const b=document.createElement("canvas"),x=b.getContext("2d"),E=new Image,C=v;E.height=C,E.src=e,E.onload=()=>{const n=E.naturalWidth/E.naturalHeight,i=Math.round(C*n);b.width=i,b.height=C,x.drawImage(E,0,0,i,C);const l=b.toDataURL("image/png");fetch(l).then(p=>p.blob()).then(p=>{const a=URL.createObjectURL(p);c(a,p,l,n)})}}function zo(e,c,v=200){let b=_("video");b.onloadedmetadata=function(){b.currentTime=b.duration*.2},b.onseeked=()=>{const x=b.videoWidth,E=b.videoHeight,C=E>0&&x>0?x/E:16/9,n=Math.round(v*C),i=document.createElement("canvas");i.width=n,i.height=v,i.getContext("2d").drawImage(b,0,0,n,v);const p=i.toDataURL("image/jpeg");fetch(p).then(a=>a.blob()).then(a=>{const h=URL.createObjectURL(a);c(h,a,p,C)}),b=void 0},b.onerror=()=>{c(null,null,null,null),b=void 0},b.src=e}function os(e,c=!0){document.documentElement.classList[e?"add":"remove"]("dark"),c&&pt({dark:e}),Me(oe.themeChange,e)}function as(e,c=!0){document.documentElement.classList[e?"add":"remove"]("glass"),c&&pt({transparency:e}),Me(oe.transparentChange,e)}function G(e){return e!=null}function ji(e){return typeof e=="number"}function ye(e){return typeof e=="function"}function Vi(e,c){switch(e.style.backgroundColor="var(--theme-background)",e.style.backgroundRepeat="no-repeat",e.style.backgroundPosition="center",c){case"fill":e.style.backgroundSize="cover";break;case"fit":e.style.backgroundSize="contain";break;case"stretch":e.style.backgroundSize="100% 100%";break;case"center":e.style.backgroundSize="cover";break;case"tile":e.style.backgroundSize="contain",e.style.backgroundRepeat="repeat";break;case"span":e.style.backgroundSize="cover",e.style.backgroundPosition="left top";break;default:e.style.backgroundSize="cover";break}}function Ki(e){document.documentElement.classList.toggle("no-border-radius",!e),document.documentElement.classList.toggle("rounded-corner",e)}function Ft(e,c){document.documentElement.classList.toggle(e,c)}function hn(e){document.documentElement.classList.toggle("use-border",e)}function mi(e,c){e.addEventListener("mousedown",i,!1);let v,b,x=0,E=0,C={x:0,y:0},n=!1;function i(a){a.button===0&&(document.addEventListener("mousemove",l,!1),document.addEventListener("mouseup",p,!1),C.x=a.x,C.y=a.y)}function l(a){if(document.documentElement.style.cursor=a.ctrlKey?"copy":"default",(Math.abs(a.x-C.x)>1||Math.abs(a.y-C.y)>1)&&!n){n=!0;const f=e.getBoundingClientRect();x=a.x-f.left,E=a.y-f.top,v=e.cloneNode(!0),v.classList.add("drag-item"),ge(v,{width:f.width+"px",height:f.height+"px"}),document.body.appendChild(v),e.dispatchEvent(new CustomEvent("customdragstart",{bubbles:!0,detail:c}))}G(v)&&ge(v,{top:a.y-E+"px",left:a.x-x+"px"});const h=document.elementFromPoint(a.x,a.y);h instanceof Element&&(b!==h?(b=h,b.dispatchEvent(new CustomEvent("customdragover",{bubbles:!0,detail:c}))):b.dispatchEvent(new CustomEvent("customdrag",{bubbles:!0,detail:c})))}function p(a){document.documentElement.style.cursor="default",n&&(b.dispatchEvent(new CustomEvent("customdrop",{bubbles:!0,detail:c})),document.body.removeChild(v),n=!1),document.removeEventListener("mousemove",l,!1),document.removeEventListener("mouseup",p,!1)}}function ci(e,c){c.parentNode.insertBefore(e,c.nextSibling)}function dn(e,c=!0){document.documentElement.style.setProperty("--accent-color",`hsl(${e.h}, ${e.s}%, ${e.l}%)`),document.documentElement.style.setProperty("--accent-color-value",e.h.toString()),c&&pt({accentColor:e})}function Xe(e){let v=/[a-z]:[\\/](?:[^\\/:*?"<>|\r\n]+[\\/])*[^\\/:*?"<>|\r\n]*/.exec(e);return G(v)&&v[0]===v.input}function St(e){const v=/^[a-zA-Z]:[\\/]?/.exec(e);return G(v)&&v[0]===v.input}function Kt(e){const v=/(?:[\\/]?[^\\/:*?"<>|\r\n]+[\\/]?)*/.exec(e);return G(v)&&v[0]===v.input}function ks(e,c){return e.reduce((v,b)=>((v[c(b)]=v[c(b)]||[]).push(b),v),{})}function Wo(e,c){var v=5,b={r:0,g:0,b:0},x=document.createElement("canvas"),E=x.getContext("2d"),C,n,i=-4,l,p={r:0,g:0,b:0},a=0;const h=new Image;h.height=200,h.src=e,h.onload=()=>{const f=h.naturalWidth/h.naturalHeight;n=Math.round(200*f),E.drawImage(h,0,0,n,200);try{C=E.getImageData(0,0,n,200)}catch{c(b)}for(l=C.data.length;(i+=v*4)<l;)++a,p.r+=C.data[i],p.g+=C.data[i+1],p.b+=C.data[i+2];p.r=Math.floor(p.r/a),p.g=Math.floor(p.g/a),p.b=Math.floor(p.b/a),E.clearRect(0,0,n,200),c(p)}}function $o({r:e,g:c,b:v}){return e*.299+c*.587+v*.114>140?"#000":"#fff"}function Es(e){Wo(e,c=>{const v=$o(c);document.documentElement.style.setProperty("--contrast-text-color",v)})}function un(e){Xe(e)?ls(e,(c,v)=>{if(!c)try{const b=URL.createObjectURL(v);Es(b)}catch{}}):Es(e)}function fn(e){Ft("use-titlebar-accent-color",e.useTitleBarAccentColor),Ft("use-startmenu-and-taskbar-accent-color",e.useTaskbarAndStartMenuAccentColor),Ft("use-window-border-accent-color",e.useWindowBorderAccentColor),dn(e.accentColor,!1),os(e.dark,!1),as(e.transparency,!1),$e.setBackgroundImage(e.background,!1),$e.setBackgroundStyle(e.backgroundImageStyle)}function pt(e){let{themes:c,themeIndex:v,customTheme:b}=Se.getState(["themes","themeIndex","customTheme"]);v>-1?b={...c[v],...e}:b={...b,...e},Se.setState({customTheme:b,themeIndex:-1}),Me(oe.customThemeChange)}function Uo(e){const c=Se.getState("recentImages").recentImages;if(G(c)){const v=c.find(b=>b.path===e.path);v?(c.splice(c.indexOf(v),1),c.unshift(e),Se.setState({recentImages:c})):(c.pop(),c.unshift(e)),Se.setState({recentImages:c})}}function hi(){window.location.reload()}function jo(){Ho({title:"Reset This PC",text:"Reset",content:_("div",{},[_("div",{style:{paddingInline:"10px",fontWeight:"bold"}},"Reseting will:"),_("ul",{},[_("li",null,"Change settings back to their defaults"),_("li",null,"Remove personal files")])]),onOK(){Se.reset();const e=indexedDB.deleteDatabase("Local Disk C");e.onsuccess=()=>{hi()},e.onerror=()=>{hi()},e.onblocked=()=>{hi()},e.onupgradeneeded=()=>{hi()}}})}function Vo(e){Fe("cmd",e)}function Yt(e,c=0,v,b,x=[],E){const C=e.length-1,n=e[c];if(E=E||"",c>C){b(x);return}if(n.isFile)n.file(i=>{x.push({type:"file",path:v+E+"/"+i.name,file:i}),Yt(e,c+1,v,b,x,E)});else if(n.isDirectory){let i=function(){p.readEntries(function(h){h.length>0?(a=a.concat(h),i()):a.length===0?Yt(e,c+1,v,b,x,E):Yt(a,0,v,f=>{const d=f.length;for(let u=0;u<d;u++)x.push(f[u]);Yt(e,c+1,v,b,x,E)},[],l)})},l=E;l+="/"+n.name,x.push({type:"dir",path:v+l});let p=n.createReader(),a=[];i()}}function pi(e,c){const v=Array.from(c).map(b=>b.webkitGetAsEntry());Yt(v,0,e,b=>{const x=b.length;let E=0;for(let l=0;l<x;l++)b[l].type==="file"&&(E+=b[l].file.size);let C=0;const n=cn({maxValue:E,title:"Copying...",description:`Copying ${v.length} items from <span style="color: var(--blue-color)">Local machine</span> to <span style="color: var(--blue-color)">${rt(e)}</span>`});function i(l=0){if(l>=x){setTimeout(()=>{n.close()},1e3);return}const p=b[l];p.type==="file"?(C+=p.file.size,me.writeFile(p.path,p.file,a=>{a&&console.log(a),n.setValue(C),i(l+1)})):p.type==="dir"&&me.createFolder(p.path,a=>{i(l+1)})}i()})}function Ko(e,c){v((b,x)=>{if(!b){let E=function(p=0){if(p>=C){setTimeout(()=>{l.close()},1e3);return}const a=x[p];me.unlink(a.location,h=>{h&&console.log(h),a.type==="file"&&(i+=a.size,l.setValue(i)),E(p+1)})};const C=x.length;let n=0;for(let p=0;p<C;p++)x[p].type==="file"&&(n+=x[p].size);if(n<10485760&&C<10){e.forEach(p=>{me.unlink(p.location,a=>{a&&console.log(a)})});return}let i=0;const l=cn({maxValue:n,title:"Removing...",description:`Removing ${C} items from <span style="color: var(--blue-color)">${rt(c)}</span>`});E()}});function v(b){let x=0,E=[];C();function C(){if(x===e.length){const i=E.concat(e);b(null,i);return}const n=e[x];n.type==="folder"?me.readFolderRecursive(n.location,(i,l)=>{if(i){b(i);return}const p=l.map(a=>{const h={type:a.type,location:a.location};return a.type==="file"&&(h.size=a.size),h}).toReversed();E=E.concat(p),x++,C()}):(x++,C())}}}function qo(e){Bt({width:300,height:400,className:"openWith-popup"},_("div",{className:"w-full h-full p-20"},"How do you want to open this file?")).show()}function Ls(e,c){return Math.floor(Math.random()*(c-e+1)+e)}function Mi(e=8){for(var c="",v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",b=0;b<e;b++)c+=v.charAt(Math.floor(Math.random()*v.length));return c}const Xo=/webkit/.test(navigator.userAgent.toLowerCase()),Hi=()=>[/Android/i,/webOS/i,/iPhone/i,/iPad/i].some(c=>navigator.userAgent.match(c));function Go(e){return e.lastIndexOf(".")>-1?e.substring(e.lastIndexOf("."),e.length):null}function qi(e,c){Xe(e)?me.readFile(e,(v,b)=>{v?c(v):G(b)?b.text().then(x=>{c(null,x)}):c(new Error("File not exists"))}):fetch(e).then(v=>v.text()).then(v=>c(null,v)).catch(v=>c(v))}function rt(e){return e.substring(e.lastIndexOf("/")+1,e.length)}function gt(e){const c=e.lastIndexOf(".");return c>-1?e.substring(c,e.length):""}function ls(e,c){const v=indexedDB.open("Local Disk C");v.onsuccess=()=>{const E=v.result.transaction("files","readwrite").objectStore("files").get(e);E.onsuccess=()=>{G(E.result)?c(null,E.result):c(new Error("Item has removed!"))},E.onerror=()=>{c(new Error("Invalid path"))}},v.onerror=()=>{c(new Error("Can not access"))}}function Yo(e,c){let v;return function b(){const x=b,E=arguments;clearTimeout(v),v=setTimeout(()=>e.apply(x,E),c)}}function Ge(e,c=100){let v,b;return function x(){const E=x,C=arguments;b?(clearTimeout(v),v=setTimeout(function(){Date.now()-b>=c&&(e.apply(E,C),b=Date.now())},c-(Date.now()-b))):(e.apply(E,C),b=Date.now())}}function zt(e,c){let v,b,x,E,C=c.limit||100,n=c.debounceDelay||200;return function i(){const l=i,p=arguments;ye(c.onFrame)&&(cancelAnimationFrame(E),E=requestAnimationFrame(()=>{c.onFrame.apply(l,p)})),ye(c.onDebounce)&&(clearTimeout(x),x=setTimeout(()=>{c.onDebounce.apply(l,p)},n)),ye(c.onFunction)&&c.onFunction.apply(l,p),b?(clearTimeout(v),v=setTimeout(function(){Date.now()-b>=C&&(e.apply(l,p),b=Date.now())},C-(Date.now()-b))):(e.apply(l,p),b=Date.now())}}function Jt(e,c=0){return Number(Math.round(parseFloat(e+"e"+c))+"e-"+c)}function mn(e,c){if(typeof e=="object")for(let v in c)typeof e[v]!=typeof c[v]?e[v]=c[v]:typeof e[v]=="object"&&mn(e[v],c[v]);return e}function Zt(e){return e>=1099511627776?{value:Jt(e/1099511627776,1),unit:"TB"}:e>=1073741824?{value:Jt(e/1073741824,1),unit:"GB"}:e>=1048576?{value:Jt(e/1048576,1),unit:"MB"}:e>=1024?{value:Jt(e/1024),unit:"KB"}:e>0?{value:1,unit:"KB"}:{value:0,unit:"B"}}const Ts=new Date(2023,0,1).getTime(),Pt={type:"mediumIcons",sortBy:"text",orderBy:"asc"};function De(e){const c={...e,name:e.name,type:e.type||"folder",children:e.children||[],cdate:Ts,mdate:Ts};return G(e.text)&&(c.text=e.text),G(e.type)&&(e.type==="file"||e.type==="shortcut")&&(c.size=0),G(e.icon)&&(c.icon=e.icon),c}const{USER_NAME:Jo,USER_HOME:qt}=nt.getState(["USER_NAME","USER_HOME"]),pn=De({name:"c:",text:"Local Disk C",icon:"imgs/icons/Drives/Hardrive%20Windows.png",children:[De({name:"windows",children:[De({name:"system32",children:[]}),De({name:"Program Data",children:[De({name:"Explorer",children:[]})]})]}),De({name:"Code",children:[De({name:"App1"}),De({name:"App2"}),De({name:"App3"}),De({name:"App4"})],view:{type:"mediumIcons",sortBy:"text",orderBy:"asc"}}),De({name:"Users",children:[De({name:Jo,icon:Ae.user,children:[De({name:"Desktop",icon:Ae.desktop}),De({name:"Documents",icon:Ae.document,children:[De({name:"Google"}),De({name:"Microsoft"})]}),De({name:"Downloads",icon:Ae.download}),De({name:"Pictures",icon:Ae.pictures,children:[De({name:"Natures",view:Pt}),De({name:"Screenshots",view:Pt}),De({name:"Art",view:Pt}),De({name:"Abstract",view:Pt}),De({name:"Wallpapers",view:Pt})],view:Pt}),De({name:"Music",icon:Ae.music}),De({name:"Videos",icon:Ae.videos})]})]})]});function Zo(e){const c=e.transaction("tree","readwrite").objectStore("tree");let v=[];function b(x,E="",C=0){const n=x[C];let i=E===""?n.name:E+"/"+n.name;if(n.type==="folder"){const l={...n},p=n.children.map(a=>{const h={...a};return delete h.children,h});l.children=p,v.push({location:i,data:l})}n.children.length&&b(n.children,i),C<x.length-1&&b(x,E,C+1)}b([pn]);for(let x of v)c.put(x.data,x.location)}window.createDefaultFolderTree=Zo;function Qo(){let e,c,v,b={};const x=indexedDB.open("Local Disk C");let E=pn,C,n,i=!1,l=!1,p=0,a=0;x.onupgradeneeded=function(){e=x.result,e.createObjectStore("tree").put(E,"c"),e.createObjectStore("files",{autoIncrement:!0});const I=indexedDB.open("Local Disk C");I.onsuccess=()=>{e=I.result;for(let y=1;y<=5;y++)fetch(`imgs/Pictures/IMG ${y}.jpg`).then(T=>T.blob()).then(T=>{o(`${qt}/Pictures/Wallpapers/IMG ${y}.jpg`,T)});fetch("videos/VID 1.mp4").then(y=>y.blob()).then(y=>{o(`${qt}/Videos/VID 1.mp4`,y),o(`${qt}/Desktop/VID 1.mp4`,y)}),fetch("videos/VID 2.mp4").then(y=>y.blob()).then(y=>{o(`${qt}/Videos/VID 2.mp4`,y),o(`${qt}/Desktop/VID 2.mp4`,y)}),setTimeout(()=>{w("ready",e)},1e3)}},x.onsuccess=function(){e=x.result,window.db=e,h(),f();const I=c.get("c");I.onsuccess=function(){I.result&&(E=I.result)},w("ready",e)},x.onerror=function(I){w("error",I)};function h(){c=e.transaction("tree","readwrite").objectStore("tree")}function f(){v=e.transaction("files","readwrite").objectStore("files")}function d(I,y,T){const A=I.replace(/\\+/g,"/");h(),f();const H=A.split("/").filter(N=>N!=="");if(H.length===1){T(new Error("Invalid Path"));return}const P=Date.now(),F=H.length-1;let L=1,B=E;O();function O(){let N=B.children.findIndex(W=>W.name===H[L]),z;if(N===-1){const W=B.children.push({name:H[L],type:y.type,children:[],cdate:P,mdate:P})-1;if(z=B.children[W],L<F&&(z.type="folder"),L===F){c.put(E,"c"),y.type==="file"||y.type==="shortcut"?(z.type,y.type,delete z.children,v.put(null,A)):z.type,T(),w("added",A);return}else B=z,L+=1,O()}else if(z=B.children[N],L===F){T(new Error(y.type+" already exists"));return}else z.type==="folder"&&!G(z.children)&&(z.children=[]),B=z,L+=1,O()}}function u(I,y){d(I,{type:"folder"},y)}function t(I,y){const T=I.replace(/\\+/g,"/");h();const A=c.get("c");A.onsuccess=()=>{let H=A.result;const P=T.split("/").filter(F=>F!=="");if(P.length===0)y(new Error("Invalid path"));else if(P.length===1){if(St(P[0])){const F=H.children.map(L=>(delete L.children,L));y(null,F);return}y(new Error("Invalid path"))}else{P.shift();let F;for(let B of P){const O=H.children.findIndex(N=>N.name===B);if(O>-1)H=H.children[O];else{F=new Error("Path is no longer exists");break}}if(H.type!=="folder"&&(F=new Error("Path is no longer exists")),F){y(F);return}const L=H.children.map(B=>(delete B.children,B));y(null,L)}}}function s(I,y){const T=I.replace(/\\+/g,"/").replace(/\/+/g,"/");f();const A=v.get(T);A.onsuccess=()=>{y(null,A.result)},A.onerror=()=>{y(A.error)}}function o(I,y,T){const A=I.replace(/\\+/g,"/"),H=A.split("/").filter(z=>z!=="");if(H.length===1){ye(T)&&T(new Error("Invalid Path"));return}const P=H.length-1;let F=1,L=E;const B=Date.now();O();function O(){let z=L.children.findIndex(U=>U.name===H[F]),W;if(z===-1){const U=L.children.push({name:H[F],type:"folder",children:[],cdate:B,mdate:B})-1;if(W=L.children[U],F===P){W.type="file",delete W.children,W.size=y.size,f();const j=new File([y],rt(A)),Y=v.put(j,A);Y.onsuccess=()=>{ye(T)&&T(),N(),w("added",A)},Y.onerror=()=>{T(Y.error)};return}else L=W,F+=1,O()}else if(W=L.children[z],F===P){delete W.children,W.type="file",W.size=y.size,W.mdate=Date.now(),f();const U=v.put(y,A);U.onsuccess=()=>{ye(T)&&T(),N(),w("modified",A)},U.onerror=()=>{T(U.error)};return}else L=W,F+=1,O()}function N(){p+=1,i||(i=!0,h(),c.put(E,"c")),C&&clearTimeout(C),C=setTimeout(()=>{if(p>1){h();const z=c.put(E,"c");z.onerror=()=>{T(z.error)}}p=0,i=!1},200)}}function r(I,y){const T=I.replace(/\\+/g,"/");h();const A=c.get("c");A.onsuccess=()=>{let H=A.result,P;const F=T.split("/").filter(B=>B!=="");if(F.length===0){y(new Error("Invalid path",{cause:1}));return}if(F.length===1){const B=F[0],O=B.split(":")[0];St(B)&&O==="c"?(delete H.children,y(null,H)):y(new Error("Invalid path",{cause:1}));return}F.shift();let L;for(let B of F){const O=H.children.findIndex(N=>N.name===B);if(O>-1)P=H.children[O],H=P;else{L=new Error("Path is no longer exists",{cause:2});break}}G(P)&&delete P.children,y(L,P)},A.onerror=()=>{y(new Error("Unknown error",{cause:0}))}}function m(I,y){const T=I.replace(/\\+/g,"/"),A=T.split("/").filter(B=>B!=="");if(A.length===1){y(new Error("Invalid Path"));return}const H=A.length-1;let P=1,F=E;L();function L(){const B=F.children.findIndex(N=>N.name===A[P]);if(B===-1){y(new Error("Item not exsist"));return}else if(P===H){const N=F.children[B];if(N.type==="file"||N.type==="shortcut"){F.children.splice(B,1),f();const z=v.delete(T);z.onsuccess=()=>{y(),O(),w("removed",T)},z.onerror=()=>y(z.error)}else N.type==="folder"?g(T,(z,W)=>{if(G(z))y(z);else{const U=W.filter(R=>R.type==="file"),j=U.length;f();for(let R=0;R<j;R++){const $=U[R];v.delete($.location),w("removed",$.location)}const Y=F.children.findIndex(R=>R.name===N.name);Y>-1?(F.children.splice(Y,1),O(),y(),w("removed",T)):y(new Error("Invalid Path"))}}):y(new Error("Unknown error"))}else F=F.children[B],P+=1,L();function O(){a+=1,l||(l=!0,h(),c.put(E,"c")),n&&clearTimeout(n),n=setTimeout(()=>{if(a>1){h();const N=c.put(E,"c");N.onerror=()=>{y(N.error)}}a=0,l=!1},200)}}}function g(I,y,T=[]){t(I,(A,H)=>{if(A)return y(A,T);let P=0;(function F(){var L=H[P++];if(!L)return y(null,T);let B=I+"/"+L.name;L.location=B,T.push(L),L.type==="folder"?g(B,(O,N)=>{if(A)return y(A,T);T=T.concat(N),F()}):F()})()})}function k(I,y,T){const A=I.replace(/\\+/g,"/");h();const H=A.split("/").filter(O=>O!=="");if(H.length===1){St(H[0])?(E.view=y,c.put(E,"c"),ye(T)&&T()):ye(T)&&T(new Error("InValid Path"));return}const P=H.length-1;let F=1,L=E;B();function B(){let O=L.children.findIndex(z=>z.name===H[F]),N;if(O>-1)if(N=L.children[O],F===P){N.view=y,c.put(E,"c"),ye(T)&&T();return}else L=N,F+=1,B()}}function D(I,y,T){b[I]||(b[I]=Object.create(null)),b[I][y]=T}function w(I,y){if(!(typeof b[I]>"u"))for(let T in b[I])b[I][T](y)}function S(I,y){delete b[I][y]}function M(){return E}return{addEventListener:D,removeListeners:S,createItem:d,createFolder:u,readFolder:t,readFolderRecursive:g,readFile:s,writeFile:o,unlink:m,stats:r,check:M,setView:k}}const me=Qo();function ea(){const c="c:/Program Data/Explorer/"+"thumbnails";let v=[],b=0;const x=[];me.addEventListener("ready","explorer-thumbnails",()=>{E()});function E(){qi(c,(f,d)=>{if(f)n();else try{v=JSON.parse(d)}catch(u){console.error(u)}})}let C;function n(){C&&clearTimeout(C),C=setTimeout(()=>{me.writeFile(c,new Blob([JSON.stringify(v)],{type:"text/plain"}))},1e3)}function i(){const f=x.shift();G(f)&&l(f.location,f.fileExt,f.cb)}function l(f,d,u){b+=1,b<3&&i(),me.readFile(f,(t,s)=>{if(t||!G(s)){u("");return}const o=URL.createObjectURL(s);Ti(d)&&rs(o,(r,m,g,k)=>{u(r,k),v.push({location:f,data:g,ratio:k}),n(),b-=1,i()},160),Di(d)&&zo(o,(r,m,g,k)=>{u(r,k),v.push({location:f,data:g,ratio:k}),n(),b-=1,i()},160)})}function p(f,d,u){const t=v.find(s=>s.location===f);if(G(t))fetch(t.data).then(s=>s.blob()).then(s=>{const o=URL.createObjectURL(s);u(o,t.ratio)});else{if(b>2){const s=x.findIndex(o=>o.location===f);if(s===-1)x.push({location:f,fileExt:d,cb:u});else{const o=x[s];o.cb=u}return}l(f,d,u)}}let a;function h(f){const d=v.findIndex(u=>u.location===f);d>-1&&(v.splice(d,1),a&&clearTimeout(a),a=setTimeout(()=>{n()},100))}return{getThumbnail:p,removeThumbnail:h}}const ri=ea();function et(e){return`imgs/icons/${encodeURIComponent(e)}`}const je={blank:et("Blank.png"),image:et("Pictures file.png"),videos:et("Videos file.png"),audio:et("Audio file.png")},ta={"":{icon:je.blank,appName:"",description:"File"},".jpg":{icon:je.image,appName:"photoViewer",description:"Picture file"},".png":{icon:je.image,appName:"photoViewer",description:"Picture file"},".jfif":{icon:je.image,appName:"photoViewer",description:"Picture file"},".webp":{icon:je.image,appName:"photoViewer",description:"Picture file"},".jpeg":{icon:je.image,appName:"photoViewer",description:"Picture file"},".mp3":{icon:je.audio,appName:"mediaPlayer",description:"Audio file"},".aac":{icon:je.audio,appName:"mediaPlayer",description:"Audio file"},".ogg":{icon:je.audio,appName:"mediaPlayer",description:"Audio file"},".m4a":{icon:je.audio,appName:"mediaPlayer",description:"Audio file"},".flac":{icon:je.audio,appName:"mediaPlayer",description:"Audio file"},".wav":{icon:je.audio,appName:"mediaPlayer",description:"Audio file"},".mp4":{icon:je.videos,appName:"mediaPlayer",description:"Video file"},".mkv":{icon:je.videos,appName:"mediaPlayer",description:"Video file"},".webm":{icon:je.videos,appName:"mediaPlayer",description:"Video file"},".txt":{icon:et("Notes.png"),appName:"notepad",description:"Text Document File"},".exe":{icon:et("Notes.png"),appName:"",description:"Application"},".html":{icon:et("Notes.png"),appName:"notepad",description:"HTML Document"},".js":{icon:et("Notes.png"),appName:"notepad",description:"Javascript Source File"},".json":{icon:et("Notes.png"),appName:"notepad",description:"JSON File"},".css":{icon:et("Notes.png"),appName:"notepad",description:"CSS Source File"},".md":{icon:et("Notes.png"),appName:"notepad",description:"Markdown File"}},Wt=e=>{let c=ta[e];return G(c)||(c={appName:"",description:e.substring(1,e.length).toUpperCase()+" file",icon:je.blank,iconType:"image"}),c};function ia(e){const{showDesktopIcons:c}=Se.getState("showDesktopIcons");return[{text:"View",children:[{text:"Large Icons",value:"large-icons"},{text:"Medium Icons",value:"medium-icons",checked:!0},{text:"Small Icons",value:"small-icons"},{divider:!0},{text:"Auto arrange icons"},{text:"Align icons to grid",checked:!0},{divider:!0},{text:"Show desktop icons",checked:c,onClick:e.onShowDesktopIconsClick}]},{text:"Sort by",children:[{text:"Name"},{text:"Size"},{text:"Item type"},{text:"Date Modified"}]},{text:"Refresh"},{divider:!0},{text:"Paste",disabled:!0},{text:"Paste shortcut",disabled:!0},{text:"Open command window here",icon:"imgs/icons/Apps/terminal.png",iconType:"image",onClick(){Vo(nt.getState("USER_HOME").USER_HOME+"/Desktop")}},{divider:!0},{text:"New",children:[{text:"Folder",icon:"imgs/icons/Folder.png",iconType:"image"},{text:"Shortcut",iconType:"image",icon:"imgs/icons/Emblems/1010.png"},{divider:!0},{text:"Bitmap Image"},{text:"Rich Text Document"},{text:"Text Document",icon:"imgs/icons/Notes.png",iconType:"image",onClick:()=>{Fe(Q.notepad.name)}}],emphasis:!0},{divider:!0},{icon:"imgs/icons/Desktop.png",iconType:"image",text:"Display settings",onClick:()=>{si({...Q.settings,type:"app",args:"system/display"})}},{icon:"imgs/icons/Personalization.png",iconType:"image",text:"Personalize",onClick:()=>{si({...Q.settings,type:"app",args:"personalization"})}}]}const Et=nt.getState("USER_HOME").USER_HOME+"/Desktop";function sa(){let e=[],c=[],v=!1;const b=[{icon:"imgs/icons/Trash Empty.png",name:"explorer",productName:"Recycle Bin",args:"Recycle Bin",type:"app"},{...Q.settings,type:"app"},{...Q.notepad,type:"app"},{...Q.explorer,type:"app"},{...Q.photos,type:"app"},{...Q.github,type:"link",args:"https://github.com/chrishtu/windows11"}];function x(s){d(),si(s)}const E=_("div",{className:"desktop-app-items absolute top flex flex-col flex-wrap"});C();function C(){for(let s of b)E.appendChild(a(s))}function n(){at(E),C(),me.readFolder(Et,(s,o)=>{s||o.forEach(r=>{const m={type:r.type,args:Et+"/"+r.name,name:r.name,productName:r.name,icon:r.icon||(r.type==="folder"?mt:null),iconType:"image"},g=a(m);E.appendChild(g)})})}function i(s){return s.substring(Et.length+1,s.length).split("/")}me.addEventListener("ready","desktop",()=>{n()});function l(){v&&(n(),v=!1)}me.addEventListener("added","desktop",zt(()=>{l()},{limit:1e3,onFunction(s){s.includes(Et)&&i(s).length===1&&(v||(v=!0))}})),me.addEventListener("modified","desktop",zt(()=>{l()},{limit:1e3,onFunction(s){s.includes(Et)&&i(s).length===1&&(v||(v=!0))}})),me.addEventListener("removed","desktop",zt(()=>{l()},{limit:1e3,onFunction(s){s.includes(Et)&&i(s).length===1&&(v||(v=!0))}}));function p(s){let o=_("div",{className:"app-association"}),r=_("div",{className:"pannel-item-icon-bg"},o);const m=_("div",{className:"desktop-app-item-icon flex items-center content-center",style:{backgroundImage:`url(${s.icon})`}},r);function g(k,D){const w=D||1;m.style.backgroundImage="none",r.style.aspectRatio=w.toString(),w>=1?r.style.width="100%":r.style.height="100%",r.style.backgroundImage=`url(${k})`,o.style.backgroundImage=`url(${yt.mediaPlayer.icon})`}if(s.icon&&(s.iconType==="svg"?m.innerHTML=s.icon:m.style.backgroundImage=`url("${s.icon}")`),s.type==="file"){const k=gt(s.args),D=Wt(k);D.icon?D.iconType==="svg"?m.innerHTML=D.icon:m.style.backgroundImage=`url("${D.icon}")`:m.style.backgroundImage='url("imgs/icons/Blank.png")',Xe(s.args)&&(Ti(k)||Di(k))&&ri.getThumbnail(s.args,k,g)}return m}function a(s){let o=s.productName;s.type==="file"&&(o=rt(s.args));const r=_("div",{className:"desktop-app-item",ondblclick:x.bind(null,s),onclick:m=>{const g=m.currentTarget;m.shiftKey||d(),g.classList.add("desktop-app-item-selected"),e.push(g)}},[_("div",{className:"flex items-center content-center",style:{padding:"3px 0"}},p(s)),_("div",{title:o,className:"desktop-app-item-label"},_("div",{className:"text-ellipsis line-clamp-2"},o))]);return mi(r,s),r}function h(s,o=!1){Array.from(E.children).forEach(m=>{const g=m.getBoundingClientRect();g.left+g.width<s.x1||g.left>s.x2||g.top+g.height<s.y1||g.top>s.y2?o||m.classList.remove("desktop-app-item-selected"):m.classList.add("desktop-app-item-selected")})}function f(){const s=Array.from(E.children);return e=s.filter(o=>o.classList.contains("desktop-app-item-selected")),c=s.filter(o=>!o.classList.contains("desktop-app-item-selected")),{items:s,selectedItems:e,notSelectedItems:c}}function d(){e.forEach(s=>{s.classList.remove("desktop-app-item-selected")}),e=[]}function u(s){E.classList.toggle("hidden",!s)}function t(){const{showDesktopIcons:s}=Se.getState("showDesktopIcons");u(!s),Se.setState({showDesktopIcons:!s})}return{element:E,selectItems:h,getItems:f,removeSelection:d,setShowDesktopIcons:u,toggleDesktopIcons:t}}function na(){const{backgroundImageStyle:e,showDesktopIcons:c}=Se.getState(["backgroundImageStyle","showDesktopIcons"]),v=sa();function b(r){r.preventDefault(),Ut({top:r.y,left:r.x},r.currentTarget,ia({onShowDesktopIconsClick:v.toggleDesktopIcons}),!1,null,!1,"desktop-context-menu")}function x(r){r.preventDefault(),pi(Et,r.dataTransfer.items)}let E=_("div",{className:"desktop-shape-presentation"}),C=_("div",{className:"desktop-selection-presentation"}),n=_("div",{className:"desktop fade-in",ondrop:x},[_("div",{className:"desktop-selection-handler",onmousedown:p,oncontextmenu:b}),C]),i=!1,l=null;function p(r){Se.getState("showDesktopIcons").showDesktopIcons&&(r.shiftKey||v.removeSelection(),r.button===0&&(i=!0,l={x:r.x,y:r.y},document.onmousemove=a,document.onmouseup=h))}function a(r){if(!i||Math.abs(r.x-l.x)<2&&Math.abs(r.y-l.y)<2)return;let m=0,g=0,k=0,D=0;r.x>l.x?(g=l.x,k=r.x-l.x):(g=r.x,k=l.x-r.x),r.y>l.y?(m=l.y,D=r.y-l.y):(m=r.y,D=l.y-r.y),ge(C,{visibility:"visible",top:m+"px",left:g+"px",width:k+"px",height:D+"px"}),v.selectItems({x1:g,x2:g+k,y1:m,y2:m+D},r.shiftKey)}function h(){i=!1,ge(C,{visibility:"hidden",width:"0px",height:"0px"}),v.getItems()}let f,d=!1;o(e),st(document.body,n),st(document.body,E),setTimeout(()=>{st(n,v.element),v.setShowDesktopIcons(c)},500);function u(r,m=!0){n.style.myBackgroundImage=r.path,m&&(pt({background:r}),Uo(r)),Me(oe.backgroundImageChange,r)}function t(r,m){f&&clearTimeout(f);const g=Math.floor(Ce.width/2),k=Ce.height-We,D=Math.floor(k/2);d||(r==="top"?ge(E,{top:"10px",left:g+"px"}):r==="left"?ge(E,{top:D+"px",left:"10px"}):r==="right"?ge(E,{top:D+"px",left:Ce.width+"px"}):r==="topLeft"?ge(E,{top:"10px",left:"10px"}):r==="topRight"?ge(E,{top:"10px",left:Ce.width+"px"}):r==="bottomLeft"?ge(E,{top:k+"px",left:"10px"}):r==="bottomRight"&&ge(E,{top:k+"px",left:Ce.width+"px"}),d=!0),f=setTimeout(()=>{r==="top"?ge(E,{top:"10px",left:"10px",height:k-20+"px",width:Ce.width-20+"px",transformOrigin:"top"}):r==="left"?ge(E,{top:"10px",left:"10px",height:k-20+"px",width:g-10+"px",transformOrigin:"left"}):r==="right"?ge(E,{top:"10px",left:g+"px",height:k-20+"px",width:g-10+"px",transformOrigin:"center right"}):r==="topLeft"?ge(E,{top:"10px",left:"10px",height:D-10+"px",width:g-10+"px",transformOrigin:"left top"}):r==="topRight"?ge(E,{top:"10px",left:g+"px",height:D-10+"px",width:g-10+"px",transformOrigin:"right top"}):r==="bottomLeft"?ge(E,{top:D+"px",left:"10px",height:D-10+"px",width:g-10+"px",transformOrigin:"left bottom"}):r==="bottomRight"&&ge(E,{top:D+"px",left:g+"px",height:D-10+"px",width:g-10+"px",transformOrigin:"right bottom"}),E.classList.add("show")},150)}function s(){d=!1,f&&clearTimeout(f),E.classList.remove("show"),E.style.top="0",E.style.left="0",E.style.width="0",E.style.height="0"}function o(r){Vi(n,r)}return{element:n,setBackgroundImage:u,setBackgroundStyle:o,showShape:t,removeShape:s,showDesktopIcons:v.setShowDesktopIcons}}const $e=na();function ra(e,c,v){let b,x,E,C=Mi(32);const n={...e},i=20;G(n.id)?C=e.id:n.id=C;const l={};G(n.icon)&&(l.backgroundImage=`url(${n.icon})`);function p(){H(!0),c.onTabChange(n),c.onDragOver(n)}const a={};G(v)&&(a.position="absolute",a.left=v+"px"),b=_("div",{className:"tab",style:a},[_("div",{className:"tab-inner w-full h-full flex items-center",onmousedown:M,oncontextmenu:c.onContextMenu},[x=_("div",{className:"tab-icon h-full flex-shrink-0 background-icon",style:l}),_("div",{className:"tab-text h-full flex-1"},E=_("div",{className:"w-full h-full flex items-center"},n.text))]),_("div",{className:"tab-close-button h-full flex-shrink-0 flex items-center content center",innerHTML:qs,onclick:()=>{L()}})]),b.addEventListener("customdragover",p,!1);let h,f,d,u=0,t=0,s=0,o=0,r=0,m=0,g=!1,k=!1,D=!1,w=0,S=!1;function M(B){B.button===0&&(ye(c.onTabChange)&&c.onTabChange(n),h=b.getBoundingClientRect(),d=b.parentElement.parentElement.getBoundingClientRect(),r=h.x,m=h.y,u=B.x-d.x,s=B.x,t=B.y-d.y,o=B.y,c.getTabCount()===1&&(S=!0),document.addEventListener("mousemove",I,!1),document.addEventListener("mouseup",y,!1))}function I(B){if(!g&&(Math.abs(B.x-s)>10||Math.abs(B.y-o)>10))S?(c.moveWindow({...n,element:b},{left:h.left,top:h.top,dl:B.x-h.left,width:h.width,height:h.height,deltaLeft:B.x-d.x,deltaTop:B.y-h.top+8}),y()):(g=!0,b.style.position="relative",b.style.removeProperty("left"),f=b.cloneNode(!0),f.classList.add("active"),f.classList.add("tab-clone"),ge(f,{position:"absolute",top:h.top+"px",left:h.left+"px",width:h.width+"px",height:h.height+"px",pointerEvents:"none",zIndex:"10000000"}),document.body.appendChild(f),b.style.visibility="hidden",ye(c.onDragStart)&&c.onDragStart());else if(!S){if(g){let O=D?B.x-w:B.x-d.left-u+r;if(O<d.left&&(O=d.left),O+h.width>d.left+d.width&&(O=d.left+d.width-h.width),f.style.left=O+"px",O>=0){let N=document.elementFromPoint(B.x,B.y);if(G(N)){let z=N.closest(".tab");G(z)&&(B.x-s>0?ci(b,z):B.x-s<0&&ci(z,b)),s=B.x}}}if(B.x<d.left-i||B.x>d.left+d.width+i||B.y<d.top-i||B.y>d.top+d.height+i){let O=B.y-d.top-t+m;if(f.style.top=O+"px",!k){k=!0;const N=f.getBoundingClientRect();c.onDragOut({...n,element:b},{left:N.left,top:N.top,dl:B.x-N.left,width:h.width,height:h.height,deltaLeft:B.x-d.x,deltaTop:B.y-N.top+8}),y(),L(k)}}}}function y(){G(f)&&f.remove(),b.style.removeProperty("visibility"),document.removeEventListener("mousemove",I,!1),document.removeEventListener("mouseup",y,!1),ye(c.onDragEnd)&&c.onDragEnd(n,D),S=!1,D=!1,g=!1}function T(B){n.text=B,E.innerText=B}function A(B){n.icon=B,x.style.backgroundImage=`url(${B})`}function H(B){var O;b.classList[B?"add":"remove"]("active"),(O=b.previousElementSibling)==null||O.classList[B?"add":"remove"]("no-divider")}function P(B){D=!0,h=b.getBoundingClientRect(),d=b.parentElement.parentElement.getBoundingClientRect(),r=h.x,m=h.y,u=B.detail.x-d.x,s=B.detail.x,t=B.detail.y-d.y,o=B.detail.y;let O=B.detail.x-B.detail.dx;if(w=B.detail.dx,g=!0,f=b.cloneNode(!0),f.classList.add("active"),f.classList.add("tab-clone"),ge(f,{position:"fixed",top:h.top+"px",left:O+"px",width:h.width+"px",height:h.height+"px",pointerEvents:"none",zIndex:"10000000"}),document.body.appendChild(f),b.style.visibility="hidden",ye(c.onDragStart)&&c.onDragStart(),O>=0){let N=document.elementFromPoint(B.detail.x,B.detail.y);if(G(N)){let z=N.closest(".tab");G(z)&&(B.detail.x-s>0?ci(b,z):B.detail.x-s<0&&ci(z,b)),s=B.detail.x}}document.addEventListener("mousemove",I,!1),document.addEventListener("mouseup",y,!1)}function F(B){n.content=B}function L(B){ye(c.onClose)&&c.onClose(n,B),b.remove()}return{id:n.id,element:b,setTitle:T,setIcon:A,setActive:H,triggerMouseMove:P,setContent:F,close:L}}function gn(e){let c,v;const b=[];function x(f){b.forEach(u=>u.setActive(!1));const d=b.find(u=>u.id===f);G(d)&&d.setActive(!0)}function E(f){return b.find(u=>u.id===f)}function C(f){return x(f.id),e.onTabChange(f),b.length}function n(f){const d=ra(f,{onTabChange:C,onClose:e.onTabClose,onContextMenu:e.onContextMenu,updateDragHandle:e.updateDragHandle,onDrag:e.onDrag,onDragStart:e.onTabDragStart,onDragOver:e.onDragOver,onDragOut:e.onDragOut,onDragEnd:e.onDragEnd,getTabCount:e.getTabCount,moveWindow:e.moveWindow});return b.push(d),c.insertBefore(d.element,v),v.scrollIntoView(),x(d.id),d}function i(f){b.splice(b.findIndex(d=>d.id===f),1)}c=_("div",{className:"tabs w-full h-full flex"},[v=_("div",{className:"tabs-action-new flex items-center content-center"},_("div",{title:"New Tab",className:"tabs-action-new-button flex items-center content-center",onclick:e.onNewTabActionClick,innerHTML:es(18,2)})),_("div",{["drag-region"]:"drag",className:"h-full flex-1"})]);function l(){v.style.visibility="hidden"}function p(){v.style.visibility="visible"}function a(){c.classList.remove("no-scrollbar")}function h(){c.classList.add("no-scrollbar")}return{element:c,add:n,remove:i,getTab:E,setActiveTab:x,showNewButton:p,hideNewButton:l,enabledScrollbar:a,disabledScrollbar:h}}function Ds(e,c){let v,b=[];v=_("div",{className:"tree-view"+(c.className?" "+c.className:"")});function E(i,l,p=0,a=0,h=""){const f=l[p];let d,u;function t(o,r,m){var g;(g=m.children)!=null&&g.length?o.isShow===!1&&(E(d,m.children,0,a+10,h+=m.text+"/"),o.isShow=!0):typeof c.requestChildren=="function"&&c.requestChildren(m.location,k=>{m.children=k,E(d,k,0,a+10,h+=m.text+"/"),o.isShow=!0}),o.classList.toggle("show"),r.classList.toggle("show")}function s(o){c==null||c.onChange(o)}if(G(f)){const o={backgroundImage:`url(${f.icon})`};d=_("div",{isShow:!1,className:"tree-node"},_("div",{className:"tree-node-inner",style:{paddingLeft:a+"px"}},[_("div",{className:"tree-display flex items-center",ondblclick:r=>{r.stopPropagation(),!f.noToggle&&G(f.children)&&f.children.length>0&&t(d,u,f)},onclick:s.bind(null,f)},[f.noToggle?_("div",{className:"tree-node-action flex-shrink-0 flex items-center"}):u=_("div",{className:"tree-node-action flex-shrink-0 flex items-center",innerHTML:$t,onclick:r=>{r.stopPropagation(),t(d,u,f)}}),_("div",{className:"tree-node-icon",style:o}),_("div",{className:"tree-node-text"},f.text)])])),i.appendChild(d),E(i,l,p+1,a,h),b.push({path:h+f.text,target:d,actionElement:u,currentData:f,toggleShow:t})}}E(v,[e]);function C(i){E(v,[i])}function n(i){return b.find(l=>l.path===i)}return{element:v,appendChild:C,getItem:n}}function oa(e){let c;const{USER_HOME:v}=nt.getState("USER_HOME");let b;function x(n){e==null||e.onChange({location:n.location,text:n.text,icon:n.icon,children:n.children,type:n.type})}function E(n,i){me.readFolder(n,(l,p)=>{const a=p.filter(h=>h.type==="folder").map(h=>({text:h.name,icon:h.icon||mt,location:n+"/"+h.name,properties:h,type:"folder"}));i(a)})}const C=Ds({text:"Favourites",icon:"imgs/icons/Quick%20Access.png",location:"",type:"root",children:[{icon:"imgs/icons/Folder%20Documents.png",text:"Documents",location:v+"/Documents",children:[],type:"folder",noToggle:!0},{icon:"imgs/icons/Folder%20Downloads.png",text:"Downloads",location:v+"/Downloads",children:[],type:"folder",noToggle:!0}]},{onChange:x,className:"explorer-sidebar-item",requestChildren:E});return c=_("div",{tabIndex:-1,className:"explorer-sidebar scrollable flex-shrink-0"},C.element),indexedDB.databases().then(n=>{b=Ds({text:"This PC",icon:"imgs/icons/Computer.png",location:"",type:"root",children:[{text:"Code",icon:mt,location:"c:/Code",children:[],type:"folder"},{text:"Desktop",icon:Ae.desktop,location:v+"/Desktop",children:[],type:"folder"},{icon:Ae.document,text:"Documents",location:v+"/Documents",children:[],type:"folder"},{icon:Ae.download,text:"Downloads",location:v+"/Downloads",children:[],type:"folder"},{icon:Ae.pictures,text:"Pictures",location:v+"/Pictures",children:[],type:"folder"},{icon:Ae.music,text:"Music",location:v+"/Music",children:[],type:"folder"},{icon:Ae.videos,text:"Videos",location:v+"/Videos",children:[],type:"folder"}].concat(n.map(l=>{const p=l.name.split(" ");let a=p[p.length-1].toLowerCase()+":";return{text:l.name,location:a,icon:"imgs/icons/Drives/Hardrive%20Windows.png",children:[],type:"driver"}}))},{className:"explorer-sidebar-item",onChange:x,requestChildren:E});const i=b.getItem("This PC");G(i)&&i.toggleShow(i.target,i.actionElement,i.currentData),c.appendChild(b.element),setTimeout(()=>{c.focus()},200)}),{element:c}}function aa(e){let c="",v=ns({title:e.title,width:e.width||300,height:e.height||160,parent:e.parent,content:_("div",{className:"text-dialog flex items-center content-center h-full"},an({placeholder:e.placholder,type:"text",value:e.text,onChange:b}).element),onOK:x});function b(E){c=E}function x(){typeof e.onSubmit=="function"&&e.onSubmit(c),v.close()}return v}function la(e){let c;const v=e.options.map(i=>{let l={style:{}};return G(i.icon)&&(i.iconType==="svg"?l.innerHTML=i.icon:l.style.backgroundImage=`url(${i.icon})`),_("div",{className:"dropdown-option"+(i.disabled?" disabled":""),onclick:i.disabled?null:i.onClick},[_("div",{className:"dropdown-option-icon image-icon",...l}),_("div",{className:"dropdown-option-label"},i.text)])}),{offsetLeft:b,offsetTop:x,offsetHeight:E}=e.triggerElement;c=_("div",{className:"dropdown",style:{top:x+E+"px",left:b+"px"},onclick:i=>i.stopPropagation()},v),e.triggerElement.appendChild(c);function C(i){const l=i.target;c.contains(l)||n()}setTimeout(()=>{document.onmousedown=C,document.onkeydown=i=>{i.key===Be.Escape&&n()}},10);function n(){c.remove(),G(e.triggerElement)&&e.triggerElement.focus()}return{element:c,close:n}}function ca(e){let c=_("div",{style:{width:"100%",height:"100%",backgroundImage:`url(${e.url})`,backgroundSize:e.imageSize||"100% 100%",backgroundPosition:"center center",backgroundRepeat:"no-repeat"}});function v(b){c.style.backgroundImage=`url(${b})`}return{element:c,setImage:v}}function Xi(){const{USER_HOME:e}=nt.getState("USER_HOME"),c=[{name:"Code",icon:mt,path:"This PC/Code",location:"c:/Code",type:"folder"},{name:"Desktop",icon:Ae.desktop,path:"Desktop",location:e+"/Desktop",type:"folder"},{name:"Documents",icon:Ae.document,path:"Documents",location:e+"/Documents",type:"folder"},{name:"Downloads",icon:Ae.download,path:"Downloads",location:e+"/Downloads",type:"folder"},{name:"Pictures",icon:Ae.pictures,path:"Pictures",location:e+"/Pictures",type:"folder"},{name:"Music",icon:Ae.music,path:"Music",location:e+"/Music",type:"folder"},{name:"Videos",icon:Ae.videos,path:"Videos",location:e+"/Videos",type:"folder"},{name:"Local Disk (C:)",icon:Ae.driverC,path:"c:/",location:"c:",type:"driver"}],{USER_NAME:v}=nt.getState("USER_HOME");return[...[{name:"Favourites",icon:"imgs/icons/Quick%20Access.png",path:"Favourites",location:"Favourites",type:"root",children:[c[2],c[3]],view:"mediumIcons",sortBy:"text",orderBy:"asc"},{name:"Recycle Bin",icon:"imgs/icons/Trash Empty.png",path:"Recycle Bin",location:"Recycle Bin",type:"root",children:[]},{name:"This PC",icon:Ae.thisPC,path:"This PC",location:"This PC",type:"root",children:c,group:{by:"type",orderBy:"desc"},view:"tiles",sortBy:"text",orderBy:"asc"},{name:v,icon:Ae.user,path:v,location:e,type:"folder"}],...c]}function gi(e){return e==="This PC"||e==="Favourites"||e==="Recycle Bin"}function ha(e){let c,v=a(e.actionEvents),b=i(e.history),x,E;c=_("div",{className:"explorer-toolbar flex-shrink-0"},[_("div",{className:"explorer-toolbar-drag w-full h-full",["drag-region"]:"drag"}),v.element,b.element]);let C=new ResizeObserver(()=>{b.toolbarPath.checkOverflow(),v.checkOverflow()});v.disableButtons(["undo","redo","paste"]),C.observe(c);function n(){let d,u,t,s,o,r=!1;function m(){r||(r=!0,d.value=s.path,d.select(),d.focus(),u.style.borderColor="var(--blue-color)",t.style.display="none")}function g(y=!1){r=!1,d.value="",u.style.borderColor="var(--border-color)",t.style.display="flex",y&&w.focus()}function k(y){if(y.key===Be.Enter){const T=D(d.value);e.onItemClick({text:T,location:T}),g(!0)}}function D(y){return y.charAt(y.length-1)==="/"?y.substring(0,y.length-1):y}o=ca({url:mt,imageSize:"18px 18px"});let w=_("div",{className:"explorer-toolbar-path w-full flex",style:{height:"28px"},tabIndex:-1},[u=_("div",{className:"explorer-toolbar-path-box w-full h-full flex",style:{border:"1px solid var(--border-color)"}},[_("div",{className:"explorer-toolbar-path-icon h-full",style:{width:"32px"}},o.element),_("div",{className:"relative w-full h-full"},[_("div",{className:"absolute w-full h-full flex"},[d=_("input",{name:"path-input",autocomplete:"off",className:"explorer-toolbar-path-input w-full h-full",style:{left:0,top:0,border:0,outline:0,background:"none",color:"var(--primary-text-color)",font:"inherit"},onblur:()=>{g()},onkeydown:k}),_("div",{className:"explorer-toolbar-path-history flex-shrink-0 h-full flex items-center content-center",style:{width:"28px"},innerHTML:Ei()})]),t=_("div",{className:"explorer-toolbar-path-items w-full h-full absolute flex items-center",onclick:m,style:{left:0,top:0,zIndex:1,overflowX:"auto"}})])]),_("div",{className:"explorer-toolbar-path-refresh flex-shrink-0 flex items-center content-center",style:{width:"28px",border:"1px solid var(--border-color)",borderLeft:0},innerHTML:Nr(14,2)})]);function S(y){return _("div",{className:"explorer-toolbar-path-item flex h-full flex-shrink-0",onclick:A=>{A.stopPropagation()}},[_("div",{className:"explorer-toolbar-path-item-text flex items-center",onclick:()=>{const A=D(y.location);e.onItemClick({text:A,location:A})},title:y.text},_("div",{className:"text-ellipsis"},y.text)),_("div",{className:"explorer-toolbar-path-item-icon flex items-center content-center",innerHTML:$t})])}function M(y){if(s=y,G(y.icon)&&o.setImage(y.icon),Xe(y.path)||St(y.path)){let T="";const A=Xi(),H=y.path.replace(/\\+/g,"/").split("/").filter(P=>P!=="").map((P,F)=>{T+=P+"/";let L=P;if(F===0){const B=A.findIndex(O=>O.path===T);B>-1&&(L=A[B].name)}return{text:L,location:T}}).map(P=>S(P));H.unshift(S({text:"This PC",location:"This PC"})),at(t),Dt(t,H)}else{const T=Xi(),A=y.path.replace(/\\/,"/").split("/").filter(H=>H!=="").map((H,P)=>{let F=H,L=H;const B=T.findIndex(O=>O.path===(P===0?H+"/":H));return B>-1&&(F=T[B].name,L=T[B].location),{text:F,location:L}}).map(H=>S(H));at(t),Dt(t,A)}I()}function I(){const y=t.offsetWidth;t.scrollWidth>y&&(t.scrollLeft=y+t.scrollWidth)}return{element:w,setPath:M,checkOverflow:I}}function i(d){let u,t,s,o,r=Li({placeholder:"Search "}),m=n(),g="";u=_("div",{className:"explorer-toolbar-top flex items-center"},[_("div",{className:"explorer-toolbar-top-col explorer-toolbar-actions flex items-center"},[t=_("div",{className:"explorer-toolbar-actions-button",innerHTML:Dr(),onclick:d.onBackward}),s=_("div",{className:"explorer-toolbar-actions-button",innerHTML:Mr(),onclick:d.onForward}),o=_("div",{className:"explorer-toolbar-actions-button",innerHTML:Ir(),onclick:()=>{d.onGoUp(g)}})]),_("div",{className:"explorer-toolbar-top-col explorer-toolbar-path"},[m.element]),_("div",{className:"explorer-toolbar-top-col explorer-toolbar-search"},r.element)]);function k(w){r.setPlaceHolder(`Search ${w}`)}function D(w,S,M){const I=w.length;t.classList[S>0?"remove":"add"]("disabled"),s.classList[S>=I-1?"add":"remove"]("disabled");const y=M.split("/").filter(T=>T!=="");if(y.length>1){let T=[...y];T.pop(),g=T.join("/")}o.classList[y.length<=1?"add":"remove"]("disabled")}return{element:u,toolbarPath:m,setPlaceHolder:k,checkHistoryButtons:D}}function l(){aa({title:x,placholder:"Enter folder name",parent:e.getContainer(),onSubmit(d){me.createFolder(x+"/"+d,u=>{u&&ns({title:"",width:300,height:150,parent:e.getContainer(),content:_("div",{className:"w-full h-full flex items-center content-center"},_("div",{className:"text-ellipsis line-clamp-1"},u.message))})})}}),E.close()}function p(d){const u=d.currentTarget,t=[{icon:"imgs/icons/Folder.png",iconType:"image",text:"Folder",onClick:()=>{l()},disabled:!G(x)||x===""||x==="This PC"||x==="Favourites"}];E=la({triggerElement:u,options:t})}function a(d){let u,t,s,o,r=!1,m=!1,g={new:{onclick:p},undo:{onclick:d.onUndo},redo:{onclick:d.onRedo},copy:{onclick:d.onCopy},cut:{onclick:d.onCut},paste:{onclick:d.onPaste},open:{onclick:d.onOpen},delete:{onclick:d.onDelete},rename:{onclick:d.onRename}};u=_("div",{className:"explorer-toolbar-bottom flex items-center"},[t=_("div",{className:"explorer-toolbar-bottom-items h-full flex items-center"},[_("div",{className:"explorer-toolbar-group"},[g.new.elem=_("div",{className:"explorer-toolbar-bottom-item",onclick:p},[_("div",{className:"explorer-toolbar-bottom-item-icon",innerHTML:es(20,1.5)}),_("div",{className:"explorer-toolbar-bottom-item-text"},"New")])]),_("div",{className:"explorer-toolbar-group"},[g.undo.elem=_("div",{className:"explorer-toolbar-bottom-item",onclick:g.undo.onclick},[_("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/Undo.png)"}}),_("div",{className:"explorer-toolbar-bottom-item-text"},"Undo")]),g.redo.elem=_("div",{className:"explorer-toolbar-bottom-item",onclick:g.redo.onclick},[_("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/Redo.png)"}}),_("div",{className:"explorer-toolbar-bottom-item-text"},"Redo")])]),_("div",{className:"explorer-toolbar-group"},[g.copy.elem=_("div",{className:"explorer-toolbar-bottom-item",onclick:g.copy.onclick},[_("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/copy.png)"}}),_("div",{className:"explorer-toolbar-bottom-item-text"},"Copy")]),g.cut.elem=_("div",{className:"explorer-toolbar-bottom-item",onclick:g.cut.onclick},[_("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/scissors.png)"}}),_("div",{className:"explorer-toolbar-bottom-item-text"},"Cut")]),g.paste.elem=_("div",{className:"explorer-toolbar-bottom-item",onclick:g.paste.onclick},[_("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/clipboard.png)"}}),_("div",{className:"explorer-toolbar-bottom-item-text"},"Paste")])]),_("div",{className:"explorer-toolbar-group"},[g.open.elem=_("div",{className:"explorer-toolbar-bottom-item",onclick:g.open.onclick},[_("div",{className:"explorer-toolbar-bottom-item-icon",innerHTML:mr}),_("div",{className:"explorer-toolbar-bottom-item-text"},"Open")])]),_("div",{className:"explorer-toolbar-group"},[g.delete.elem=_("div",{className:"explorer-toolbar-bottom-item",onclick:g.delete.onclick},[_("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Emblems/170.png)"}}),_("div",{className:"explorer-toolbar-bottom-item-text"},"Delete")]),g.rename.elem=_("div",{className:"explorer-toolbar-bottom-item",onclick:g.rename.onclick},[_("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/Rename.png)"}}),_("div",{className:"explorer-toolbar-bottom-item-text"},"Rename")])])]),o=_("div",{className:"explorer-overflow-action-more",style:{width:"30px",height:"30px",display:"none",marginInline:"10px"},innerHTML:Ys()},s=_("div",{className:"explorer-overflow-actions flex flex-col"})),_("div",{["drag-region"]:"drag",className:"h-full flex-1"})]);function k(){const M=t.offsetWidth,I=[];if(t.scrollWidth>M){const y=Array.from(t.children);for(let T of y)T.offsetLeft+T.offsetWidth>M?(I.push(T.cloneNode(!0)),T.style.visibility="hidden"):T.style.visibility="visible";at(s),I.forEach(T=>{T.style.visibility="visible",s.appendChild(T)}),r||(r=!0,m=!1,o.style.display="block")}else if(!m){m=!0,r=!1;const y=Array.from(t.children);for(let T of y)T.style.visibility="visible";o.style.display="none"}}function D(M){var I,y;for(let T of M)(y=(I=g[T])==null?void 0:I.elem)==null||y.classList.remove("disabled")}function w(M){var I,y;for(let T of M)(y=(I=g[T])==null?void 0:I.elem)==null||y.classList.add("disabled")}function S(){const M=Object.keys(g);for(let I of M)g[I].elem.classList.add("disabled")}return{element:u,checkOverflow:k,enableButtons:D,disableButtons:w,disableAllButtons:S}}function h(d){x=d}function f(d,u){if(gi(u))v.disableButtons(["new","copy","cut","paste","open","delete","rename"]);else{const t=d.length;t===0?(v.enableButtons(["new"]),v.disableButtons(["copy","cut","open","delete","rename"])):t===1?v.enableButtons(["new","copy","cut","open","delete","rename"]):t>1&&(v.disableButtons(["rename"]),v.enableButtons(["new","copy","cut","open","delete"]))}}return{element:c,toolbarActions:v,toolbarNavigation:b,setLocation:h,setSelectedItems:f}}const da=e=>({"":"",folder:"File Folder",file:e.type==="file"?Wt(gt(e.text)).description:"File Folder",driver:"Local Disk"})[e.type];function ua(e,c){let v,b,x,E,C=0,n=0,i={...e},l=[],p=_("div",{className:"pannel-selection",style:{display:"none",pointerEvents:"none"}}),a=!1,h,f;v=_("div",{className:"pannel w-full h-full scrollable"},[p,b=_("div",{className:"pannel-selector-handler w-full h-full",onmousedown:T}),E=u(i.view)]);function d(N){c.onChange(N)}function u(N="details"){switch(N){case"extraLargeIcons":case"largeIcons":case"mediumIcons":case"smallIcons":return t(N);case"list":return k();case"details":return g();case"tiles":return D();default:return g()}}function t(N){if(G(i.group)){let W=ks(e.items,Y=>Y[i.group.by]);const U=Object.keys(W).map(Y=>Y).sort((Y,R)=>i.group.orderBy==="asc"?Y.localeCompare(R):R.localeCompare(Y));x=_("div",{className:"pannel-items-group-container"});const j=U.length;for(let Y=0;Y<j;Y++){const R=U[Y];let $=W[R];G(i.sortBy)&&($=$.sort((X,se)=>i.orderBy==="asc"?X[i.sortBy].localeCompare(se[i.sortBy]):se[i.sortBy].localeCompare(X[i.sortBy])));const q=r(R.toFirstUpperCase()+` (${$.length})`,o($,N));x.appendChild(q)}return x}let z=i.items.sort((W,U)=>{const j=U.type.localeCompare(W.type),Y=W.text.localeCompare(U.text);return j||Y});return G(i.sortBy)&&(z=z.sort((W,U)=>i.orderBy==="asc"?W[i.sortBy].localeCompare(U[i.sortBy]):U[i.sortBy].localeCompare(W[i.sortBy]))),x=o(z,N)}function s(N){let z=_("div",{className:"pannel-item-icon-bg"});const W=_("div",{className:"pannel-item-icon flex items-end content-center",style:{backgroundImage:`url(${N.icon})`}},z);function U(j,Y){const R=Y||1;W.style.backgroundImage="none",z.style.aspectRatio=R.toString(),R>=1?z.style.width="100%":z.style.height="100%",z.style.backgroundImage=`url(${j})`}if(N.type==="file"){const j=gt(N.name||N.text);if(Xe(N.location)){if(Ti(j))ri.getThumbnail(N.location,j,U);else if(Di(j)){const Y=_("div",{className:"app-association",style:{backgroundImage:`url(${yt.mediaPlayer.icon})`}});z.appendChild(Y),ri.getThumbnail(N.location,j,U)}}}return W}function o(N,z){let W=N.sort((U,j)=>{const Y=j.type.localeCompare(U.type),R=U.text.localeCompare(j.text);return Y||R});return _("div",{className:"pannel-items pannel-items-thumbnail "+z},W.map(U=>{let j,Y;return j=_("div",{className:"w-full h-full"},Y=_("div",{className:"pannel-item flex flex-col items-center content-center",info:U,onclick:()=>{Hi()&&d(U)},ondblclick:d.bind(null,U),onmousedown:m,ondragover(R){c.onPannelItemDragover(R,U),j.classList.add("pannel-item-selected")},ondragleave(){j.classList.remove("pannel-item-selected")},ondrop(R){j.classList.remove("pannel-item-selected"),c.onPannelItemDrop(R,U)}},[s(U),_("div",{title:U.text,className:"pannel-item-text text-center"},U.text)])),mi(Y,U),j}))}function r(N,z){return _("div",{className:"pannel-items-group"},[_("div",{className:"pannel-items-group-header flex items-center",style:{padding:"3px 5px"}},[_("div",{className:"pannel-items-group-header-icon flex-shrink-0 flex items-center content-center",innerHTML:Ei(18)}),_("div",{className:"pannel-items-group-header-label flex-shrink-0"},N),_("div",{className:"pannel-items-group-header-line w-full",style:{height:"1px",backgroundColor:"var(--border-color)",marginLeft:"5px"}})]),_("div",{className:"pannel-items-group-body"},z)])}function m(N){if(N.button!==0)return;c.onItemMouseDown();const z=N.currentTarget;if(!N.shiftKey)if(N.ctrlKey)if(z.classList.contains("pannel-item-selected")){z.classList.remove("pannel-item-selected");const W=l.findIndex(U=>U.info.location===z.info.location);W>-1&&l.splice(W,1)}else z.classList.add("pannel-item-selected"),l.push(z);else F(),z.classList.add("pannel-item-selected"),l.push(z);ye(c.onSelect)&&c.onSelect(l)}function g(){let N=i.items.sort((z,W)=>{const U=W.type.localeCompare(z.type),j=z.text.localeCompare(W.text);return U||j});return _("div",{className:"pannel-detail w-full"},_("table",{},[_("thead",{},_("tr",{className:"pannel-detail-header"},[_("td",{className:"pannel-detail-header-col pannel-detail-name",colSpan:2},"Name"),_("td",{className:"pannel-detail-header-col pannel-detail-date"},"Date modified"),_("td",{className:"pannel-detail-header-col pannel-detail-type"},"Type"),_("td",{className:"pannel-detail-header-col pannel-detail-size"},"Size")])),x=_("tbody",{className:"pannel-items pannel-items-details"},N.map(z=>{let W,U="";if(z.size){const j=Zt(parseInt(z.size));U=j.value+" "+j.unit}return W=_("tr",{className:"pannel-item",info:z,onclick:()=>{Hi()&&d(z)},ondblclick:d.bind(null,z),onmousedown:m,ondragover(j){c.onPannelItemDragover(j,z),W.classList.add("pannel-item-selected")},ondragleave(){W.classList.remove("pannel-item-selected")},ondrop(j){W.classList.remove("pannel-item-selected"),c.onPannelItemDrop(j,z)}},[_("td",{className:"pannel-item-icon",style:{backgroundImage:`url(${z.icon})`}}),_("td",{className:"pannel-item-col"},_("div",{className:"text-ellipsis line-clamp-1"},z.text)),_("td",{className:"pannel-item-col pannel-item-mdate pannel-detail-date"},_("div",{className:"text-ellipsis line-clamp-1"},z.properties.mdate?y(z.properties.mdate):"")),_("td",{className:"pannel-item-col pannel-item-type pannel-detail-type"},_("div",{className:"text-ellipsis line-clamp-1"},da(z))),_("td",{className:"pannel-item-col pannel-item-size pannel-detail-size"},U)]),mi(W,z),W}))]))}function k(){return _("div")}function D(){if(G(i.group)){let N=ks(e.items,U=>U.type);const z=Object.keys(N).map(U=>U).sort((U,j)=>i.group.orderBy==="asc"?U.localeCompare(j):j.localeCompare(U));x=_("div",{className:"pannel-items-group-container"});const W=z.length;for(let U=0;U<W;U++){const j=z[U];let Y=N[j];G(i.sortBy)&&(Y=Y.sort(($,q)=>i.orderBy==="asc"?$[i.sortBy].localeCompare(q[i.sortBy]):q[i.sortBy].localeCompare($[i.sortBy])));const R=r(j.toFirstUpperCase()+` (${Y.length})`,w(Y));x.appendChild(R)}return x}return x=w(e.items)}function w(N){return _("div",{className:"pannel-items pannel-items-tiles"},N.map(z=>{let W,U;return W=_("div",{className:"w-full h-full flex items-center content-center"},U=_("div",{className:"pannel-item flex items-center",info:z,onclick:()=>{Hi()&&d(z)},ondblclick:d.bind(null,z),onmousedown:m,ondragover(j){c.onPannelItemDragover(j,z),W.classList.add("pannel-item-selected")},ondragleave(){W.classList.remove("pannel-item-selected")},ondrop(j){W.classList.remove("pannel-item-selected"),c.onPannelItemDrop(j,z)}},[_("div",{className:"pannel-item-icon",style:{backgroundImage:`url(${z.icon})`}}),_("div",{className:"pannel-item-info w-full"},[_("div",{className:"pannel-item-text"},z.text),_("div",{className:"pannel-item-desc"},z.type==="driver"?_("div",{className:"progress w-full"},M()):""),_("div",{className:"pannel-item-size"},z.type==="driver"?I():"")])])),mi(U,z),W}))}function S(N){navigator.storage.estimate().then(({quota:z,usage:W})=>{let U=W/z*100,j=Zt(z),Y=Zt(z-W);z>2e10&&(U=(W+2e10)/z*100,Y=Zt(z-2e10-W)),N({available:j,free:Y,percent:U})})}function M(){const N=_("div",{className:"progress-value",style:{width:"80%"}});return S(({percent:z})=>{N.style.width=z+"%"}),N}function I(){const N=_("div",{},"4 GB free of 20 GB");return S(({available:z,free:W})=>{N.textContent=`${W.value} ${W.unit} free of ${z.value} ${z.unit}`}),N}function y(N){const z=new Date(N),W=z.getDate();return Zi[z.getDay()]+", "+(W<10?"0"+W:W)+"-"+$i[z.getMonth()]+"-"+z.getFullYear()+" "+It(z)}function T(N){N.button===0&&(N.shiftKey||F(),a=!0,h={x:N.x+v.scrollLeft,y:N.y+v.scrollTop},f=v.getBoundingClientRect(),document.addEventListener("mousemove",A,!1),document.addEventListener("mouseup",H,!1))}function A(N){const z={top:v.scrollTop,left:v.scrollLeft};if(C=Math.abs(N.x+z.left-h.x),n=Math.abs(N.y+z.top-h.y),!a||C<2&&n<2)return;let W=0,U=0,j=C,Y=n;N.x+z.left>h.x?U=h.x-f.left:U=N.x-f.left+z.left,N.y+z.top>h.y?W=h.y-f.top:W=N.y-f.top+z.top,ge(p,{display:"initial",top:W+"px",left:U+"px",width:j+"px",height:Y+"px"}),(U+j>f.width+z.left||U<z.left)&&v.scrollTo({top:N.y-f.top,left:N.x-f.left}),P({x1:U,x2:U+j,y1:W,y2:W+Y},N.shiftKey)}function H(){a=!1,document.removeEventListener("mousemove",A,!1),document.removeEventListener("mouseup",H,!1),ge(p,{display:"none",top:0,left:0,width:0,height:0}),l=Array.from(x.getElementsByClassName("pannel-item-selected")),ye(c.onSelected)&&c.onSelected(l)}function P(N,z){const W=Array.from(x.getElementsByClassName("pannel-item")).map(j=>j),U=[];for(let j of W){let Y=j.offsetLeft,R=j.offsetTop,$=j.offsetWidth,q=j.offsetHeight;Y+$<N.x1||Y>N.x2||R+q<N.y1||R>N.y2?z||j.classList.remove("pannel-item-selected"):(U.push(j),j.classList.add("pannel-item-selected"))}ye(c.onSelect)&&c.onSelect(U)}function F(){for(let N of l)N.classList.remove("pannel-item-selected");l=[],ye(c.onSelect)&&c.onSelect([])}function L(N){G(E)&&E.remove(),E=u(N),v.appendChild(E),O()}function B(){b.style.height="0px"}function O(){B(),b.style.height=v.scrollHeight+"px"}return{element:v,setView:L,updateSelectionHandler:O}}function fa(e){let c,v,b,x,E,C;c=_("div",{className:"explorer-status-bar flex items-center flex-shrink-0"},[v=_("div",{className:"explorer-status-bar-item"},"0 items"),b=_("div",{className:"explorer-status-bar-item"}),x=_("div",{className:"explorer-status-bar-item"}),_("div",{className:"explorer-status-bar-item",style:{marginLeft:"auto",marginRight:"10px"}},[E=_("div",{className:"explorer-status-bar-view button-presentation",innerHTML:Hr(16),onclick:n.bind(null,"details")}),C=_("div",{className:"explorer-status-bar-view button-presentation",innerHTML:Js(16),onclick:n.bind(null,"mediumIcons")})])]);function n(h){e.onViewChange(h)}function i(h){E.classList.remove("selected"),C.classList.remove("selected"),h==="details"?E.classList.add("selected"):h==="mediumIcons"&&C.classList.add("selected")}function l(h=0){v.textContent=h+" items"}function p(h=0){b.textContent=h>0?h+" items selected":""}function a(h){x.textContent=h}return{element:c,setItemCount:l,setSelectedItem:p,setView:i,setSize:a}}const vn=(e,c,v=!1)=>{let b;const x=[];let E,C=[],n;const i=Xi(),l=gn({onTabChange:f,onTabClose:u,onNewTabActionClick:S,onDragOut:r,onDragOver:()=>{},onDragEnd(M,I){I&&(E.content.setCurrentWindow(b),l.showNewButton())},getTabCount:h,moveWindow:a}),p=_("div",{className:"window-tabs-container explorer-tabs-container w-full"},[_("div",{className:"tabs-drag-handle w-full h-full absolute",["drag-region"]:"drag"}),l.element]);p.addEventListener("tabdragover",o,!1);function a(M,I){ge(b.element,{pointerEvents:"none"}),document.addEventListener("mousemove",T,!1),document.addEventListener("mouseup",A,!1);let y;function T(H){b.checkWindowSnap({x:H.x,y:H.y}),b.setBounds({top:H.y-I.deltaTop,left:H.x-I.deltaLeft});const P=document.elementFromPoint(H.x,H.y);if(P instanceof Element){const F=P.closest(".explorer-tabs-container");G(F)&&y!==F&&(y=F,A(),b.close(),F.dispatchEvent(new CustomEvent("tabdragover",{bubbles:!0,detail:{x:H.x,dx:I.dl,y:H.y,tabId:M.id,windowId:M.windowId,icon:M.icon,text:M.text,content:E.content}})))}}function A(){b.setWindowSnap(),ge(b.element,{pointerEvents:"initial"}),document.removeEventListener("mousemove",T,!1),document.removeEventListener("mouseup",A,!1)}}function h(){return x.length}function f(M){if(n===M.id)return;n=M.id,E=d(M.id);const I=C.findLastIndex(y=>y===M.id);I>-1&&C.splice(I,1),C.unshift(M.id),l.setActiveTab(M.id),b.setContent(E.content.element),E.content.updateSelectionHandler(),s(E.id,E.text,E.icon)}function d(M){return x.find(I=>I.id===M)}function u(M,I){const y=x.findIndex(A=>A.id===M.id);l.remove(M.id),y>-1&&(I||x[y].content.dispose(),x.splice(y,1));const T=C.findIndex(A=>A===M.id);T>-1&&C.splice(T,1),x.length===0?b.close():(E=d(C[0]),l.setActiveTab(E.id),s(E.id,E.text,E.icon),b.setContent(E.content.element))}function t(M){let I=b,y,T="wtct"+Mi(),A;const H=[];let P=0,F="",L=[],B;const O=J=>{B=J},N=ha({onItemClick:J=>{let le=!(Xe(J.location)||St(J.location));U(J,!0,le)},history:{onBackward:Y,onForward:R,onGoUp:$},getContainer:()=>b.element,getCurrentLocation:()=>F,actionEvents:{onDelete(){const J=L.map(le=>{const te={type:le.info.type,location:le.info.location};return le.info.type==="file"&&(te.size=le.info.properties.size),te});Ko(J,F)}}}),z=oa({onChange:J=>{U(J,!0,!0)}}),W=fa({onViewChange:J=>{y.setView(J),W.setView(J),me.setView(F,{type:J,sortBy:"name",orderBy:"asc"})}});function U(J,le=!0,te=!1){var ce;if(W.setSelectedItem(0),N.setLocation(J.location),le&&(H.splice(P+1,H.length),((ce=H[H.length-1])==null?void 0:ce.text)!==J.text&&(P=H.push(J)-1)),te){const Pe=i.findIndex(ie=>ie.name===J.text||ie.path===J.text),ve=i[Pe];if(Pe>-1)if(F=ve.location,q(),ve.type==="root"){const ie=ve.children.filter(fe=>fe.type==="folder").map(fe=>new Promise((Le,ne)=>{me.stats(fe.location,(ue,be)=>{ue?ne(ue):Le({...be,location:fe.location})})})),pe=ve.children.filter(fe=>fe.type!=="folder");Promise.all(ie).then(fe=>{const ne=pe.concat(fe).map(ue=>({icon:ue.icon||(ue.type==="file"?Wt(gt(ue.name)).icon:mt),text:ue.name,properties:{...ue},type:ue.type,location:ue.location}));he(ne,{view:ve.view,group:ve.group,sortBy:ve.sortBy,orderBy:ve.orderBy})}),N.toolbarNavigation.toolbarPath.setPath({text:ve.name,icon:ve.icon,path:ve.path,location:ve.location}),N.toolbarNavigation.setPlaceHolder(ve.name),ye(B)&&B(M,ve.name,ve.icon)}else(ve.type==="folder"||ve.type==="driver")&&xe(ve.location,ve.path,{view:ve.view,group:ve.group,sortBy:ve.sortBy,orderBy:ve.orderBy});else xe(J.location)}else xe(J.location);function xe(Pe,ve,ie){me.readFolder(Pe,(pe,fe)=>{if(pe)console.log(pe);else{F=Pe,q();const Le=fe.map(ne=>{var ue;return{icon:ne.icon||(ne.type==="file"?Wt(gt(ne.name)).icon:mt),text:ne.name,properties:{...ne},type:ne.type,location:Pe+"/"+ne.name,name:ne.name,cdate:ne.cdate.toString(),size:(ue=ne.size)==null?void 0:ue.toString()}});me.stats(Pe,(ne,ue)=>{if(ne)console.log(ne);else{N.toolbarNavigation.toolbarPath.setPath({text:ue.text||ue.name,icon:ue.icon||mt,path:G(ve)?ve:Pe,location:Pe}),ye(B)&&B(M,ue.text||ue.name,ue.icon||mt),N.toolbarNavigation.setPlaceHolder(ue.text||ue.name);let be={};G(ue.view)?Object.assign(be,{...ue.view,view:ue.view.type}):G(ie)&&(be=ie),he(Le,be)}})}})}}function j(){let J=!1,le=F;function te(){J&&le===F&&(U({location:F,text:F},!1),J=!1)}function xe(ce){return ce.substring(F.length+1,ce.length).split("/")}me.addEventListener("added",T,zt(()=>{te()},{limit:1e3,onFunction(ce){ce.includes(F)&&xe(ce).length===1&&(J||(J=!0),le=F)}})),me.addEventListener("modified",T,zt(()=>{te()},{limit:1e3,onFunction(ce){ce.includes(F)&&xe(ce).length===1&&(J||(J=!0),le=F)}})),me.addEventListener("removed",T,zt(()=>{te()},{limit:1e3,onFunction(ce){ce.includes(F)&&xe(ce).length===1&&(J||(J=!0),le=F)}}))}j();function Y(){P-=1,U(H[P],!1,!0)}function R(){P+=1,U(H[P],!1,!0)}function $(J){U({text:J,location:J})}function q(){N.toolbarNavigation.checkHistoryButtons(H,P,F)}function X(J){J.preventDefault(),gi(F)||pi(F,J.dataTransfer.items)}function se(J){J.preventDefault(),J.stopPropagation(),J.dataTransfer.dropEffect="copy"}function V(J,le){J.preventDefault(),J.stopPropagation(),le.type==="folder"||le.type==="driver"?pi(le.location,J.dataTransfer.items):gi(F)||pi(F,J.dataTransfer.items)}function he(J,le){setTimeout(()=>{at(A),N.setSelectedItems([],F),W.setItemCount(J.length),W.setView(le.view),!G(J)||(J==null?void 0:J.length)===0?A.appendChild(_("div",{style:{textAlign:"center",padding:"20px 0"}},"This folder is empty")):(y=ua({selectable:!0,items:J,...le},{onItemMouseDown(){},onChange:te=>{if(te.type==="folder"||te.type==="driver")U({text:te.location,location:te.location},!0);else{const xe=gt(te.text),ce=Wt(xe);Fe(ce.appName,te.location)}},onSelect(te){if(L=te,N.setSelectedItems(te,F),W.setSelectedItem(te.length),te.length>0&&te.every(ce=>ce.info.type==="file")){const ce=Zt(Z(te));W.setSize(ce.value+" "+ce.unit)}else W.setSize("")},onPannelItemDragover:se,onPannelItemDrop:V}),A.appendChild(y.element),y.updateSelectionHandler())},50)}function ke(){I.addEventListener("resize",Ge(()=>{y.updateSelectionHandler()})),I.addEventListener("passiveResize",Ge(()=>{y.updateSelectionHandler()})),I.addEventListener("maximize",Ge(()=>{y.updateSelectionHandler()})),I.addEventListener("unmaximize",Ge(()=>{y.updateSelectionHandler()})),I.addEventListener("unSnap",Ge(()=>{y.updateSelectionHandler()})),I.addEventListener("restore",Ge(()=>{y.updateSelectionHandler()}))}function ee(){I.removeListeners("resize",Ge(()=>{})),I.removeListeners("passiveResize",Ge(()=>{})),I.removeListeners("maximize",Ge(()=>{})),I.removeListeners("unmaximize",Ge(()=>{})),I.removeListeners("unSnap",Ge(()=>{})),I.removeListeners("restore",Ge(()=>{}))}function ae(){ke()}ae();function Z(J){let le=0,te=J.length;for(let xe=0;xe<te;xe++){const ce=J[xe];ce.info.type==="file"&&(le+=ce.info.properties.size)}return le}const de=_("div",{className:"explorer-container w-full h-full relative"},[N.element,_("div",{className:"explorer-body flex flex-col w-full h-full"},[_("div",{className:"w-full flex",style:{height:"calc(100% - 25px)"}},[z.element,A=_("div",{className:"explorer-content h-full flex-1",ondragover(J){gi(F)&&(J.dataTransfer.dropEffect="none")},ondrop:X})]),W.element])]);function _e(J){I=J,ae()}function we(){me.removeListeners("added",T),me.removeListeners("modified",T),me.removeListeners("removed",T)}return{element:de,toolbar:N,listenEvent:O,routeTo:U,listenFileChange:j,setCurrentWindow:_e,updateSelectionHandler(){y==null||y.updateSelectionHandler()},addWindowEvents:ke,removeWindowEvents:ee,dispose:we}}function s(M,I,y){b.setTitle(I),G(y)&&b.setIcon(y);const T=l.getTab(M);G(T)&&(T.setTitle(I),G(y)&&T.setIcon(y));const A=d(M);G(A)&&(A.text=I,A.icon=y)}function o(M){l.hideNewButton(),b.focus();const I=M,y={icon:I.detail.icon,text:I.detail.text,content:I.detail.content},T=l.add(y);T.triggerMouseMove(I),E={id:T.id,text:y.text,icon:y.icon,content:y.content},E.content.listenEvent((A,H,P)=>{s(T.id,H,P)}),E.content.listenFileChange(),C.unshift(T.id),x.push(E),b.setContent(y.content.element)}function r(M,I){const y=b.getBounds(),T={top:I.top-I.deltaTop,left:I.left-I.deltaLeft,width:y.width,height:y.height},A=d(M.id);A.content.listenEvent(null),A.content.removeWindowEvents(),M.content=A.content;const H=vn(null,T,!0);H.addTabAndMoveWindow(M,{...I,windowBounds:T},H.window)}function m(M,I,y){const T=l.add(M);l.disabledScrollbar(),ge(T.element,{position:"absolute",left:I.deltaLeft-I.dl+"px"}),E={id:T.id,text:M.text,icon:M.icon,content:M.content},E.content.setCurrentWindow(y),E.content.addWindowEvents(),C.unshift(T.id),n=T.id,E.content.listenEvent((A,H,P)=>{s(E.id,H,P)}),E.content.listenFileChange(),x.push(E),b.setContent(E.content.element),s(E.id,E.text,E.icon),g(M,I,T),l.hideNewButton()}function g(M,I,y){ge(b.element,{pointerEvents:"none"}),document.addEventListener("mousemove",A,!1),document.addEventListener("mouseup",H,!1);let T;function A(P){b.checkWindowSnap({x:P.x,y:P.y}),b.setBounds({top:P.y-I.deltaTop,left:P.x-I.deltaLeft});const F=document.elementFromPoint(P.x,P.y);if(F instanceof Element){const L=F.closest(".explorer-tabs-container");G(L)&&T!==L&&(T=L,H(),b.close(),L.dispatchEvent(new CustomEvent("tabdragover",{bubbles:!0,detail:{x:P.x,dx:I.dl,y:P.y,tabId:M.id,windowId:M.windowId,icon:M.icon,text:M.text,content:E.content}})))}}function H(){l.enabledScrollbar(),b.setWindowSnap(),l.showNewButton(),ge(b.element,{pointerEvents:"initial"}),y.element.style.removeProperty("position"),y.element.style.removeProperty("left"),document.removeEventListener("mousemove",A,!1),document.removeEventListener("mouseup",H,!1)}}function k(M){const I={text:M,icon:"imgs/icons/Folder.png"},y=l.add(I),T=t(y.id);T.listenEvent((A,H,P)=>{s(A,H,P)}),T.routeTo({text:M,location:M},!0,!0),E={id:y.id,text:I.text,icon:I.icon,content:T},C.unshift(y.id),x.push(E),b.setContent(T.element),s(I.id,I.text,I.icon)}function D(M){const I=l.add({...M,windowId:b.id});let y=t(I.id);y.listenEvent(s),E={id:I.id,text:M.text,icon:M.icon,content:y},C.unshift(I.id),n=I.id,x.push(E),b.setContent(y.element),y.routeTo({text:M.text},!0,!0),s(M.id,M.text,M.icon)}function w(){D({text:"This PC",windowId:b.id,icon:"imgs/icons/Computer.png"})}function S(){w()}return b=lt({args:e,icon:Q.explorer.icon,hideIcon:!0,name:Q.explorer.name,title:Q.explorer.productName,hideTitle:!0,titlebarHeight:bt,titlebarContent:p,top:(c==null?void 0:c.top)||50,left:(c==null?void 0:c.left)||50,width:(c==null?void 0:c.width)||800,height:(c==null?void 0:c.height)||520,className:"explorer-app-window",transprencyContent:!0}),v||(G(e)?k(e):w()),b.addEventListener("close",()=>{for(let M=0;M<x.length;M++)x[M].content.dispose()}),b.addEventListener("secondInstance",M=>{b.isVisible()||b.show(),b.focus(),G(M)?k(M):w()}),b.addEventListener("restore",function(){b.isMaximized()||b.setTitlebarHeight(bt)}),b.addEventListener("unmaximize",function(){b.isMaximized()||b.setTitlebarHeight(bt)}),b.addEventListener("unSnap",function(){b.isMaximized()||b.setTitlebarHeight(bt)}),b.addEventListener("maximize",function(){b.setTitlebarHeight(Mt)}),{addTabAndMoveWindow:m,tabs:l,window:b}};function ma(e){let c=ss(Q.explorer.name);G(c)?c.window.executeListeners("secondInstance",e):vn(e)}function qe(e,c){const v=Ls(50,200),b=Ls(50,200);lt({icon:e.icon,name:e.name,title:e.productName,top:v,left:b,width:450,height:300,content:()=>_("div",{className:"w-full h-full flex content-center items-center"},_("h3",{},"In Progress"))})}function pa(e,c){let v;v=_("div",{tabIndex:0,className:"menu-strip flex items-center",onfocus:c.onfocus,onblur:c.onblur});for(let E=0;E<e.length;E++){const C=e[E],n=_("div",{className:"menu-strip-item flex-shrink-0"},_("div",{className:"h-full flex items-center"},C.text));b(n,C.children),v.appendChild(n)}function b(E,C){if(G(C)){const n=_("div",{className:"context-menu"});C.forEach(i=>[x(n,i)]),E.appendChild(n)}}function x(E,C){if(C.divider){let l=_("div",{className:"menu-item-divider"});E.appendChild(l);return}const n=G(C.children)&&C.children.length>0,i=_("div",{className:"menu-item"+(C.disabled?" disabled":"")+(C.emphasis?" emphasis":"")+(C.checked?" checked":""),onclick:()=>{!C.disabled&&!n&&ye(c.onItemClick)&&c.onItemClick(C)}},[_("div",{className:"menu-item-icon",innerHTML:C.checked?nn():"",style:{pointerEvents:"none"}}),_("div",{className:"menu-item-text",style:{pointerEvents:"none"}},C.text||"")]);if(C.shortcut){let l=_("div",{className:"menu-item-shortcut",style:{pointerEvents:"none"}},C.shortcut);i.appendChild(l)}if(n){let l=_("div",{className:"menu-item-arrow flex items-center",innerHTML:$t});i.appendChild(l)}E.appendChild(i),b(i,C.children)}return v}function _n(e,c,v=!1){let b,x;const E=[];let C,n=[],i;const l=gn({onTabChange:h,onTabClose:d,onNewTabActionClick:u,onDragOver:()=>{},onDragOut:g,onDragEnd(S,M){M&&l.showNewButton()},getTabCount:a,moveWindow:p});function p(S,M){ge(x.element,{pointerEvents:"none"}),document.addEventListener("mousemove",y,!1),document.addEventListener("mouseup",T,!1);let I;function y(A){x.checkWindowSnap({x:A.x,y:A.y}),x.setBounds({top:A.y-M.deltaTop,left:A.x-M.deltaLeft});const H=document.elementFromPoint(A.x,A.y);if(H instanceof Element){const P=H.closest(".notepad-tabs-container");G(P)&&I!==P&&(I=P,T(),x.close(),P.dispatchEvent(new CustomEvent("tabdragover",{bubbles:!0,detail:{x:A.x,dx:M.dl,y:A.y,tabId:S.id,windowId:S.windowId,icon:S.icon,text:S.text,content:C.element}})))}}function T(){x.setWindowSnap(),ge(x.element,{pointerEvents:"initial"}),setTimeout(()=>{C.element.input.focus()},10),document.removeEventListener("mousemove",y,!1),document.removeEventListener("mouseup",T,!1)}}function a(){return E.length}function h(S){if(i===S.id)return;i=S.id,C=f(S.id);const M=n.findLastIndex(I=>I===S.id);M>-1&&n.splice(M,1),n.unshift(S.id),l.setActiveTab(S.id),x.setContent(C.element.element),setTimeout(()=>{C.element.input.focus()},10),r(S.id,S.text,S.icon)}function f(S){return E.find(M=>M.id===S)}function d(S){const M=E.findIndex(y=>y.id===S.id);M>-1&&E.splice(M,1);const I=n.findIndex(y=>y===S.id);I>-1&&n.splice(I,1),E.length===0?x.close():(C=f(n[0]),l.setActiveTab(C.id),r(C.id,C.text),x.setContent(C.element.element))}function u(){t()}function t(){s({text:"Untitled - Notepad",icon:"imgs/icons/Apps/notepad.png"})}function s(S,M){const I=l.add({...S,windowId:x.id});let y;G(M)?y=M:y=o(),C={id:I.id,text:S.text,element:y},n.unshift(I.id),E.push(C),x.setContent(y.element),setTimeout(()=>{y.input.focus()},10),r(S.id,S.text)}function o(){let S,M,I,y;S=_("div",{className:"w-full h-full flex flex-col"},[pa([{text:"File",children:[{text:"New",shortcut:"Ctrl+N"},{text:"Open",shortcut:"Ctrl+O"},{text:"Save",shortcut:"Ctrl+S"},{text:"SaveAs",shortcut:"Ctrl+Shift+S"},{divider:!0},{text:"Close",shortcut:"Alt+W"}]},{text:"Edit",children:[{text:"Undo",disabled:!0,shortcut:"Ctrl+Z"},{divider:!0},{text:"Cut",disabled:!0,shortcut:"Ctrl+X"},{text:"Copy",disabled:!0,shortcut:"Ctrl+C"},{text:"Paste",disabled:!0,shortcut:"Ctrl+V"},{text:"Delete",disabled:!0,shortcut:"Del"},{divider:!0},{text:"Find",shortcut:"Ctrl+F"},{text:"Replace...",shortcut:"Ctrl+H"},{divider:!0},{text:"Select All",shortcut:"Ctrl+A"}]},{text:"Format",children:[{text:"Wordwrap",checked:!0},{text:"Font..."}]},{text:"View",children:[{text:"Zoom",children:[{text:"Zoom In",shortcut:"Ctrl+Plus"},{text:"Zoom Out",shortcut:"Ctrl+Minus"},{text:"Restore Default Zoom",shortcut:"Ctrl+0"}]},{text:"Status Bar",checked:!0}]},{text:"Help",children:[{text:"View Help"},{text:"Send Feedback"},{divider:!0},{text:"About Notepad"}]}],{onItemClick(){M.focus()}}),M=_("textarea",{tabIndex:0,name:"notepad-input",className:"w-full h-full scrollable scroll-y",style:{display:"block",border:0,borderTop:"1px solid var(--border-color)",outline:0,padding:"5px",color:"var(--primary-text-color)",backgroundColor:"transparent",font:"400 14px Consolas",cursor:"default",resize:"none"},onselect(P){P.preventDefault()},onkeydown:()=>{A(),document.onkeyup=H},onmousedown:()=>{A(),H(),document.onmousemove=()=>{A(),H()},document.onmouseup=H}}),_("div",{className:"note-pad-status-bar w-full flex items-center flex-shrink-0",style:{borderTop:"1px solid var(--border-color)",minHeight:"25px",paddingInline:"10px"}},[_("div",{className:"note-pad-status-left h-full"}),_("div",{className:"note-pad-status-right flex h-full",style:{marginLeft:"auto"}},[I=_("div",{className:"note-pad-status-bar-item"}),y=_("div",{className:"note-pad-status-bar-item"}),_("div",{className:"note-pad-status-bar-item"},"100%"),_("div",{className:"note-pad-status-bar-item"},"Windows (CRLF)"),_("div",{className:"note-pad-status-bar-item"},"UTF-8")])])]),A(),H();function A(){setTimeout(()=>{const P=M.value.substring(0,M.selectionStart).split(`
`),F=P.length,L=P[P.length-1].length;y.textContent=`Ln ${F}, Col ${L}`},150)}function H(){setTimeout(()=>{const P=M.value.substring(M.selectionStart,M.selectionEnd);I.textContent=(P.length>0?P.length:0)+" selected"},100)}return{element:S,input:M}}function r(S,M,I){x.setTitle(M);const y=l.getTab(S);G(y)&&(y.setIcon(I||"imgs/icons/Apps/notepad.png"),y.setTitle(M))}function m(S){l.hideNewButton(),x.focus();const M=S,I={icon:M.detail.icon,text:M.detail.text,content:M.detail.content},y=l.add(I);y.triggerMouseMove(M),C={id:y.id,text:I.text,element:I.content},n.unshift(y.id),E.push(C),x.setContent(I.content.element),setTimeout(()=>{C.element.input.focus()},10),r(y.id,C.text)}function g(S,M){const I=x.getBounds(),y={top:M.top-M.deltaTop,left:M.left-M.deltaLeft,width:I.width,height:I.height},T=f(S.id);S.content=T.element,_n(null,y,!0).addTabAndMoveWindow(S,{...M,windowBounds:y})}function k(S,M){const I=l.add(S);ge(I.element,{position:"absolute",left:M.deltaLeft-M.dl+"px"}),C={id:I.id,text:S.text,element:S.content},n.unshift(I.id),E.push(C),x.setContent(C.element.element),setTimeout(()=>{C.element.input.focus()},10),r(I.id,S.text,S.icon),D(S,M,I),l.hideNewButton()}function D(S,M,I){ge(x.element,{pointerEvents:"none"}),document.addEventListener("mousemove",T,!1),document.addEventListener("mouseup",A,!1);let y;function T(H){x.checkWindowSnap({x:H.x,y:H.y}),x.setBounds({top:H.y-M.deltaTop,left:H.x-M.deltaLeft,width:M.windowBounds.width,height:M.windowBounds.height});const P=document.elementFromPoint(H.x,H.y);if(P instanceof Element){const F=P.closest(".notepad-tabs-container");G(F)&&y!==F&&(y=F,A(),x.close(),F.dispatchEvent(new CustomEvent("tabdragover",{bubbles:!0,detail:{x:H.x,dx:M.dl,y:H.y,tabId:S.id,windowId:S.windowId,icon:S.icon,text:S.text,content:C.element}})))}}function A(){x.setWindowSnap(),l.showNewButton(),ge(x.element,{pointerEvents:"initial"}),I.element.style.removeProperty("position"),I.element.style.removeProperty("left"),setTimeout(()=>{C.element.input.focus()},10),document.removeEventListener("mousemove",T,!1),document.removeEventListener("mouseup",A,!1)}}function w(S){qi(S,(M,I)=>{if(M)return;const y=rt(S)+" - Notepad";x.setTitle(y);const T={text:y,icon:"imgs/icons/Apps/notepad.png"},A=l.add({...T,windowId:x.id}),H=o();H.input.value=I,C={id:A.id,text:y,element:H},n.unshift(A.id),E.push(C),x.setContent(H.element),H.input.focus(),r(A.id,T.text,T.icon)})}return b=_("div",{className:"window-tabs-container notepad-tabs-container w-full"},[_("div",{className:"tabs-drag-handle w-full h-full absolute",["drag-region"]:"drag"}),l.element]),b.addEventListener("tabdragover",m,!1),x=lt({args:e,icon:Q.notepad.icon,hideIcon:!0,name:Q.notepad.name,title:Q.notepad.productName,hideTitle:!0,top:(c==null?void 0:c.top)||50,left:(c==null?void 0:c.left)||100,width:(c==null?void 0:c.width)||700,height:(c==null?void 0:c.height)||450,titlebarHeight:bt,titlebarContent:b,className:"notepad-app-window",transprencyContent:!0}),v||(G(e)?w(e):t()),x.addEventListener("customdrop",S=>{S!=null&&S.type&&S.type==="file"&&gt(S.args)===".txt"&&qi(S.args,(M,I)=>{M||(C.element.input.value=I,x.focus(),r(C.id,rt(S.args)+" - NotePad"))})}),x.addEventListener("secondInstance",S=>{x.isVisible()||x.show(),G(S)?w(S):t(),x.focus()}),x.addEventListener("restore",()=>{x.isMaximized()||x.setTitlebarHeight(bt)}),x.addEventListener("unmaximize",()=>{x.isMaximized()||x.setTitlebarHeight(bt)}),x.addEventListener("unSnap",()=>{x.isMaximized()||x.setTitlebarHeight(bt)}),x.addEventListener("maximize",()=>{x.setTitlebarHeight(Mt)}),{addTabAndMoveWindow:k,tabs:l,window:x}}const ga=e=>{let c=ss(Q.notepad.name);G(c)?c.window.executeListeners("secondInstance",e):_n(e)};const yi=1.7777777777777777,ti=120,ut=140,Si=160,ft=8,xt=48,Ms=200,va=200,Is=40,Gi=xt,_a=60,Bs=45,Xt=4,wa="#bbb",ba=`
<svg width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="#333" fill="none" stroke-linecap="round" stroke-linejoin="round" style="stroke: var(--stroke-color)">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="12" y1="5" x2="12" y2="19" />
  <line x1="16" y1="9" x2="12" y2="5" />
  <line x1="8" y1="9" x2="12" y2="5" />
</svg>`,ya=`
<svg width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="#333" fill="none" stroke-linecap="round" stroke-linejoin="round" style="stroke: var(--stroke-color)">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="12" y1="5" x2="12" y2="19" />
  <line x1="16" y1="15" x2="12" y2="19" />
  <line x1="8" y1="15" x2="12" y2="19" />
</svg>
`;function Rs(e,c){typeof c>"u"||c===null||(c instanceof HTMLElement?e.appendChild(c):c instanceof Array?wn(e,c):e.appendChild(document.createTextNode(c.toString())))}function wn(e,c){c instanceof Array?c.forEach(v=>{Rs(e,v)}):Rs(e,c)}function Sa(e,c){for(let v in c)v.indexOf("-")>-1?e.style.setProperty(v,c[v]):e.style[v]=c[v]}function He(e,c,v){let b=document.createElement(e);if(c){const x=c;for(let E in x)if(E==="style"){const C=x[E];Sa(b,C)}else if(E.indexOf("-")>-1||E.indexOf(":")>-1){const C=x[E];b.setAttribute(E,C)}else b[E]=x[E]}return v&&wn(b,v),b}function As(e){let c=e.firstChild;for(;c;)e.removeChild(c),c=e.firstChild}function bn(e=0,c=[],v=4){const b=c.length;let x=[0],E=!1,C=0;function n(h=[],f=0,d=0,u=0,t){const s=c[d];if(!s)return h;const o=d+1-f,r=o>1?(o-1)*v:0;u+=s.ratio;const m=u*ut,g=(e-r)/u,k=g<=Si+C&&g>=ti,D=e-m<=0?g/Si:g/ti,w=Math.pow(Math.abs(D),3)*100,S=u;if(k)h.push({edge:d,badness:w,rowHeight:g,flag:1,itemCount:o,boxSpacing:v,ratio:S}),C=0,E=!1;else{if(m+r>e)return E?(C=0,h.length===0&&(g<ti||!t?h.push({edge:d,badness:w,rowHeight:g,flag:o>1?-1:0,ratio:S,itemCount:o,boxSpacing:v}):t&&h.push(t)),h):(E=!0,C=20,n(h,f,d,u-s.ratio,t));if(d===(b>1?b-1:0))return h.push({edge:d,badness:w,flag:0,rowHeight:ut,ratio:S,itemCount:o,boxSpacing:v}),h;t={edge:d,badness:w,rowHeight:g,flag:o>1?1:0,ratio:S,itemCount:o,boxSpacing:v}}return n(h,f,d+1,u,t)}let i=[];function l(){let h=x.shift();if(typeof h>"u"||h===null||!c[h])return;let f=n([],h,h),d;d=f[0];for(let t=1;t<f.length;t++){const s=f[t];s.badness<d.badness&&(d=s)}const u={flag:d.flag,row:[h,d.edge],ratio:d.ratio||yi,itemCount:d.itemCount,boxSpacing:d.boxSpacing,rowHeight:d.rowHeight||ut};i.push(u),d.edge+1<=b&&x.push(d.edge+1)}for(;x.length>0;)l();let p=i.length,a=i[p-1];return p>1&&a.flag===0&&(a.rowHeight=i[p-2].rowHeight),{paths:i,rowCount:i.length}}function xa(e=0,c=[],v=48){const b=c.length;let x=[0];function E(i=[],l=0,p=0,a=0,h=0,f){const d=c[p];if(!d)return i;h+=d.itemCount>1?(d.itemCount-1)*ft:0;const u=p+1-l,t=(u>1?(u-1)*v:0)+h;a+=d.ratio;const s=a*ut,o=(e-t)/a,r=o<=Si&&o>=ti,m=e-s<=0?o/Si:o/ti,g=Math.pow(Math.abs(m),3)*100;if(r)i.push({edge:p,badness:g,rowHeight:o,flag:1,itemCount:u,boxSpacing:v,ratio:a});else{if(s+t>e)return i.length===0&&(f?i.push(f):i.push({edge:p,badness:g,rowHeight:o,flag:1,itemCount:u,boxSpacing:v,ratio:a})),i;if(p===(b>1?b-1:0))return i.push({edge:p,badness:g,flag:0,rowHeight:ut,ratio:a,itemCount:u,boxSpacing:v}),i;f={edge:p,badness:g,rowHeight:ut,flag:0,itemCount:u,boxSpacing:v,ratio:a}}return E(i,l,p+1,a,h,f)}let C=[];function n(){let i=x.shift();if(typeof i>"u"||i===null||!c[i])return;const l=c[i];let p=c[i+1];if(l.rowCount>1||typeof p<"u"&&p.rowCount>1)C.push({flag:1,row:[i,i],boxSpacing:v,rowHeight:ut,ratio:l.ratio||yi}),i+1<=b&&x.push(i+1);else{let a=E([],i,i,0,0),h=a[0];for(let d=1;d<a.length;d++){const u=a[d];u.badness<h.badness&&(h=u)}const f={flag:h.flag,row:[i,h.edge],rowHeight:h.rowHeight||ut,boxSpacing:h.boxSpacing,ratio:h.ratio||yi};C.push(f),h.edge+1<=b&&x.push(h.edge+1)}}for(;x.length>0;)n();return{paths:C,rowCount:C.length}}function Ns(e=300,c){const v=c.segments.map(l=>{const{paths:p,rowCount:a}=bn(e,l.items),h=p[0];return{rows:p,rowCount:a,ratio:h.ratio||yi,itemCount:a===1?h.row[1]+1-h.row[0]:0}}),b=v.map(({rowCount:l,ratio:p,itemCount:a})=>({rowCount:l,ratio:p,itemCount:a})),x=xa(e,b,xt),E={index:c.index,name:c.name,loaded:!0,left:0,width:e,height:0,segments:[],segmentInfo:[]};let C=0,n=0;for(let l=0;l<x.paths.length;l++){const p=x.paths[l],a=p.flag,h=p.row[1]+1-p.row[0];let f=0;for(let d=p.row[0];d<=p.row[1];d++){const u=v[d];var i=c.segments[d];const t={index:i.index,name:i.name,top:C,left:f,width:0,height:0,items:[],flag:a};let s=0,o=0;for(let r=0;r<u.rows.length;r++){const m=u.rows[r],g=p.rowHeight||m.rowHeight||ut,k=Math.floor(g);let D=0;for(let w=m.row[0];w<=m.row[1];w++){const S=i.items[w],M=Math.round(S.ratio*g);let I={...S,top:s+xt,left:D,width:a===0?M:h>1?d===p.row[1]&&w===m.row[1]?e-(f+D):M:m.flag===0?M:w===m.row[1]&&m.itemCount>1?e-D:M,height:k};t.items.push(I),D+=I.width+ft}o=D-ft,s+=k+ft,f+=D-ft+xt}t.width=u.rowCount===1?o:e,n=s-ft+Gi,t.height=n,d===p.row[1]&&(C+=n),E.segments.push(t),E.segmentInfo.push({index:t.index,top:t.top,height:t.height})}}return E.height=C,E}function Ps(e=300,c){const v={index:c.index,name:c.name,left:0,width:e,height:0,segments:[],segmentInfo:[],loaded:!0},b=c.segments;let x=0;for(let E=0;E<b.length;E++){const C=b[E],{paths:n,rowCount:i}=bn(e,C.items),l={index:C.index,name:C.name,top:x,left:0,width:e,height:0,items:[]};let p=0;for(let a=0;a<i;a++){const h=n[a],f=h.rowHeight,d=Math.floor(f);let u=0;for(let t=h.row[0];t<=h.row[1];t++){const s=C.items[t],o=Math.round(s.ratio*f);let r={...s,top:p+xt,left:u,width:h.flag===0?o:t===h.row[1]&&h.itemCount>1?e-u:o,height:d+Gi};l.items.push(r),u+=r.width+ft}p+=d+ft+xt}l.height=p-ft+Gi,x+=l.height,v.segments.push(l),v.segmentInfo.push({index:l.index,top:l.top,height:l.height})}return v.height=x,v}function yn(e,c,v,b){let x=0;return e+c<b-Ms&&(x=-1),e>b+v+Ms&&(x=-1),x===0}function Ca(e=0,c=[],v,b){const x=[];for(let E=0;E<c.length;E++){const C=c[E];yn(e+C.top,C.height,v,b)&&x.push(C.index)}return x}function di(e,c,v,b=10,x){let E,C,n,i;return function(){const l=this,p=arguments;window.cancelAnimationFrame(i),i=window.requestAnimationFrame(()=>{typeof x=="function"&&x.apply(l,p,i)}),window.clearTimeout(n),n=window.setTimeout(()=>{typeof v=="function"&&v.apply(l,p)},b),C?(window.clearTimeout(E),E=window.setTimeout(function(){Date.now()-C>=c&&(e.apply(l,p),C=Date.now())},c-(Date.now()-C))):(e.apply(l,p),C=Date.now())}}function ka(e=[],c,v,b={},x){var E;let C=e.length,n={position:"absolute",top:"0",bottom:"0",right:"0",width:_a+"px",height:"100%",margin:"auto",background:"none",fontFamily:"inherit",cursor:"ns-resize"};b.style&&(n={...n,...b.style});let i=[],l=48,p=(l-2)/2,a=c,h,f,d,u,t,s,o,r,m,g,k;const D=x.getBounds();let w={width:D.width,height:D.height},S=!1,M=!1,I=!1,y=!1,T=0,A=0,H=!1,P,F=!1,L=!1,B=!1;d=He("div",{className:"grid-scrollbar",style:n},u=He("div",{className:"scrollbar-wrapper w-full h-full"},[t=He("div",{className:"grid-scrollbar-inner w-full",style:{top:p+(b.hideButton?0:Bs)+"px",bottom:p+(b.hideButton?0:Bs)+2+"px",cursor:n.cursor},onmouseover:W,onmouseleave:U},[He("div",{className:"w-full h-full",onmousemove:se,onmousedown:N},[s=He("div",{className:"grid-scrollbar-thumb-primary"}),o=He("div",{className:"grid-scrollbar-thumb-secondary",tabIndex:0,style:{top:-(l/2-1)+"px",height:l+"px",cursor:n.cursor},onmouseover:W,onmouseleave:U,onkeydown:j,onclick:Y},He("div",{className:"grid-scrollbar-thumb-secondary-inner"},[m=He("div",{className:"grid-scrollbar-thumb-text"}),He("div",{className:"grid-scrollbar-thumb-line",style:{top:p+"px"}})]))]),r=He("div",{className:"grid-scrollbar-parts"})]),b.hideButton?null:g=He("button",{className:"grid-scrollbar-button grid-scrollbar-button-up disabled",innerHTML:ba}),b.hideButton?null:k=He("button",{className:"grid-scrollbar-button grid-scrollbar-button-down",innerHTML:ya})])),(E=v.parentElement)==null||E.appendChild(d),O();function O(){v.scrollHeight/v.getBoundingClientRect().height<=1?d.style.display="none":d.style.display="initial"}if(he(),V(),ee(),J(0),le(0),x.addEventListener("passiveResize",di($,100),!1),x.addEventListener("resize",di($,100),!1),b.autoHide){let ie=function(){y=!0,u.classList.add("mouse-over"),u.classList.remove("fade-out"),u.classList.add("fade-in")},pe=function(){y=!1,!M&&!F&&(u.classList.remove("fade-in"),u.classList.add("fade-out"),u.classList.remove("mouse-over"))};u.classList.add("auto-hide"),u.addEventListener("mouseover",ie,!1),u.addEventListener("mouseleave",pe,!1),setTimeout(()=>{v.addEventListener("scroll",R,!1)},50)}b.hideButton||(_e(g,L,()=>{ce()}),_e(k,B,()=>{xe()}));function N(){s.style.visibility="hidden",M=!0,document.addEventListener("mousemove",se,!1),document.addEventListener("mouseup",z,!1)}function z(){s.style.visibility="visible",M=!1,document.removeEventListener("mousemove",se,!1),document.removeEventListener("mouseup",z,!1)}function W(){S=!0}function U(){S=!1}function j(ie){ie.key==="ArrowUp"?ce():ie.key==="ArrowDown"&&xe()}function Y(ie){let pe=ie.y-h.top;te(pe),de()}function R(){F||(setTimeout(()=>{H||(y||(u.classList.remove("fade-out"),u.classList.add("fade-in")),u.classList.add("scrolling"))},1e3),F=!0),P&&clearTimeout(P),P=setTimeout(()=>{u.classList.remove("scrolling"),y||(u.classList.add("fade-out"),u.classList.remove("fade-in"),u.classList.remove("mouse-over")),H=!1,F=!1},2e3)}function $(){const ie=x.getBounds();w.height!==ie.height&&(w={width:ie.width,height:ie.height},he(),V(),ee(),q(!0),de(),O())}function q(ie){const pe=v.scrollTop/(v.scrollHeight-f.height)*h.height;J(pe),(ie||!S)&&le(pe),de()}function X(ie=0,pe=0){T=ie,A=pe;const fe=T/(A-f.height)*h.height;J(fe),S||le(fe),de()}function se(ie){ie.stopPropagation();let pe=ie.y-h.top;M?(te(pe),le(pe)):S&&le(pe)}function V(){f=v.getBoundingClientRect()}function he(){h=t.getBoundingClientRect()}function ke(ie,pe){e=ie,C=ie.length,a=pe,ee();const fe=T/(A-f.height)*h.height;J(fe),S||le(fe),O(),de()}function ee(){ae(),Z()}function ae(){let ie=0,pe=[];function fe(ue){const be=pe[ue+1];return be?be.isMileStone?be:fe(ue+1):null}for(let ue=0;ue<C;ue++){const be=e[ue];let ct=be.height/a*h.height;pe.push({index:be.index,name:be.name,top:ie,height:ct,isMileStone:be.isMileStone,year:be.year}),ie+=ct}let Le=-20,ne=0;for(let ue=0;ue<C;ue++){const be=pe[ue];if(be.isMileStone)be.top+be.height-ne>=20&&(be.visible=!1,be.displayMileStone=!0,ne=be.top),Le=be.top;else{const ct=fe(ue),ot=be.top-Le>=10;ct?ot&&ct.top-be.top>=10&&(be.visible=!0,Le=be.top):ot&&(be.visible=!0,Le=be.top)}}i=pe}function Z(){r.innerHTML="";let ie=i.length;for(let pe=0;pe<ie;pe++){const fe=i[pe];(fe.visible||fe.isMileStone)&&r.appendChild(He("div",{style:{position:"absolute",top:fe.top+fe.height-Xt+"px",right:"10px",width:Xt+"px",height:Xt+"px",display:"flex",alignItem:"center",justifyContent:"flex-end",boxSizing:"border-box"}},[fe.displayMileStone?He("div",{className:"grid-scrollbar-point-text",style:{position:"absolute",top:"-5px",right:"-2px"}},fe.year):null,fe.visible?He("div",{style:{width:Xt+"px",height:Xt+"px",borderRadius:"100%",background:wa,boxSizing:"border-box"}}):null]))}}function de(){b.hideButton||(T===0?(L=!0,B=!1,g.classList.add("disabled"),k.classList.remove("disabled")):T+f.height===A?(L=!1,B=!0,k.classList.add("disabled"),g.classList.remove("disabled")):(L=!1,B=!1,I||(g.classList.remove("disabled"),k.classList.remove("disabled"))))}function _e(ie,pe=!1,fe){if(pe)return;let Le;ie.addEventListener("mousedown",ne,!1);function ne(){I=!0,Le=requestAnimationFrame(be),document.addEventListener("mouseup",ue,!1)}function ue(){cancelAnimationFrame(Le),setTimeout(()=>{cancelAnimationFrame(Le),I=!1,de()},50),document.removeEventListener("mouseup",ue,!1)}function be(){Le=requestAnimationFrame(be),typeof fe=="function"&&fe()}}function we(ie){m.textContent=ie}function J(ie=0){s.style.transform=`translate3d(0px, ${ie}px, 0px)`}function le(ie=0){if(ie>=0&&ie<=h.height){o.style.transform=`translate3d(0px, ${ie}px, 0px)`;let pe,fe=i.length;for(let Le=0;Le<fe;Le++){const ne=i[Le];ie>=ne.top&&ie<ne.top+ne.height&&(pe=ne)}pe&&we(pe.name)}}function te(ie=0){v.scroll({top:ie/h.height*(v.scrollHeight-f.height)})}function xe(){v.scrollTop+=Is}function ce(){v.scrollTop-=Is}function Pe(){x.removeEventListener("resize",di($,100),!1),x.removeEventListener("passiveResize",di($,100),!1)}function ve(){o.focus()}return{element:d,getContainerInfo:he,update:ke,updateScroll:X,focus:ve,destroy:Pe}}function Ea(e,c,v,b,x,E,C,n,i){let l=0,p=[],a=[],h=0,f=0,d=b.padding||120,u=[],t=c,s,o,r,m,g=!1,k,D=0,w=0;const S=He("div",{className:"justified-layout w-full"},r=He("div",{tabIndex:-1,className:"grid-scroll-panel w-full h-full scrollable scroll-y"+(b.useNativeScrollbar?" use-native-scrollbar":""),style:{position:"relative"},onkeydown:ee=>{ee.altKey&&ee.key==="s"&&(b.useNativeScrollbar||o.focus())},onscroll:O}));e.appendChild(S),t.length===0?(i instanceof HTMLElement&&(As(r),r.appendChild(i)),T()):(r.appendChild(M()),I(),v!==null?(P(),T(),setTimeout(()=>{r.scrollTop=v.scrollTop,D=v.scrollTop,D===0&&Y(u)},10)):y()),b.resizeSmooth?(x.addEventListener("passiveResize",F,!1),x.addEventListener("resize",F,!1)):(x.addEventListener("passiveResize",L,!1),x.addEventListener("resize",L,!1));function M(){return m=He("div",{className:"grid-layout-container",style:{position:"relative",marginBottom:xt+"px"}},s=He("div",{className:"layout"}))}function I(){const ee=r.getBoundingClientRect();f=ee.height;let ae=Math.round(ee.width)-d;x.getBounds().width<600&&(ae=ae-ae*.2+d),h=ae-ae%2,R(h)}function y(){A(),T(),U(),Y(u),z()}function T(){b.useNativeScrollbar||(o=ka(a,l,r,b.scrollbar,x))}function A(){const ee=[],ae=[];let Z=0;for(let de=0;de<t.length;de++){const _e=t[de],we=b.useNavieLayout?Ps(h,_e):Ns(h,_e);ae.push({index:_e.index,name:_e.name,top:Z,width:h,height:we.height,loaded:!0,isMileStone:_e.isMileStone,year:_e.year}),ee.push(we),Z+=we.height}p=ee,a=ae,l=Z,$(Z)}function H(){typeof n=="function"&&n({layoutHeight:l,scrollTop:D,loadedSections:p,sectionBounds:a,lastSectionInViewport:u})}function P(){l=v.layoutHeight,p=v.loadedSections,a=v.sectionBounds,u=v.lastSectionInViewport,$(l)}function F(){t.length!==0&&(k&&cancelAnimationFrame(k),k=requestAnimationFrame(()=>{B()}))}function L(){t.length!==0&&(k&&clearTimeout(k),k=setTimeout(()=>{B()},50))}function B(){q(),I(),A(),b.useNativeScrollbar||o.update(a,l),U(),Y(u),z()}function O(){g||(requestAnimationFrame(()=>{D=r.scrollTop,w=r.scrollHeight,N(),b.useNativeScrollbar||o.updateScroll(D,w),g=!1,setTimeout(()=>{z()},va)}),g=!0)}function N(){U(),Y(u)}function z(){H(),W()}function W(){const ee=U(!0),ae=ee.map(de=>de.index).toString(),Z=u.map(de=>de.index).toString();ae!==Z&&(u=ee,z())}function U(ee){const ae=[];let Z=a.length;for(let de=0;de<Z;de++){const _e=a[de];yn(_e.top,_e.height,f,D)&&ae.push(_e)}return ee||(u=ae),ae}function j(ee){let ae=s.querySelector(`.grid-section[data-index="${ee.index}"]`);if(ae||(ae=He("div",{className:"grid-section",sectionIndex:ee.index,"data-index":ee.index,style:{top:ee.top+"px",height:ee.height+"px"}}),s.appendChild(ae)),ee.loaded){const Z=p[ee.index],de=Ca(ee.top,Z.segmentInfo,f,D),_e=[...ae.getElementsByClassName("grid-segment")];for(let we=0;we<_e.length;we++){const J=_e[we];let le=!1;for(let te=0;te<de.length;te++){const xe=de[te];if(parseInt(J.dataset.index||"")===xe){le=!0;break}}le||J.remove()}for(let we=0;we<de.length;we++){const J=de[we],le=Z.segments[J];if(!ae.querySelector(`.grid-segment[data-index="${J}"]`)){const te=He("div",{className:"grid-segment",segmentIndex:J,"data-index":J,style:{top:le.top+"px",left:le.left+"px",width:le.width+"px",height:le.height+"px"}},C(le)),xe=le.items.length;for(let ce=0;ce<xe;ce++){const Pe=le.items[ce];let ve=E(Pe);te.appendChild(ve)}ae.appendChild(te)}}}}function Y(ee=[]){const ae=[...s.getElementsByClassName("grid-section")];for(let Z=0;Z<ae.length;Z++){const de=ae[Z];let _e=!1;for(let we=0;we<ee.length;we++){const J=ee[we];if(parseInt(de.dataset.index||"")===J.index){_e=!0;break}}_e||de.remove()}for(let Z=0;Z<ee.length;Z++){const de=ee[Z];j(de)}}function R(ee=0){m.style.width=ee+"px"}function $(ee=0){s.style.height=ee+"px"}function q(){s.innerHTML=""}function X(){t=[],p=[],a=[],b.useNativeScrollbar||o.update(a,0)}function se(ee){ee.length>0?(As(r),r.appendChild(M()),t=ee,B(),b.useNativeScrollbar||(o.getContainerInfo(),o.update(a,l)),r.scrollTop=D):(X(),r.innerHTML="",i instanceof HTMLElement&&r.appendChild(i),$(f-xt),b.useNativeScrollbar||o.update([],0))}function V(ee){const{sectionName:ae,sections:Z}=ee;t=Z;const de=a.find(te=>te.name===ae);if(!de)return;let _e;b.useNavieLayout?_e=Ps(h,t[de.index]):_e=Ns(h,t[de.index]);let we=de.height-_e.height;a[de.index].height=_e.height,p[de.index]=_e;let J=a.length;for(let te=de.index+1;te<J;te++)a[te].top-=we;l-=we,$(l),U();let le=u.length;for(let te=0;te<le;te++){const xe=u[te];let ce=s.querySelector(`.grid-section[data-index="${xe.index}"]`);ce instanceof HTMLElement&&ce.remove()}Y(u),b.useNativeScrollbar||(o.getContainerInfo(),o.update(a,l))}function he(){b.useNativeScrollbar||o.destroy(),b.resizeSmooth?x.removeEventListener("resize",F,!1):x.removeEventListener("resize",L,!1)}function ke(){b.useNativeScrollbar||o.getContainerInfo()}return{element:S,update:se,updateItem:V,recalculateLayout:B,updateScrollbar:ke,destroy:he}}function xi(e){let c,v,b,x=!1,E=e.options.find(u=>u.value===e.value),C=[];function n(u){E=u,c.textContent=u.text,e.onChange&&e.onChange(u),h(),p()}const i=e.value?e.options.find(u=>u.value===e.value).text:"Select",l=e.options.map(u=>{const t=u.value===e.value,s=_("div",{className:"select-option"+(t?" selected":""),onclick:n.bind(null,u)},[_("div",{className:"select-option-decorator"}),_("div",{className:"select-option-label"},u.text)]);return C.push({id:u.value,element:s}),s});v=_("div",{className:"select-options"},l);function p(){v.classList.remove("show"),x=!1,b.classList.remove("show"),document.removeEventListener("click",a)}function a(u){u.target!==b&&!b.contains(u.target)&&p()}function h(){C.forEach(u=>{u.element.classList.remove("selected"),E&&u.id===E.value&&u.element.classList.add("selected")})}function f(){x=!x,b.classList[x?"add":"remove"]("show"),x&&(h(),document.addEventListener("click",a)),v.classList.toggle("show")}b=_("div",{className:"select"+(e.noBackground?" no-background":"")},[_("div",{className:"select-placeholder flex items-center",onclick:f},[c=_("div",{className:"select-placeholder-text flex-1"},i),_("div",{className:"select-placeholder-icon",innerHTML:Xs})]),v=_("div",{className:"select-options"},l)]);function d(u){const t=e.options.find(s=>s.value===u);t&&n(t)}return{element:b,setValue:d}}const Sn="imgs/apps/photos/",La=Sn+"Thumbnails/",Ta=e=>{if(G(e)){v(e);return}const c=b=>{const x=window.photoData;let E,C,n,i;C=_("div",{className:"app-photos w-full h-full standard-content"},_("div",{className:"w-full h-full flex flex-col theme-background"},[_("div",{className:"photos-app-toolbar flex items-center"},[_("div",{className:"photos-app-toolbar-col flex-1"},[_("div",{className:"photos-app-toolbar-nav flex items-center"},[_("div",{className:"photos-app-toolbar-nav-item active"},"Collection"),_("div",{className:"photos-app-toolbar-nav-item"},"Albums"),_("div",{className:"photos-app-toolbar-nav-item"},"Folders")])]),_("div",{className:"photos-app-toolbar-col flex-1 flex content-center"},Li({placeholder:"Search photos or things..."}).element),_("div",{className:"photos-app-toolbar-col photos-app-toolbar-actions flex-1 flex content-end"},[_("div",{className:"photos-app-toolbar-action flex items-center"},[_("div",{className:"photos-app-toolbar-action-icon",innerHTML:Ar(20)}),_("div",{className:"photos-app-toolbar-action-text"},"New")]),_("div",{className:"photos-app-toolbar-action flex items-center"},[_("div",{className:"photos-app-toolbar-action-icon",innerHTML:Br(20)}),_("div",{className:"photos-app-toolbar-action-text"},"Select")]),_("div",{className:"photos-app-toolbar-action flex items-center"},[_("div",{className:"photos-app-toolbar-action-icon",innerHTML:Rr(20)}),_("div",{className:"photos-app-toolbar-action-text"},"Import")])])]),n=_("div",{className:"photos-app-content w-full"})])),b.addEventListener("secondInstance",h=>{b.isVisible()||b.show(),b.focus(),v(h)}),b.addEventListener("dragend",()=>{G(E)&&E.updateScrollbar()}),b.addEventListener("ready",()=>{st(n,l()),E=Ea(i,x,null,{},b,p,a,()=>{})}),b.addEventListener("restore",()=>{E.recalculateLayout()}),b.addEventListener("snap",()=>{E.recalculateLayout()});function l(){return _("div",{className:"w-full h-full"},[_("div",{className:"photos-app-grid-header flex items-center w-full"},[_("div",{className:"flex items-center flex-1"},[_("div",{className:"flex-shrink-0",style:{marginRight:"10px"}},"View By"),xi({value:"datetaken",options:[{text:"Date taken",value:"datetaken"},{text:"Recently added",value:"recentlyadded"}]}).element]),_("div",{className:"flex items-center flex-1"})]),i=_("div",{className:"photos-app-grid w-full"})])}function p(h){const f=window.encodeURI(La+h.name),d=window.encodeURI(Sn+h.name);let u={};return h.name&&(u.backgroundImage=`url('${f}')`),_("div",{title:h.name,className:"grid-item",style:{top:h.top+"px",left:h.left+"px",width:h.width+"px",height:h.height+"px"}},[_("div",{className:"grid-item-content w-full h-full",style:u,onclick:()=>{v(d)}})])}function a(h){return _("div",{className:"segment-heading flex items-center"},_("div",{className:"segment-heading-inner flex items-center full-height"},_("div",{title:h.name,className:"segment-heading-text text-ellipsis line-clamp-1"},h.name)))}return C};function v(b){G(b)&&Fe("photoViewer",b)}lt({args:e,icon:Q.photos.icon,hideIcon:!0,name:Q.photos.name,title:Q.photos.productName,top:100,left:100,width:980,height:585,center:!0,fluidContent:!0,singleInstance:!0,transprencyContent:!0,content:c})},oi={system:{icon:"imgs/icons/Desktop.png",iconType:"image",text:"System",items:{display:{icon:"",text:"Display",desc:"Monitors, brightness, nightlight, display profile"},sound:{icon:"",text:"Sound",desc:"Volume levels, ouput, input sound devices"},noitification:{icon:"",text:"Noitification",desc:"Alerts from apps and system"},focusAssist:{icon:"",text:"Focus Assist",desc:"Notifications, automatic rules"},powerAndBatery:{icon:"",text:"Power & batery",desc:"Sleep, batery usage, batery saver"},storage:{icon:"",text:"Storage",desc:"View storage usage on driver"},troubleshoot:{icon:"",text:"Troubleshoot",desc:"Recommended troubleshooters, preferences, history"},recovery:{icon:"",text:"Recovery",desc:"Reset, advanced startup, go back"}}},bluetoothAndDevice:{icon:"imgs/icons/Misc/Bluetooth.png",text:"Bluetooth & Devices"},networkAndInternet:{icon:"imgs/icons/Misc/wifi.png",text:"Network & Intenet"},personalization:{icon:"imgs/icons/Personalization.png",iconType:"image",text:"Personalization",items:{background:{icon:"",text:"Background",desc:"Change desktop background image"},colors:{icon:"",text:"Colors",desc:"Accent color, transparency, dark theme"},lockScreen:{icon:"",text:"Lock Screen",desc:"Background image, notifications"},theme:{icon:"",text:"Themes",desc:"Customize window theme"},font:{icon:"",text:"Fonts",desc:"Browser installed fonts or install new fonts"},start:{icon:"",text:"Start",desc:"Pinned apps, remommended"},taskbar:{icon:"",text:"Taskbar",desc:"Taskbar arrangement, position"}}},apps:{icon:"imgs/icons/Misc/15.png",text:"Apps"},accounts:{icon:"imgs/icons/Users.png",iconType:"image",text:"Accounts"},timeAndLanguage:{icon:"imgs/icons/Misc/Time And Language.png",text:"Time & Language"},gaming:{icon:"imgs/icons/Misc/Gaming.png",text:"Gaming"},accessibility:{icon:"imgs/icons/Help.png",text:"Accessibility"},privacyAndSecurity:{icon:"imgs/icons/Security.png",text:"Privacy & Security"},windowUpdate:{icon:"imgs/icons/Emblems/1401.png",text:"Window Update"}},Hs=Object.keys(oi).map((e,c)=>{const v=oi[e];let b=Object.create(null);return b={name:e,icon:v.icon,text:v.text},c===0&&(b.active=!0),b});function Da(e){return _("label",{className:"button "+(e.className||"")},[_("input",{type:"file",accept:e.accept||"",className:"button "+(e.className||""),style:{display:"none"},onchange:e.onChange}),e.children])}function wt(e){return _("div",{className:"setting-nav-row flex flex-wrap"+(e.hasIcon?" has-icon":"")},[_("div",{className:"setting-nav-row-left flex-1"+(G(e.contentCenter)||G(e.itemsCenter)?" flex":"")+(e.contentCenter?" content-center":"")+(e.itemsCenter?" items-center":"")},e==null?void 0:e.contentLeft),_("div",{className:"setting-nav-row-right flex-shrink-0"},e==null?void 0:e.contentRight)])}function it(e,c){let v=!1,b,x,E;function C(){if(e.isNav){c(e.path);return}v=!v,b.classList[v?"add":"remove"]("expanded"),x.classList[v?"add":"remove"]("show"),E.classList[v?"add":"remove"]("rotate"),x.scrollIntoView()}b=_("div",{className:"setting-nav-item"+(e.isNav?"":" no-hover"),onclick:e.isNav?c.bind(null,e.path):null},[_("div",{className:"setting-nav-item-header flex"},[e.icon?_("div",{className:"setting-nav-item-icon flex items-center content-center flex-shrink-0",innerHTML:e.icon}):null,_("div",{className:"setting-nav-item-info flex-1 flex flex-col content-center"},[_("div",{className:"setting-nav-item-name flex items-center"},e.text),e.desc?_("div",{className:"setting-nav-item-desc flex items-center"},e.desc):null]),e.control?_("div",{className:"setting-nav-item-control flex items-center"},e.control):null,E=_("div",{className:"setting-nav-item-icon setting-nav-item-icon-more flex items-center content-center flex-shrink-0",innerHTML:$t,onclick:i=>{i.stopPropagation(),C()}})]),e.isNav?null:x=_("div",{className:"setting-nav-item-content"},e.content)]),e.expanded&&C();function n(i){at(x),Dt(x,i)}return{element:b,setContent:n}}function cs(e,c){return _("div",{className:"setting-nav-list"},e.map(v=>it(v,c).element))}function Ma(e,c,v){return _("div",{className:"setting-group"},[_("div",{className:"setting-label"},e),_("div",{className:"setting-items"},cs(c,v))])}function Ia(e){let c,v,b=[];function x(C){e(C)}c=_("div",{className:"settings-recent-images-container"},[_("div",{className:"settings-recent-images-header"},"Recent Images"),v=_("div",{className:"settings-recent-images flex flex-wrap"},E())]);function E(){return Se.getState("recentImages").recentImages.map((n,i)=>{let l=_("div",{key:i,className:"settings-recent-image",onclick:x.bind(null,n)},_("div",{className:"settings-recent-image-inner",style:{myBackgroundImage:n.thumbnailPath}}));return b.push({id:n.path,element:l}),l})}return Ne(oe.backgroundImageChange,"settingRecentImage",()=>{at(v),Dt(v,E())}),c}function xn(e){const{themes:c,themeIndex:v,customTheme:b}=Se.getState(["themes","themeIndex","customTheme"]),E=(v>-1?c[v]:b).backgroundImageStyle,C={};G(e.backgroundImage)&&(C.myBackgroundImage=e.backgroundImage);let n=_("div",{className:"settings-screen-preview",style:C},_("div",{className:"settings-screen-preview-inner"},[_("div",{className:"settings-screen-preview-taskbar"}),_("div",{className:"settings-screen-preview-card"},[_("div",{className:"settings-screen-preview-card-placeholder"},[_("div",{className:"settings-screen-preview-card-placeholder-line"}),_("div",{className:"settings-screen-preview-card-placeholder-line"}),_("div",{className:"settings-screen-preview-card-placeholder-line"}),_("div",{className:"settings-screen-preview-card-placeholder-line half"})]),_("div",{className:"settings-screen-preview-card-button"})])]));Vi(n,E);function i(p){n.style.myBackgroundImage=p}function l(p){Vi(n,p)}return{element:n,changeBackground:i,setBackgroundStyle:l}}function Ba(){const{themeIndex:e,themes:c,customTheme:v}=Se.getState(["themeIndex","themes","customTheme"]),x=(e>-1?c[e]:v).background,E=xn({});let C,n;C=xi({options:[{id:"solid",text:"Solid Color",value:"solid"},{id:"slideshow",text:"Slideshow",value:"slideshow"},{id:"picture",text:"Picture",value:"picture"}],value:"picture",onChange:d=>{n.setContent(p(d.value))}});function i(d){const t=d.target.files[0];if(!t)return;const s=URL.createObjectURL(t),o=nt.getState("USER_HOME").USER_HOME+"/AppData/Microsoft/Windows/Desktop/Background/",r=o+t.name,m=o+"Thumbnails/"+t.name;me.writeFile(o+t.name,t,g=>{g||rs(s,(k,D)=>{me.writeFile(m,D,w=>{if(!w){const S={name:t.name,path:r,thumbnailPath:m};$e.setBackgroundImage(S),E.changeBackground(k)}})})})}function l(){const{themeIndex:d,themes:u,customTheme:t}=Se.getState(["themeIndex","themes","customTheme"]),o=(d>-1?u[d]:t).backgroundImageStyle;return[wt({contentLeft:Ia(f)}),wt({contentLeft:"Choose a photo",contentRight:Da({accept:"image/png, image/jpeg",children:"Choose a photo",onChange:i}),itemsCenter:!0}),wt({contentLeft:"Choose a fit for your desktop image",contentRight:xi({options:[{id:"fill",text:"Fill",value:"fill"},{id:"fit",text:"Fit",value:"fit"},{id:"stretch",text:"Stretch",value:"stretch"},{id:"center",text:"Center",value:"center"},{id:"tile",text:"Tile",value:"tile"},{id:"span",text:"Span",value:"span"}],value:o.toLowerCase(),onChange:r=>{E.setBackgroundStyle(r.value),$e.setBackgroundStyle(r.value),pt({backgroundImageStyle:r.text})}}).element,itemsCenter:!0})]}function p(d){switch(d){case"solid":return wt({contentLeft:"Solid Color"});case"slideshow":return wt({contentLeft:"Slideshow"});case"picture":return l()}return""}n=it({name:"background",text:"Personalize your Background",icon:"",desc:"A picture background applies to your current desktop. Solid color or slideshow background apply to all your desktops.",path:"background",control:C.element,expanded:!0,content:l()});let a=_("div",{className:"setting-system flex flex-wrap"},[_("div",{className:"w-full background-selector"},[E.element,n.element,Ma("Related Settings",[{name:"contras theme",text:"Contrast Theme",icon:"",desc:"Color themes for low vision light sensitvity",path:"contras theme"}])])]);h(x);function h(d){E.changeBackground(d.thumbnailPath)}function f(d){h(d),$e.setBackgroundImage(d)}return{element:a,dispose:()=>{}}}function Oi(e,c,v){let b,x;function E(l){const p=l.target;typeof v=="function"&&v(p.checked),C(p.checked)}function C(l){n.classList[l?"add":"remove"]("checked"),x.innerHTML=l?br:""}const n=_("div",{className:"checkbox"},_("label",{className:"flex items-center"},[b=_("input",{type:"checkbox",style:{display:"none"},checked:c,onchange:E}),x=_("div",{className:"checkbox-mark flex items-center content-center"}),_("div",{className:"checkbox-label"},e)]));C(c);function i(l){b.checked=l,C(l)}return{element:n,setChecked:i}}function Ra(e){let c,v,b,x=0;function E(p){b=c.getBoundingClientRect(),x=i(p.clientX),l(x),document.addEventListener("mousemove",C,!1),document.addEventListener("mouseup",n,!1),e!=null&&e.onChange&&e.onChange(x),e!=null&&e.onDidChange&&e.onDidChange(x)}function C(p){p.clientX<b.left||p.clientX>b.left+b.width||(x=i(p.clientX),l(x),e!=null&&e.onChange&&e.onChange(x))}function n(){e!=null&&e.onDidChange&&e.onDidChange(x),document.removeEventListener("mousemove",C,!1),document.removeEventListener("mouseup",n,!1)}c=_("div",{className:"hue-picker",style:{position:"relative",width:"360px",height:"30px"},onmousedown:E},v=_("div",{className:"hue-picker-mark"}));function i(p=0){return p-b.left}function l(p=0){v.style.left=p-1+"px"}return{element:c,setValue:l}}function ai(e){let c=!1,v;v=_("div",{className:"toggle",onclick:()=>{b(),e.onChange&&e.onChange(c)}},[_("div",{className:"toggle-button"}),_("div",{className:"toggle-indicator"}),e.showLabel?_("div",{className:"toggle-label"},e.label):null]),x(e.checked);function b(){c=!c,v.classList.toggle("checked",c)}function x(E){c=E,v.classList.toggle("checked",c)}return{element:v,get checked(){return c},set checked(E){x(E)}}}const ui="setting-color";function Aa(){let{themes:e,themeIndex:c,customTheme:v}=Se.getState(["themes","themeIndex","customTheme"]);const b=c>-1?e[c]:v,{useTitleBarAccentColor:x,useTaskbarAndStartMenuAccentColor:E,useWindowBorderAccentColor:C,accentColor:n,transparency:i,dark:l}=b;let p=ai({label:"Dark Theme",checked:l,onChange:s=>{os(s)}}),a=ai({label:"Dark Theme",checked:i,onChange:s=>{as(s)}}),h=Ra({onChange:d,onDidChange:u}),f=_("div",{className:"setting-personalization-colors"},[it({name:"darktheme",text:"Dark Theme",icon:"",desc:"Dark theme for all windows",path:"personalization/colors/darktheme",control:p.element}).element,it({name:"transparency",text:"Transparency",icon:"",desc:"Transparency for all windows",path:"personalization/colors/transparency",control:a.element}).element,it({name:"accentColor",text:"Accent Color",icon:"",desc:"Choose your accent color",path:"personalization/colors/accentColor",expanded:!0,content:wt({contentLeft:_("div",null,h.element)})}).element,it({name:"showAccentColor",text:"Show Accent Color",icon:"",expanded:!0,desc:"Show accent color on the following surfaces",path:"personalization/colors/showAccentColor",content:wt({contentLeft:[_("div",null,Oi("Window Titlebar",x,s=>{Ft("use-titlebar-accent-color",s),pt({useTitleBarAccentColor:s})}).element),_("div",null,Oi("Start menu, Taskbar,...",E,s=>{Ft("use-startmenu-and-taskbar-accent-color",s),pt({useTaskbarAndStartMenuAccentColor:s})}).element),_("div",null,Oi("Window Borders",C,s=>{Ft("use-window-border-accent-color",s),pt({useWindowBorderAccentColor:s})}).element)]})}).element]);h.setValue(n.h);function d(s){dn({h:s,s:b.dark?100:70,l:b.dark?60:50},!1)}function u(s){pt({accentColor:{h:s,s:b.dark?100:70,l:b.dark?60:50}})}Ne(oe.themeChange,ui,s=>{p.checked=s}),Ne(oe.transparentChange,ui,s=>{a.checked=s});function t(){f.remove(),f=null,ii(oe.themeChange,ui),ii(oe.nightLightChange,ui)}return{element:f,dispose:t}}function Na(e){const{themes:c,themeIndex:v}=Se.getState(["themes","themeIndex"]);let b=v,x;function E(C,n,i){const{themeIndex:l}=Se.getState(["themeIndex"]);l>-1&&i===b||(b=i,Array.from(x.children).forEach(p=>{p.classList.remove("selected-item")}),C.classList.add("selected-item"),e(n,i))}return Ne(oe.customThemeChange,"quicktheme",()=>{Array.from(x.children).forEach(C=>{C.classList.remove("selected-item")})}),x=_("div",{className:"setting-quick-theme flex",onBeforeRemove(){ii(oe.customThemeChange,"quicktheme")}},c.map((C,n)=>_("div",{className:"setting-quick-theme-item"+(n===b?" active selected-item":""),onclick:i=>{E(i.currentTarget,C,n)}},_("div",{className:"setting-quick-theme-item-inner"},[_("div",{className:"setting-quick-theme-item-image",style:{backgroundImage:`url("${C.background.thumbnailPath}")`}}),_("div",{className:"setting-quick-theme-item-color flex items-end content-center",style:{backgroundColor:C.dark?"#333":"#f8f8f8"}},_("div",{className:"setting-quick-theme-item-color-accent",style:{backgroundColor:`hsl(${C.accentColor.h},${C.accentColor.s}%,${C.accentColor.l}%)`}}))])))),x}function Pa(e){let c=oi.personalization.items,v;v=Object.keys(c).map(u=>{const t=c[u];return{isNav:!0,name:u,text:t.text,icon:t.icon,desc:t.desc,path:"personalization/"+u}});const{roundedCorner:b,useBorder:x,themes:E,themeIndex:C,customTheme:n}=Se.getState(["roundedCorner","useBorder","backgroundImage","themes","themeIndex","customTheme"]),i=C>-1?E[C]:n;Ki(b);const l={isNav:!1,name:"roundedCorner",icon:"",text:"Rounded Corner",desc:"Atjust window and controls corner radius",path:"personalization/roundedCorner",control:ai({label:"Rounded Corner",checked:b,onChange:u=>{Ki(u),Se.setState({roundedCorner:u})}}).element},p={isNav:!1,name:"useBorder",icon:"",text:"Window Border",desc:"Show window border",path:"personalization/useBorder",control:ai({checked:x,onChange:u=>{hn(u),Se.setState({useBorder:u})}}).element},a=xn({});function h(u,t,s=!0){fn(u),d(u.background),s&&Se.setState({themeIndex:t})}let f=_("div",{className:"setting-personalization"},[_("div",{className:"w-full flex flex-wrap"},[_("div",{style:{marginTop:"28px",marginRight:"40px"}},a.element),_("div",{className:"flex-1"},[_("div",{style:{height:"26px",fontWeight:"bold",fontSize:"14px"}},"Select a theme to apply"),Na(h)])]),cs(v,e),it(l,e).element,it(p,e).element]);d(i.background);function d(u){a.changeBackground(u.thumbnailPath)}return{element:f,dispose:()=>{}}}function Cn(e){return e?_("div",{className:"setting-help flex-shrink-0"},[e.relates&&_("div",{className:"setting-system-help-items"},e.relates.map(c=>{var v;return _("div",{className:"setting-system-help-item",onclick:(v=c.onClick)==null?void 0:v.bind(null,c.name)},[_("div",{className:"setting-system-help-item-label"},c.text),_("div",{className:"setting-system-help-item-content"},c.desc)])})),e.actions&&_("div",{className:"setting-system-help-actions"},[_("div",{className:"setting-system-help-item-label"},"Have a question?"),_("div",{className:"setting-system-help-actions-list"},e.actions.map(c=>{var v;return _("div",{onclick:(v=c.onClick)==null?void 0:v.bind(null,c.name),className:"setting-system-help-item-link"},c.text)}))])]):null}function Ha(){const e=()=>"settings/system/",{nightlight:c}=Se.getState("nightlight"),v=ai({checked:c,onChange:()=>{ni.toogleNightLight()}});Ne(oe.nightLightChange,"settings-display-nightlight",i=>{v.checked=i});const b=[{path:"",text:"Night light",desc:"Use warmer colors to help block blue light",icon:"",name:"nightlight",control:v.element,content:wt({itemsCenter:!0,contentLeft:"Atjust the color of the screen to help block blue light"})},{path:"",text:"HDR",desc:"More about HDR",icon:"",name:"nightlight"}],x=it(b[0]),E=it(b[1]);let C=_("div",{className:"setting-system-display flex flex-wrap",onBeforeRemove(){ii(oe.nightLightChange,"settings-display-nightlight")}},[_("div",{className:"flex-1"},_("div",{className:"setting-system-main-content"},[x.element,E.element])),Cn({relates:[{name:e()+"nightlight",text:"Sleep better",desc:"Nightlight can help you get to sleep by displaying warmer colors at night. Select Night light settings to set things up."}],actions:[{name:"",text:"Changing screen brightness",desc:""},{name:"",text:"Adjusting font size",desc:""}]})]);function n(){C.remove(),C=null}return{element:C,dispose:n}}function Oa(e){return _("button",{className:"button "+(e.className||""),onclick:e.onclick},e.children)}function Fa(){let e=_("div",{className:"setting-recovery"},[_("div",{},"If you're having problems with your PC or want to reset it, these recovery options might help"),_("div",{},[it({path:"",text:"Reset this PC",desc:"Choose or keep your personal files, then reinstall Windows",icon:"",name:"recovery",control:Oa({children:"Reset PC",onclick(){jo()}})}).element])]);function c(){e=null}return{element:e,dispose:c}}function za(){const{themes:e,themeIndex:c,customTheme:v}=Se.getState(["themes","themeIndex","customTheme"]),x=(c>-1?e[c]:v).background;let E;const{USER_NAME:C}=nt.getState("USER_NAME");let n=_("div",{className:"setting-system-overall",onBeforeRemove(){ii(oe.backgroundImageChange,"setting-system")}},[_("div",{className:"flex"},[_("div",{className:"setting-system-desktop relative"},E=_("div",{className:"setting-system-desktop-inner image-cover"})),_("div",{className:"setting-system-info"},[_("div",{className:"setting-system-info-name"},`${C}`),_("div",{className:"setting-system-info-role"},"Administrator"),_("div",{className:"setting-system-info-action"},"Rename")])]),_("div",{className:"setting-system-office flex"},[_("div",{className:"setting-system-office-onedrive flex"},[_("div",{className:"setting-system-office-onedrive-icon flex items-center content-center"}),_("div",{className:"setting-system-office-onedrive-info"},[_("div",{className:"setting-system-office-onedrive-info-name"},"OneDrive"),_("div",{className:"setting-system-office-onedrive-info-action"},"Manage")])])])]);x&&i(x.path),Ne(oe.backgroundImageChange,"setting-system",l=>{i(l.path)});function i(l){E.style.myBackgroundImage=l}return n}function Wa(e){let c=oi.system.items,v;v=Object.keys(c).map(E=>{const C=c[E];return{isNav:!0,name:E,text:C.text,icon:C.icon,iconType:C.iconType,desc:C.desc,path:"system/"+E}});let b=_("div",{className:"setting-system flex flex-wrap"},[_("div",{className:"flex-1"},_("div",{className:"setting-system-main-content"},[za(),cs(v,e)])),Cn()]);function x(){b.remove(),b=null}return{element:b,dispose:x}}function Oe(){let e=_("div",{},"In progress");function c(){e.remove(),e=null}return{element:e,dispose:c}}const $a={system:{content:Wa,children:{display:{content:Ha},sound:{content:Oe},noitification:{content:Oe},focusAssist:{content:Oe},powerAndBatery:{content:Oe},storage:{content:Oe},troubleshoot:{content:Oe},recovery:{content:Fa}}},bluetoothAndDevice:{content:Oe},networkAndInternet:{content:Oe},personalization:{content:Pa,children:{background:{content:Ba},colors:{content:Aa},lockScreen:{content:Oe},theme:{content:Oe},font:{content:Oe},start:{content:Oe},taskbar:{content:Oe}}},apps:{content:Oe},accounts:{content:Oe},timeAndLanguage:{content:Oe},gaming:{content:Oe},accessibility:{content:Oe},privacyAndSecurity:{content:Oe},windowUpdate:{content:Oe}};function Ua(e,c,v){let b=_("div",{className:"setting-sidebar-nav-item flex items-center"+(e.active?" active":""),onclick:()=>v(e,b,c)},[_("div",{className:"setting-sidebar-nav-item-icon flex-shrink-0",style:{backgroundImage:`url("${e.icon}")`}}),_("div",{className:"setting-sidebar-nav-item-text"},e.text)]);return b}function ja(e){const c=Hs.map((i,l)=>Ua(i,l,C));let v=0,b=c[0];b.classList.add("active");let x=Li({placeholder:"Find a Setting"}),E=_("div",{className:"setting-sidebar h-full flex-shrink-0"},_("div",{className:"setting-sidebar-inner standard-content w-full h-full"},_("div",{className:"w-full h-full flex flex-col"},[_("div",{className:"setting-sidebar-heading"},x.element),_("div",{tabIndex:0,className:"setting-sidebar-nav scrollable scroll-y"},c)])));function C(i,l,p){p!==v&&(b.classList.remove("active"),l.classList.add("active"),v=p,b=l,e(i.name))}function n(i){const l=i.split("/")[0];if(l){const p=Hs.findIndex(a=>a.name===l);if(p>-1){b.classList.remove("active");let a=c[p];v=p,a.classList.add("active"),b=a}}}return{element:E,setRoute:n}}function Va(e){let c;const v=_("div",{className:"setting-content-heading flex-shrink-0 flex items-center"},c=_("div",{className:"setting-content-heading-item"},"System"));function b(x){const E=_("div",{className:"w-full flex items-center"},x.map((C,n)=>{let i=_("div",{className:"setting-content-heading-route flex items-center"+(n===x.length-1&&n>0?" disabled":""),onclick:x.length-1?e.bind(null,C.path):null},C.text);return n>0&&i.prepend(_("div",{className:"setting-content-heading-route-divider flex-center",innerHTML:$t})),i}));c.innerHTML="",c.appendChild(E)}return{element:v,setRoute:b}}function Ka(e){let c;const v=Va(e);let b,x=_("div",{className:"setting-content w-full h-full"},_("div",{className:"setting-content-inner standard-content w-full h-full flex flex-col"},[v.element,b=_("div",{tabIndex:0,className:"setting-content-main scrollable scroll-y"})]));function E(C){const n=C.split("/"),i=n.length;if(i===0)return;let l=$a[n[0]];if(!l)return;c&&c.dispose();let p;i===1?p=l.content(e):i===2&&(p=l.children[n[1]].content(e)),c=p;const a=n.reduce((h,f,d)=>(h.path+=f,h.currentSetting=d===0?oi[f]:h.currentSetting.items[f],h.routes.push({text:h.currentSetting.text,path:h.path}),d<i-1&&(h.path+="/"),h),{routes:[],path:"",currentSetting:Object.create(null)});v.setRoute(a.routes),at(b),b.scrollTop=0,b.appendChild(p.element)}return{element:x,update:E}}const qa=e=>{const c=function(b){let x=ja(n),E=Ka(n);function C(i){x.setRoute(i),E.update(i)}e?C(e):E.update("system"),b.addEventListener("secondInstance",i=>{b.isVisible()||b.show(),b.focus(),i&&C(i)});function n(i){E.update(i)}return _("div",{className:"app-settings w-full h-full"},_("div",{className:"setting-inner flex w-full h-full"},[x.element,E.element]))},v=_("div",{className:"w-full h-full flex items-center"},[_("div",{["drag-region"]:"drag",className:"flex-1 h-full"}),_("div",{className:"setting-user-info-avatar",style:{padding:"6px"}},_("div",{className:"setting-user-info-avatar-image w-full h-full",style:{marginLeft:"auto",backgroundImage:`url("${ur}")`,backgroundSize:"cover"}}))]);lt({args:e,icon:Q.settings.icon,name:Q.settings.name,title:Q.settings.productName,singleInstance:!0,titlebarHeight:36,titlebarContent:v,top:200,left:300,minWidth:700,minHeight:400,width:1e3,height:540,center:!0,fluidContent:!0,transprencyContent:!0,content:c})};function Xa(e){const x=ts("calculator",{top:50,left:Ce.width-380-50});let{top:E,left:C}=x.getState();E>Ce.height-We-Mt&&(E=50),C>Ce.width-380-50&&(C=Ce.width-380-50);let n,i;const l=xi({options:[{id:"standard",value:"standard",text:"Standard"},{id:"scientific",value:"scientific",text:"Scientific"},{id:"programmer",value:"programmer",text:"Programmer"}],value:"standard",noBackground:!0,onChange(u){p(u.value),n.setContent(i)}});n=lt({icon:Q.calculator.icon,name:Q.calculator.name,title:Q.calculator.productName,titlebarHeight:36,titlebarContent:l.element,top:E,left:C,width:380,height:500,disableResize:!0,disableMaximize:!0,transprencyContent:!0}),n.addEventListener("dragend",u=>{x.setState({top:u.top,left:u.left})}),n.addEventListener("focus",()=>{i.focus()}),p("standard"),n.setContent(i);function p(u){switch(u){case"standard":i=h();break;case"scientific":i=f();break;case"programmer":i=d();break;default:i=h();break}}function a(u,t){const s={};return u.type==="command"&&u.value==="="&&(s.color="var(--accent-color)"),_("div",{className:"calculator-button flex flex-1 items-center content-center"+(u.type==="number"?" emphasis":""),onclick:t.bind(null,u.type,u.value),innerHTML:u.content,style:s})}function h(){let u,t,s,o="",r="",m="",g=48;function k(){let P;const F=parseFloat(o);let L=parseFloat(r);if(!(isNaN(F)||isNaN(L))){switch(m){case"+":P=F+L;break;case"-":P=F-L;break;case"x":P=F*L;break;case"/":P=F/L;break}r=P.toString(),m=null,o=""}}function D(){o="",m="",w()}function w(){r="0",t.style.removeProperty("font-size")}function S(P){const F=P.toString(),L=parseFloat(F.split(".")[0]),B=F.split(".")[1];let O;return isNaN(L)?O="":O=L.toLocaleString("en",{maximumFractionDigits:0}),B!=null?`${O}.${B}`:O}function M(P){P==="."&&r.includes(".")||(r=r.toString()+P.toString())}function I(P){r!==""&&(o!==""&&k(),m=P,o=r,r="")}function y(P){t.scrollWidth>t.offsetWidth&&(P-=2,t.style.fontSize=P+"px",y(P))}function T(){u.textContent=S(parseFloat(r)),y(g),G(m)?s.textContent=`${S(parseFloat(o))} ${m}`:s.textContent=""}function A(P,F){if(P==="number")M(F),T();else if(P==="operator")I(F),T();else if(P==="command"){switch(F){case"c":D();break;case"ce":w();break;case"=":k();break;case"sqrt":r=Math.sqrt(parseFloat(r)).toString();break;case"negative":r=(parseFloat(r)*-1).toString();break}T()}}function H(P){let F=/[0-9]/g,L=/[+\-*\/]/g;P.key.match(F)&&(P.preventDefault(),M(P.key),T()),P.key==="."&&(P.preventDefault(),M(P.key),T()),P.key.match(L)&&(P.preventDefault(),I(P.key),T()),(P.key==="Enter"||P.key==="=")&&(P.preventDefault(),k(),T()),P.key==="Backspace"&&(P.preventDefault(),w(),T()),P.key==="Delete"&&(P.preventDefault(),D(),T())}return _("div",{tabIndex:-1,className:"w-full h-full flex flex-col",onkeydown:H},[_("div",{className:"w-full calculator-display flex flex-col"},[s=_("div",{className:"calculator-display-input flex items-center content-end"}),t=_("div",{className:"calculator-display-result flex-1 flex items-center content-end no-scrollbar"},u=_("div",{className:"w-full"},"0"))]),_("div",{className:"w-full h-full calculator-buttons flex flex-col"},[_("div",{className:"w-full calculator-buttons-row flex flex-1"},[a({type:"command",value:"sqrt",content:'<svg class="svg-icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M277.7 843.7h-35.6L93.6 483.2h-76V445h105.6l132.6 330.4 159.6-635.1h37.8L277.7 843.7zM831.6 773.7L697.7 578.8 563.4 773.7h-45.1l155.4-223.6-148.1-212.5h46.8l125.3 183.7 124.9-183.7h47.2L722.2 549.2l157.1 224.4h-47.7z"  /><path d="M984.5 176h-568v-37.1h568V176z"  /></svg>'},A),a({type:"command",value:"ce",content:"CE"},A),a({type:"command",value:"c",content:"C"},A),a({type:"operator",value:"/",content:"/"},A)]),_("div",{className:"w-full calculator-buttons-row flex flex-1"},[a({type:"number",value:"7",content:"7"},A),a({type:"number",value:"8",content:"8"},A),a({type:"number",value:"9",content:"9"},A),a({type:"operator",value:"x",content:"&#215;"},A)]),_("div",{className:"w-full calculator-buttons-row flex flex-1"},[a({type:"number",value:"4",content:"4"},A),a({type:"number",value:"5",content:"5"},A),a({type:"number",value:"6",content:"6"},A),a({type:"operator",value:"-",content:"&#8722;"},A)]),_("div",{className:"w-full calculator-buttons-row flex flex-1"},[a({type:"number",value:"1",content:"1"},A),a({type:"number",value:"2",content:"2"},A),a({type:"number",value:"3",content:"3"},A),a({type:"operator",value:"+",content:"+"},A)]),_("div",{className:"w-full calculator-buttons-row flex flex-1"},[a({type:"command",value:"negative",content:"+/-"},A),a({type:"number",value:"0",content:"0"},A),a({type:"number",value:".",content:"."},A),a({type:"command",value:"=",content:"="},A)])])])}function f(){return _("div",{className:"w-full h-full flex content-center items-center"},_("h1",{},"Scientific Calculator"))}function d(){return _("div",{className:"w-full h-full flex content-center items-center"},_("h1",{},"Programmer Calculator"))}}var Yi={},Ga={get exports(){return Yi},set exports(e){Yi=e}};(function(e,c){(function(v,b){e.exports=b()})(self,()=>(()=>{var v={4567:function(C,n,i){var l=this&&this.__decorate||function(r,m,g,k){var D,w=arguments.length,S=w<3?m:k===null?k=Object.getOwnPropertyDescriptor(m,g):k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(r,m,g,k);else for(var M=r.length-1;M>=0;M--)(D=r[M])&&(S=(w<3?D(S):w>3?D(m,g,S):D(m,g))||S);return w>3&&S&&Object.defineProperty(m,g,S),S},p=this&&this.__param||function(r,m){return function(g,k){m(g,k,r)}};Object.defineProperty(n,"__esModule",{value:!0}),n.AccessibilityManager=void 0;const a=i(9042),h=i(6114),f=i(9924),d=i(844),u=i(5596),t=i(4725),s=i(3656);let o=n.AccessibilityManager=class extends d.Disposable{constructor(r,m){super(),this._terminal=r,this._renderService=m,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let g=0;g<this._terminal.rows;g++)this._rowElements[g]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[g]);if(this._topBoundaryFocusListener=g=>this._handleBoundaryFocus(g,0),this._bottomBoundaryFocusListener=g=>this._handleBoundaryFocus(g,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new f.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(g=>this._handleResize(g.rows))),this.register(this._terminal.onRender(g=>this._refreshRows(g.start,g.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(g=>this._handleChar(g))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(g=>this._handleTab(g))),this.register(this._terminal.onKey(g=>this._handleKey(g.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new u.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,s.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,d.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(r){for(let m=0;m<r;m++)this._handleChar(" ")}_handleChar(r){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==r&&(this._charsToAnnounce+=r):this._charsToAnnounce+=r,r===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=a.tooMuchOutput)),h.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,h.isMac&&this._liveRegion.remove()}_handleKey(r){this._clearLiveRegion(),/\p{Control}/u.test(r)||this._charsToConsume.push(r)}_refreshRows(r,m){this._liveRegionDebouncer.refresh(r,m,this._terminal.rows)}_renderRows(r,m){const g=this._terminal.buffer,k=g.lines.length.toString();for(let D=r;D<=m;D++){const w=g.translateBufferLineToString(g.ydisp+D,!0),S=(g.ydisp+D+1).toString(),M=this._rowElements[D];M&&(w.length===0?M.innerText=" ":M.textContent=w,M.setAttribute("aria-posinset",S),M.setAttribute("aria-setsize",k))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(r,m){const g=r.target,k=this._rowElements[m===0?1:this._rowElements.length-2];if(g.getAttribute("aria-posinset")===(m===0?"1":`${this._terminal.buffer.lines.length}`)||r.relatedTarget!==k)return;let D,w;if(m===0?(D=g,w=this._rowElements.pop(),this._rowContainer.removeChild(w)):(D=this._rowElements.shift(),w=g,this._rowContainer.removeChild(D)),D.removeEventListener("focus",this._topBoundaryFocusListener),w.removeEventListener("focus",this._bottomBoundaryFocusListener),m===0){const S=this._createAccessibilityTreeNode();this._rowElements.unshift(S),this._rowContainer.insertAdjacentElement("afterbegin",S)}else{const S=this._createAccessibilityTreeNode();this._rowElements.push(S),this._rowContainer.appendChild(S)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(m===0?-1:1),this._rowElements[m===0?1:this._rowElements.length-2].focus(),r.preventDefault(),r.stopImmediatePropagation()}_handleResize(r){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let m=this._rowContainer.children.length;m<this._terminal.rows;m++)this._rowElements[m]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[m]);for(;this._rowElements.length>r;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const r=document.createElement("div");return r.setAttribute("role","listitem"),r.tabIndex=-1,this._refreshRowDimensions(r),r}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let r=0;r<this._terminal.rows;r++)this._refreshRowDimensions(this._rowElements[r])}}_refreshRowDimensions(r){r.style.height=`${this._renderService.dimensions.css.cell.height}px`}};n.AccessibilityManager=o=l([p(1,t.IRenderService)],o)},3614:(C,n)=>{function i(h){return h.replace(/\r?\n/g,"\r")}function l(h,f){return f?"\x1B[200~"+h+"\x1B[201~":h}function p(h,f,d,u){h=l(h=i(h),d.decPrivateModes.bracketedPasteMode&&u.rawOptions.ignoreBracketedPasteMode!==!0),d.triggerDataEvent(h,!0),f.value=""}function a(h,f,d){const u=d.getBoundingClientRect(),t=h.clientX-u.left-10,s=h.clientY-u.top-10;f.style.width="20px",f.style.height="20px",f.style.left=`${t}px`,f.style.top=`${s}px`,f.style.zIndex="1000",f.focus()}Object.defineProperty(n,"__esModule",{value:!0}),n.rightClickHandler=n.moveTextAreaUnderMouseCursor=n.paste=n.handlePasteEvent=n.copyHandler=n.bracketTextForPaste=n.prepareTextForTerminal=void 0,n.prepareTextForTerminal=i,n.bracketTextForPaste=l,n.copyHandler=function(h,f){h.clipboardData&&h.clipboardData.setData("text/plain",f.selectionText),h.preventDefault()},n.handlePasteEvent=function(h,f,d,u){h.stopPropagation(),h.clipboardData&&p(h.clipboardData.getData("text/plain"),f,d,u)},n.paste=p,n.moveTextAreaUnderMouseCursor=a,n.rightClickHandler=function(h,f,d,u,t){a(h,f,d),t&&u.rightClickSelect(h),f.value=u.selectionText,f.select()}},7239:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorContrastCache=void 0;const l=i(1505);n.ColorContrastCache=class{constructor(){this._color=new l.TwoKeyMap,this._css=new l.TwoKeyMap}setCss(p,a,h){this._css.set(p,a,h)}getCss(p,a){return this._css.get(p,a)}setColor(p,a,h){this._color.set(p,a,h)}getColor(p,a){return this._color.get(p,a)}clear(){this._color.clear(),this._css.clear()}}},3656:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.addDisposableDomListener=void 0,n.addDisposableDomListener=function(i,l,p,a){i.addEventListener(l,p,a);let h=!1;return{dispose:()=>{h||(h=!0,i.removeEventListener(l,p,a))}}}},6465:function(C,n,i){var l=this&&this.__decorate||function(t,s,o,r){var m,g=arguments.length,k=g<3?s:r===null?r=Object.getOwnPropertyDescriptor(s,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(t,s,o,r);else for(var D=t.length-1;D>=0;D--)(m=t[D])&&(k=(g<3?m(k):g>3?m(s,o,k):m(s,o))||k);return g>3&&k&&Object.defineProperty(s,o,k),k},p=this&&this.__param||function(t,s){return function(o,r){s(o,r,t)}};Object.defineProperty(n,"__esModule",{value:!0}),n.Linkifier2=void 0;const a=i(3656),h=i(8460),f=i(844),d=i(2585);let u=n.Linkifier2=class extends f.Disposable{get currentLink(){return this._currentLink}constructor(t){super(),this._bufferService=t,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new h.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new h.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,f.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,f.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}registerLinkProvider(t){return this._linkProviders.push(t),{dispose:()=>{const s=this._linkProviders.indexOf(t);s!==-1&&this._linkProviders.splice(s,1)}}}attachToDom(t,s,o){this._element=t,this._mouseService=s,this._renderService=o,this.register((0,a.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,a.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,a.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,a.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(t){if(this._lastMouseEvent=t,!this._element||!this._mouseService)return;const s=this._positionFromMouseEvent(t,this._element,this._mouseService);if(!s)return;this._isMouseOut=!1;const o=t.composedPath();for(let r=0;r<o.length;r++){const m=o[r];if(m.classList.contains("xterm"))break;if(m.classList.contains("xterm-hover"))return}this._lastBufferCell&&s.x===this._lastBufferCell.x&&s.y===this._lastBufferCell.y||(this._handleHover(s),this._lastBufferCell=s)}_handleHover(t){if(this._activeLine!==t.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(t,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,t)||(this._clearCurrentLink(),this._askForLink(t,!0))}_askForLink(t,s){var o,r;this._activeProviderReplies&&s||((o=this._activeProviderReplies)===null||o===void 0||o.forEach(g=>{g==null||g.forEach(k=>{k.link.dispose&&k.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=t.y);let m=!1;for(const[g,k]of this._linkProviders.entries())s?!((r=this._activeProviderReplies)===null||r===void 0)&&r.get(g)&&(m=this._checkLinkProviderResult(g,t,m)):k.provideLinks(t.y,D=>{var w,S;if(this._isMouseOut)return;const M=D==null?void 0:D.map(I=>({link:I}));(w=this._activeProviderReplies)===null||w===void 0||w.set(g,M),m=this._checkLinkProviderResult(g,t,m),((S=this._activeProviderReplies)===null||S===void 0?void 0:S.size)===this._linkProviders.length&&this._removeIntersectingLinks(t.y,this._activeProviderReplies)})}_removeIntersectingLinks(t,s){const o=new Set;for(let r=0;r<s.size;r++){const m=s.get(r);if(m)for(let g=0;g<m.length;g++){const k=m[g],D=k.link.range.start.y<t?0:k.link.range.start.x,w=k.link.range.end.y>t?this._bufferService.cols:k.link.range.end.x;for(let S=D;S<=w;S++){if(o.has(S)){m.splice(g--,1);break}o.add(S)}}}}_checkLinkProviderResult(t,s,o){var r;if(!this._activeProviderReplies)return o;const m=this._activeProviderReplies.get(t);let g=!1;for(let k=0;k<t;k++)this._activeProviderReplies.has(k)&&!this._activeProviderReplies.get(k)||(g=!0);if(!g&&m){const k=m.find(D=>this._linkAtPosition(D.link,s));k&&(o=!0,this._handleNewLink(k))}if(this._activeProviderReplies.size===this._linkProviders.length&&!o)for(let k=0;k<this._activeProviderReplies.size;k++){const D=(r=this._activeProviderReplies.get(k))===null||r===void 0?void 0:r.find(w=>this._linkAtPosition(w.link,s));if(D){o=!0,this._handleNewLink(D);break}}return o}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(t){if(!this._element||!this._mouseService||!this._currentLink)return;const s=this._positionFromMouseEvent(t,this._element,this._mouseService);s&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,s)&&this._currentLink.link.activate(t,this._currentLink.link.text)}_clearCurrentLink(t,s){this._element&&this._currentLink&&this._lastMouseEvent&&(!t||!s||this._currentLink.link.range.start.y>=t&&this._currentLink.link.range.end.y<=s)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,f.disposeArray)(this._linkCacheDisposables))}_handleNewLink(t){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const s=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);s&&this._linkAtPosition(t.link,s)&&(this._currentLink=t,this._currentLink.state={decorations:{underline:t.link.decorations===void 0||t.link.decorations.underline,pointerCursor:t.link.decorations===void 0||t.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,t.link,this._lastMouseEvent),t.link.decorations={},Object.defineProperties(t.link.decorations,{pointerCursor:{get:()=>{var o,r;return(r=(o=this._currentLink)===null||o===void 0?void 0:o.state)===null||r===void 0?void 0:r.decorations.pointerCursor},set:o=>{var r,m;!((r=this._currentLink)===null||r===void 0)&&r.state&&this._currentLink.state.decorations.pointerCursor!==o&&(this._currentLink.state.decorations.pointerCursor=o,this._currentLink.state.isHovered&&((m=this._element)===null||m===void 0||m.classList.toggle("xterm-cursor-pointer",o)))}},underline:{get:()=>{var o,r;return(r=(o=this._currentLink)===null||o===void 0?void 0:o.state)===null||r===void 0?void 0:r.decorations.underline},set:o=>{var r,m,g;!((r=this._currentLink)===null||r===void 0)&&r.state&&((g=(m=this._currentLink)===null||m===void 0?void 0:m.state)===null||g===void 0?void 0:g.decorations.underline)!==o&&(this._currentLink.state.decorations.underline=o,this._currentLink.state.isHovered&&this._fireUnderlineEvent(t.link,o))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(o=>{if(!this._currentLink)return;const r=o.start===0?0:o.start+1+this._bufferService.buffer.ydisp,m=this._bufferService.buffer.ydisp+1+o.end;if(this._currentLink.link.range.start.y>=r&&this._currentLink.link.range.end.y<=m&&(this._clearCurrentLink(r,m),this._lastMouseEvent&&this._element)){const g=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);g&&this._askForLink(g,!1)}})))}_linkHover(t,s,o){var r;!((r=this._currentLink)===null||r===void 0)&&r.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(s,!0),this._currentLink.state.decorations.pointerCursor&&t.classList.add("xterm-cursor-pointer")),s.hover&&s.hover(o,s.text)}_fireUnderlineEvent(t,s){const o=t.range,r=this._bufferService.buffer.ydisp,m=this._createLinkUnderlineEvent(o.start.x-1,o.start.y-r-1,o.end.x,o.end.y-r-1,void 0);(s?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(m)}_linkLeave(t,s,o){var r;!((r=this._currentLink)===null||r===void 0)&&r.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(s,!1),this._currentLink.state.decorations.pointerCursor&&t.classList.remove("xterm-cursor-pointer")),s.leave&&s.leave(o,s.text)}_linkAtPosition(t,s){const o=t.range.start.y*this._bufferService.cols+t.range.start.x,r=t.range.end.y*this._bufferService.cols+t.range.end.x,m=s.y*this._bufferService.cols+s.x;return o<=m&&m<=r}_positionFromMouseEvent(t,s,o){const r=o.getCoords(t,s,this._bufferService.cols,this._bufferService.rows);if(r)return{x:r[0],y:r[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(t,s,o,r,m){return{x1:t,y1:s,x2:o,y2:r,cols:this._bufferService.cols,fg:m}}};n.Linkifier2=u=l([p(0,d.IBufferService)],u)},9042:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.tooMuchOutput=n.promptLabel=void 0,n.promptLabel="Terminal input",n.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(C,n,i){var l=this&&this.__decorate||function(u,t,s,o){var r,m=arguments.length,g=m<3?t:o===null?o=Object.getOwnPropertyDescriptor(t,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(u,t,s,o);else for(var k=u.length-1;k>=0;k--)(r=u[k])&&(g=(m<3?r(g):m>3?r(t,s,g):r(t,s))||g);return m>3&&g&&Object.defineProperty(t,s,g),g},p=this&&this.__param||function(u,t){return function(s,o){t(s,o,u)}};Object.defineProperty(n,"__esModule",{value:!0}),n.OscLinkProvider=void 0;const a=i(511),h=i(2585);let f=n.OscLinkProvider=class{constructor(u,t,s){this._bufferService=u,this._optionsService=t,this._oscLinkService=s}provideLinks(u,t){var s;const o=this._bufferService.buffer.lines.get(u-1);if(!o)return void t(void 0);const r=[],m=this._optionsService.rawOptions.linkHandler,g=new a.CellData,k=o.getTrimmedLength();let D=-1,w=-1,S=!1;for(let M=0;M<k;M++)if(w!==-1||o.hasContent(M)){if(o.loadCell(M,g),g.hasExtendedAttrs()&&g.extended.urlId){if(w===-1){w=M,D=g.extended.urlId;continue}S=g.extended.urlId!==D}else w!==-1&&(S=!0);if(S||w!==-1&&M===k-1){const I=(s=this._oscLinkService.getLinkData(D))===null||s===void 0?void 0:s.uri;if(I){const y={start:{x:w+1,y:u},end:{x:M+(S||M!==k-1?0:1),y:u}};let T=!1;if(!(m!=null&&m.allowNonHttpProtocols))try{const A=new URL(I);["http:","https:"].includes(A.protocol)||(T=!0)}catch{T=!0}T||r.push({text:I,range:y,activate:(A,H)=>m?m.activate(A,H,y):d(0,H),hover:(A,H)=>{var P;return(P=m==null?void 0:m.hover)===null||P===void 0?void 0:P.call(m,A,H,y)},leave:(A,H)=>{var P;return(P=m==null?void 0:m.leave)===null||P===void 0?void 0:P.call(m,A,H,y)}})}S=!1,g.hasExtendedAttrs()&&g.extended.urlId?(w=M,D=g.extended.urlId):(w=-1,D=-1)}}t(r)}};function d(u,t){if(confirm(`Do you want to navigate to ${t}?

WARNING: This link could potentially be dangerous`)){const s=window.open();if(s){try{s.opener=null}catch{}s.location.href=t}else console.warn("Opening link blocked as opener could not be cleared")}}n.OscLinkProvider=f=l([p(0,h.IBufferService),p(1,h.IOptionsService),p(2,h.IOscLinkService)],f)},6193:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.RenderDebouncer=void 0,n.RenderDebouncer=class{constructor(i,l){this._parentWindow=i,this._renderCallback=l,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(i){return this._refreshCallbacks.push(i),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(i,l,p){this._rowCount=p,i=i!==void 0?i:0,l=l!==void 0?l:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,i):i,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,l):l,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const i=Math.max(this._rowStart,0),l=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(i,l),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const i of this._refreshCallbacks)i(0);this._refreshCallbacks=[]}}},5596:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ScreenDprMonitor=void 0;const l=i(844);class p extends l.Disposable{constructor(h){super(),this._parentWindow=h,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,l.toDisposable)(()=>{this.clearListener()}))}setListener(h){this._listener&&this.clearListener(),this._listener=h,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var h;this._outerListener&&((h=this._resolutionMediaMatchList)===null||h===void 0||h.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}n.ScreenDprMonitor=p},3236:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Terminal=void 0;const l=i(3614),p=i(3656),a=i(6465),h=i(9042),f=i(3730),d=i(1680),u=i(3107),t=i(5744),s=i(2950),o=i(1296),r=i(428),m=i(4269),g=i(5114),k=i(8934),D=i(3230),w=i(9312),S=i(4725),M=i(6731),I=i(8055),y=i(8969),T=i(8460),A=i(844),H=i(6114),P=i(8437),F=i(2584),L=i(7399),B=i(5941),O=i(9074),N=i(2585),z=i(5435),W=i(4567),U=typeof window<"u"?window.document:null;class j extends y.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(R={}){super(R),this.browser=H,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new A.MutableDisposable),this._onCursorMove=this.register(new T.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new T.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new T.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new T.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new T.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new T.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new T.EventEmitter),this._onBlur=this.register(new T.EventEmitter),this._onA11yCharEmitter=this.register(new T.EventEmitter),this._onA11yTabEmitter=this.register(new T.EventEmitter),this._onWillOpen=this.register(new T.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(a.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(f.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(O.DecorationService),this._instantiationService.setService(N.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows(($,q)=>this.refresh($,q))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport($=>this._reportWindowsOptions($))),this.register(this._inputHandler.onColor($=>this._handleColorEvent($))),this.register((0,T.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,T.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,T.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,T.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize($=>this._afterResize($.cols,$.rows))),this.register((0,A.toDisposable)(()=>{var $,q;this._customKeyEventHandler=void 0,(q=($=this.element)===null||$===void 0?void 0:$.parentNode)===null||q===void 0||q.removeChild(this.element)}))}_handleColorEvent(R){if(this._themeService)for(const $ of R){let q,X="";switch($.index){case 256:q="foreground",X="10";break;case 257:q="background",X="11";break;case 258:q="cursor",X="12";break;default:q="ansi",X="4;"+$.index}switch($.type){case 0:const se=I.color.toColorRGB(q==="ansi"?this._themeService.colors.ansi[$.index]:this._themeService.colors[q]);this.coreService.triggerDataEvent(`${F.C0.ESC}]${X};${(0,B.toRgbString)(se)}${F.C1_ESCAPED.ST}`);break;case 1:if(q==="ansi")this._themeService.modifyColors(V=>V.ansi[$.index]=I.rgba.toColor(...$.color));else{const V=q;this._themeService.modifyColors(he=>he[V]=I.rgba.toColor(...$.color))}break;case 2:this._themeService.restoreColor($.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(R){R?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(W.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(R){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(F.C0.ESC+"[I"),this.updateCursorStyle(R),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var R;return(R=this.textarea)===null||R===void 0?void 0:R.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(F.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const R=this.buffer.ybase+this.buffer.y,$=this.buffer.lines.get(R);if(!$)return;const q=Math.min(this.buffer.x,this.cols-1),X=this._renderService.dimensions.css.cell.height,se=$.getWidth(q),V=this._renderService.dimensions.css.cell.width*se,he=this.buffer.y*this._renderService.dimensions.css.cell.height,ke=q*this._renderService.dimensions.css.cell.width;this.textarea.style.left=ke+"px",this.textarea.style.top=he+"px",this.textarea.style.width=V+"px",this.textarea.style.height=X+"px",this.textarea.style.lineHeight=X+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,p.addDisposableDomListener)(this.element,"copy",$=>{this.hasSelection()&&(0,l.copyHandler)($,this._selectionService)}));const R=$=>(0,l.handlePasteEvent)($,this.textarea,this.coreService,this.optionsService);this.register((0,p.addDisposableDomListener)(this.textarea,"paste",R)),this.register((0,p.addDisposableDomListener)(this.element,"paste",R)),H.isFirefox?this.register((0,p.addDisposableDomListener)(this.element,"mousedown",$=>{$.button===2&&(0,l.rightClickHandler)($,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,p.addDisposableDomListener)(this.element,"contextmenu",$=>{(0,l.rightClickHandler)($,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),H.isLinux&&this.register((0,p.addDisposableDomListener)(this.element,"auxclick",$=>{$.button===1&&(0,l.moveTextAreaUnderMouseCursor)($,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,p.addDisposableDomListener)(this.textarea,"keyup",R=>this._keyUp(R),!0)),this.register((0,p.addDisposableDomListener)(this.textarea,"keydown",R=>this._keyDown(R),!0)),this.register((0,p.addDisposableDomListener)(this.textarea,"keypress",R=>this._keyPress(R),!0)),this.register((0,p.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,p.addDisposableDomListener)(this.textarea,"compositionupdate",R=>this._compositionHelper.compositionupdate(R))),this.register((0,p.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,p.addDisposableDomListener)(this.textarea,"input",R=>this._inputEvent(R),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(R){var $;if(!R)throw new Error("Terminal requires a parent element.");R.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=R.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),R.appendChild(this.element);const q=U.createDocumentFragment();this._viewportElement=U.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),q.appendChild(this._viewportElement),this._viewportScrollArea=U.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=U.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=U.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),q.appendChild(this.screenElement),this.textarea=U.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",h.promptLabel),H.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(g.CoreBrowserService,this.textarea,($=this._document.defaultView)!==null&&$!==void 0?$:window),this._instantiationService.setService(S.ICoreBrowserService,this._coreBrowserService),this.register((0,p.addDisposableDomListener)(this.textarea,"focus",X=>this._handleTextAreaFocus(X))),this.register((0,p.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(r.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(S.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(M.ThemeService),this._instantiationService.setService(S.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(m.CharacterJoinerService),this._instantiationService.setService(S.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(D.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(S.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(X=>this._onRender.fire(X))),this.onResize(X=>this._renderService.resize(X.cols,X.rows)),this._compositionView=U.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(s.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(q);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(k.MouseService),this._instantiationService.setService(S.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(d.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(X=>this.scrollLines(X.amount,X.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(w.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(S.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(X=>this.scrollLines(X.amount,X.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(X=>this._renderService.handleSelectionChanged(X.start,X.end,X.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(X=>{this.textarea.value=X,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(X=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,p.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(u.BufferDecorationRenderer,this.screenElement)),this.register((0,p.addDisposableDomListener)(this.element,"mousedown",X=>this._selectionService.handleMouseDown(X))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(W.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",X=>this._handleScreenReaderModeOptionChange(X))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(t.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",X=>{!this._overviewRulerRenderer&&X&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(t.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(o.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const R=this,$=this.element;function q(V){const he=R._mouseService.getMouseReportCoords(V,R.screenElement);if(!he)return!1;let ke,ee;switch(V.overrideType||V.type){case"mousemove":ee=32,V.buttons===void 0?(ke=3,V.button!==void 0&&(ke=V.button<3?V.button:3)):ke=1&V.buttons?0:4&V.buttons?1:2&V.buttons?2:3;break;case"mouseup":ee=0,ke=V.button<3?V.button:3;break;case"mousedown":ee=1,ke=V.button<3?V.button:3;break;case"wheel":if(R.viewport.getLinesScrolled(V)===0)return!1;ee=V.deltaY<0?0:1,ke=4;break;default:return!1}return!(ee===void 0||ke===void 0||ke>4)&&R.coreMouseService.triggerMouseEvent({col:he.col,row:he.row,x:he.x,y:he.y,button:ke,action:ee,ctrl:V.ctrlKey,alt:V.altKey,shift:V.shiftKey})}const X={mouseup:null,wheel:null,mousedrag:null,mousemove:null},se={mouseup:V=>(q(V),V.buttons||(this._document.removeEventListener("mouseup",X.mouseup),X.mousedrag&&this._document.removeEventListener("mousemove",X.mousedrag)),this.cancel(V)),wheel:V=>(q(V),this.cancel(V,!0)),mousedrag:V=>{V.buttons&&q(V)},mousemove:V=>{V.buttons||q(V)}};this.register(this.coreMouseService.onProtocolChange(V=>{V?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(V)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&V?X.mousemove||($.addEventListener("mousemove",se.mousemove),X.mousemove=se.mousemove):($.removeEventListener("mousemove",X.mousemove),X.mousemove=null),16&V?X.wheel||($.addEventListener("wheel",se.wheel,{passive:!1}),X.wheel=se.wheel):($.removeEventListener("wheel",X.wheel),X.wheel=null),2&V?X.mouseup||($.addEventListener("mouseup",se.mouseup),X.mouseup=se.mouseup):(this._document.removeEventListener("mouseup",X.mouseup),$.removeEventListener("mouseup",X.mouseup),X.mouseup=null),4&V?X.mousedrag||(X.mousedrag=se.mousedrag):(this._document.removeEventListener("mousemove",X.mousedrag),X.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,p.addDisposableDomListener)($,"mousedown",V=>{if(V.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(V))return q(V),X.mouseup&&this._document.addEventListener("mouseup",X.mouseup),X.mousedrag&&this._document.addEventListener("mousemove",X.mousedrag),this.cancel(V)})),this.register((0,p.addDisposableDomListener)($,"wheel",V=>{if(!X.wheel){if(!this.buffer.hasScrollback){const he=this.viewport.getLinesScrolled(V);if(he===0)return;const ke=F.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(V.deltaY<0?"A":"B");let ee="";for(let ae=0;ae<Math.abs(he);ae++)ee+=ke;return this.coreService.triggerDataEvent(ee,!0),this.cancel(V,!0)}return this.viewport.handleWheel(V)?this.cancel(V):void 0}},{passive:!1})),this.register((0,p.addDisposableDomListener)($,"touchstart",V=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(V),this.cancel(V)},{passive:!0})),this.register((0,p.addDisposableDomListener)($,"touchmove",V=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(V)?void 0:this.cancel(V)},{passive:!1}))}refresh(R,$){var q;(q=this._renderService)===null||q===void 0||q.refreshRows(R,$)}updateCursorStyle(R){var $;!(($=this._selectionService)===null||$===void 0)&&$.shouldColumnSelect(R)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(R,$,q=0){var X;q===1?(super.scrollLines(R,$,q),this.refresh(0,this.rows-1)):(X=this.viewport)===null||X===void 0||X.scrollLines(R)}paste(R){(0,l.paste)(R,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(R){this._customKeyEventHandler=R}registerLinkProvider(R){return this.linkifier2.registerLinkProvider(R)}registerCharacterJoiner(R){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const $=this._characterJoinerService.register(R);return this.refresh(0,this.rows-1),$}deregisterCharacterJoiner(R){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(R)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(R){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+R)}registerDecoration(R){return this._decorationService.registerDecoration(R)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(R,$,q){this._selectionService.setSelection(R,$,q)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var R;(R=this._selectionService)===null||R===void 0||R.clearSelection()}selectAll(){var R;(R=this._selectionService)===null||R===void 0||R.selectAll()}selectLines(R,$){var q;(q=this._selectionService)===null||q===void 0||q.selectLines(R,$)}_keyDown(R){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(R)===!1)return!1;const $=this.browser.isMac&&this.options.macOptionIsMeta&&R.altKey;if(!$&&!this._compositionHelper.keydown(R))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;$||R.key!=="Dead"&&R.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const q=(0,L.evaluateKeyboardEvent)(R,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(R),q.type===3||q.type===2){const X=this.rows-1;return this.scrollLines(q.type===2?-X:X),this.cancel(R,!0)}return q.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,R)||(q.cancel&&this.cancel(R,!0),!q.key||!!(R.key&&!R.ctrlKey&&!R.altKey&&!R.metaKey&&R.key.length===1&&R.key.charCodeAt(0)>=65&&R.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(q.key!==F.C0.ETX&&q.key!==F.C0.CR||(this.textarea.value=""),this._onKey.fire({key:q.key,domEvent:R}),this._showCursor(),this.coreService.triggerDataEvent(q.key,!0),!this.optionsService.rawOptions.screenReaderMode||R.altKey||R.ctrlKey?this.cancel(R,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(R,$){const q=R.isMac&&!this.options.macOptionIsMeta&&$.altKey&&!$.ctrlKey&&!$.metaKey||R.isWindows&&$.altKey&&$.ctrlKey&&!$.metaKey||R.isWindows&&$.getModifierState("AltGraph");return $.type==="keypress"?q:q&&(!$.keyCode||$.keyCode>47)}_keyUp(R){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(R)===!1||(function($){return $.keyCode===16||$.keyCode===17||$.keyCode===18}(R)||this.focus(),this.updateCursorStyle(R),this._keyPressHandled=!1)}_keyPress(R){let $;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(R)===!1)return!1;if(this.cancel(R),R.charCode)$=R.charCode;else if(R.which===null||R.which===void 0)$=R.keyCode;else{if(R.which===0||R.charCode===0)return!1;$=R.which}return!(!$||(R.altKey||R.ctrlKey||R.metaKey)&&!this._isThirdLevelShift(this.browser,R)||($=String.fromCharCode($),this._onKey.fire({key:$,domEvent:R}),this._showCursor(),this.coreService.triggerDataEvent($,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(R){if(R.data&&R.inputType==="insertText"&&(!R.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const $=R.data;return this.coreService.triggerDataEvent($,!0),this.cancel(R),!0}return!1}resize(R,$){R!==this.cols||$!==this.rows?super.resize(R,$):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(R,$){var q,X;(q=this._charSizeService)===null||q===void 0||q.measure(),(X=this.viewport)===null||X===void 0||X.syncScrollArea(!0)}clear(){var R;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let $=1;$<this.rows;$++)this.buffer.lines.push(this.buffer.getBlankLine(P.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(R=this.viewport)===null||R===void 0||R.reset(),this.refresh(0,this.rows-1)}}reset(){var R,$;this.options.rows=this.rows,this.options.cols=this.cols;const q=this._customKeyEventHandler;this._setup(),super.reset(),(R=this._selectionService)===null||R===void 0||R.reset(),this._decorationService.reset(),($=this.viewport)===null||$===void 0||$.reset(),this._customKeyEventHandler=q,this.refresh(0,this.rows-1)}clearTextureAtlas(){var R;(R=this._renderService)===null||R===void 0||R.clearTextureAtlas()}_reportFocus(){var R;!((R=this.element)===null||R===void 0)&&R.classList.contains("focus")?this.coreService.triggerDataEvent(F.C0.ESC+"[I"):this.coreService.triggerDataEvent(F.C0.ESC+"[O")}_reportWindowsOptions(R){if(this._renderService)switch(R){case z.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const $=this._renderService.dimensions.css.canvas.width.toFixed(0),q=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${F.C0.ESC}[4;${q};${$}t`);break;case z.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const X=this._renderService.dimensions.css.cell.width.toFixed(0),se=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${F.C0.ESC}[6;${se};${X}t`)}}cancel(R,$){if(this.options.cancelEvents||$)return R.preventDefault(),R.stopPropagation(),!1}}n.Terminal=j},9924:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TimeBasedDebouncer=void 0,n.TimeBasedDebouncer=class{constructor(i,l=1e3){this._renderCallback=i,this._debounceThresholdMS=l,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(i,l,p){this._rowCount=p,i=i!==void 0?i:0,l=l!==void 0?l:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,i):i,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,l):l;const a=Date.now();if(a-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=a,this._innerRefresh();else if(!this._additionalRefreshRequested){const h=a-this._lastRefreshMs,f=this._debounceThresholdMS-h;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},f)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const i=Math.max(this._rowStart,0),l=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(i,l)}}},1680:function(C,n,i){var l=this&&this.__decorate||function(s,o,r,m){var g,k=arguments.length,D=k<3?o:m===null?m=Object.getOwnPropertyDescriptor(o,r):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(s,o,r,m);else for(var w=s.length-1;w>=0;w--)(g=s[w])&&(D=(k<3?g(D):k>3?g(o,r,D):g(o,r))||D);return k>3&&D&&Object.defineProperty(o,r,D),D},p=this&&this.__param||function(s,o){return function(r,m){o(r,m,s)}};Object.defineProperty(n,"__esModule",{value:!0}),n.Viewport=void 0;const a=i(3656),h=i(4725),f=i(8460),d=i(844),u=i(2585);let t=n.Viewport=class extends d.Disposable{constructor(s,o,r,m,g,k,D,w){super(),this._viewportElement=s,this._scrollArea=o,this._bufferService=r,this._optionsService=m,this._charSizeService=g,this._renderService=k,this._coreBrowserService=D,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new f.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,a.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(S=>this._activeBuffer=S.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(S=>this._renderDimensions=S)),this._handleThemeChange(w.colors),this.register(w.onChangeColors(S=>this._handleThemeChange(S))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(s){this._viewportElement.style.backgroundColor=s.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(s){if(s)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const o=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==o&&(this._lastRecordedBufferHeight=o,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const s=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==s&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=s),this._refreshAnimationFrame=null}syncScrollArea(s=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(s);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(s)}_handleScroll(s){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const o=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:o,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const s=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(s*(this._smoothScrollState.target-this._smoothScrollState.origin)),s<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(s,o){const r=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(o<0&&this._viewportElement.scrollTop!==0||o>0&&r<this._lastRecordedBufferHeight)||(s.cancelable&&s.preventDefault(),!1)}handleWheel(s){const o=this._getPixelsScrolled(s);return o!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+o:this._smoothScrollState.target+=o,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=o,this._bubbleScroll(s,o))}scrollLines(s){if(s!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const o=s*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+o,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:s,suppressScrollEvent:!1})}_getPixelsScrolled(s){if(s.deltaY===0||s.shiftKey)return 0;let o=this._applyScrollModifier(s.deltaY,s);return s.deltaMode===WheelEvent.DOM_DELTA_LINE?o*=this._currentRowHeight:s.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(o*=this._currentRowHeight*this._bufferService.rows),o}getBufferElements(s,o){var r;let m,g="";const k=[],D=o??this._bufferService.buffer.lines.length,w=this._bufferService.buffer.lines;for(let S=s;S<D;S++){const M=w.get(S);if(!M)continue;const I=(r=w.get(S+1))===null||r===void 0?void 0:r.isWrapped;if(g+=M.translateToString(!I),!I||S===w.length-1){const y=document.createElement("div");y.textContent=g,k.push(y),g.length>0&&(m=y),g=""}}return{bufferElements:k,cursorElement:m}}getLinesScrolled(s){if(s.deltaY===0||s.shiftKey)return 0;let o=this._applyScrollModifier(s.deltaY,s);return s.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(o/=this._currentRowHeight+0,this._wheelPartialScroll+=o,o=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):s.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(o*=this._bufferService.rows),o}_applyScrollModifier(s,o){const r=this._optionsService.rawOptions.fastScrollModifier;return r==="alt"&&o.altKey||r==="ctrl"&&o.ctrlKey||r==="shift"&&o.shiftKey?s*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:s*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(s){this._lastTouchY=s.touches[0].pageY}handleTouchMove(s){const o=this._lastTouchY-s.touches[0].pageY;return this._lastTouchY=s.touches[0].pageY,o!==0&&(this._viewportElement.scrollTop+=o,this._bubbleScroll(s,o))}};n.Viewport=t=l([p(2,u.IBufferService),p(3,u.IOptionsService),p(4,h.ICharSizeService),p(5,h.IRenderService),p(6,h.ICoreBrowserService),p(7,h.IThemeService)],t)},3107:function(C,n,i){var l=this&&this.__decorate||function(t,s,o,r){var m,g=arguments.length,k=g<3?s:r===null?r=Object.getOwnPropertyDescriptor(s,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(t,s,o,r);else for(var D=t.length-1;D>=0;D--)(m=t[D])&&(k=(g<3?m(k):g>3?m(s,o,k):m(s,o))||k);return g>3&&k&&Object.defineProperty(s,o,k),k},p=this&&this.__param||function(t,s){return function(o,r){s(o,r,t)}};Object.defineProperty(n,"__esModule",{value:!0}),n.BufferDecorationRenderer=void 0;const a=i(3656),h=i(4725),f=i(844),d=i(2585);let u=n.BufferDecorationRenderer=class extends f.Disposable{constructor(t,s,o,r){super(),this._screenElement=t,this._bufferService=s,this._decorationService=o,this._renderService=r,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,a.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(m=>this._removeDecoration(m))),this.register((0,f.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const t of this._decorationService.decorations)this._renderDecoration(t);this._dimensionsChanged=!1}_renderDecoration(t){this._refreshStyle(t),this._dimensionsChanged&&this._refreshXPosition(t)}_createElement(t){var s,o;const r=document.createElement("div");r.classList.add("xterm-decoration"),r.classList.toggle("xterm-decoration-top-layer",((s=t==null?void 0:t.options)===null||s===void 0?void 0:s.layer)==="top"),r.style.width=`${Math.round((t.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,r.style.height=(t.options.height||1)*this._renderService.dimensions.css.cell.height+"px",r.style.top=(t.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",r.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const m=(o=t.options.x)!==null&&o!==void 0?o:0;return m&&m>this._bufferService.cols&&(r.style.display="none"),this._refreshXPosition(t,r),r}_refreshStyle(t){const s=t.marker.line-this._bufferService.buffers.active.ydisp;if(s<0||s>=this._bufferService.rows)t.element&&(t.element.style.display="none",t.onRenderEmitter.fire(t.element));else{let o=this._decorationElements.get(t);o||(o=this._createElement(t),t.element=o,this._decorationElements.set(t,o),this._container.appendChild(o),t.onDispose(()=>{this._decorationElements.delete(t),o.remove()})),o.style.top=s*this._renderService.dimensions.css.cell.height+"px",o.style.display=this._altBufferIsActive?"none":"block",t.onRenderEmitter.fire(o)}}_refreshXPosition(t,s=t.element){var o;if(!s)return;const r=(o=t.options.x)!==null&&o!==void 0?o:0;(t.options.anchor||"left")==="right"?s.style.right=r?r*this._renderService.dimensions.css.cell.width+"px":"":s.style.left=r?r*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(t){var s;(s=this._decorationElements.get(t))===null||s===void 0||s.remove(),this._decorationElements.delete(t),t.dispose()}};n.BufferDecorationRenderer=u=l([p(1,d.IBufferService),p(2,d.IDecorationService),p(3,h.IRenderService)],u)},5871:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorZoneStore=void 0,n.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(i){if(i.options.overviewRulerOptions){for(const l of this._zones)if(l.color===i.options.overviewRulerOptions.color&&l.position===i.options.overviewRulerOptions.position){if(this._lineIntersectsZone(l,i.marker.line))return;if(this._lineAdjacentToZone(l,i.marker.line,i.options.overviewRulerOptions.position))return void this._addLineToZone(l,i.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=i.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=i.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=i.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=i.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:i.options.overviewRulerOptions.color,position:i.options.overviewRulerOptions.position,startBufferLine:i.marker.line,endBufferLine:i.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(i){this._linePadding=i}_lineIntersectsZone(i,l){return l>=i.startBufferLine&&l<=i.endBufferLine}_lineAdjacentToZone(i,l,p){return l>=i.startBufferLine-this._linePadding[p||"full"]&&l<=i.endBufferLine+this._linePadding[p||"full"]}_addLineToZone(i,l){i.startBufferLine=Math.min(i.startBufferLine,l),i.endBufferLine=Math.max(i.endBufferLine,l)}}},5744:function(C,n,i){var l=this&&this.__decorate||function(m,g,k,D){var w,S=arguments.length,M=S<3?g:D===null?D=Object.getOwnPropertyDescriptor(g,k):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(m,g,k,D);else for(var I=m.length-1;I>=0;I--)(w=m[I])&&(M=(S<3?w(M):S>3?w(g,k,M):w(g,k))||M);return S>3&&M&&Object.defineProperty(g,k,M),M},p=this&&this.__param||function(m,g){return function(k,D){g(k,D,m)}};Object.defineProperty(n,"__esModule",{value:!0}),n.OverviewRulerRenderer=void 0;const a=i(5871),h=i(3656),f=i(4725),d=i(844),u=i(2585),t={full:0,left:0,center:0,right:0},s={full:0,left:0,center:0,right:0},o={full:0,left:0,center:0,right:0};let r=n.OverviewRulerRenderer=class extends d.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(m,g,k,D,w,S,M){var I;super(),this._viewportElement=m,this._screenElement=g,this._bufferService=k,this._decorationService=D,this._renderService=w,this._optionsService=S,this._coreBrowseService=M,this._colorZoneStore=new a.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(I=this._viewportElement.parentElement)===null||I===void 0||I.insertBefore(this._canvas,this._viewportElement);const y=this._canvas.getContext("2d");if(!y)throw new Error("Ctx cannot be null");this._ctx=y,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,d.toDisposable)(()=>{var T;(T=this._canvas)===null||T===void 0||T.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,h.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const m=Math.floor(this._canvas.width/3),g=Math.ceil(this._canvas.width/3);s.full=this._canvas.width,s.left=m,s.center=g,s.right=m,this._refreshDrawHeightConstants(),o.full=0,o.left=0,o.center=s.left,o.right=s.left+s.center}_refreshDrawHeightConstants(){t.full=Math.round(2*this._coreBrowseService.dpr);const m=this._canvas.height/this._bufferService.buffer.lines.length,g=Math.round(Math.max(Math.min(m,12),6)*this._coreBrowseService.dpr);t.left=g,t.center=g,t.right=g}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const g of this._decorationService.decorations)this._colorZoneStore.addDecoration(g);this._ctx.lineWidth=1;const m=this._colorZoneStore.zones;for(const g of m)g.position!=="full"&&this._renderColorZone(g);for(const g of m)g.position==="full"&&this._renderColorZone(g);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(m){this._ctx.fillStyle=m.color,this._ctx.fillRect(o[m.position||"full"],Math.round((this._canvas.height-1)*(m.startBufferLine/this._bufferService.buffers.active.lines.length)-t[m.position||"full"]/2),s[m.position||"full"],Math.round((this._canvas.height-1)*((m.endBufferLine-m.startBufferLine)/this._bufferService.buffers.active.lines.length)+t[m.position||"full"]))}_queueRefresh(m,g){this._shouldUpdateDimensions=m||this._shouldUpdateDimensions,this._shouldUpdateAnchor=g||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};n.OverviewRulerRenderer=r=l([p(2,u.IBufferService),p(3,u.IDecorationService),p(4,f.IRenderService),p(5,u.IOptionsService),p(6,f.ICoreBrowserService)],r)},2950:function(C,n,i){var l=this&&this.__decorate||function(u,t,s,o){var r,m=arguments.length,g=m<3?t:o===null?o=Object.getOwnPropertyDescriptor(t,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(u,t,s,o);else for(var k=u.length-1;k>=0;k--)(r=u[k])&&(g=(m<3?r(g):m>3?r(t,s,g):r(t,s))||g);return m>3&&g&&Object.defineProperty(t,s,g),g},p=this&&this.__param||function(u,t){return function(s,o){t(s,o,u)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CompositionHelper=void 0;const a=i(4725),h=i(2585),f=i(2584);let d=n.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(u,t,s,o,r,m){this._textarea=u,this._compositionView=t,this._bufferService=s,this._optionsService=o,this._coreService=r,this._renderService=m,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(u){this._compositionView.textContent=u.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(u){if(this._isComposing||this._isSendingComposition){if(u.keyCode===229||u.keyCode===16||u.keyCode===17||u.keyCode===18)return!1;this._finalizeComposition(!1)}return u.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(u){if(this._compositionView.classList.remove("active"),this._isComposing=!1,u){const t={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let s;this._isSendingComposition=!1,t.start+=this._dataAlreadySent.length,s=this._isComposing?this._textarea.value.substring(t.start,t.end):this._textarea.value.substring(t.start),s.length>0&&this._coreService.triggerDataEvent(s,!0)}},0)}else{this._isSendingComposition=!1;const t=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(t,!0)}}_handleAnyTextareaChanges(){const u=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const t=this._textarea.value,s=t.replace(u,"");this._dataAlreadySent=s,t.length>u.length?this._coreService.triggerDataEvent(s,!0):t.length<u.length?this._coreService.triggerDataEvent(`${f.C0.DEL}`,!0):t.length===u.length&&t!==u&&this._coreService.triggerDataEvent(t,!0)}},0)}updateCompositionElements(u){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const t=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),s=this._renderService.dimensions.css.cell.height,o=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,r=t*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=r+"px",this._compositionView.style.top=o+"px",this._compositionView.style.height=s+"px",this._compositionView.style.lineHeight=s+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const m=this._compositionView.getBoundingClientRect();this._textarea.style.left=r+"px",this._textarea.style.top=o+"px",this._textarea.style.width=Math.max(m.width,1)+"px",this._textarea.style.height=Math.max(m.height,1)+"px",this._textarea.style.lineHeight=m.height+"px"}u||setTimeout(()=>this.updateCompositionElements(!0),0)}}};n.CompositionHelper=d=l([p(2,h.IBufferService),p(3,h.IOptionsService),p(4,h.ICoreService),p(5,a.IRenderService)],d)},9806:(C,n)=>{function i(l,p,a){const h=a.getBoundingClientRect(),f=l.getComputedStyle(a),d=parseInt(f.getPropertyValue("padding-left")),u=parseInt(f.getPropertyValue("padding-top"));return[p.clientX-h.left-d,p.clientY-h.top-u]}Object.defineProperty(n,"__esModule",{value:!0}),n.getCoords=n.getCoordsRelativeToElement=void 0,n.getCoordsRelativeToElement=i,n.getCoords=function(l,p,a,h,f,d,u,t,s){if(!d)return;const o=i(l,p,a);return o?(o[0]=Math.ceil((o[0]+(s?u/2:0))/u),o[1]=Math.ceil(o[1]/t),o[0]=Math.min(Math.max(o[0],1),h+(s?1:0)),o[1]=Math.min(Math.max(o[1],1),f),o):void 0}},9504:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.moveToCellSequence=void 0;const l=i(2584);function p(t,s,o,r){const m=t-a(t,o),g=s-a(s,o),k=Math.abs(m-g)-function(D,w,S){let M=0;const I=D-a(D,S),y=w-a(w,S);for(let T=0;T<Math.abs(I-y);T++){const A=h(D,w)==="A"?-1:1,H=S.buffer.lines.get(I+A*T);H!=null&&H.isWrapped&&M++}return M}(t,s,o);return u(k,d(h(t,s),r))}function a(t,s){let o=0,r=s.buffer.lines.get(t),m=r==null?void 0:r.isWrapped;for(;m&&t>=0&&t<s.rows;)o++,r=s.buffer.lines.get(--t),m=r==null?void 0:r.isWrapped;return o}function h(t,s){return t>s?"A":"B"}function f(t,s,o,r,m,g){let k=t,D=s,w="";for(;k!==o||D!==r;)k+=m?1:-1,m&&k>g.cols-1?(w+=g.buffer.translateBufferLineToString(D,!1,t,k),k=0,t=0,D++):!m&&k<0&&(w+=g.buffer.translateBufferLineToString(D,!1,0,t+1),k=g.cols-1,t=k,D--);return w+g.buffer.translateBufferLineToString(D,!1,t,k)}function d(t,s){const o=s?"O":"[";return l.C0.ESC+o+t}function u(t,s){t=Math.floor(t);let o="";for(let r=0;r<t;r++)o+=s;return o}n.moveToCellSequence=function(t,s,o,r){const m=o.buffer.x,g=o.buffer.y;if(!o.buffer.hasScrollback)return function(w,S,M,I,y,T){return p(S,I,y,T).length===0?"":u(f(w,S,w,S-a(S,y),!1,y).length,d("D",T))}(m,g,0,s,o,r)+p(g,s,o,r)+function(w,S,M,I,y,T){let A;A=p(S,I,y,T).length>0?I-a(I,y):S;const H=I,P=function(F,L,B,O,N,z){let W;return W=p(B,O,N,z).length>0?O-a(O,N):L,F<B&&W<=O||F>=B&&W<O?"C":"D"}(w,S,M,I,y,T);return u(f(w,A,M,H,P==="C",y).length,d(P,T))}(m,g,t,s,o,r);let k;if(g===s)return k=m>t?"D":"C",u(Math.abs(m-t),d(k,r));k=g>s?"D":"C";const D=Math.abs(g-s);return u(function(w,S){return S.cols-w}(g>s?t:m,o)+(D-1)*o.cols+1+((g>s?m:t)-1),d(k,r))}},1296:function(C,n,i){var l=this&&this.__decorate||function(y,T,A,H){var P,F=arguments.length,L=F<3?T:H===null?H=Object.getOwnPropertyDescriptor(T,A):H;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(y,T,A,H);else for(var B=y.length-1;B>=0;B--)(P=y[B])&&(L=(F<3?P(L):F>3?P(T,A,L):P(T,A))||L);return F>3&&L&&Object.defineProperty(T,A,L),L},p=this&&this.__param||function(y,T){return function(A,H){T(A,H,y)}};Object.defineProperty(n,"__esModule",{value:!0}),n.DomRenderer=void 0;const a=i(3787),h=i(2550),f=i(2223),d=i(6171),u=i(4725),t=i(8055),s=i(8460),o=i(844),r=i(2585),m="xterm-dom-renderer-owner-",g="xterm-rows",k="xterm-fg-",D="xterm-bg-",w="xterm-focus",S="xterm-selection";let M=1,I=n.DomRenderer=class extends o.Disposable{constructor(y,T,A,H,P,F,L,B,O,N){super(),this._element=y,this._screenElement=T,this._viewportElement=A,this._linkifier2=H,this._charSizeService=F,this._optionsService=L,this._bufferService=B,this._coreBrowserService=O,this._themeService=N,this._terminalClass=M++,this._rowElements=[],this.onRequestRedraw=this.register(new s.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add(g),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add(S),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,d.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(z=>this._injectCss(z))),this._injectCss(this._themeService.colors),this._rowFactory=P.createInstance(a.DomRendererRowFactory,document),this._element.classList.add(m+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(z=>this._handleLinkHover(z))),this.register(this._linkifier2.onHideLinkUnderline(z=>this._handleLinkLeave(z))),this.register((0,o.toDisposable)(()=>{this._element.classList.remove(m+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new h.WidthCache(document),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const y=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*y,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*y),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/y),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/y),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const A of this._rowElements)A.style.width=`${this.dimensions.css.canvas.width}px`,A.style.height=`${this.dimensions.css.cell.height}px`,A.style.lineHeight=`${this.dimensions.css.cell.height}px`,A.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const T=`${this._terminalSelector} .${g} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=T,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(y){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let T=`${this._terminalSelector} .${g} { color: ${y.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;T+=`${this._terminalSelector} .${g} .xterm-dim { color: ${t.color.multiplyOpacity(y.foreground,.5).css};}`,T+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`,T+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  border-bottom-style: hidden; }}",T+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${y.cursor.css};  color: ${y.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${y.cursor.css}; }}`,T+=`${this._terminalSelector} .${g}.${w} .xterm-cursor.xterm-cursor-blink:not(.xterm-cursor-block) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${g}.${w} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-block { background-color: ${y.cursor.css}; color: ${y.cursorAccent.css};}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${y.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${y.cursor.css} inset;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${y.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,T+=`${this._terminalSelector} .${S} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${S} div { position: absolute; background-color: ${y.selectionBackgroundOpaque.css};}${this._terminalSelector} .${S} div { position: absolute; background-color: ${y.selectionInactiveBackgroundOpaque.css};}`;for(const[A,H]of y.ansi.entries())T+=`${this._terminalSelector} .${k}${A} { color: ${H.css}; }${this._terminalSelector} .${k}${A}.xterm-dim { color: ${t.color.multiplyOpacity(H,.5).css}; }${this._terminalSelector} .${D}${A} { background-color: ${H.css}; }`;T+=`${this._terminalSelector} .${k}${f.INVERTED_DEFAULT_COLOR} { color: ${t.color.opaque(y.background).css}; }${this._terminalSelector} .${k}${f.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${t.color.multiplyOpacity(t.color.opaque(y.background),.5).css}; }${this._terminalSelector} .${D}${f.INVERTED_DEFAULT_COLOR} { background-color: ${y.foreground.css}; }`,this._themeStyleElement.textContent=T}_setDefaultSpacing(){const y=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${y}px`,this._rowFactory.defaultSpacing=y}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(y,T){for(let A=this._rowElements.length;A<=T;A++){const H=document.createElement("div");this._rowContainer.appendChild(H),this._rowElements.push(H)}for(;this._rowElements.length>T;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(y,T){this._refreshRowElements(y,T),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(w)}handleFocus(){this._rowContainer.classList.add(w),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(y,T,A){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(y,T,A),this.renderRows(0,this._bufferService.rows-1),!y||!T)return;const H=y[1]-this._bufferService.buffer.ydisp,P=T[1]-this._bufferService.buffer.ydisp,F=Math.max(H,0),L=Math.min(P,this._bufferService.rows-1);if(F>=this._bufferService.rows||L<0)return;const B=document.createDocumentFragment();if(A){const O=y[0]>T[0];B.appendChild(this._createSelectionElement(F,O?T[0]:y[0],O?y[0]:T[0],L-F+1))}else{const O=H===F?y[0]:0,N=F===P?T[0]:this._bufferService.cols;B.appendChild(this._createSelectionElement(F,O,N));const z=L-F-1;if(B.appendChild(this._createSelectionElement(F+1,0,this._bufferService.cols,z)),F!==L){const W=P===L?T[0]:this._bufferService.cols;B.appendChild(this._createSelectionElement(L,0,W))}}this._selectionContainer.appendChild(B)}_createSelectionElement(y,T,A,H=1){const P=document.createElement("div");return P.style.height=H*this.dimensions.css.cell.height+"px",P.style.top=y*this.dimensions.css.cell.height+"px",P.style.left=T*this.dimensions.css.cell.width+"px",P.style.width=this.dimensions.css.cell.width*(A-T)+"px",P}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const y of this._rowElements)y.replaceChildren()}renderRows(y,T){const A=this._bufferService.buffer,H=A.ybase+A.y,P=Math.min(A.x,this._bufferService.cols-1),F=this._optionsService.rawOptions.cursorBlink,L=this._optionsService.rawOptions.cursorStyle,B=this._optionsService.rawOptions.cursorInactiveStyle;for(let O=y;O<=T;O++){const N=O+A.ydisp,z=this._rowElements[O],W=A.lines.get(N);if(!z||!W)break;z.replaceChildren(...this._rowFactory.createRow(W,N,N===H,L,B,P,F,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${m}${this._terminalClass}`}_handleLinkHover(y){this._setCellUnderline(y.x1,y.x2,y.y1,y.y2,y.cols,!0)}_handleLinkLeave(y){this._setCellUnderline(y.x1,y.x2,y.y1,y.y2,y.cols,!1)}_setCellUnderline(y,T,A,H,P,F){A<0&&(y=0),H<0&&(T=0);const L=this._bufferService.rows-1;A=Math.max(Math.min(A,L),0),H=Math.max(Math.min(H,L),0),P=Math.min(P,this._bufferService.cols);const B=this._bufferService.buffer,O=B.ybase+B.y,N=Math.min(B.x,P-1),z=this._optionsService.rawOptions.cursorBlink,W=this._optionsService.rawOptions.cursorStyle,U=this._optionsService.rawOptions.cursorInactiveStyle;for(let j=A;j<=H;++j){const Y=j+B.ydisp,R=this._rowElements[j],$=B.lines.get(Y);if(!R||!$)break;R.replaceChildren(...this._rowFactory.createRow($,Y,Y===O,W,U,N,z,this.dimensions.css.cell.width,this._widthCache,F?j===A?y:0:-1,F?(j===H?T:P)-1:-1))}}};n.DomRenderer=I=l([p(4,r.IInstantiationService),p(5,u.ICharSizeService),p(6,r.IOptionsService),p(7,r.IBufferService),p(8,u.ICoreBrowserService),p(9,u.IThemeService)],I)},3787:function(C,n,i){var l=this&&this.__decorate||function(k,D,w,S){var M,I=arguments.length,y=I<3?D:S===null?S=Object.getOwnPropertyDescriptor(D,w):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(k,D,w,S);else for(var T=k.length-1;T>=0;T--)(M=k[T])&&(y=(I<3?M(y):I>3?M(D,w,y):M(D,w))||y);return I>3&&y&&Object.defineProperty(D,w,y),y},p=this&&this.__param||function(k,D){return function(w,S){D(w,S,k)}};Object.defineProperty(n,"__esModule",{value:!0}),n.DomRendererRowFactory=void 0;const a=i(2223),h=i(643),f=i(511),d=i(2585),u=i(8055),t=i(4725),s=i(4269),o=i(6171),r=i(3734);let m=n.DomRendererRowFactory=class{constructor(k,D,w,S,M,I,y){this._document=k,this._characterJoinerService=D,this._optionsService=w,this._coreBrowserService=S,this._coreService=M,this._decorationService=I,this._themeService=y,this._workCell=new f.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(k,D,w){this._selectionStart=k,this._selectionEnd=D,this._columnSelectMode=w}createRow(k,D,w,S,M,I,y,T,A,H,P){const F=[],L=this._characterJoinerService.getJoinedCharacters(D),B=this._themeService.colors;let O,N=k.getNoBgTrimmedLength();w&&N<I+1&&(N=I+1);let z=0,W="",U=0,j=0,Y=0,R=!1,$=0,q=!1,X=0;const se=[],V=H!==-1&&P!==-1;for(let he=0;he<N;he++){k.loadCell(he,this._workCell);let ke=this._workCell.getWidth();if(ke===0)continue;let ee=!1,ae=he,Z=this._workCell;if(L.length>0&&he===L[0][0]){ee=!0;const ne=L.shift();Z=new s.JoinedCellData(this._workCell,k.translateToString(!0,ne[0],ne[1]),ne[1]-ne[0]),ae=ne[1]-1,ke=Z.getWidth()}const de=this._isCellInSelection(he,D),_e=w&&he===I,we=V&&he>=H&&he<=P;let J=!1;this._decorationService.forEachDecorationAtCell(he,D,void 0,ne=>{J=!0});let le=Z.getChars()||h.WHITESPACE_CELL_CHAR;if(le===" "&&(Z.isUnderline()||Z.isOverline())&&(le=" "),X=ke*T-A.get(le,Z.isBold(),Z.isItalic()),O){if(z&&(de&&q||!de&&!q&&Z.bg===U)&&(de&&q&&B.selectionForeground||Z.fg===j)&&Z.extended.ext===Y&&we===R&&X===$&&!_e&&!ee&&!J){W+=le,z++;continue}z&&(O.textContent=W),O=this._document.createElement("span"),z=0,W=""}else O=this._document.createElement("span");if(U=Z.bg,j=Z.fg,Y=Z.extended.ext,R=we,$=X,q=de,ee&&I>=he&&I<=ae&&(I=he),!this._coreService.isCursorHidden&&_e){if(se.push("xterm-cursor"),this._coreBrowserService.isFocused)y&&se.push("xterm-cursor-blink"),se.push(S==="bar"?"xterm-cursor-bar":S==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(M)switch(M){case"outline":se.push("xterm-cursor-outline");break;case"block":se.push("xterm-cursor-block");break;case"bar":se.push("xterm-cursor-bar");break;case"underline":se.push("xterm-cursor-underline")}}if(Z.isBold()&&se.push("xterm-bold"),Z.isItalic()&&se.push("xterm-italic"),Z.isDim()&&se.push("xterm-dim"),W=Z.isInvisible()?h.WHITESPACE_CELL_CHAR:Z.getChars()||h.WHITESPACE_CELL_CHAR,Z.isUnderline()&&(se.push(`xterm-underline-${Z.extended.underlineStyle}`),W===" "&&(W=" "),!Z.isUnderlineColorDefault()))if(Z.isUnderlineColorRGB())O.style.textDecorationColor=`rgb(${r.AttributeData.toColorRGB(Z.getUnderlineColor()).join(",")})`;else{let ne=Z.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&Z.isBold()&&ne<8&&(ne+=8),O.style.textDecorationColor=B.ansi[ne].css}Z.isOverline()&&(se.push("xterm-overline"),W===" "&&(W=" ")),Z.isStrikethrough()&&se.push("xterm-strikethrough"),we&&(O.style.textDecoration="underline");let te=Z.getFgColor(),xe=Z.getFgColorMode(),ce=Z.getBgColor(),Pe=Z.getBgColorMode();const ve=!!Z.isInverse();if(ve){const ne=te;te=ce,ce=ne;const ue=xe;xe=Pe,Pe=ue}let ie,pe,fe,Le=!1;switch(this._decorationService.forEachDecorationAtCell(he,D,void 0,ne=>{ne.options.layer!=="top"&&Le||(ne.backgroundColorRGB&&(Pe=50331648,ce=ne.backgroundColorRGB.rgba>>8&16777215,ie=ne.backgroundColorRGB),ne.foregroundColorRGB&&(xe=50331648,te=ne.foregroundColorRGB.rgba>>8&16777215,pe=ne.foregroundColorRGB),Le=ne.options.layer==="top")}),!Le&&de&&(ie=this._coreBrowserService.isFocused?B.selectionBackgroundOpaque:B.selectionInactiveBackgroundOpaque,ce=ie.rgba>>8&16777215,Pe=50331648,Le=!0,B.selectionForeground&&(xe=50331648,te=B.selectionForeground.rgba>>8&16777215,pe=B.selectionForeground)),Le&&se.push("xterm-decoration-top"),Pe){case 16777216:case 33554432:fe=B.ansi[ce],se.push(`xterm-bg-${ce}`);break;case 50331648:fe=u.rgba.toColor(ce>>16,ce>>8&255,255&ce),this._addStyle(O,`background-color:#${g((ce>>>0).toString(16),"0",6)}`);break;default:ve?(fe=B.foreground,se.push(`xterm-bg-${a.INVERTED_DEFAULT_COLOR}`)):fe=B.background}switch(ie||Z.isDim()&&(ie=u.color.multiplyOpacity(fe,.5)),xe){case 16777216:case 33554432:Z.isBold()&&te<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(te+=8),this._applyMinimumContrast(O,fe,B.ansi[te],Z,ie,void 0)||se.push(`xterm-fg-${te}`);break;case 50331648:const ne=u.rgba.toColor(te>>16&255,te>>8&255,255&te);this._applyMinimumContrast(O,fe,ne,Z,ie,pe)||this._addStyle(O,`color:#${g(te.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(O,fe,B.foreground,Z,ie,void 0)||ve&&se.push(`xterm-fg-${a.INVERTED_DEFAULT_COLOR}`)}se.length&&(O.className=se.join(" "),se.length=0),_e||ee||J?O.textContent=W:z++,X!==this.defaultSpacing&&(O.style.letterSpacing=`${X}px`),F.push(O),he=ae}return O&&z&&(O.textContent=W),F}_applyMinimumContrast(k,D,w,S,M,I){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,o.excludeFromContrastRatioDemands)(S.getCode()))return!1;const y=this._getContrastCache(S);let T;if(M||I||(T=y.getColor(D.rgba,w.rgba)),T===void 0){const A=this._optionsService.rawOptions.minimumContrastRatio/(S.isDim()?2:1);T=u.color.ensureContrastRatio(M||D,I||w,A),y.setColor((M||D).rgba,(I||w).rgba,T??null)}return!!T&&(this._addStyle(k,`color:${T.css}`),!0)}_getContrastCache(k){return k.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(k,D){k.setAttribute("style",`${k.getAttribute("style")||""}${D};`)}_isCellInSelection(k,D){const w=this._selectionStart,S=this._selectionEnd;return!(!w||!S)&&(this._columnSelectMode?w[0]<=S[0]?k>=w[0]&&D>=w[1]&&k<S[0]&&D<=S[1]:k<w[0]&&D>=w[1]&&k>=S[0]&&D<=S[1]:D>w[1]&&D<S[1]||w[1]===S[1]&&D===w[1]&&k>=w[0]&&k<S[0]||w[1]<S[1]&&D===S[1]&&k<S[0]||w[1]<S[1]&&D===w[1]&&k>=w[0])}};function g(k,D,w){for(;k.length<w;)k=D+k;return k}n.DomRendererRowFactory=m=l([p(1,t.ICharacterJoinerService),p(2,d.IOptionsService),p(3,t.ICoreBrowserService),p(4,d.ICoreService),p(5,d.IDecorationService),p(6,t.IThemeService)],m)},2550:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WidthCache=void 0,n.WidthCache=class{constructor(i){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=i.createElement("div"),this._container.style.position="absolute",this._container.style.top="-50000px",this._container.style.width="50000px",this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const l=i.createElement("span"),p=i.createElement("span");p.style.fontWeight="bold";const a=i.createElement("span");a.style.fontStyle="italic";const h=i.createElement("span");h.style.fontWeight="bold",h.style.fontStyle="italic",this._measureElements=[l,p,a,h],this._container.appendChild(l),this._container.appendChild(p),this._container.appendChild(a),this._container.appendChild(h),i.body.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(i,l,p,a){i===this._font&&l===this._fontSize&&p===this._weight&&a===this._weightBold||(this._font=i,this._fontSize=l,this._weight=p,this._weightBold=a,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${p}`,this._measureElements[1].style.fontWeight=`${a}`,this._measureElements[2].style.fontWeight=`${p}`,this._measureElements[3].style.fontWeight=`${a}`,this.clear())}get(i,l,p){let a=0;if(!l&&!p&&i.length===1&&(a=i.charCodeAt(0))<256)return this._flat[a]!==-9999?this._flat[a]:this._flat[a]=this._measure(i,0);let h=i;l&&(h+="B"),p&&(h+="I");let f=this._holey.get(h);if(f===void 0){let d=0;l&&(d|=1),p&&(d|=2),f=this._measure(i,d),this._holey.set(h,f)}return f}_measure(i,l){const p=this._measureElements[l];return p.textContent=i.repeat(32),p.offsetWidth/32}}},2223:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TEXT_BASELINE=n.DIM_OPACITY=n.INVERTED_DEFAULT_COLOR=void 0;const l=i(6114);n.INVERTED_DEFAULT_COLOR=257,n.DIM_OPACITY=.5,n.TEXT_BASELINE=l.isFirefox||l.isLegacyEdge?"bottom":"ideographic"},6171:(C,n)=>{function i(l){return 57508<=l&&l<=57558}Object.defineProperty(n,"__esModule",{value:!0}),n.createRenderDimensions=n.excludeFromContrastRatioDemands=n.isRestrictedPowerlineGlyph=n.isPowerlineGlyph=n.throwIfFalsy=void 0,n.throwIfFalsy=function(l){if(!l)throw new Error("value must not be falsy");return l},n.isPowerlineGlyph=i,n.isRestrictedPowerlineGlyph=function(l){return 57520<=l&&l<=57527},n.excludeFromContrastRatioDemands=function(l){return i(l)||function(p){return 9472<=p&&p<=9631}(l)},n.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SelectionModel=void 0,n.SelectionModel=class{constructor(i){this._bufferService=i,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const i=this.selectionStart[0]+this.selectionStartLength;return i>this._bufferService.cols?i%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(i/this._bufferService.cols)-1]:[i%this._bufferService.cols,this.selectionStart[1]+Math.floor(i/this._bufferService.cols)]:[i,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const i=this.selectionStart[0]+this.selectionStartLength;return i>this._bufferService.cols?[i%this._bufferService.cols,this.selectionStart[1]+Math.floor(i/this._bufferService.cols)]:[Math.max(i,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const i=this.selectionStart,l=this.selectionEnd;return!(!i||!l)&&(i[1]>l[1]||i[1]===l[1]&&i[0]>l[0])}handleTrim(i){return this.selectionStart&&(this.selectionStart[1]-=i),this.selectionEnd&&(this.selectionEnd[1]-=i),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(C,n,i){var l=this&&this.__decorate||function(t,s,o,r){var m,g=arguments.length,k=g<3?s:r===null?r=Object.getOwnPropertyDescriptor(s,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(t,s,o,r);else for(var D=t.length-1;D>=0;D--)(m=t[D])&&(k=(g<3?m(k):g>3?m(s,o,k):m(s,o))||k);return g>3&&k&&Object.defineProperty(s,o,k),k},p=this&&this.__param||function(t,s){return function(o,r){s(o,r,t)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CharSizeService=void 0;const a=i(2585),h=i(8460),f=i(844);let d=n.CharSizeService=class extends f.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(t,s,o){super(),this._optionsService=o,this.width=0,this.height=0,this._onCharSizeChange=this.register(new h.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new u(t,s,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const t=this._measureStrategy.measure();t.width===this.width&&t.height===this.height||(this.width=t.width,this.height=t.height,this._onCharSizeChange.fire())}};n.CharSizeService=d=l([p(2,a.IOptionsService)],d);class u{constructor(s,o,r){this._document=s,this._parentElement=o,this._optionsService=r,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const s={height:Number(this._measureElement.offsetHeight),width:Number(this._measureElement.offsetWidth)};return s.width!==0&&s.height!==0&&(this._result.width=s.width/32,this._result.height=Math.ceil(s.height)),this._result}}},4269:function(C,n,i){var l=this&&this.__decorate||function(s,o,r,m){var g,k=arguments.length,D=k<3?o:m===null?m=Object.getOwnPropertyDescriptor(o,r):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(s,o,r,m);else for(var w=s.length-1;w>=0;w--)(g=s[w])&&(D=(k<3?g(D):k>3?g(o,r,D):g(o,r))||D);return k>3&&D&&Object.defineProperty(o,r,D),D},p=this&&this.__param||function(s,o){return function(r,m){o(r,m,s)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CharacterJoinerService=n.JoinedCellData=void 0;const a=i(3734),h=i(643),f=i(511),d=i(2585);class u extends a.AttributeData{constructor(o,r,m){super(),this.content=0,this.combinedData="",this.fg=o.fg,this.bg=o.bg,this.combinedData=r,this._width=m}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(o){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}n.JoinedCellData=u;let t=n.CharacterJoinerService=class kn{constructor(o){this._bufferService=o,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new f.CellData}register(o){const r={id:this._nextCharacterJoinerId++,handler:o};return this._characterJoiners.push(r),r.id}deregister(o){for(let r=0;r<this._characterJoiners.length;r++)if(this._characterJoiners[r].id===o)return this._characterJoiners.splice(r,1),!0;return!1}getJoinedCharacters(o){if(this._characterJoiners.length===0)return[];const r=this._bufferService.buffer.lines.get(o);if(!r||r.length===0)return[];const m=[],g=r.translateToString(!0);let k=0,D=0,w=0,S=r.getFg(0),M=r.getBg(0);for(let I=0;I<r.getTrimmedLength();I++)if(r.loadCell(I,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==S||this._workCell.bg!==M){if(I-k>1){const y=this._getJoinedRanges(g,w,D,r,k);for(let T=0;T<y.length;T++)m.push(y[T])}k=I,w=D,S=this._workCell.fg,M=this._workCell.bg}D+=this._workCell.getChars().length||h.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-k>1){const I=this._getJoinedRanges(g,w,D,r,k);for(let y=0;y<I.length;y++)m.push(I[y])}return m}_getJoinedRanges(o,r,m,g,k){const D=o.substring(r,m);let w=[];try{w=this._characterJoiners[0].handler(D)}catch(S){console.error(S)}for(let S=1;S<this._characterJoiners.length;S++)try{const M=this._characterJoiners[S].handler(D);for(let I=0;I<M.length;I++)kn._mergeRanges(w,M[I])}catch(M){console.error(M)}return this._stringRangesToCellRanges(w,g,k),w}_stringRangesToCellRanges(o,r,m){let g=0,k=!1,D=0,w=o[g];if(w){for(let S=m;S<this._bufferService.cols;S++){const M=r.getWidth(S),I=r.getString(S).length||h.WHITESPACE_CELL_CHAR.length;if(M!==0){if(!k&&w[0]<=D&&(w[0]=S,k=!0),w[1]<=D){if(w[1]=S,w=o[++g],!w)break;w[0]<=D?(w[0]=S,k=!0):k=!1}D+=I}}w&&(w[1]=this._bufferService.cols)}}static _mergeRanges(o,r){let m=!1;for(let g=0;g<o.length;g++){const k=o[g];if(m){if(r[1]<=k[0])return o[g-1][1]=r[1],o;if(r[1]<=k[1])return o[g-1][1]=Math.max(r[1],k[1]),o.splice(g,1),o;o.splice(g,1),g--}else{if(r[1]<=k[0])return o.splice(g,0,r),o;if(r[1]<=k[1])return k[0]=Math.min(r[0],k[0]),o;r[0]<k[1]&&(k[0]=Math.min(r[0],k[0]),m=!0)}}return m?o[o.length-1][1]=r[1]:o.push(r),o}};n.CharacterJoinerService=t=l([p(0,d.IBufferService)],t)},5114:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CoreBrowserService=void 0,n.CoreBrowserService=class{constructor(i,l){this._textarea=i,this.window=l,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(C,n,i){var l=this&&this.__decorate||function(d,u,t,s){var o,r=arguments.length,m=r<3?u:s===null?s=Object.getOwnPropertyDescriptor(u,t):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(d,u,t,s);else for(var g=d.length-1;g>=0;g--)(o=d[g])&&(m=(r<3?o(m):r>3?o(u,t,m):o(u,t))||m);return r>3&&m&&Object.defineProperty(u,t,m),m},p=this&&this.__param||function(d,u){return function(t,s){u(t,s,d)}};Object.defineProperty(n,"__esModule",{value:!0}),n.MouseService=void 0;const a=i(4725),h=i(9806);let f=n.MouseService=class{constructor(d,u){this._renderService=d,this._charSizeService=u}getCoords(d,u,t,s,o){return(0,h.getCoords)(window,d,u,t,s,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,o)}getMouseReportCoords(d,u){const t=(0,h.getCoordsRelativeToElement)(window,d,u);if(this._charSizeService.hasValidSize)return t[0]=Math.min(Math.max(t[0],0),this._renderService.dimensions.css.canvas.width-1),t[1]=Math.min(Math.max(t[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(t[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(t[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(t[0]),y:Math.floor(t[1])}}};n.MouseService=f=l([p(0,a.IRenderService),p(1,a.ICharSizeService)],f)},3230:function(C,n,i){var l=this&&this.__decorate||function(m,g,k,D){var w,S=arguments.length,M=S<3?g:D===null?D=Object.getOwnPropertyDescriptor(g,k):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(m,g,k,D);else for(var I=m.length-1;I>=0;I--)(w=m[I])&&(M=(S<3?w(M):S>3?w(g,k,M):w(g,k))||M);return S>3&&M&&Object.defineProperty(g,k,M),M},p=this&&this.__param||function(m,g){return function(k,D){g(k,D,m)}};Object.defineProperty(n,"__esModule",{value:!0}),n.RenderService=void 0;const a=i(3656),h=i(6193),f=i(5596),d=i(4725),u=i(8460),t=i(844),s=i(7226),o=i(2585);let r=n.RenderService=class extends t.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(m,g,k,D,w,S,M,I){if(super(),this._rowCount=m,this._charSizeService=D,this._renderer=this.register(new t.MutableDisposable),this._pausedResizeTask=new s.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new u.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new u.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new u.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new u.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new h.RenderDebouncer(M.window,(y,T)=>this._renderRows(y,T)),this.register(this._renderDebouncer),this._screenDprMonitor=new f.ScreenDprMonitor(M.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(S.onResize(()=>this._fullRefresh())),this.register(S.buffers.onBufferActivate(()=>{var y;return(y=this._renderer.value)===null||y===void 0?void 0:y.clear()})),this.register(k.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(w.onDecorationRegistered(()=>this._fullRefresh())),this.register(w.onDecorationRemoved(()=>this._fullRefresh())),this.register(k.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(S.cols,S.rows),this._fullRefresh()})),this.register(k.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(S.buffer.y,S.buffer.y,!0))),this.register((0,a.addDisposableDomListener)(M.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(I.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in M.window){const y=new M.window.IntersectionObserver(T=>this._handleIntersectionChange(T[T.length-1]),{threshold:0});y.observe(g),this.register({dispose:()=>y.disconnect()})}}_handleIntersectionChange(m){this._isPaused=m.isIntersecting===void 0?m.intersectionRatio===0:!m.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(m,g,k=!1){this._isPaused?this._needsFullRefresh=!0:(k||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(m,g,this._rowCount))}_renderRows(m,g){this._renderer.value&&(m=Math.min(m,this._rowCount-1),g=Math.min(g,this._rowCount-1),this._renderer.value.renderRows(m,g),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:m,end:g}),this._onRender.fire({start:m,end:g}),this._isNextRenderRedrawOnly=!0)}resize(m,g){this._rowCount=g,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(m){this._renderer.value=m,this._renderer.value.onRequestRedraw(g=>this.refreshRows(g.start,g.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(m){return this._renderDebouncer.addRefreshCallback(m)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var m,g;this._renderer.value&&((g=(m=this._renderer.value).clearTextureAtlas)===null||g===void 0||g.call(m),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(m,g){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value.handleResize(m,g)):this._renderer.value.handleResize(m,g),this._fullRefresh())}handleCharSizeChanged(){var m;(m=this._renderer.value)===null||m===void 0||m.handleCharSizeChanged()}handleBlur(){var m;(m=this._renderer.value)===null||m===void 0||m.handleBlur()}handleFocus(){var m;(m=this._renderer.value)===null||m===void 0||m.handleFocus()}handleSelectionChanged(m,g,k){var D;this._selectionState.start=m,this._selectionState.end=g,this._selectionState.columnSelectMode=k,(D=this._renderer.value)===null||D===void 0||D.handleSelectionChanged(m,g,k)}handleCursorMove(){var m;(m=this._renderer.value)===null||m===void 0||m.handleCursorMove()}clear(){var m;(m=this._renderer.value)===null||m===void 0||m.clear()}};n.RenderService=r=l([p(2,o.IOptionsService),p(3,d.ICharSizeService),p(4,o.IDecorationService),p(5,o.IBufferService),p(6,d.ICoreBrowserService),p(7,d.IThemeService)],r)},9312:function(C,n,i){var l=this&&this.__decorate||function(w,S,M,I){var y,T=arguments.length,A=T<3?S:I===null?I=Object.getOwnPropertyDescriptor(S,M):I;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(w,S,M,I);else for(var H=w.length-1;H>=0;H--)(y=w[H])&&(A=(T<3?y(A):T>3?y(S,M,A):y(S,M))||A);return T>3&&A&&Object.defineProperty(S,M,A),A},p=this&&this.__param||function(w,S){return function(M,I){S(M,I,w)}};Object.defineProperty(n,"__esModule",{value:!0}),n.SelectionService=void 0;const a=i(9806),h=i(9504),f=i(456),d=i(4725),u=i(8460),t=i(844),s=i(6114),o=i(4841),r=i(511),m=i(2585),g=String.fromCharCode(160),k=new RegExp(g,"g");let D=n.SelectionService=class extends t.Disposable{constructor(w,S,M,I,y,T,A,H,P){super(),this._element=w,this._screenElement=S,this._linkifier=M,this._bufferService=I,this._coreService=y,this._mouseService=T,this._optionsService=A,this._renderService=H,this._coreBrowserService=P,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new r.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new u.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new u.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new u.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new u.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=F=>this._handleMouseMove(F),this._mouseUpListener=F=>this._handleMouseUp(F),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(F=>this._handleTrim(F)),this.register(this._bufferService.buffers.onBufferActivate(F=>this._handleBufferActivate(F))),this.enable(),this._model=new f.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,t.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const w=this._model.finalSelectionStart,S=this._model.finalSelectionEnd;return!(!w||!S||w[0]===S[0]&&w[1]===S[1])}get selectionText(){const w=this._model.finalSelectionStart,S=this._model.finalSelectionEnd;if(!w||!S)return"";const M=this._bufferService.buffer,I=[];if(this._activeSelectionMode===3){if(w[0]===S[0])return"";const y=w[0]<S[0]?w[0]:S[0],T=w[0]<S[0]?S[0]:w[0];for(let A=w[1];A<=S[1];A++){const H=M.translateBufferLineToString(A,!0,y,T);I.push(H)}}else{const y=w[1]===S[1]?S[0]:void 0;I.push(M.translateBufferLineToString(w[1],!0,w[0],y));for(let T=w[1]+1;T<=S[1]-1;T++){const A=M.lines.get(T),H=M.translateBufferLineToString(T,!0);A!=null&&A.isWrapped?I[I.length-1]+=H:I.push(H)}if(w[1]!==S[1]){const T=M.lines.get(S[1]),A=M.translateBufferLineToString(S[1],!0,0,S[0]);T&&T.isWrapped?I[I.length-1]+=A:I.push(A)}}return I.map(y=>y.replace(k," ")).join(s.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(w){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),s.isLinux&&w&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(w){const S=this._getMouseBufferCoords(w),M=this._model.finalSelectionStart,I=this._model.finalSelectionEnd;return!!(M&&I&&S)&&this._areCoordsInSelection(S,M,I)}isCellInSelection(w,S){const M=this._model.finalSelectionStart,I=this._model.finalSelectionEnd;return!(!M||!I)&&this._areCoordsInSelection([w,S],M,I)}_areCoordsInSelection(w,S,M){return w[1]>S[1]&&w[1]<M[1]||S[1]===M[1]&&w[1]===S[1]&&w[0]>=S[0]&&w[0]<M[0]||S[1]<M[1]&&w[1]===M[1]&&w[0]<M[0]||S[1]<M[1]&&w[1]===S[1]&&w[0]>=S[0]}_selectWordAtCursor(w,S){var M,I;const y=(I=(M=this._linkifier.currentLink)===null||M===void 0?void 0:M.link)===null||I===void 0?void 0:I.range;if(y)return this._model.selectionStart=[y.start.x-1,y.start.y-1],this._model.selectionStartLength=(0,o.getRangeLength)(y,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const T=this._getMouseBufferCoords(w);return!!T&&(this._selectWordAt(T,S),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(w,S){this._model.clearSelection(),w=Math.max(w,0),S=Math.min(S,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,w],this._model.selectionEnd=[this._bufferService.cols,S],this.refresh(),this._onSelectionChange.fire()}_handleTrim(w){this._model.handleTrim(w)&&this.refresh()}_getMouseBufferCoords(w){const S=this._mouseService.getCoords(w,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(S)return S[0]--,S[1]--,S[1]+=this._bufferService.buffer.ydisp,S}_getMouseEventScrollAmount(w){let S=(0,a.getCoordsRelativeToElement)(this._coreBrowserService.window,w,this._screenElement)[1];const M=this._renderService.dimensions.css.canvas.height;return S>=0&&S<=M?0:(S>M&&(S-=M),S=Math.min(Math.max(S,-50),50),S/=50,S/Math.abs(S)+Math.round(14*S))}shouldForceSelection(w){return s.isMac?w.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:w.shiftKey}handleMouseDown(w){if(this._mouseDownTimeStamp=w.timeStamp,(w.button!==2||!this.hasSelection)&&w.button===0){if(!this._enabled){if(!this.shouldForceSelection(w))return;w.stopPropagation()}w.preventDefault(),this._dragScrollAmount=0,this._enabled&&w.shiftKey?this._handleIncrementalClick(w):w.detail===1?this._handleSingleClick(w):w.detail===2?this._handleDoubleClick(w):w.detail===3&&this._handleTripleClick(w),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(w){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(w))}_handleSingleClick(w){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(w)?3:0,this._model.selectionStart=this._getMouseBufferCoords(w),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const S=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);S&&S.length!==this._model.selectionStart[0]&&S.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(w){this._selectWordAtCursor(w,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(w){const S=this._getMouseBufferCoords(w);S&&(this._activeSelectionMode=2,this._selectLineAt(S[1]))}shouldColumnSelect(w){return w.altKey&&!(s.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(w){if(w.stopImmediatePropagation(),!this._model.selectionStart)return;const S=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(w),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(w),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const M=this._bufferService.buffer;if(this._model.selectionEnd[1]<M.lines.length){const I=M.lines.get(this._model.selectionEnd[1]);I&&I.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}S&&S[0]===this._model.selectionEnd[0]&&S[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const w=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(w.ydisp+this._bufferService.rows,w.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=w.ydisp),this.refresh()}}_handleMouseUp(w){const S=w.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&S<500&&w.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const M=this._mouseService.getCoords(w,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(M&&M[0]!==void 0&&M[1]!==void 0){const I=(0,h.moveToCellSequence)(M[0]-1,M[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(I,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const w=this._model.finalSelectionStart,S=this._model.finalSelectionEnd,M=!(!w||!S||w[0]===S[0]&&w[1]===S[1]);M?w&&S&&(this._oldSelectionStart&&this._oldSelectionEnd&&w[0]===this._oldSelectionStart[0]&&w[1]===this._oldSelectionStart[1]&&S[0]===this._oldSelectionEnd[0]&&S[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(w,S,M)):this._oldHasSelection&&this._fireOnSelectionChange(w,S,M)}_fireOnSelectionChange(w,S,M){this._oldSelectionStart=w,this._oldSelectionEnd=S,this._oldHasSelection=M,this._onSelectionChange.fire()}_handleBufferActivate(w){this.clearSelection(),this._trimListener.dispose(),this._trimListener=w.activeBuffer.lines.onTrim(S=>this._handleTrim(S))}_convertViewportColToCharacterIndex(w,S){let M=S;for(let I=0;S>=I;I++){const y=w.loadCell(I,this._workCell).getChars().length;this._workCell.getWidth()===0?M--:y>1&&S!==I&&(M+=y-1)}return M}setSelection(w,S,M){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[w,S],this._model.selectionStartLength=M,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(w){this._isClickInSelection(w)||(this._selectWordAtCursor(w,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(w,S,M=!0,I=!0){if(w[0]>=this._bufferService.cols)return;const y=this._bufferService.buffer,T=y.lines.get(w[1]);if(!T)return;const A=y.translateBufferLineToString(w[1],!1);let H=this._convertViewportColToCharacterIndex(T,w[0]),P=H;const F=w[0]-H;let L=0,B=0,O=0,N=0;if(A.charAt(H)===" "){for(;H>0&&A.charAt(H-1)===" ";)H--;for(;P<A.length&&A.charAt(P+1)===" ";)P++}else{let U=w[0],j=w[0];T.getWidth(U)===0&&(L++,U--),T.getWidth(j)===2&&(B++,j++);const Y=T.getString(j).length;for(Y>1&&(N+=Y-1,P+=Y-1);U>0&&H>0&&!this._isCharWordSeparator(T.loadCell(U-1,this._workCell));){T.loadCell(U-1,this._workCell);const R=this._workCell.getChars().length;this._workCell.getWidth()===0?(L++,U--):R>1&&(O+=R-1,H-=R-1),H--,U--}for(;j<T.length&&P+1<A.length&&!this._isCharWordSeparator(T.loadCell(j+1,this._workCell));){T.loadCell(j+1,this._workCell);const R=this._workCell.getChars().length;this._workCell.getWidth()===2?(B++,j++):R>1&&(N+=R-1,P+=R-1),P++,j++}}P++;let z=H+F-L+O,W=Math.min(this._bufferService.cols,P-H+L+B-O-N);if(S||A.slice(H,P).trim()!==""){if(M&&z===0&&T.getCodePoint(0)!==32){const U=y.lines.get(w[1]-1);if(U&&T.isWrapped&&U.getCodePoint(this._bufferService.cols-1)!==32){const j=this._getWordAt([this._bufferService.cols-1,w[1]-1],!1,!0,!1);if(j){const Y=this._bufferService.cols-j.start;z-=Y,W+=Y}}}if(I&&z+W===this._bufferService.cols&&T.getCodePoint(this._bufferService.cols-1)!==32){const U=y.lines.get(w[1]+1);if(U!=null&&U.isWrapped&&U.getCodePoint(0)!==32){const j=this._getWordAt([0,w[1]+1],!1,!1,!0);j&&(W+=j.length)}}return{start:z,length:W}}}_selectWordAt(w,S){const M=this._getWordAt(w,S);if(M){for(;M.start<0;)M.start+=this._bufferService.cols,w[1]--;this._model.selectionStart=[M.start,w[1]],this._model.selectionStartLength=M.length}}_selectToWordAt(w){const S=this._getWordAt(w,!0);if(S){let M=w[1];for(;S.start<0;)S.start+=this._bufferService.cols,M--;if(!this._model.areSelectionValuesReversed())for(;S.start+S.length>this._bufferService.cols;)S.length-=this._bufferService.cols,M++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?S.start:S.start+S.length,M]}}_isCharWordSeparator(w){return w.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(w.getChars())>=0}_selectLineAt(w){const S=this._bufferService.buffer.getWrappedRangeForLine(w),M={start:{x:0,y:S.first},end:{x:this._bufferService.cols-1,y:S.last}};this._model.selectionStart=[0,S.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,o.getRangeLength)(M,this._bufferService.cols)}};n.SelectionService=D=l([p(3,m.IBufferService),p(4,m.ICoreService),p(5,d.IMouseService),p(6,m.IOptionsService),p(7,d.IRenderService),p(8,d.ICoreBrowserService)],D)},4725:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.IThemeService=n.ICharacterJoinerService=n.ISelectionService=n.IRenderService=n.IMouseService=n.ICoreBrowserService=n.ICharSizeService=void 0;const l=i(8343);n.ICharSizeService=(0,l.createDecorator)("CharSizeService"),n.ICoreBrowserService=(0,l.createDecorator)("CoreBrowserService"),n.IMouseService=(0,l.createDecorator)("MouseService"),n.IRenderService=(0,l.createDecorator)("RenderService"),n.ISelectionService=(0,l.createDecorator)("SelectionService"),n.ICharacterJoinerService=(0,l.createDecorator)("CharacterJoinerService"),n.IThemeService=(0,l.createDecorator)("ThemeService")},6731:function(C,n,i){var l=this&&this.__decorate||function(D,w,S,M){var I,y=arguments.length,T=y<3?w:M===null?M=Object.getOwnPropertyDescriptor(w,S):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(D,w,S,M);else for(var A=D.length-1;A>=0;A--)(I=D[A])&&(T=(y<3?I(T):y>3?I(w,S,T):I(w,S))||T);return y>3&&T&&Object.defineProperty(w,S,T),T},p=this&&this.__param||function(D,w){return function(S,M){w(S,M,D)}};Object.defineProperty(n,"__esModule",{value:!0}),n.ThemeService=n.DEFAULT_ANSI_COLORS=void 0;const a=i(7239),h=i(8055),f=i(8460),d=i(844),u=i(2585),t=h.css.toColor("#ffffff"),s=h.css.toColor("#000000"),o=h.css.toColor("#ffffff"),r=h.css.toColor("#000000"),m={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};n.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const D=[h.css.toColor("#2e3436"),h.css.toColor("#cc0000"),h.css.toColor("#4e9a06"),h.css.toColor("#c4a000"),h.css.toColor("#3465a4"),h.css.toColor("#75507b"),h.css.toColor("#06989a"),h.css.toColor("#d3d7cf"),h.css.toColor("#555753"),h.css.toColor("#ef2929"),h.css.toColor("#8ae234"),h.css.toColor("#fce94f"),h.css.toColor("#729fcf"),h.css.toColor("#ad7fa8"),h.css.toColor("#34e2e2"),h.css.toColor("#eeeeec")],w=[0,95,135,175,215,255];for(let S=0;S<216;S++){const M=w[S/36%6|0],I=w[S/6%6|0],y=w[S%6];D.push({css:h.channels.toCss(M,I,y),rgba:h.channels.toRgba(M,I,y)})}for(let S=0;S<24;S++){const M=8+10*S;D.push({css:h.channels.toCss(M,M,M),rgba:h.channels.toRgba(M,M,M)})}return D})());let g=n.ThemeService=class extends d.Disposable{get colors(){return this._colors}constructor(D){super(),this._optionsService=D,this._contrastCache=new a.ColorContrastCache,this._halfContrastCache=new a.ColorContrastCache,this._onChangeColors=this.register(new f.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:t,background:s,cursor:o,cursorAccent:r,selectionForeground:void 0,selectionBackgroundTransparent:m,selectionBackgroundOpaque:h.color.blend(s,m),selectionInactiveBackgroundTransparent:m,selectionInactiveBackgroundOpaque:h.color.blend(s,m),ansi:n.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(D={}){const w=this._colors;if(w.foreground=k(D.foreground,t),w.background=k(D.background,s),w.cursor=k(D.cursor,o),w.cursorAccent=k(D.cursorAccent,r),w.selectionBackgroundTransparent=k(D.selectionBackground,m),w.selectionBackgroundOpaque=h.color.blend(w.background,w.selectionBackgroundTransparent),w.selectionInactiveBackgroundTransparent=k(D.selectionInactiveBackground,w.selectionBackgroundTransparent),w.selectionInactiveBackgroundOpaque=h.color.blend(w.background,w.selectionInactiveBackgroundTransparent),w.selectionForeground=D.selectionForeground?k(D.selectionForeground,h.NULL_COLOR):void 0,w.selectionForeground===h.NULL_COLOR&&(w.selectionForeground=void 0),h.color.isOpaque(w.selectionBackgroundTransparent)&&(w.selectionBackgroundTransparent=h.color.opacity(w.selectionBackgroundTransparent,.3)),h.color.isOpaque(w.selectionInactiveBackgroundTransparent)&&(w.selectionInactiveBackgroundTransparent=h.color.opacity(w.selectionInactiveBackgroundTransparent,.3)),w.ansi=n.DEFAULT_ANSI_COLORS.slice(),w.ansi[0]=k(D.black,n.DEFAULT_ANSI_COLORS[0]),w.ansi[1]=k(D.red,n.DEFAULT_ANSI_COLORS[1]),w.ansi[2]=k(D.green,n.DEFAULT_ANSI_COLORS[2]),w.ansi[3]=k(D.yellow,n.DEFAULT_ANSI_COLORS[3]),w.ansi[4]=k(D.blue,n.DEFAULT_ANSI_COLORS[4]),w.ansi[5]=k(D.magenta,n.DEFAULT_ANSI_COLORS[5]),w.ansi[6]=k(D.cyan,n.DEFAULT_ANSI_COLORS[6]),w.ansi[7]=k(D.white,n.DEFAULT_ANSI_COLORS[7]),w.ansi[8]=k(D.brightBlack,n.DEFAULT_ANSI_COLORS[8]),w.ansi[9]=k(D.brightRed,n.DEFAULT_ANSI_COLORS[9]),w.ansi[10]=k(D.brightGreen,n.DEFAULT_ANSI_COLORS[10]),w.ansi[11]=k(D.brightYellow,n.DEFAULT_ANSI_COLORS[11]),w.ansi[12]=k(D.brightBlue,n.DEFAULT_ANSI_COLORS[12]),w.ansi[13]=k(D.brightMagenta,n.DEFAULT_ANSI_COLORS[13]),w.ansi[14]=k(D.brightCyan,n.DEFAULT_ANSI_COLORS[14]),w.ansi[15]=k(D.brightWhite,n.DEFAULT_ANSI_COLORS[15]),D.extendedAnsi){const S=Math.min(w.ansi.length-16,D.extendedAnsi.length);for(let M=0;M<S;M++)w.ansi[M+16]=k(D.extendedAnsi[M],n.DEFAULT_ANSI_COLORS[M+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(D){this._restoreColor(D),this._onChangeColors.fire(this.colors)}_restoreColor(D){if(D!==void 0)switch(D){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[D]=this._restoreColors.ansi[D]}else for(let w=0;w<this._restoreColors.ansi.length;++w)this._colors.ansi[w]=this._restoreColors.ansi[w]}modifyColors(D){D(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function k(D,w){if(D!==void 0)try{return h.css.toColor(D)}catch{}return w}n.ThemeService=g=l([p(0,u.IOptionsService)],g)},6349:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CircularList=void 0;const l=i(8460),p=i(844);class a extends p.Disposable{constructor(f){super(),this._maxLength=f,this.onDeleteEmitter=this.register(new l.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new l.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new l.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(f){if(this._maxLength===f)return;const d=new Array(f);for(let u=0;u<Math.min(f,this.length);u++)d[u]=this._array[this._getCyclicIndex(u)];this._array=d,this._maxLength=f,this._startIndex=0}get length(){return this._length}set length(f){if(f>this._length)for(let d=this._length;d<f;d++)this._array[d]=void 0;this._length=f}get(f){return this._array[this._getCyclicIndex(f)]}set(f,d){this._array[this._getCyclicIndex(f)]=d}push(f){this._array[this._getCyclicIndex(this._length)]=f,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(f,d,...u){if(d){for(let t=f;t<this._length-d;t++)this._array[this._getCyclicIndex(t)]=this._array[this._getCyclicIndex(t+d)];this._length-=d,this.onDeleteEmitter.fire({index:f,amount:d})}for(let t=this._length-1;t>=f;t--)this._array[this._getCyclicIndex(t+u.length)]=this._array[this._getCyclicIndex(t)];for(let t=0;t<u.length;t++)this._array[this._getCyclicIndex(f+t)]=u[t];if(u.length&&this.onInsertEmitter.fire({index:f,amount:u.length}),this._length+u.length>this._maxLength){const t=this._length+u.length-this._maxLength;this._startIndex+=t,this._length=this._maxLength,this.onTrimEmitter.fire(t)}else this._length+=u.length}trimStart(f){f>this._length&&(f=this._length),this._startIndex+=f,this._length-=f,this.onTrimEmitter.fire(f)}shiftElements(f,d,u){if(!(d<=0)){if(f<0||f>=this._length)throw new Error("start argument out of range");if(f+u<0)throw new Error("Cannot shift elements in list beyond index 0");if(u>0){for(let s=d-1;s>=0;s--)this.set(f+s+u,this.get(f+s));const t=f+d+u-this._length;if(t>0)for(this._length+=t;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let t=0;t<d;t++)this.set(f+t+u,this.get(f+t))}}_getCyclicIndex(f){return(this._startIndex+f)%this._maxLength}}n.CircularList=a},1439:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.clone=void 0,n.clone=function i(l,p=5){if(typeof l!="object")return l;const a=Array.isArray(l)?[]:{};for(const h in l)a[h]=p<=1?l[h]:l[h]&&i(l[h],p-1);return a}},8055:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.contrastRatio=n.toPaddedHex=n.rgba=n.rgb=n.css=n.color=n.channels=n.NULL_COLOR=void 0;const l=i(6114);let p=0,a=0,h=0,f=0;var d,u,t,s,o;function r(g){const k=g.toString(16);return k.length<2?"0"+k:k}function m(g,k){return g<k?(k+.05)/(g+.05):(g+.05)/(k+.05)}n.NULL_COLOR={css:"#00000000",rgba:0},function(g){g.toCss=function(k,D,w,S){return S!==void 0?`#${r(k)}${r(D)}${r(w)}${r(S)}`:`#${r(k)}${r(D)}${r(w)}`},g.toRgba=function(k,D,w,S=255){return(k<<24|D<<16|w<<8|S)>>>0}}(d||(n.channels=d={})),function(g){function k(D,w){return f=Math.round(255*w),[p,a,h]=o.toChannels(D.rgba),{css:d.toCss(p,a,h,f),rgba:d.toRgba(p,a,h,f)}}g.blend=function(D,w){if(f=(255&w.rgba)/255,f===1)return{css:w.css,rgba:w.rgba};const S=w.rgba>>24&255,M=w.rgba>>16&255,I=w.rgba>>8&255,y=D.rgba>>24&255,T=D.rgba>>16&255,A=D.rgba>>8&255;return p=y+Math.round((S-y)*f),a=T+Math.round((M-T)*f),h=A+Math.round((I-A)*f),{css:d.toCss(p,a,h),rgba:d.toRgba(p,a,h)}},g.isOpaque=function(D){return(255&D.rgba)==255},g.ensureContrastRatio=function(D,w,S){const M=o.ensureContrastRatio(D.rgba,w.rgba,S);if(M)return o.toColor(M>>24&255,M>>16&255,M>>8&255)},g.opaque=function(D){const w=(255|D.rgba)>>>0;return[p,a,h]=o.toChannels(w),{css:d.toCss(p,a,h),rgba:w}},g.opacity=k,g.multiplyOpacity=function(D,w){return f=255&D.rgba,k(D,f*w/255)},g.toColorRGB=function(D){return[D.rgba>>24&255,D.rgba>>16&255,D.rgba>>8&255]}}(u||(n.color=u={})),function(g){let k,D;if(!l.isNode){const w=document.createElement("canvas");w.width=1,w.height=1;const S=w.getContext("2d",{willReadFrequently:!0});S&&(k=S,k.globalCompositeOperation="copy",D=k.createLinearGradient(0,0,1,1))}g.toColor=function(w){if(w.match(/#[\da-f]{3,8}/i))switch(w.length){case 4:return p=parseInt(w.slice(1,2).repeat(2),16),a=parseInt(w.slice(2,3).repeat(2),16),h=parseInt(w.slice(3,4).repeat(2),16),o.toColor(p,a,h);case 5:return p=parseInt(w.slice(1,2).repeat(2),16),a=parseInt(w.slice(2,3).repeat(2),16),h=parseInt(w.slice(3,4).repeat(2),16),f=parseInt(w.slice(4,5).repeat(2),16),o.toColor(p,a,h,f);case 7:return{css:w,rgba:(parseInt(w.slice(1),16)<<8|255)>>>0};case 9:return{css:w,rgba:parseInt(w.slice(1),16)>>>0}}const S=w.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(S)return p=parseInt(S[1]),a=parseInt(S[2]),h=parseInt(S[3]),f=Math.round(255*(S[5]===void 0?1:parseFloat(S[5]))),o.toColor(p,a,h,f);if(!k||!D)throw new Error("css.toColor: Unsupported css format");if(k.fillStyle=D,k.fillStyle=w,typeof k.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(k.fillRect(0,0,1,1),[p,a,h,f]=k.getImageData(0,0,1,1).data,f!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:d.toRgba(p,a,h,f),css:w}}}(t||(n.css=t={})),function(g){function k(D,w,S){const M=D/255,I=w/255,y=S/255;return .2126*(M<=.03928?M/12.92:Math.pow((M+.055)/1.055,2.4))+.7152*(I<=.03928?I/12.92:Math.pow((I+.055)/1.055,2.4))+.0722*(y<=.03928?y/12.92:Math.pow((y+.055)/1.055,2.4))}g.relativeLuminance=function(D){return k(D>>16&255,D>>8&255,255&D)},g.relativeLuminance2=k}(s||(n.rgb=s={})),function(g){function k(w,S,M){const I=w>>24&255,y=w>>16&255,T=w>>8&255;let A=S>>24&255,H=S>>16&255,P=S>>8&255,F=m(s.relativeLuminance2(A,H,P),s.relativeLuminance2(I,y,T));for(;F<M&&(A>0||H>0||P>0);)A-=Math.max(0,Math.ceil(.1*A)),H-=Math.max(0,Math.ceil(.1*H)),P-=Math.max(0,Math.ceil(.1*P)),F=m(s.relativeLuminance2(A,H,P),s.relativeLuminance2(I,y,T));return(A<<24|H<<16|P<<8|255)>>>0}function D(w,S,M){const I=w>>24&255,y=w>>16&255,T=w>>8&255;let A=S>>24&255,H=S>>16&255,P=S>>8&255,F=m(s.relativeLuminance2(A,H,P),s.relativeLuminance2(I,y,T));for(;F<M&&(A<255||H<255||P<255);)A=Math.min(255,A+Math.ceil(.1*(255-A))),H=Math.min(255,H+Math.ceil(.1*(255-H))),P=Math.min(255,P+Math.ceil(.1*(255-P))),F=m(s.relativeLuminance2(A,H,P),s.relativeLuminance2(I,y,T));return(A<<24|H<<16|P<<8|255)>>>0}g.ensureContrastRatio=function(w,S,M){const I=s.relativeLuminance(w>>8),y=s.relativeLuminance(S>>8);if(m(I,y)<M){if(y<I){const H=k(w,S,M),P=m(I,s.relativeLuminance(H>>8));if(P<M){const F=D(w,S,M);return P>m(I,s.relativeLuminance(F>>8))?H:F}return H}const T=D(w,S,M),A=m(I,s.relativeLuminance(T>>8));if(A<M){const H=k(w,S,M);return A>m(I,s.relativeLuminance(H>>8))?T:H}return T}},g.reduceLuminance=k,g.increaseLuminance=D,g.toChannels=function(w){return[w>>24&255,w>>16&255,w>>8&255,255&w]},g.toColor=function(w,S,M,I){return{css:d.toCss(w,S,M,I),rgba:d.toRgba(w,S,M,I)}}}(o||(n.rgba=o={})),n.toPaddedHex=r,n.contrastRatio=m},8969:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CoreTerminal=void 0;const l=i(844),p=i(2585),a=i(4348),h=i(7866),f=i(744),d=i(7302),u=i(6975),t=i(8460),s=i(1753),o=i(1480),r=i(7994),m=i(9282),g=i(5435),k=i(5981),D=i(2660);let w=!1;class S extends l.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new t.EventEmitter),this._onScroll.event(I=>{var y;(y=this._onScrollApi)===null||y===void 0||y.fire(I.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(I){for(const y in I)this.optionsService.options[y]=I[y]}constructor(I){super(),this._windowsWrappingHeuristics=this.register(new l.MutableDisposable),this._onBinary=this.register(new t.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new t.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new t.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new t.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new t.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new t.EventEmitter),this._instantiationService=new a.InstantiationService,this.optionsService=this.register(new d.OptionsService(I)),this._instantiationService.setService(p.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(f.BufferService)),this._instantiationService.setService(p.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(h.LogService)),this._instantiationService.setService(p.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(u.CoreService)),this._instantiationService.setService(p.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(s.CoreMouseService)),this._instantiationService.setService(p.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(o.UnicodeService)),this._instantiationService.setService(p.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(r.CharsetService),this._instantiationService.setService(p.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(D.OscLinkService),this._instantiationService.setService(p.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new g.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,t.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,t.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,t.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,t.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(y=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(y=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new k.WriteBuffer((y,T)=>this._inputHandler.parse(y,T))),this.register((0,t.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(I,y){this._writeBuffer.write(I,y)}writeSync(I,y){this._logService.logLevel<=p.LogLevelEnum.WARN&&!w&&(this._logService.warn("writeSync is unreliable and will be removed soon."),w=!0),this._writeBuffer.writeSync(I,y)}resize(I,y){isNaN(I)||isNaN(y)||(I=Math.max(I,f.MINIMUM_COLS),y=Math.max(y,f.MINIMUM_ROWS),this._bufferService.resize(I,y))}scroll(I,y=!1){this._bufferService.scroll(I,y)}scrollLines(I,y,T){this._bufferService.scrollLines(I,y,T)}scrollPages(I){this.scrollLines(I*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(I){const y=I-this._bufferService.buffer.ydisp;y!==0&&this.scrollLines(y)}registerEscHandler(I,y){return this._inputHandler.registerEscHandler(I,y)}registerDcsHandler(I,y){return this._inputHandler.registerDcsHandler(I,y)}registerCsiHandler(I,y){return this._inputHandler.registerCsiHandler(I,y)}registerOscHandler(I,y){return this._inputHandler.registerOscHandler(I,y)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let I=!1;const y=this.optionsService.rawOptions.windowsPty;y&&y.buildNumber!==void 0&&y.buildNumber!==void 0?I=y.backend==="conpty"&&y.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(I=!0),I?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const I=[];I.push(this.onLineFeed(m.updateWindowsModeWrappedState.bind(null,this._bufferService))),I.push(this.registerCsiHandler({final:"H"},()=>((0,m.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,l.toDisposable)(()=>{for(const y of I)y.dispose()})}}}n.CoreTerminal=S},8460:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.forwardEvent=n.EventEmitter=void 0,n.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=i=>(this._listeners.push(i),{dispose:()=>{if(!this._disposed){for(let l=0;l<this._listeners.length;l++)if(this._listeners[l]===i)return void this._listeners.splice(l,1)}}})),this._event}fire(i,l){const p=[];for(let a=0;a<this._listeners.length;a++)p.push(this._listeners[a]);for(let a=0;a<p.length;a++)p[a].call(void 0,i,l)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},n.forwardEvent=function(i,l){return i(p=>l.fire(p))}},5435:function(C,n,i){var l=this&&this.__decorate||function(F,L,B,O){var N,z=arguments.length,W=z<3?L:O===null?O=Object.getOwnPropertyDescriptor(L,B):O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")W=Reflect.decorate(F,L,B,O);else for(var U=F.length-1;U>=0;U--)(N=F[U])&&(W=(z<3?N(W):z>3?N(L,B,W):N(L,B))||W);return z>3&&W&&Object.defineProperty(L,B,W),W},p=this&&this.__param||function(F,L){return function(B,O){L(B,O,F)}};Object.defineProperty(n,"__esModule",{value:!0}),n.InputHandler=n.WindowsOptionsReportType=void 0;const a=i(2584),h=i(7116),f=i(2015),d=i(844),u=i(482),t=i(8437),s=i(8460),o=i(643),r=i(511),m=i(3734),g=i(2585),k=i(6242),D=i(6351),w=i(5941),S={"(":0,")":1,"*":2,"+":3,"-":1,".":2},M=131072;function I(F,L){if(F>24)return L.setWinLines||!1;switch(F){case 1:return!!L.restoreWin;case 2:return!!L.minimizeWin;case 3:return!!L.setWinPosition;case 4:return!!L.setWinSizePixels;case 5:return!!L.raiseWin;case 6:return!!L.lowerWin;case 7:return!!L.refreshWin;case 8:return!!L.setWinSizeChars;case 9:return!!L.maximizeWin;case 10:return!!L.fullscreenWin;case 11:return!!L.getWinState;case 13:return!!L.getWinPosition;case 14:return!!L.getWinSizePixels;case 15:return!!L.getScreenSizePixels;case 16:return!!L.getCellSizePixels;case 18:return!!L.getWinSizeChars;case 19:return!!L.getScreenSizeChars;case 20:return!!L.getIconTitle;case 21:return!!L.getWinTitle;case 22:return!!L.pushTitle;case 23:return!!L.popTitle;case 24:return!!L.setWinLines}return!1}var y;(function(F){F[F.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",F[F.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(y||(n.WindowsOptionsReportType=y={}));let T=0;class A extends d.Disposable{getAttrData(){return this._curAttrData}constructor(L,B,O,N,z,W,U,j,Y=new f.EscapeSequenceParser){super(),this._bufferService=L,this._charsetService=B,this._coreService=O,this._logService=N,this._optionsService=z,this._oscLinkService=W,this._coreMouseService=U,this._unicodeService=j,this._parser=Y,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new u.StringToUtf32,this._utf8Decoder=new u.Utf8ToUtf32,this._workCell=new r.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=t.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new s.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new s.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new s.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new s.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new s.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new s.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new s.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new s.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new s.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new s.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new s.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new s.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new s.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new H(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(R=>this._activeBuffer=R.activeBuffer)),this._parser.setCsiHandlerFallback((R,$)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(R),params:$.toArray()})}),this._parser.setEscHandlerFallback(R=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(R)})}),this._parser.setExecuteHandlerFallback(R=>{this._logService.debug("Unknown EXECUTE code: ",{code:R})}),this._parser.setOscHandlerFallback((R,$,q)=>{this._logService.debug("Unknown OSC code: ",{identifier:R,action:$,data:q})}),this._parser.setDcsHandlerFallback((R,$,q)=>{$==="HOOK"&&(q=q.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(R),action:$,payload:q})}),this._parser.setPrintHandler((R,$,q)=>this.print(R,$,q)),this._parser.registerCsiHandler({final:"@"},R=>this.insertChars(R)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},R=>this.scrollLeft(R)),this._parser.registerCsiHandler({final:"A"},R=>this.cursorUp(R)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},R=>this.scrollRight(R)),this._parser.registerCsiHandler({final:"B"},R=>this.cursorDown(R)),this._parser.registerCsiHandler({final:"C"},R=>this.cursorForward(R)),this._parser.registerCsiHandler({final:"D"},R=>this.cursorBackward(R)),this._parser.registerCsiHandler({final:"E"},R=>this.cursorNextLine(R)),this._parser.registerCsiHandler({final:"F"},R=>this.cursorPrecedingLine(R)),this._parser.registerCsiHandler({final:"G"},R=>this.cursorCharAbsolute(R)),this._parser.registerCsiHandler({final:"H"},R=>this.cursorPosition(R)),this._parser.registerCsiHandler({final:"I"},R=>this.cursorForwardTab(R)),this._parser.registerCsiHandler({final:"J"},R=>this.eraseInDisplay(R,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},R=>this.eraseInDisplay(R,!0)),this._parser.registerCsiHandler({final:"K"},R=>this.eraseInLine(R,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},R=>this.eraseInLine(R,!0)),this._parser.registerCsiHandler({final:"L"},R=>this.insertLines(R)),this._parser.registerCsiHandler({final:"M"},R=>this.deleteLines(R)),this._parser.registerCsiHandler({final:"P"},R=>this.deleteChars(R)),this._parser.registerCsiHandler({final:"S"},R=>this.scrollUp(R)),this._parser.registerCsiHandler({final:"T"},R=>this.scrollDown(R)),this._parser.registerCsiHandler({final:"X"},R=>this.eraseChars(R)),this._parser.registerCsiHandler({final:"Z"},R=>this.cursorBackwardTab(R)),this._parser.registerCsiHandler({final:"`"},R=>this.charPosAbsolute(R)),this._parser.registerCsiHandler({final:"a"},R=>this.hPositionRelative(R)),this._parser.registerCsiHandler({final:"b"},R=>this.repeatPrecedingCharacter(R)),this._parser.registerCsiHandler({final:"c"},R=>this.sendDeviceAttributesPrimary(R)),this._parser.registerCsiHandler({prefix:">",final:"c"},R=>this.sendDeviceAttributesSecondary(R)),this._parser.registerCsiHandler({final:"d"},R=>this.linePosAbsolute(R)),this._parser.registerCsiHandler({final:"e"},R=>this.vPositionRelative(R)),this._parser.registerCsiHandler({final:"f"},R=>this.hVPosition(R)),this._parser.registerCsiHandler({final:"g"},R=>this.tabClear(R)),this._parser.registerCsiHandler({final:"h"},R=>this.setMode(R)),this._parser.registerCsiHandler({prefix:"?",final:"h"},R=>this.setModePrivate(R)),this._parser.registerCsiHandler({final:"l"},R=>this.resetMode(R)),this._parser.registerCsiHandler({prefix:"?",final:"l"},R=>this.resetModePrivate(R)),this._parser.registerCsiHandler({final:"m"},R=>this.charAttributes(R)),this._parser.registerCsiHandler({final:"n"},R=>this.deviceStatus(R)),this._parser.registerCsiHandler({prefix:"?",final:"n"},R=>this.deviceStatusPrivate(R)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},R=>this.softReset(R)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},R=>this.setCursorStyle(R)),this._parser.registerCsiHandler({final:"r"},R=>this.setScrollRegion(R)),this._parser.registerCsiHandler({final:"s"},R=>this.saveCursor(R)),this._parser.registerCsiHandler({final:"t"},R=>this.windowOptions(R)),this._parser.registerCsiHandler({final:"u"},R=>this.restoreCursor(R)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},R=>this.insertColumns(R)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},R=>this.deleteColumns(R)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},R=>this.selectProtected(R)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},R=>this.requestMode(R,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},R=>this.requestMode(R,!1)),this._parser.setExecuteHandler(a.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(a.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(a.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(a.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(a.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(a.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(a.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(a.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(a.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(a.C1.IND,()=>this.index()),this._parser.setExecuteHandler(a.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(a.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new k.OscHandler(R=>(this.setTitle(R),this.setIconName(R),!0))),this._parser.registerOscHandler(1,new k.OscHandler(R=>this.setIconName(R))),this._parser.registerOscHandler(2,new k.OscHandler(R=>this.setTitle(R))),this._parser.registerOscHandler(4,new k.OscHandler(R=>this.setOrReportIndexedColor(R))),this._parser.registerOscHandler(8,new k.OscHandler(R=>this.setHyperlink(R))),this._parser.registerOscHandler(10,new k.OscHandler(R=>this.setOrReportFgColor(R))),this._parser.registerOscHandler(11,new k.OscHandler(R=>this.setOrReportBgColor(R))),this._parser.registerOscHandler(12,new k.OscHandler(R=>this.setOrReportCursorColor(R))),this._parser.registerOscHandler(104,new k.OscHandler(R=>this.restoreIndexedColor(R))),this._parser.registerOscHandler(110,new k.OscHandler(R=>this.restoreFgColor(R))),this._parser.registerOscHandler(111,new k.OscHandler(R=>this.restoreBgColor(R))),this._parser.registerOscHandler(112,new k.OscHandler(R=>this.restoreCursorColor(R))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const R in h.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:R},()=>this.selectCharset("("+R)),this._parser.registerEscHandler({intermediates:")",final:R},()=>this.selectCharset(")"+R)),this._parser.registerEscHandler({intermediates:"*",final:R},()=>this.selectCharset("*"+R)),this._parser.registerEscHandler({intermediates:"+",final:R},()=>this.selectCharset("+"+R)),this._parser.registerEscHandler({intermediates:"-",final:R},()=>this.selectCharset("-"+R)),this._parser.registerEscHandler({intermediates:".",final:R},()=>this.selectCharset("."+R)),this._parser.registerEscHandler({intermediates:"/",final:R},()=>this.selectCharset("/"+R));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(R=>(this._logService.error("Parsing error: ",R),R)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new D.DcsHandler((R,$)=>this.requestStatusString(R,$)))}_preserveStack(L,B,O,N){this._parseStack.paused=!0,this._parseStack.cursorStartX=L,this._parseStack.cursorStartY=B,this._parseStack.decodedLength=O,this._parseStack.position=N}_logSlowResolvingAsync(L){this._logService.logLevel<=g.LogLevelEnum.WARN&&Promise.race([L,new Promise((B,O)=>setTimeout(()=>O("#SLOW_TIMEOUT"),5e3))]).catch(B=>{if(B!=="#SLOW_TIMEOUT")throw B;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(L,B){let O,N=this._activeBuffer.x,z=this._activeBuffer.y,W=0;const U=this._parseStack.paused;if(U){if(O=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,B))return this._logSlowResolvingAsync(O),O;N=this._parseStack.cursorStartX,z=this._parseStack.cursorStartY,this._parseStack.paused=!1,L.length>M&&(W=this._parseStack.position+M)}if(this._logService.logLevel<=g.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof L=="string"?` "${L}"`:` "${Array.prototype.map.call(L,j=>String.fromCharCode(j)).join("")}"`),typeof L=="string"?L.split("").map(j=>j.charCodeAt(0)):L),this._parseBuffer.length<L.length&&this._parseBuffer.length<M&&(this._parseBuffer=new Uint32Array(Math.min(L.length,M))),U||this._dirtyRowTracker.clearRange(),L.length>M)for(let j=W;j<L.length;j+=M){const Y=j+M<L.length?j+M:L.length,R=typeof L=="string"?this._stringDecoder.decode(L.substring(j,Y),this._parseBuffer):this._utf8Decoder.decode(L.subarray(j,Y),this._parseBuffer);if(O=this._parser.parse(this._parseBuffer,R))return this._preserveStack(N,z,R,j),this._logSlowResolvingAsync(O),O}else if(!U){const j=typeof L=="string"?this._stringDecoder.decode(L,this._parseBuffer):this._utf8Decoder.decode(L,this._parseBuffer);if(O=this._parser.parse(this._parseBuffer,j))return this._preserveStack(N,z,j,0),this._logSlowResolvingAsync(O),O}this._activeBuffer.x===N&&this._activeBuffer.y===z||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(L,B,O){let N,z;const W=this._charsetService.charset,U=this._optionsService.rawOptions.screenReaderMode,j=this._bufferService.cols,Y=this._coreService.decPrivateModes.wraparound,R=this._coreService.modes.insertMode,$=this._curAttrData;let q=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&O-B>0&&q.getWidth(this._activeBuffer.x-1)===2&&q.setCellFromCodePoint(this._activeBuffer.x-1,0,1,$.fg,$.bg,$.extended);for(let X=B;X<O;++X){if(N=L[X],z=this._unicodeService.wcwidth(N),N<127&&W){const se=W[String.fromCharCode(N)];se&&(N=se.charCodeAt(0))}if(U&&this._onA11yChar.fire((0,u.stringFromCodePoint)(N)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),z||!this._activeBuffer.x){if(this._activeBuffer.x+z-1>=j){if(Y){for(;this._activeBuffer.x<j;)q.setCellFromCodePoint(this._activeBuffer.x++,0,1,$.fg,$.bg,$.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),q=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=j-1,z===2)continue}if(R&&(q.insertCells(this._activeBuffer.x,z,this._activeBuffer.getNullCell($),$),q.getWidth(j-1)===2&&q.setCellFromCodePoint(j-1,o.NULL_CELL_CODE,o.NULL_CELL_WIDTH,$.fg,$.bg,$.extended)),q.setCellFromCodePoint(this._activeBuffer.x++,N,z,$.fg,$.bg,$.extended),z>0)for(;--z;)q.setCellFromCodePoint(this._activeBuffer.x++,0,0,$.fg,$.bg,$.extended)}else q.getWidth(this._activeBuffer.x-1)?q.addCodepointToCell(this._activeBuffer.x-1,N):q.addCodepointToCell(this._activeBuffer.x-2,N)}O-B>0&&(q.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<j&&O-B>0&&q.getWidth(this._activeBuffer.x)===0&&!q.hasContent(this._activeBuffer.x)&&q.setCellFromCodePoint(this._activeBuffer.x,0,1,$.fg,$.bg,$.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(L,B){return L.final!=="t"||L.prefix||L.intermediates?this._parser.registerCsiHandler(L,B):this._parser.registerCsiHandler(L,O=>!I(O.params[0],this._optionsService.rawOptions.windowOptions)||B(O))}registerDcsHandler(L,B){return this._parser.registerDcsHandler(L,new D.DcsHandler(B))}registerEscHandler(L,B){return this._parser.registerEscHandler(L,B)}registerOscHandler(L,B){return this._parser.registerOscHandler(L,new k.OscHandler(B))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var L;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||L===void 0)&&L.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);B.hasWidth(this._activeBuffer.x)&&!B.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const L=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-L),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(L=this._bufferService.cols-1){this._activeBuffer.x=Math.min(L,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(L,B){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=L,this._activeBuffer.y=this._activeBuffer.scrollTop+B):(this._activeBuffer.x=L,this._activeBuffer.y=B),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(L,B){this._restrictCursor(),this._setCursor(this._activeBuffer.x+L,this._activeBuffer.y+B)}cursorUp(L){const B=this._activeBuffer.y-this._activeBuffer.scrollTop;return B>=0?this._moveCursor(0,-Math.min(B,L.params[0]||1)):this._moveCursor(0,-(L.params[0]||1)),!0}cursorDown(L){const B=this._activeBuffer.scrollBottom-this._activeBuffer.y;return B>=0?this._moveCursor(0,Math.min(B,L.params[0]||1)):this._moveCursor(0,L.params[0]||1),!0}cursorForward(L){return this._moveCursor(L.params[0]||1,0),!0}cursorBackward(L){return this._moveCursor(-(L.params[0]||1),0),!0}cursorNextLine(L){return this.cursorDown(L),this._activeBuffer.x=0,!0}cursorPrecedingLine(L){return this.cursorUp(L),this._activeBuffer.x=0,!0}cursorCharAbsolute(L){return this._setCursor((L.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(L){return this._setCursor(L.length>=2?(L.params[1]||1)-1:0,(L.params[0]||1)-1),!0}charPosAbsolute(L){return this._setCursor((L.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(L){return this._moveCursor(L.params[0]||1,0),!0}linePosAbsolute(L){return this._setCursor(this._activeBuffer.x,(L.params[0]||1)-1),!0}vPositionRelative(L){return this._moveCursor(0,L.params[0]||1),!0}hVPosition(L){return this.cursorPosition(L),!0}tabClear(L){const B=L.params[0];return B===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:B===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(L){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let B=L.params[0]||1;for(;B--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(L){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let B=L.params[0]||1;for(;B--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(L){const B=L.params[0];return B===1&&(this._curAttrData.bg|=536870912),B!==2&&B!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(L,B,O,N=!1,z=!1){const W=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);W.replaceCells(B,O,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),z),N&&(W.isWrapped=!1)}_resetBufferLine(L,B=!1){const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);O&&(O.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),B),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+L),O.isWrapped=!1)}eraseInDisplay(L,B=!1){let O;switch(this._restrictCursor(this._bufferService.cols),L.params[0]){case 0:for(O=this._activeBuffer.y,this._dirtyRowTracker.markDirty(O),this._eraseInBufferLine(O++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,B);O<this._bufferService.rows;O++)this._resetBufferLine(O,B);this._dirtyRowTracker.markDirty(O);break;case 1:for(O=this._activeBuffer.y,this._dirtyRowTracker.markDirty(O),this._eraseInBufferLine(O,0,this._activeBuffer.x+1,!0,B),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(O+1).isWrapped=!1);O--;)this._resetBufferLine(O,B);this._dirtyRowTracker.markDirty(0);break;case 2:for(O=this._bufferService.rows,this._dirtyRowTracker.markDirty(O-1);O--;)this._resetBufferLine(O,B);this._dirtyRowTracker.markDirty(0);break;case 3:const N=this._activeBuffer.lines.length-this._bufferService.rows;N>0&&(this._activeBuffer.lines.trimStart(N),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-N,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-N,0),this._onScroll.fire(0))}return!0}eraseInLine(L,B=!1){switch(this._restrictCursor(this._bufferService.cols),L.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,B);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,B);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,B)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(L){this._restrictCursor();let B=L.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=this._activeBuffer.ybase+this._activeBuffer.y,N=this._bufferService.rows-1-this._activeBuffer.scrollBottom,z=this._bufferService.rows-1+this._activeBuffer.ybase-N+1;for(;B--;)this._activeBuffer.lines.splice(z-1,1),this._activeBuffer.lines.splice(O,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(L){this._restrictCursor();let B=L.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=this._activeBuffer.ybase+this._activeBuffer.y;let N;for(N=this._bufferService.rows-1-this._activeBuffer.scrollBottom,N=this._bufferService.rows-1+this._activeBuffer.ybase-N;B--;)this._activeBuffer.lines.splice(O,1),this._activeBuffer.lines.splice(N,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(L){this._restrictCursor();const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return B&&(B.insertCells(this._activeBuffer.x,L.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(L){this._restrictCursor();const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return B&&(B.deleteCells(this._activeBuffer.x,L.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(L){let B=L.params[0]||1;for(;B--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(L){let B=L.params[0]||1;for(;B--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(t.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=L.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const N=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);N.deleteCells(0,B,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),N.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=L.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const N=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);N.insertCells(0,B,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),N.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=L.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const N=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);N.insertCells(this._activeBuffer.x,B,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),N.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=L.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const N=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);N.deleteCells(this._activeBuffer.x,B,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),N.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(L){this._restrictCursor();const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return B&&(B.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(L.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(L){if(!this._parser.precedingCodepoint)return!0;const B=L.params[0]||1,O=new Uint32Array(B);for(let N=0;N<B;++N)O[N]=this._parser.precedingCodepoint;return this.print(O,0,O.length),!0}sendDeviceAttributesPrimary(L){return L.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(a.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(a.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(L){return L.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(a.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(a.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(L.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(a.C0.ESC+"[>83;40003;0c")),!0}_is(L){return(this._optionsService.rawOptions.termName+"").indexOf(L)===0}setMode(L){for(let B=0;B<L.length;B++)switch(L.params[B]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(L){for(let B=0;B<L.length;B++)switch(L.params[B]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,h.DEFAULT_CHARSET),this._charsetService.setgCharset(1,h.DEFAULT_CHARSET),this._charsetService.setgCharset(2,h.DEFAULT_CHARSET),this._charsetService.setgCharset(3,h.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(L){for(let B=0;B<L.length;B++)switch(L.params[B]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(L){for(let B=0;B<L.length;B++)switch(L.params[B]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),L.params[B]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(L,B){const O=this._coreService.decPrivateModes,{activeProtocol:N,activeEncoding:z}=this._coreMouseService,W=this._coreService,{buffers:U,cols:j}=this._bufferService,{active:Y,alt:R}=U,$=this._optionsService.rawOptions,q=he=>he?1:2,X=L.params[0];return se=X,V=B?X===2?4:X===4?q(W.modes.insertMode):X===12?3:X===20?q($.convertEol):0:X===1?q(O.applicationCursorKeys):X===3?$.windowOptions.setWinLines?j===80?2:j===132?1:0:0:X===6?q(O.origin):X===7?q(O.wraparound):X===8?3:X===9?q(N==="X10"):X===12?q($.cursorBlink):X===25?q(!W.isCursorHidden):X===45?q(O.reverseWraparound):X===66?q(O.applicationKeypad):X===67?4:X===1e3?q(N==="VT200"):X===1002?q(N==="DRAG"):X===1003?q(N==="ANY"):X===1004?q(O.sendFocus):X===1005?4:X===1006?q(z==="SGR"):X===1015?4:X===1016?q(z==="SGR_PIXELS"):X===1048?1:X===47||X===1047||X===1049?q(Y===R):X===2004?q(O.bracketedPasteMode):0,W.triggerDataEvent(`${a.C0.ESC}[${B?"":"?"}${se};${V}$y`),!0;var se,V}_updateAttrColor(L,B,O,N,z){return B===2?(L|=50331648,L&=-16777216,L|=m.AttributeData.fromColorRGB([O,N,z])):B===5&&(L&=-50331904,L|=33554432|255&O),L}_extractColor(L,B,O){const N=[0,0,-1,0,0,0];let z=0,W=0;do{if(N[W+z]=L.params[B+W],L.hasSubParams(B+W)){const U=L.getSubParams(B+W);let j=0;do N[1]===5&&(z=1),N[W+j+1+z]=U[j];while(++j<U.length&&j+W+1+z<N.length);break}if(N[1]===5&&W+z>=2||N[1]===2&&W+z>=5)break;N[1]&&(z=1)}while(++W+B<L.length&&W+z<N.length);for(let U=2;U<N.length;++U)N[U]===-1&&(N[U]=0);switch(N[0]){case 38:O.fg=this._updateAttrColor(O.fg,N[1],N[3],N[4],N[5]);break;case 48:O.bg=this._updateAttrColor(O.bg,N[1],N[3],N[4],N[5]);break;case 58:O.extended=O.extended.clone(),O.extended.underlineColor=this._updateAttrColor(O.extended.underlineColor,N[1],N[3],N[4],N[5])}return W}_processUnderline(L,B){B.extended=B.extended.clone(),(!~L||L>5)&&(L=1),B.extended.underlineStyle=L,B.fg|=268435456,L===0&&(B.fg&=-268435457),B.updateExtended()}_processSGR0(L){L.fg=t.DEFAULT_ATTR_DATA.fg,L.bg=t.DEFAULT_ATTR_DATA.bg,L.extended=L.extended.clone(),L.extended.underlineStyle=0,L.extended.underlineColor&=-67108864,L.updateExtended()}charAttributes(L){if(L.length===1&&L.params[0]===0)return this._processSGR0(this._curAttrData),!0;const B=L.length;let O;const N=this._curAttrData;for(let z=0;z<B;z++)O=L.params[z],O>=30&&O<=37?(N.fg&=-50331904,N.fg|=16777216|O-30):O>=40&&O<=47?(N.bg&=-50331904,N.bg|=16777216|O-40):O>=90&&O<=97?(N.fg&=-50331904,N.fg|=16777224|O-90):O>=100&&O<=107?(N.bg&=-50331904,N.bg|=16777224|O-100):O===0?this._processSGR0(N):O===1?N.fg|=134217728:O===3?N.bg|=67108864:O===4?(N.fg|=268435456,this._processUnderline(L.hasSubParams(z)?L.getSubParams(z)[0]:1,N)):O===5?N.fg|=536870912:O===7?N.fg|=67108864:O===8?N.fg|=1073741824:O===9?N.fg|=2147483648:O===2?N.bg|=134217728:O===21?this._processUnderline(2,N):O===22?(N.fg&=-134217729,N.bg&=-134217729):O===23?N.bg&=-67108865:O===24?(N.fg&=-268435457,this._processUnderline(0,N)):O===25?N.fg&=-536870913:O===27?N.fg&=-67108865:O===28?N.fg&=-1073741825:O===29?N.fg&=2147483647:O===39?(N.fg&=-67108864,N.fg|=16777215&t.DEFAULT_ATTR_DATA.fg):O===49?(N.bg&=-67108864,N.bg|=16777215&t.DEFAULT_ATTR_DATA.bg):O===38||O===48||O===58?z+=this._extractColor(L,z,N):O===53?N.bg|=1073741824:O===55?N.bg&=-1073741825:O===59?(N.extended=N.extended.clone(),N.extended.underlineColor=-1,N.updateExtended()):O===100?(N.fg&=-67108864,N.fg|=16777215&t.DEFAULT_ATTR_DATA.fg,N.bg&=-67108864,N.bg|=16777215&t.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",O);return!0}deviceStatus(L){switch(L.params[0]){case 5:this._coreService.triggerDataEvent(`${a.C0.ESC}[0n`);break;case 6:const B=this._activeBuffer.y+1,O=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${a.C0.ESC}[${B};${O}R`)}return!0}deviceStatusPrivate(L){if(L.params[0]===6){const B=this._activeBuffer.y+1,O=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${a.C0.ESC}[?${B};${O}R`)}return!0}softReset(L){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(L){const B=L.params[0]||1;switch(B){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const O=B%2==1;return this._optionsService.options.cursorBlink=O,!0}setScrollRegion(L){const B=L.params[0]||1;let O;return(L.length<2||(O=L.params[1])>this._bufferService.rows||O===0)&&(O=this._bufferService.rows),O>B&&(this._activeBuffer.scrollTop=B-1,this._activeBuffer.scrollBottom=O-1,this._setCursor(0,0)),!0}windowOptions(L){if(!I(L.params[0],this._optionsService.rawOptions.windowOptions))return!0;const B=L.length>1?L.params[1]:0;switch(L.params[0]){case 14:B!==2&&this._onRequestWindowsOptionsReport.fire(y.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(y.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${a.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:B!==0&&B!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),B!==0&&B!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:B!==0&&B!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),B!==0&&B!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(L){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(L){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(L){return this._windowTitle=L,this._onTitleChange.fire(L),!0}setIconName(L){return this._iconName=L,!0}setOrReportIndexedColor(L){const B=[],O=L.split(";");for(;O.length>1;){const N=O.shift(),z=O.shift();if(/^\d+$/.exec(N)){const W=parseInt(N);if(P(W))if(z==="?")B.push({type:0,index:W});else{const U=(0,w.parseColor)(z);U&&B.push({type:1,index:W,color:U})}}}return B.length&&this._onColor.fire(B),!0}setHyperlink(L){const B=L.split(";");return!(B.length<2)&&(B[1]?this._createHyperlink(B[0],B[1]):!B[0]&&this._finishHyperlink())}_createHyperlink(L,B){this._getCurrentLinkId()&&this._finishHyperlink();const O=L.split(":");let N;const z=O.findIndex(W=>W.startsWith("id="));return z!==-1&&(N=O[z].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:N,uri:B}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(L,B){const O=L.split(";");for(let N=0;N<O.length&&!(B>=this._specialColors.length);++N,++B)if(O[N]==="?")this._onColor.fire([{type:0,index:this._specialColors[B]}]);else{const z=(0,w.parseColor)(O[N]);z&&this._onColor.fire([{type:1,index:this._specialColors[B],color:z}])}return!0}setOrReportFgColor(L){return this._setOrReportSpecialColor(L,0)}setOrReportBgColor(L){return this._setOrReportSpecialColor(L,1)}setOrReportCursorColor(L){return this._setOrReportSpecialColor(L,2)}restoreIndexedColor(L){if(!L)return this._onColor.fire([{type:2}]),!0;const B=[],O=L.split(";");for(let N=0;N<O.length;++N)if(/^\d+$/.exec(O[N])){const z=parseInt(O[N]);P(z)&&B.push({type:2,index:z})}return B.length&&this._onColor.fire(B),!0}restoreFgColor(L){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(L){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(L){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,h.DEFAULT_CHARSET),!0}selectCharset(L){return L.length!==2?(this.selectDefaultCharset(),!0):(L[0]==="/"||this._charsetService.setgCharset(S[L[0]],h.CHARSETS[L[1]]||h.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const L=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,L,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=t.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(L){return this._charsetService.setgLevel(L),!0}screenAlignmentPattern(){const L=new r.CellData;L.content=4194304|"E".charCodeAt(0),L.fg=this._curAttrData.fg,L.bg=this._curAttrData.bg,this._setCursor(0,0);for(let B=0;B<this._bufferService.rows;++B){const O=this._activeBuffer.ybase+this._activeBuffer.y+B,N=this._activeBuffer.lines.get(O);N&&(N.fill(L),N.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(L,B){const O=this._bufferService.buffer,N=this._optionsService.rawOptions;return(z=>(this._coreService.triggerDataEvent(`${a.C0.ESC}${z}${a.C0.ESC}\\`),!0))(L==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:L==='"p'?'P1$r61;1"p':L==="r"?`P1$r${O.scrollTop+1};${O.scrollBottom+1}r`:L==="m"?"P1$r0m":L===" q"?`P1$r${{block:2,underline:4,bar:6}[N.cursorStyle]-(N.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(L,B){this._dirtyRowTracker.markRangeDirty(L,B)}}n.InputHandler=A;let H=class{constructor(F){this._bufferService=F,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(F){F<this.start?this.start=F:F>this.end&&(this.end=F)}markRangeDirty(F,L){F>L&&(T=F,F=L,L=T),F<this.start&&(this.start=F),L>this.end&&(this.end=L)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function P(F){return 0<=F&&F<256}H=l([p(0,g.IBufferService)],H)},844:(C,n)=>{function i(l){for(const p of l)p.dispose();l.length=0}Object.defineProperty(n,"__esModule",{value:!0}),n.getDisposeArrayDisposable=n.disposeArray=n.toDisposable=n.MutableDisposable=n.Disposable=void 0,n.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const l of this._disposables)l.dispose();this._disposables.length=0}register(l){return this._disposables.push(l),l}unregister(l){const p=this._disposables.indexOf(l);p!==-1&&this._disposables.splice(p,1)}},n.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(l){var p;this._isDisposed||l===this._value||((p=this._value)===null||p===void 0||p.dispose(),this._value=l)}clear(){this.value=void 0}dispose(){var l;this._isDisposed=!0,(l=this._value)===null||l===void 0||l.dispose(),this._value=void 0}},n.toDisposable=function(l){return{dispose:l}},n.disposeArray=i,n.getDisposeArrayDisposable=function(l){return{dispose:()=>i(l)}}},1505:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FourKeyMap=n.TwoKeyMap=void 0;class i{constructor(){this._data={}}set(p,a,h){this._data[p]||(this._data[p]={}),this._data[p][a]=h}get(p,a){return this._data[p]?this._data[p][a]:void 0}clear(){this._data={}}}n.TwoKeyMap=i,n.FourKeyMap=class{constructor(){this._data=new i}set(l,p,a,h,f){this._data.get(l,p)||this._data.set(l,p,new i),this._data.get(l,p).set(a,h,f)}get(l,p,a,h){var f;return(f=this._data.get(l,p))===null||f===void 0?void 0:f.get(a,h)}clear(){this._data.clear()}}},6114:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isChromeOS=n.isLinux=n.isWindows=n.isIphone=n.isIpad=n.isMac=n.getSafariVersion=n.isSafari=n.isLegacyEdge=n.isFirefox=n.isNode=void 0,n.isNode=typeof navigator>"u";const i=n.isNode?"node":navigator.userAgent,l=n.isNode?"node":navigator.platform;n.isFirefox=i.includes("Firefox"),n.isLegacyEdge=i.includes("Edge"),n.isSafari=/^((?!chrome|android).)*safari/i.test(i),n.getSafariVersion=function(){if(!n.isSafari)return 0;const p=i.match(/Version\/(\d+)/);return p===null||p.length<2?0:parseInt(p[1])},n.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(l),n.isIpad=l==="iPad",n.isIphone=l==="iPhone",n.isWindows=["Windows","Win16","Win32","WinCE"].includes(l),n.isLinux=l.indexOf("Linux")>=0,n.isChromeOS=/\bCrOS\b/.test(i)},6106:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SortedList=void 0;let i=0;n.SortedList=class{constructor(l){this._getKey=l,this._array=[]}clear(){this._array.length=0}insert(l){this._array.length!==0?(i=this._search(this._getKey(l)),this._array.splice(i,0,l)):this._array.push(l)}delete(l){if(this._array.length===0)return!1;const p=this._getKey(l);if(p===void 0||(i=this._search(p),i===-1)||this._getKey(this._array[i])!==p)return!1;do if(this._array[i]===l)return this._array.splice(i,1),!0;while(++i<this._array.length&&this._getKey(this._array[i])===p);return!1}*getKeyIterator(l){if(this._array.length!==0&&(i=this._search(l),!(i<0||i>=this._array.length)&&this._getKey(this._array[i])===l))do yield this._array[i];while(++i<this._array.length&&this._getKey(this._array[i])===l)}forEachByKey(l,p){if(this._array.length!==0&&(i=this._search(l),!(i<0||i>=this._array.length)&&this._getKey(this._array[i])===l))do p(this._array[i]);while(++i<this._array.length&&this._getKey(this._array[i])===l)}values(){return[...this._array].values()}_search(l){let p=0,a=this._array.length-1;for(;a>=p;){let h=p+a>>1;const f=this._getKey(this._array[h]);if(f>l)a=h-1;else{if(!(f<l)){for(;h>0&&this._getKey(this._array[h-1])===l;)h--;return h}p=h+1}}return p}}},7226:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DebouncedIdleTask=n.IdleTaskQueue=n.PriorityTaskQueue=void 0;const l=i(6114);class p{constructor(){this._tasks=[],this._i=0}enqueue(f){this._tasks.push(f),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(f){this._idleCallback=void 0;let d=0,u=0,t=f.timeRemaining(),s=0;for(;this._i<this._tasks.length;){if(d=Date.now(),this._tasks[this._i]()||this._i++,d=Math.max(1,Date.now()-d),u=Math.max(d,u),s=f.timeRemaining(),1.5*u>s)return t-d<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(t-d))}ms`),void this._start();t=s}this.clear()}}class a extends p{_requestCallback(f){return setTimeout(()=>f(this._createDeadline(16)))}_cancelCallback(f){clearTimeout(f)}_createDeadline(f){const d=Date.now()+f;return{timeRemaining:()=>Math.max(0,d-Date.now())}}}n.PriorityTaskQueue=a,n.IdleTaskQueue=!l.isNode&&"requestIdleCallback"in window?class extends p{_requestCallback(h){return requestIdleCallback(h)}_cancelCallback(h){cancelIdleCallback(h)}}:a,n.DebouncedIdleTask=class{constructor(){this._queue=new n.IdleTaskQueue}set(h){this._queue.clear(),this._queue.enqueue(h)}flush(){this._queue.flush()}}},9282:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.updateWindowsModeWrappedState=void 0;const l=i(643);n.updateWindowsModeWrappedState=function(p){const a=p.buffer.lines.get(p.buffer.ybase+p.buffer.y-1),h=a==null?void 0:a.get(p.cols-1),f=p.buffer.lines.get(p.buffer.ybase+p.buffer.y);f&&h&&(f.isWrapped=h[l.CHAR_DATA_CODE_INDEX]!==l.NULL_CELL_CODE&&h[l.CHAR_DATA_CODE_INDEX]!==l.WHITESPACE_CELL_CODE)}},3734:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ExtendedAttrs=n.AttributeData=void 0;class i{constructor(){this.fg=0,this.bg=0,this.extended=new l}static toColorRGB(a){return[a>>>16&255,a>>>8&255,255&a]}static fromColorRGB(a){return(255&a[0])<<16|(255&a[1])<<8|255&a[2]}clone(){const a=new i;return a.fg=this.fg,a.bg=this.bg,a.extended=this.extended.clone(),a}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}n.AttributeData=i;class l{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(a){this._ext=a}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(a){this._ext&=-469762049,this._ext|=a<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(a){this._ext&=-67108864,this._ext|=67108863&a}get urlId(){return this._urlId}set urlId(a){this._urlId=a}constructor(a=0,h=0){this._ext=0,this._urlId=0,this._ext=a,this._urlId=h}clone(){return new l(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}n.ExtendedAttrs=l},9092:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Buffer=n.MAX_BUFFER_SIZE=void 0;const l=i(6349),p=i(7226),a=i(3734),h=i(8437),f=i(4634),d=i(511),u=i(643),t=i(4863),s=i(7116);n.MAX_BUFFER_SIZE=4294967295,n.Buffer=class{constructor(o,r,m){this._hasScrollback=o,this._optionsService=r,this._bufferService=m,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=h.DEFAULT_ATTR_DATA.clone(),this.savedCharset=s.DEFAULT_CHARSET,this.markers=[],this._nullCell=d.CellData.fromCharData([0,u.NULL_CELL_CHAR,u.NULL_CELL_WIDTH,u.NULL_CELL_CODE]),this._whitespaceCell=d.CellData.fromCharData([0,u.WHITESPACE_CELL_CHAR,u.WHITESPACE_CELL_WIDTH,u.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new p.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new l.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(o){return o?(this._nullCell.fg=o.fg,this._nullCell.bg=o.bg,this._nullCell.extended=o.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new a.ExtendedAttrs),this._nullCell}getWhitespaceCell(o){return o?(this._whitespaceCell.fg=o.fg,this._whitespaceCell.bg=o.bg,this._whitespaceCell.extended=o.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new a.ExtendedAttrs),this._whitespaceCell}getBlankLine(o,r){return new h.BufferLine(this._bufferService.cols,this.getNullCell(o),r)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const o=this.ybase+this.y-this.ydisp;return o>=0&&o<this._rows}_getCorrectBufferLength(o){if(!this._hasScrollback)return o;const r=o+this._optionsService.rawOptions.scrollback;return r>n.MAX_BUFFER_SIZE?n.MAX_BUFFER_SIZE:r}fillViewportRows(o){if(this.lines.length===0){o===void 0&&(o=h.DEFAULT_ATTR_DATA);let r=this._rows;for(;r--;)this.lines.push(this.getBlankLine(o))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new l.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(o,r){const m=this.getNullCell(h.DEFAULT_ATTR_DATA);let g=0;const k=this._getCorrectBufferLength(r);if(k>this.lines.maxLength&&(this.lines.maxLength=k),this.lines.length>0){if(this._cols<o)for(let w=0;w<this.lines.length;w++)g+=+this.lines.get(w).resize(o,m);let D=0;if(this._rows<r)for(let w=this._rows;w<r;w++)this.lines.length<r+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new h.BufferLine(o,m)):this.ybase>0&&this.lines.length<=this.ybase+this.y+D+1?(this.ybase--,D++,this.ydisp>0&&this.ydisp--):this.lines.push(new h.BufferLine(o,m)));else for(let w=this._rows;w>r;w--)this.lines.length>r+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(k<this.lines.maxLength){const w=this.lines.length-k;w>0&&(this.lines.trimStart(w),this.ybase=Math.max(this.ybase-w,0),this.ydisp=Math.max(this.ydisp-w,0),this.savedY=Math.max(this.savedY-w,0)),this.lines.maxLength=k}this.x=Math.min(this.x,o-1),this.y=Math.min(this.y,r-1),D&&(this.y+=D),this.savedX=Math.min(this.savedX,o-1),this.scrollTop=0}if(this.scrollBottom=r-1,this._isReflowEnabled&&(this._reflow(o,r),this._cols>o))for(let D=0;D<this.lines.length;D++)g+=+this.lines.get(D).resize(o,m);this._cols=o,this._rows=r,this._memoryCleanupQueue.clear(),g>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let o=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,o=!1);let r=0;for(;this._memoryCleanupPosition<this.lines.length;)if(r+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),r>100)return!0;return o}get _isReflowEnabled(){const o=this._optionsService.rawOptions.windowsPty;return o&&o.buildNumber?this._hasScrollback&&o.backend==="conpty"&&o.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(o,r){this._cols!==o&&(o>this._cols?this._reflowLarger(o,r):this._reflowSmaller(o,r))}_reflowLarger(o,r){const m=(0,f.reflowLargerGetLinesToRemove)(this.lines,this._cols,o,this.ybase+this.y,this.getNullCell(h.DEFAULT_ATTR_DATA));if(m.length>0){const g=(0,f.reflowLargerCreateNewLayout)(this.lines,m);(0,f.reflowLargerApplyNewLayout)(this.lines,g.layout),this._reflowLargerAdjustViewport(o,r,g.countRemoved)}}_reflowLargerAdjustViewport(o,r,m){const g=this.getNullCell(h.DEFAULT_ATTR_DATA);let k=m;for(;k-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<r&&this.lines.push(new h.BufferLine(o,g))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-m,0)}_reflowSmaller(o,r){const m=this.getNullCell(h.DEFAULT_ATTR_DATA),g=[];let k=0;for(let D=this.lines.length-1;D>=0;D--){let w=this.lines.get(D);if(!w||!w.isWrapped&&w.getTrimmedLength()<=o)continue;const S=[w];for(;w.isWrapped&&D>0;)w=this.lines.get(--D),S.unshift(w);const M=this.ybase+this.y;if(M>=D&&M<D+S.length)continue;const I=S[S.length-1].getTrimmedLength(),y=(0,f.reflowSmallerGetNewLineLengths)(S,this._cols,o),T=y.length-S.length;let A;A=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+T):Math.max(0,this.lines.length-this.lines.maxLength+T);const H=[];for(let N=0;N<T;N++){const z=this.getBlankLine(h.DEFAULT_ATTR_DATA,!0);H.push(z)}H.length>0&&(g.push({start:D+S.length+k,newLines:H}),k+=H.length),S.push(...H);let P=y.length-1,F=y[P];F===0&&(P--,F=y[P]);let L=S.length-T-1,B=I;for(;L>=0;){const N=Math.min(B,F);if(S[P]===void 0)break;if(S[P].copyCellsFrom(S[L],B-N,F-N,N,!0),F-=N,F===0&&(P--,F=y[P]),B-=N,B===0){L--;const z=Math.max(L,0);B=(0,f.getWrappedLineTrimmedLength)(S,z,this._cols)}}for(let N=0;N<S.length;N++)y[N]<o&&S[N].setCell(y[N],m);let O=T-A;for(;O-- >0;)this.ybase===0?this.y<r-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+k)-r&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+T,this.ybase+r-1)}if(g.length>0){const D=[],w=[];for(let P=0;P<this.lines.length;P++)w.push(this.lines.get(P));const S=this.lines.length;let M=S-1,I=0,y=g[I];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+k);let T=0;for(let P=Math.min(this.lines.maxLength-1,S+k-1);P>=0;P--)if(y&&y.start>M+T){for(let F=y.newLines.length-1;F>=0;F--)this.lines.set(P--,y.newLines[F]);P++,D.push({index:M+1,amount:y.newLines.length}),T+=y.newLines.length,y=g[++I]}else this.lines.set(P,w[M--]);let A=0;for(let P=D.length-1;P>=0;P--)D[P].index+=A,this.lines.onInsertEmitter.fire(D[P]),A+=D[P].amount;const H=Math.max(0,S+k-this.lines.maxLength);H>0&&this.lines.onTrimEmitter.fire(H)}}translateBufferLineToString(o,r,m=0,g){const k=this.lines.get(o);return k?k.translateToString(r,m,g):""}getWrappedRangeForLine(o){let r=o,m=o;for(;r>0&&this.lines.get(r).isWrapped;)r--;for(;m+1<this.lines.length&&this.lines.get(m+1).isWrapped;)m++;return{first:r,last:m}}setupTabStops(o){for(o!=null?this.tabs[o]||(o=this.prevStop(o)):(this.tabs={},o=0);o<this._cols;o+=this._optionsService.rawOptions.tabStopWidth)this.tabs[o]=!0}prevStop(o){for(o==null&&(o=this.x);!this.tabs[--o]&&o>0;);return o>=this._cols?this._cols-1:o<0?0:o}nextStop(o){for(o==null&&(o=this.x);!this.tabs[++o]&&o<this._cols;);return o>=this._cols?this._cols-1:o<0?0:o}clearMarkers(o){this._isClearing=!0;for(let r=0;r<this.markers.length;r++)this.markers[r].line===o&&(this.markers[r].dispose(),this.markers.splice(r--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let o=0;o<this.markers.length;o++)this.markers[o].dispose(),this.markers.splice(o--,1);this._isClearing=!1}addMarker(o){const r=new t.Marker(o);return this.markers.push(r),r.register(this.lines.onTrim(m=>{r.line-=m,r.line<0&&r.dispose()})),r.register(this.lines.onInsert(m=>{r.line>=m.index&&(r.line+=m.amount)})),r.register(this.lines.onDelete(m=>{r.line>=m.index&&r.line<m.index+m.amount&&r.dispose(),r.line>m.index&&(r.line-=m.amount)})),r.register(r.onDispose(()=>this._removeMarker(r))),r}_removeMarker(o){this._isClearing||this.markers.splice(this.markers.indexOf(o),1)}}},8437:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferLine=n.DEFAULT_ATTR_DATA=void 0;const l=i(3734),p=i(511),a=i(643),h=i(482);n.DEFAULT_ATTR_DATA=Object.freeze(new l.AttributeData);let f=0;class d{constructor(t,s,o=!1){this.isWrapped=o,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*t);const r=s||p.CellData.fromCharData([0,a.NULL_CELL_CHAR,a.NULL_CELL_WIDTH,a.NULL_CELL_CODE]);for(let m=0;m<t;++m)this.setCell(m,r);this.length=t}get(t){const s=this._data[3*t+0],o=2097151&s;return[this._data[3*t+1],2097152&s?this._combined[t]:o?(0,h.stringFromCodePoint)(o):"",s>>22,2097152&s?this._combined[t].charCodeAt(this._combined[t].length-1):o]}set(t,s){this._data[3*t+1]=s[a.CHAR_DATA_ATTR_INDEX],s[a.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[t]=s[1],this._data[3*t+0]=2097152|t|s[a.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*t+0]=s[a.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|s[a.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(t){return this._data[3*t+0]>>22}hasWidth(t){return 12582912&this._data[3*t+0]}getFg(t){return this._data[3*t+1]}getBg(t){return this._data[3*t+2]}hasContent(t){return 4194303&this._data[3*t+0]}getCodePoint(t){const s=this._data[3*t+0];return 2097152&s?this._combined[t].charCodeAt(this._combined[t].length-1):2097151&s}isCombined(t){return 2097152&this._data[3*t+0]}getString(t){const s=this._data[3*t+0];return 2097152&s?this._combined[t]:2097151&s?(0,h.stringFromCodePoint)(2097151&s):""}isProtected(t){return 536870912&this._data[3*t+2]}loadCell(t,s){return f=3*t,s.content=this._data[f+0],s.fg=this._data[f+1],s.bg=this._data[f+2],2097152&s.content&&(s.combinedData=this._combined[t]),268435456&s.bg&&(s.extended=this._extendedAttrs[t]),s}setCell(t,s){2097152&s.content&&(this._combined[t]=s.combinedData),268435456&s.bg&&(this._extendedAttrs[t]=s.extended),this._data[3*t+0]=s.content,this._data[3*t+1]=s.fg,this._data[3*t+2]=s.bg}setCellFromCodePoint(t,s,o,r,m,g){268435456&m&&(this._extendedAttrs[t]=g),this._data[3*t+0]=s|o<<22,this._data[3*t+1]=r,this._data[3*t+2]=m}addCodepointToCell(t,s){let o=this._data[3*t+0];2097152&o?this._combined[t]+=(0,h.stringFromCodePoint)(s):(2097151&o?(this._combined[t]=(0,h.stringFromCodePoint)(2097151&o)+(0,h.stringFromCodePoint)(s),o&=-2097152,o|=2097152):o=s|4194304,this._data[3*t+0]=o)}insertCells(t,s,o,r){if((t%=this.length)&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs),s<this.length-t){const m=new p.CellData;for(let g=this.length-t-s-1;g>=0;--g)this.setCell(t+s+g,this.loadCell(t+g,m));for(let g=0;g<s;++g)this.setCell(t+g,o)}else for(let m=t;m<this.length;++m)this.setCell(m,o);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs)}deleteCells(t,s,o,r){if(t%=this.length,s<this.length-t){const m=new p.CellData;for(let g=0;g<this.length-t-s;++g)this.setCell(t+g,this.loadCell(t+s+g,m));for(let g=this.length-s;g<this.length;++g)this.setCell(g,o)}else for(let m=t;m<this.length;++m)this.setCell(m,o);t&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs),this.getWidth(t)!==0||this.hasContent(t)||this.setCellFromCodePoint(t,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs)}replaceCells(t,s,o,r,m=!1){if(m)for(t&&this.getWidth(t-1)===2&&!this.isProtected(t-1)&&this.setCellFromCodePoint(t-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs),s<this.length&&this.getWidth(s-1)===2&&!this.isProtected(s)&&this.setCellFromCodePoint(s,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs);t<s&&t<this.length;)this.isProtected(t)||this.setCell(t,o),t++;else for(t&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs),s<this.length&&this.getWidth(s-1)===2&&this.setCellFromCodePoint(s,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs);t<s&&t<this.length;)this.setCell(t++,o)}resize(t,s){if(t===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const o=3*t;if(t>this.length){if(this._data.buffer.byteLength>=4*o)this._data=new Uint32Array(this._data.buffer,0,o);else{const r=new Uint32Array(o);r.set(this._data),this._data=r}for(let r=this.length;r<t;++r)this.setCell(r,s)}else{this._data=this._data.subarray(0,o);const r=Object.keys(this._combined);for(let g=0;g<r.length;g++){const k=parseInt(r[g],10);k>=t&&delete this._combined[k]}const m=Object.keys(this._extendedAttrs);for(let g=0;g<m.length;g++){const k=parseInt(m[g],10);k>=t&&delete this._extendedAttrs[k]}}return this.length=t,4*o*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const t=new Uint32Array(this._data.length);return t.set(this._data),this._data=t,1}return 0}fill(t,s=!1){if(s)for(let o=0;o<this.length;++o)this.isProtected(o)||this.setCell(o,t);else{this._combined={},this._extendedAttrs={};for(let o=0;o<this.length;++o)this.setCell(o,t)}}copyFrom(t){this.length!==t.length?this._data=new Uint32Array(t._data):this._data.set(t._data),this.length=t.length,this._combined={};for(const s in t._combined)this._combined[s]=t._combined[s];this._extendedAttrs={};for(const s in t._extendedAttrs)this._extendedAttrs[s]=t._extendedAttrs[s];this.isWrapped=t.isWrapped}clone(){const t=new d(0);t._data=new Uint32Array(this._data),t.length=this.length;for(const s in this._combined)t._combined[s]=this._combined[s];for(const s in this._extendedAttrs)t._extendedAttrs[s]=this._extendedAttrs[s];return t.isWrapped=this.isWrapped,t}getTrimmedLength(){for(let t=this.length-1;t>=0;--t)if(4194303&this._data[3*t+0])return t+(this._data[3*t+0]>>22);return 0}getNoBgTrimmedLength(){for(let t=this.length-1;t>=0;--t)if(4194303&this._data[3*t+0]||50331648&this._data[3*t+2])return t+(this._data[3*t+0]>>22);return 0}copyCellsFrom(t,s,o,r,m){const g=t._data;if(m)for(let D=r-1;D>=0;D--){for(let w=0;w<3;w++)this._data[3*(o+D)+w]=g[3*(s+D)+w];268435456&g[3*(s+D)+2]&&(this._extendedAttrs[o+D]=t._extendedAttrs[s+D])}else for(let D=0;D<r;D++){for(let w=0;w<3;w++)this._data[3*(o+D)+w]=g[3*(s+D)+w];268435456&g[3*(s+D)+2]&&(this._extendedAttrs[o+D]=t._extendedAttrs[s+D])}const k=Object.keys(t._combined);for(let D=0;D<k.length;D++){const w=parseInt(k[D],10);w>=s&&(this._combined[w-s+o]=t._combined[w])}}translateToString(t=!1,s=0,o=this.length){t&&(o=Math.min(o,this.getTrimmedLength()));let r="";for(;s<o;){const m=this._data[3*s+0],g=2097151&m;r+=2097152&m?this._combined[s]:g?(0,h.stringFromCodePoint)(g):a.WHITESPACE_CELL_CHAR,s+=m>>22||1}return r}}n.BufferLine=d},4841:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getRangeLength=void 0,n.getRangeLength=function(i,l){if(i.start.y>i.end.y)throw new Error(`Buffer range end (${i.end.x}, ${i.end.y}) cannot be before start (${i.start.x}, ${i.start.y})`);return l*(i.end.y-i.start.y)+(i.end.x-i.start.x+1)}},4634:(C,n)=>{function i(l,p,a){if(p===l.length-1)return l[p].getTrimmedLength();const h=!l[p].hasContent(a-1)&&l[p].getWidth(a-1)===1,f=l[p+1].getWidth(0)===2;return h&&f?a-1:a}Object.defineProperty(n,"__esModule",{value:!0}),n.getWrappedLineTrimmedLength=n.reflowSmallerGetNewLineLengths=n.reflowLargerApplyNewLayout=n.reflowLargerCreateNewLayout=n.reflowLargerGetLinesToRemove=void 0,n.reflowLargerGetLinesToRemove=function(l,p,a,h,f){const d=[];for(let u=0;u<l.length-1;u++){let t=u,s=l.get(++t);if(!s.isWrapped)continue;const o=[l.get(u)];for(;t<l.length&&s.isWrapped;)o.push(s),s=l.get(++t);if(h>=u&&h<t){u+=o.length-1;continue}let r=0,m=i(o,r,p),g=1,k=0;for(;g<o.length;){const w=i(o,g,p),S=w-k,M=a-m,I=Math.min(S,M);o[r].copyCellsFrom(o[g],k,m,I,!1),m+=I,m===a&&(r++,m=0),k+=I,k===w&&(g++,k=0),m===0&&r!==0&&o[r-1].getWidth(a-1)===2&&(o[r].copyCellsFrom(o[r-1],a-1,m++,1,!1),o[r-1].setCell(a-1,f))}o[r].replaceCells(m,a,f);let D=0;for(let w=o.length-1;w>0&&(w>r||o[w].getTrimmedLength()===0);w--)D++;D>0&&(d.push(u+o.length-D),d.push(D)),u+=o.length-1}return d},n.reflowLargerCreateNewLayout=function(l,p){const a=[];let h=0,f=p[h],d=0;for(let u=0;u<l.length;u++)if(f===u){const t=p[++h];l.onDeleteEmitter.fire({index:u-d,amount:t}),u+=t-1,d+=t,f=p[++h]}else a.push(u);return{layout:a,countRemoved:d}},n.reflowLargerApplyNewLayout=function(l,p){const a=[];for(let h=0;h<p.length;h++)a.push(l.get(p[h]));for(let h=0;h<a.length;h++)l.set(h,a[h]);l.length=p.length},n.reflowSmallerGetNewLineLengths=function(l,p,a){const h=[],f=l.map((s,o)=>i(l,o,p)).reduce((s,o)=>s+o);let d=0,u=0,t=0;for(;t<f;){if(f-t<a){h.push(f-t);break}d+=a;const s=i(l,u,p);d>s&&(d-=s,u++);const o=l[u].getWidth(d-1)===2;o&&d--;const r=o?a-1:a;h.push(r),t+=r}return h},n.getWrappedLineTrimmedLength=i},5295:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferSet=void 0;const l=i(8460),p=i(844),a=i(9092);class h extends p.Disposable{constructor(d,u){super(),this._optionsService=d,this._bufferService=u,this._onBufferActivate=this.register(new l.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new a.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new a.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(d){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(d),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(d,u){this._normal.resize(d,u),this._alt.resize(d,u),this.setupTabStops(d)}setupTabStops(d){this._normal.setupTabStops(d),this._alt.setupTabStops(d)}}n.BufferSet=h},511:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CellData=void 0;const l=i(482),p=i(643),a=i(3734);class h extends a.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new a.ExtendedAttrs,this.combinedData=""}static fromCharData(d){const u=new h;return u.setFromCharData(d),u}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,l.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(d){this.fg=d[p.CHAR_DATA_ATTR_INDEX],this.bg=0;let u=!1;if(d[p.CHAR_DATA_CHAR_INDEX].length>2)u=!0;else if(d[p.CHAR_DATA_CHAR_INDEX].length===2){const t=d[p.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=t&&t<=56319){const s=d[p.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=s&&s<=57343?this.content=1024*(t-55296)+s-56320+65536|d[p.CHAR_DATA_WIDTH_INDEX]<<22:u=!0}else u=!0}else this.content=d[p.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|d[p.CHAR_DATA_WIDTH_INDEX]<<22;u&&(this.combinedData=d[p.CHAR_DATA_CHAR_INDEX],this.content=2097152|d[p.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}n.CellData=h},643:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WHITESPACE_CELL_CODE=n.WHITESPACE_CELL_WIDTH=n.WHITESPACE_CELL_CHAR=n.NULL_CELL_CODE=n.NULL_CELL_WIDTH=n.NULL_CELL_CHAR=n.CHAR_DATA_CODE_INDEX=n.CHAR_DATA_WIDTH_INDEX=n.CHAR_DATA_CHAR_INDEX=n.CHAR_DATA_ATTR_INDEX=n.DEFAULT_EXT=n.DEFAULT_ATTR=n.DEFAULT_COLOR=void 0,n.DEFAULT_COLOR=0,n.DEFAULT_ATTR=256|n.DEFAULT_COLOR<<9,n.DEFAULT_EXT=0,n.CHAR_DATA_ATTR_INDEX=0,n.CHAR_DATA_CHAR_INDEX=1,n.CHAR_DATA_WIDTH_INDEX=2,n.CHAR_DATA_CODE_INDEX=3,n.NULL_CELL_CHAR="",n.NULL_CELL_WIDTH=1,n.NULL_CELL_CODE=0,n.WHITESPACE_CELL_CHAR=" ",n.WHITESPACE_CELL_WIDTH=1,n.WHITESPACE_CELL_CODE=32},4863:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Marker=void 0;const l=i(8460),p=i(844);class a{get id(){return this._id}constructor(f){this.line=f,this.isDisposed=!1,this._disposables=[],this._id=a._nextId++,this._onDispose=this.register(new l.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,p.disposeArray)(this._disposables),this._disposables.length=0)}register(f){return this._disposables.push(f),f}}n.Marker=a,a._nextId=1},7116:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DEFAULT_CHARSET=n.CHARSETS=void 0,n.CHARSETS={},n.DEFAULT_CHARSET=n.CHARSETS.B,n.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},n.CHARSETS.A={"#":"£"},n.CHARSETS.B=void 0,n.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},n.CHARSETS.C=n.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},n.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},n.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},n.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},n.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},n.CHARSETS.E=n.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},n.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},n.CHARSETS.H=n.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},n.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(C,n)=>{var i,l,p;Object.defineProperty(n,"__esModule",{value:!0}),n.C1_ESCAPED=n.C1=n.C0=void 0,function(a){a.NUL="\0",a.SOH="",a.STX="",a.ETX="",a.EOT="",a.ENQ="",a.ACK="",a.BEL="\x07",a.BS="\b",a.HT="	",a.LF=`
`,a.VT="\v",a.FF="\f",a.CR="\r",a.SO="",a.SI="",a.DLE="",a.DC1="",a.DC2="",a.DC3="",a.DC4="",a.NAK="",a.SYN="",a.ETB="",a.CAN="",a.EM="",a.SUB="",a.ESC="\x1B",a.FS="",a.GS="",a.RS="",a.US="",a.SP=" ",a.DEL=""}(i||(n.C0=i={})),function(a){a.PAD="",a.HOP="",a.BPH="",a.NBH="",a.IND="",a.NEL="",a.SSA="",a.ESA="",a.HTS="",a.HTJ="",a.VTS="",a.PLD="",a.PLU="",a.RI="",a.SS2="",a.SS3="",a.DCS="",a.PU1="",a.PU2="",a.STS="",a.CCH="",a.MW="",a.SPA="",a.EPA="",a.SOS="",a.SGCI="",a.SCI="",a.CSI="",a.ST="",a.OSC="",a.PM="",a.APC=""}(l||(n.C1=l={})),function(a){a.ST=`${i.ESC}\\`}(p||(n.C1_ESCAPED=p={}))},7399:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.evaluateKeyboardEvent=void 0;const l=i(2584),p={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};n.evaluateKeyboardEvent=function(a,h,f,d){const u={type:0,cancel:!1,key:void 0},t=(a.shiftKey?1:0)|(a.altKey?2:0)|(a.ctrlKey?4:0)|(a.metaKey?8:0);switch(a.keyCode){case 0:a.key==="UIKeyInputUpArrow"?u.key=h?l.C0.ESC+"OA":l.C0.ESC+"[A":a.key==="UIKeyInputLeftArrow"?u.key=h?l.C0.ESC+"OD":l.C0.ESC+"[D":a.key==="UIKeyInputRightArrow"?u.key=h?l.C0.ESC+"OC":l.C0.ESC+"[C":a.key==="UIKeyInputDownArrow"&&(u.key=h?l.C0.ESC+"OB":l.C0.ESC+"[B");break;case 8:if(a.altKey){u.key=l.C0.ESC+l.C0.DEL;break}u.key=l.C0.DEL;break;case 9:if(a.shiftKey){u.key=l.C0.ESC+"[Z";break}u.key=l.C0.HT,u.cancel=!0;break;case 13:u.key=a.altKey?l.C0.ESC+l.C0.CR:l.C0.CR,u.cancel=!0;break;case 27:u.key=l.C0.ESC,a.altKey&&(u.key=l.C0.ESC+l.C0.ESC),u.cancel=!0;break;case 37:if(a.metaKey)break;t?(u.key=l.C0.ESC+"[1;"+(t+1)+"D",u.key===l.C0.ESC+"[1;3D"&&(u.key=l.C0.ESC+(f?"b":"[1;5D"))):u.key=h?l.C0.ESC+"OD":l.C0.ESC+"[D";break;case 39:if(a.metaKey)break;t?(u.key=l.C0.ESC+"[1;"+(t+1)+"C",u.key===l.C0.ESC+"[1;3C"&&(u.key=l.C0.ESC+(f?"f":"[1;5C"))):u.key=h?l.C0.ESC+"OC":l.C0.ESC+"[C";break;case 38:if(a.metaKey)break;t?(u.key=l.C0.ESC+"[1;"+(t+1)+"A",f||u.key!==l.C0.ESC+"[1;3A"||(u.key=l.C0.ESC+"[1;5A")):u.key=h?l.C0.ESC+"OA":l.C0.ESC+"[A";break;case 40:if(a.metaKey)break;t?(u.key=l.C0.ESC+"[1;"+(t+1)+"B",f||u.key!==l.C0.ESC+"[1;3B"||(u.key=l.C0.ESC+"[1;5B")):u.key=h?l.C0.ESC+"OB":l.C0.ESC+"[B";break;case 45:a.shiftKey||a.ctrlKey||(u.key=l.C0.ESC+"[2~");break;case 46:u.key=t?l.C0.ESC+"[3;"+(t+1)+"~":l.C0.ESC+"[3~";break;case 36:u.key=t?l.C0.ESC+"[1;"+(t+1)+"H":h?l.C0.ESC+"OH":l.C0.ESC+"[H";break;case 35:u.key=t?l.C0.ESC+"[1;"+(t+1)+"F":h?l.C0.ESC+"OF":l.C0.ESC+"[F";break;case 33:a.shiftKey?u.type=2:a.ctrlKey?u.key=l.C0.ESC+"[5;"+(t+1)+"~":u.key=l.C0.ESC+"[5~";break;case 34:a.shiftKey?u.type=3:a.ctrlKey?u.key=l.C0.ESC+"[6;"+(t+1)+"~":u.key=l.C0.ESC+"[6~";break;case 112:u.key=t?l.C0.ESC+"[1;"+(t+1)+"P":l.C0.ESC+"OP";break;case 113:u.key=t?l.C0.ESC+"[1;"+(t+1)+"Q":l.C0.ESC+"OQ";break;case 114:u.key=t?l.C0.ESC+"[1;"+(t+1)+"R":l.C0.ESC+"OR";break;case 115:u.key=t?l.C0.ESC+"[1;"+(t+1)+"S":l.C0.ESC+"OS";break;case 116:u.key=t?l.C0.ESC+"[15;"+(t+1)+"~":l.C0.ESC+"[15~";break;case 117:u.key=t?l.C0.ESC+"[17;"+(t+1)+"~":l.C0.ESC+"[17~";break;case 118:u.key=t?l.C0.ESC+"[18;"+(t+1)+"~":l.C0.ESC+"[18~";break;case 119:u.key=t?l.C0.ESC+"[19;"+(t+1)+"~":l.C0.ESC+"[19~";break;case 120:u.key=t?l.C0.ESC+"[20;"+(t+1)+"~":l.C0.ESC+"[20~";break;case 121:u.key=t?l.C0.ESC+"[21;"+(t+1)+"~":l.C0.ESC+"[21~";break;case 122:u.key=t?l.C0.ESC+"[23;"+(t+1)+"~":l.C0.ESC+"[23~";break;case 123:u.key=t?l.C0.ESC+"[24;"+(t+1)+"~":l.C0.ESC+"[24~";break;default:if(!a.ctrlKey||a.shiftKey||a.altKey||a.metaKey)if(f&&!d||!a.altKey||a.metaKey)!f||a.altKey||a.ctrlKey||a.shiftKey||!a.metaKey?a.key&&!a.ctrlKey&&!a.altKey&&!a.metaKey&&a.keyCode>=48&&a.key.length===1?u.key=a.key:a.key&&a.ctrlKey&&(a.key==="_"&&(u.key=l.C0.US),a.key==="@"&&(u.key=l.C0.NUL)):a.keyCode===65&&(u.type=1);else{const s=p[a.keyCode],o=s==null?void 0:s[a.shiftKey?1:0];if(o)u.key=l.C0.ESC+o;else if(a.keyCode>=65&&a.keyCode<=90){const r=a.ctrlKey?a.keyCode-64:a.keyCode+32;let m=String.fromCharCode(r);a.shiftKey&&(m=m.toUpperCase()),u.key=l.C0.ESC+m}else if(a.keyCode===32)u.key=l.C0.ESC+(a.ctrlKey?l.C0.NUL:" ");else if(a.key==="Dead"&&a.code.startsWith("Key")){let r=a.code.slice(3,4);a.shiftKey||(r=r.toLowerCase()),u.key=l.C0.ESC+r,u.cancel=!0}}else a.keyCode>=65&&a.keyCode<=90?u.key=String.fromCharCode(a.keyCode-64):a.keyCode===32?u.key=l.C0.NUL:a.keyCode>=51&&a.keyCode<=55?u.key=String.fromCharCode(a.keyCode-51+27):a.keyCode===56?u.key=l.C0.DEL:a.keyCode===219?u.key=l.C0.ESC:a.keyCode===220?u.key=l.C0.FS:a.keyCode===221&&(u.key=l.C0.GS)}return u}},482:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Utf8ToUtf32=n.StringToUtf32=n.utf32ToString=n.stringFromCodePoint=void 0,n.stringFromCodePoint=function(i){return i>65535?(i-=65536,String.fromCharCode(55296+(i>>10))+String.fromCharCode(i%1024+56320)):String.fromCharCode(i)},n.utf32ToString=function(i,l=0,p=i.length){let a="";for(let h=l;h<p;++h){let f=i[h];f>65535?(f-=65536,a+=String.fromCharCode(55296+(f>>10))+String.fromCharCode(f%1024+56320)):a+=String.fromCharCode(f)}return a},n.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(i,l){const p=i.length;if(!p)return 0;let a=0,h=0;if(this._interim){const f=i.charCodeAt(h++);56320<=f&&f<=57343?l[a++]=1024*(this._interim-55296)+f-56320+65536:(l[a++]=this._interim,l[a++]=f),this._interim=0}for(let f=h;f<p;++f){const d=i.charCodeAt(f);if(55296<=d&&d<=56319){if(++f>=p)return this._interim=d,a;const u=i.charCodeAt(f);56320<=u&&u<=57343?l[a++]=1024*(d-55296)+u-56320+65536:(l[a++]=d,l[a++]=u)}else d!==65279&&(l[a++]=d)}return a}},n.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(i,l){const p=i.length;if(!p)return 0;let a,h,f,d,u=0,t=0,s=0;if(this.interim[0]){let m=!1,g=this.interim[0];g&=(224&g)==192?31:(240&g)==224?15:7;let k,D=0;for(;(k=63&this.interim[++D])&&D<4;)g<<=6,g|=k;const w=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,S=w-D;for(;s<S;){if(s>=p)return 0;if(k=i[s++],(192&k)!=128){s--,m=!0;break}this.interim[D++]=k,g<<=6,g|=63&k}m||(w===2?g<128?s--:l[u++]=g:w===3?g<2048||g>=55296&&g<=57343||g===65279||(l[u++]=g):g<65536||g>1114111||(l[u++]=g)),this.interim.fill(0)}const o=p-4;let r=s;for(;r<p;){for(;!(!(r<o)||128&(a=i[r])||128&(h=i[r+1])||128&(f=i[r+2])||128&(d=i[r+3]));)l[u++]=a,l[u++]=h,l[u++]=f,l[u++]=d,r+=4;if(a=i[r++],a<128)l[u++]=a;else if((224&a)==192){if(r>=p)return this.interim[0]=a,u;if(h=i[r++],(192&h)!=128){r--;continue}if(t=(31&a)<<6|63&h,t<128){r--;continue}l[u++]=t}else if((240&a)==224){if(r>=p)return this.interim[0]=a,u;if(h=i[r++],(192&h)!=128){r--;continue}if(r>=p)return this.interim[0]=a,this.interim[1]=h,u;if(f=i[r++],(192&f)!=128){r--;continue}if(t=(15&a)<<12|(63&h)<<6|63&f,t<2048||t>=55296&&t<=57343||t===65279)continue;l[u++]=t}else if((248&a)==240){if(r>=p)return this.interim[0]=a,u;if(h=i[r++],(192&h)!=128){r--;continue}if(r>=p)return this.interim[0]=a,this.interim[1]=h,u;if(f=i[r++],(192&f)!=128){r--;continue}if(r>=p)return this.interim[0]=a,this.interim[1]=h,this.interim[2]=f,u;if(d=i[r++],(192&d)!=128){r--;continue}if(t=(7&a)<<18|(63&h)<<12|(63&f)<<6|63&d,t<65536||t>1114111)continue;l[u++]=t}}return u}}},225:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeV6=void 0;const i=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],l=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let p;n.UnicodeV6=class{constructor(){if(this.version="6",!p){p=new Uint8Array(65536),p.fill(1),p[0]=0,p.fill(0,1,32),p.fill(0,127,160),p.fill(2,4352,4448),p[9001]=2,p[9002]=2,p.fill(2,11904,42192),p[12351]=1,p.fill(2,44032,55204),p.fill(2,63744,64256),p.fill(2,65040,65050),p.fill(2,65072,65136),p.fill(2,65280,65377),p.fill(2,65504,65511);for(let a=0;a<i.length;++a)p.fill(0,i[a][0],i[a][1]+1)}}wcwidth(a){return a<32?0:a<127?1:a<65536?p[a]:function(h,f){let d,u=0,t=f.length-1;if(h<f[0][0]||h>f[t][1])return!1;for(;t>=u;)if(d=u+t>>1,h>f[d][1])u=d+1;else{if(!(h<f[d][0]))return!0;t=d-1}return!1}(a,l)?0:a>=131072&&a<=196605||a>=196608&&a<=262141?2:1}}},5981:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WriteBuffer=void 0;const l=i(8460),p=i(844);class a extends p.Disposable{constructor(f){super(),this._action=f,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new l.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(f,d){if(d!==void 0&&this._syncCalls>d)return void(this._syncCalls=0);if(this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let u;for(this._isSyncWriting=!0;u=this._writeBuffer.shift();){this._action(u);const t=this._callbacks.shift();t&&t()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(f,d){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(d),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(d)}_innerWrite(f=0,d=!0){const u=f||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const t=this._writeBuffer[this._bufferOffset],s=this._action(t,d);if(s){const r=m=>Date.now()-u>=12?setTimeout(()=>this._innerWrite(0,m)):this._innerWrite(u,m);return void s.catch(m=>(queueMicrotask(()=>{throw m}),Promise.resolve(!1))).then(r)}const o=this._callbacks[this._bufferOffset];if(o&&o(),this._bufferOffset++,this._pendingData-=t.length,Date.now()-u>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}n.WriteBuffer=a},5941:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.toRgbString=n.parseColor=void 0;const i=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,l=/^[\da-f]+$/;function p(a,h){const f=a.toString(16),d=f.length<2?"0"+f:f;switch(h){case 4:return f[0];case 8:return d;case 12:return(d+d).slice(0,3);default:return d+d}}n.parseColor=function(a){if(!a)return;let h=a.toLowerCase();if(h.indexOf("rgb:")===0){h=h.slice(4);const f=i.exec(h);if(f){const d=f[1]?15:f[4]?255:f[7]?4095:65535;return[Math.round(parseInt(f[1]||f[4]||f[7]||f[10],16)/d*255),Math.round(parseInt(f[2]||f[5]||f[8]||f[11],16)/d*255),Math.round(parseInt(f[3]||f[6]||f[9]||f[12],16)/d*255)]}}else if(h.indexOf("#")===0&&(h=h.slice(1),l.exec(h)&&[3,6,9,12].includes(h.length))){const f=h.length/3,d=[0,0,0];for(let u=0;u<3;++u){const t=parseInt(h.slice(f*u,f*u+f),16);d[u]=f===1?t<<4:f===2?t:f===3?t>>4:t>>8}return d}},n.toRgbString=function(a,h=16){const[f,d,u]=a;return`rgb:${p(f,h)}/${p(d,h)}/${p(u,h)}`}},5770:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PAYLOAD_LIMIT=void 0,n.PAYLOAD_LIMIT=1e7},6351:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DcsHandler=n.DcsParser=void 0;const l=i(482),p=i(8742),a=i(5770),h=[];n.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=h,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=h}registerHandler(d,u){this._handlers[d]===void 0&&(this._handlers[d]=[]);const t=this._handlers[d];return t.push(u),{dispose:()=>{const s=t.indexOf(u);s!==-1&&t.splice(s,1)}}}clearHandler(d){this._handlers[d]&&delete this._handlers[d]}setHandlerFallback(d){this._handlerFb=d}reset(){if(this._active.length)for(let d=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;d>=0;--d)this._active[d].unhook(!1);this._stack.paused=!1,this._active=h,this._ident=0}hook(d,u){if(this.reset(),this._ident=d,this._active=this._handlers[d]||h,this._active.length)for(let t=this._active.length-1;t>=0;t--)this._active[t].hook(u);else this._handlerFb(this._ident,"HOOK",u)}put(d,u,t){if(this._active.length)for(let s=this._active.length-1;s>=0;s--)this._active[s].put(d,u,t);else this._handlerFb(this._ident,"PUT",(0,l.utf32ToString)(d,u,t))}unhook(d,u=!0){if(this._active.length){let t=!1,s=this._active.length-1,o=!1;if(this._stack.paused&&(s=this._stack.loopPosition-1,t=u,o=this._stack.fallThrough,this._stack.paused=!1),!o&&t===!1){for(;s>=0&&(t=this._active[s].unhook(d),t!==!0);s--)if(t instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=s,this._stack.fallThrough=!1,t;s--}for(;s>=0;s--)if(t=this._active[s].unhook(!1),t instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=s,this._stack.fallThrough=!0,t}else this._handlerFb(this._ident,"UNHOOK",d);this._active=h,this._ident=0}};const f=new p.Params;f.addParam(0),n.DcsHandler=class{constructor(d){this._handler=d,this._data="",this._params=f,this._hitLimit=!1}hook(d){this._params=d.length>1||d.params[0]?d.clone():f,this._data="",this._hitLimit=!1}put(d,u,t){this._hitLimit||(this._data+=(0,l.utf32ToString)(d,u,t),this._data.length>a.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(d){let u=!1;if(this._hitLimit)u=!1;else if(d&&(u=this._handler(this._data,this._params),u instanceof Promise))return u.then(t=>(this._params=f,this._data="",this._hitLimit=!1,t));return this._params=f,this._data="",this._hitLimit=!1,u}}},2015:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.EscapeSequenceParser=n.VT500_TRANSITION_TABLE=n.TransitionTable=void 0;const l=i(844),p=i(8742),a=i(6242),h=i(6351);class f{constructor(s){this.table=new Uint8Array(s)}setDefault(s,o){this.table.fill(s<<4|o)}add(s,o,r,m){this.table[o<<8|s]=r<<4|m}addMany(s,o,r,m){for(let g=0;g<s.length;g++)this.table[o<<8|s[g]]=r<<4|m}}n.TransitionTable=f;const d=160;n.VT500_TRANSITION_TABLE=function(){const t=new f(4095),s=Array.apply(null,Array(256)).map((D,w)=>w),o=(D,w)=>s.slice(D,w),r=o(32,127),m=o(0,24);m.push(25),m.push.apply(m,o(28,32));const g=o(0,14);let k;for(k in t.setDefault(1,0),t.addMany(r,0,2,0),g)t.addMany([24,26,153,154],k,3,0),t.addMany(o(128,144),k,3,0),t.addMany(o(144,152),k,3,0),t.add(156,k,0,0),t.add(27,k,11,1),t.add(157,k,4,8),t.addMany([152,158,159],k,0,7),t.add(155,k,11,3),t.add(144,k,11,9);return t.addMany(m,0,3,0),t.addMany(m,1,3,1),t.add(127,1,0,1),t.addMany(m,8,0,8),t.addMany(m,3,3,3),t.add(127,3,0,3),t.addMany(m,4,3,4),t.add(127,4,0,4),t.addMany(m,6,3,6),t.addMany(m,5,3,5),t.add(127,5,0,5),t.addMany(m,2,3,2),t.add(127,2,0,2),t.add(93,1,4,8),t.addMany(r,8,5,8),t.add(127,8,5,8),t.addMany([156,27,24,26,7],8,6,0),t.addMany(o(28,32),8,0,8),t.addMany([88,94,95],1,0,7),t.addMany(r,7,0,7),t.addMany(m,7,0,7),t.add(156,7,0,0),t.add(127,7,0,7),t.add(91,1,11,3),t.addMany(o(64,127),3,7,0),t.addMany(o(48,60),3,8,4),t.addMany([60,61,62,63],3,9,4),t.addMany(o(48,60),4,8,4),t.addMany(o(64,127),4,7,0),t.addMany([60,61,62,63],4,0,6),t.addMany(o(32,64),6,0,6),t.add(127,6,0,6),t.addMany(o(64,127),6,0,0),t.addMany(o(32,48),3,9,5),t.addMany(o(32,48),5,9,5),t.addMany(o(48,64),5,0,6),t.addMany(o(64,127),5,7,0),t.addMany(o(32,48),4,9,5),t.addMany(o(32,48),1,9,2),t.addMany(o(32,48),2,9,2),t.addMany(o(48,127),2,10,0),t.addMany(o(48,80),1,10,0),t.addMany(o(81,88),1,10,0),t.addMany([89,90,92],1,10,0),t.addMany(o(96,127),1,10,0),t.add(80,1,11,9),t.addMany(m,9,0,9),t.add(127,9,0,9),t.addMany(o(28,32),9,0,9),t.addMany(o(32,48),9,9,12),t.addMany(o(48,60),9,8,10),t.addMany([60,61,62,63],9,9,10),t.addMany(m,11,0,11),t.addMany(o(32,128),11,0,11),t.addMany(o(28,32),11,0,11),t.addMany(m,10,0,10),t.add(127,10,0,10),t.addMany(o(28,32),10,0,10),t.addMany(o(48,60),10,8,10),t.addMany([60,61,62,63],10,0,11),t.addMany(o(32,48),10,9,12),t.addMany(m,12,0,12),t.add(127,12,0,12),t.addMany(o(28,32),12,0,12),t.addMany(o(32,48),12,9,12),t.addMany(o(48,64),12,0,11),t.addMany(o(64,127),12,12,13),t.addMany(o(64,127),10,12,13),t.addMany(o(64,127),9,12,13),t.addMany(m,13,13,13),t.addMany(r,13,13,13),t.add(127,13,0,13),t.addMany([27,156,24,26],13,14,0),t.add(d,0,2,0),t.add(d,8,5,8),t.add(d,6,0,6),t.add(d,11,0,11),t.add(d,13,13,13),t}();class u extends l.Disposable{constructor(s=n.VT500_TRANSITION_TABLE){super(),this._transitions=s,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new p.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(o,r,m)=>{},this._executeHandlerFb=o=>{},this._csiHandlerFb=(o,r)=>{},this._escHandlerFb=o=>{},this._errorHandlerFb=o=>o,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,l.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new a.OscParser),this._dcsParser=this.register(new h.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(s,o=[64,126]){let r=0;if(s.prefix){if(s.prefix.length>1)throw new Error("only one byte as prefix supported");if(r=s.prefix.charCodeAt(0),r&&60>r||r>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(s.intermediates){if(s.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let g=0;g<s.intermediates.length;++g){const k=s.intermediates.charCodeAt(g);if(32>k||k>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");r<<=8,r|=k}}if(s.final.length!==1)throw new Error("final must be a single byte");const m=s.final.charCodeAt(0);if(o[0]>m||m>o[1])throw new Error(`final must be in range ${o[0]} .. ${o[1]}`);return r<<=8,r|=m,r}identToString(s){const o=[];for(;s;)o.push(String.fromCharCode(255&s)),s>>=8;return o.reverse().join("")}setPrintHandler(s){this._printHandler=s}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(s,o){const r=this._identifier(s,[48,126]);this._escHandlers[r]===void 0&&(this._escHandlers[r]=[]);const m=this._escHandlers[r];return m.push(o),{dispose:()=>{const g=m.indexOf(o);g!==-1&&m.splice(g,1)}}}clearEscHandler(s){this._escHandlers[this._identifier(s,[48,126])]&&delete this._escHandlers[this._identifier(s,[48,126])]}setEscHandlerFallback(s){this._escHandlerFb=s}setExecuteHandler(s,o){this._executeHandlers[s.charCodeAt(0)]=o}clearExecuteHandler(s){this._executeHandlers[s.charCodeAt(0)]&&delete this._executeHandlers[s.charCodeAt(0)]}setExecuteHandlerFallback(s){this._executeHandlerFb=s}registerCsiHandler(s,o){const r=this._identifier(s);this._csiHandlers[r]===void 0&&(this._csiHandlers[r]=[]);const m=this._csiHandlers[r];return m.push(o),{dispose:()=>{const g=m.indexOf(o);g!==-1&&m.splice(g,1)}}}clearCsiHandler(s){this._csiHandlers[this._identifier(s)]&&delete this._csiHandlers[this._identifier(s)]}setCsiHandlerFallback(s){this._csiHandlerFb=s}registerDcsHandler(s,o){return this._dcsParser.registerHandler(this._identifier(s),o)}clearDcsHandler(s){this._dcsParser.clearHandler(this._identifier(s))}setDcsHandlerFallback(s){this._dcsParser.setHandlerFallback(s)}registerOscHandler(s,o){return this._oscParser.registerHandler(s,o)}clearOscHandler(s){this._oscParser.clearHandler(s)}setOscHandlerFallback(s){this._oscParser.setHandlerFallback(s)}setErrorHandler(s){this._errorHandler=s}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(s,o,r,m,g){this._parseStack.state=s,this._parseStack.handlers=o,this._parseStack.handlerPos=r,this._parseStack.transition=m,this._parseStack.chunkPos=g}parse(s,o,r){let m,g=0,k=0,D=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,D=this._parseStack.chunkPos+1;else{if(r===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const w=this._parseStack.handlers;let S=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(r===!1&&S>-1){for(;S>=0&&(m=w[S](this._params),m!==!0);S--)if(m instanceof Promise)return this._parseStack.handlerPos=S,m}this._parseStack.handlers=[];break;case 4:if(r===!1&&S>-1){for(;S>=0&&(m=w[S](),m!==!0);S--)if(m instanceof Promise)return this._parseStack.handlerPos=S,m}this._parseStack.handlers=[];break;case 6:if(g=s[this._parseStack.chunkPos],m=this._dcsParser.unhook(g!==24&&g!==26,r),m)return m;g===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(g=s[this._parseStack.chunkPos],m=this._oscParser.end(g!==24&&g!==26,r),m)return m;g===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,D=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let w=D;w<o;++w){switch(g=s[w],k=this._transitions.table[this.currentState<<8|(g<160?g:d)],k>>4){case 2:for(let T=w+1;;++T){if(T>=o||(g=s[T])<32||g>126&&g<d){this._printHandler(s,w,T),w=T-1;break}if(++T>=o||(g=s[T])<32||g>126&&g<d){this._printHandler(s,w,T),w=T-1;break}if(++T>=o||(g=s[T])<32||g>126&&g<d){this._printHandler(s,w,T),w=T-1;break}if(++T>=o||(g=s[T])<32||g>126&&g<d){this._printHandler(s,w,T),w=T-1;break}}break;case 3:this._executeHandlers[g]?this._executeHandlers[g]():this._executeHandlerFb(g),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:w,code:g,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const S=this._csiHandlers[this._collect<<8|g];let M=S?S.length-1:-1;for(;M>=0&&(m=S[M](this._params),m!==!0);M--)if(m instanceof Promise)return this._preserveStack(3,S,M,k,w),m;M<0&&this._csiHandlerFb(this._collect<<8|g,this._params),this.precedingCodepoint=0;break;case 8:do switch(g){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(g-48)}while(++w<o&&(g=s[w])>47&&g<60);w--;break;case 9:this._collect<<=8,this._collect|=g;break;case 10:const I=this._escHandlers[this._collect<<8|g];let y=I?I.length-1:-1;for(;y>=0&&(m=I[y](),m!==!0);y--)if(m instanceof Promise)return this._preserveStack(4,I,y,k,w),m;y<0&&this._escHandlerFb(this._collect<<8|g),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|g,this._params);break;case 13:for(let T=w+1;;++T)if(T>=o||(g=s[T])===24||g===26||g===27||g>127&&g<d){this._dcsParser.put(s,w,T),w=T-1;break}break;case 14:if(m=this._dcsParser.unhook(g!==24&&g!==26),m)return this._preserveStack(6,[],0,k,w),m;g===27&&(k|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let T=w+1;;T++)if(T>=o||(g=s[T])<32||g>127&&g<d){this._oscParser.put(s,w,T),w=T-1;break}break;case 6:if(m=this._oscParser.end(g!==24&&g!==26),m)return this._preserveStack(5,[],0,k,w),m;g===27&&(k|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&k}}}n.EscapeSequenceParser=u},6242:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OscHandler=n.OscParser=void 0;const l=i(5770),p=i(482),a=[];n.OscParser=class{constructor(){this._state=0,this._active=a,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(h,f){this._handlers[h]===void 0&&(this._handlers[h]=[]);const d=this._handlers[h];return d.push(f),{dispose:()=>{const u=d.indexOf(f);u!==-1&&d.splice(u,1)}}}clearHandler(h){this._handlers[h]&&delete this._handlers[h]}setHandlerFallback(h){this._handlerFb=h}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=a}reset(){if(this._state===2)for(let h=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;h>=0;--h)this._active[h].end(!1);this._stack.paused=!1,this._active=a,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||a,this._active.length)for(let h=this._active.length-1;h>=0;h--)this._active[h].start();else this._handlerFb(this._id,"START")}_put(h,f,d){if(this._active.length)for(let u=this._active.length-1;u>=0;u--)this._active[u].put(h,f,d);else this._handlerFb(this._id,"PUT",(0,p.utf32ToString)(h,f,d))}start(){this.reset(),this._state=1}put(h,f,d){if(this._state!==3){if(this._state===1)for(;f<d;){const u=h[f++];if(u===59){this._state=2,this._start();break}if(u<48||57<u)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+u-48}this._state===2&&d-f>0&&this._put(h,f,d)}}end(h,f=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let d=!1,u=this._active.length-1,t=!1;if(this._stack.paused&&(u=this._stack.loopPosition-1,d=f,t=this._stack.fallThrough,this._stack.paused=!1),!t&&d===!1){for(;u>=0&&(d=this._active[u].end(h),d!==!0);u--)if(d instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=u,this._stack.fallThrough=!1,d;u--}for(;u>=0;u--)if(d=this._active[u].end(!1),d instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=u,this._stack.fallThrough=!0,d}else this._handlerFb(this._id,"END",h);this._active=a,this._id=-1,this._state=0}}},n.OscHandler=class{constructor(h){this._handler=h,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(h,f,d){this._hitLimit||(this._data+=(0,p.utf32ToString)(h,f,d),this._data.length>l.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(h){let f=!1;if(this._hitLimit)f=!1;else if(h&&(f=this._handler(this._data),f instanceof Promise))return f.then(d=>(this._data="",this._hitLimit=!1,d));return this._data="",this._hitLimit=!1,f}}},8742:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Params=void 0;const i=2147483647;class l{static fromArray(a){const h=new l;if(!a.length)return h;for(let f=Array.isArray(a[0])?1:0;f<a.length;++f){const d=a[f];if(Array.isArray(d))for(let u=0;u<d.length;++u)h.addSubParam(d[u]);else h.addParam(d)}return h}constructor(a=32,h=32){if(this.maxLength=a,this.maxSubParamsLength=h,h>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(a),this.length=0,this._subParams=new Int32Array(h),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(a),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const a=new l(this.maxLength,this.maxSubParamsLength);return a.params.set(this.params),a.length=this.length,a._subParams.set(this._subParams),a._subParamsLength=this._subParamsLength,a._subParamsIdx.set(this._subParamsIdx),a._rejectDigits=this._rejectDigits,a._rejectSubDigits=this._rejectSubDigits,a._digitIsSub=this._digitIsSub,a}toArray(){const a=[];for(let h=0;h<this.length;++h){a.push(this.params[h]);const f=this._subParamsIdx[h]>>8,d=255&this._subParamsIdx[h];d-f>0&&a.push(Array.prototype.slice.call(this._subParams,f,d))}return a}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(a){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(a<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=a>i?i:a}}addSubParam(a){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(a<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=a>i?i:a,this._subParamsIdx[this.length-1]++}}hasSubParams(a){return(255&this._subParamsIdx[a])-(this._subParamsIdx[a]>>8)>0}getSubParams(a){const h=this._subParamsIdx[a]>>8,f=255&this._subParamsIdx[a];return f-h>0?this._subParams.subarray(h,f):null}getSubParamsAll(){const a={};for(let h=0;h<this.length;++h){const f=this._subParamsIdx[h]>>8,d=255&this._subParamsIdx[h];d-f>0&&(a[h]=this._subParams.slice(f,d))}return a}addDigit(a){let h;if(this._rejectDigits||!(h=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const f=this._digitIsSub?this._subParams:this.params,d=f[h-1];f[h-1]=~d?Math.min(10*d+a,i):a}}n.Params=l},5741:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AddonManager=void 0,n.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let i=this._addons.length-1;i>=0;i--)this._addons[i].instance.dispose()}loadAddon(i,l){const p={instance:l,dispose:l.dispose,isDisposed:!1};this._addons.push(p),l.dispose=()=>this._wrappedAddonDispose(p),l.activate(i)}_wrappedAddonDispose(i){if(i.isDisposed)return;let l=-1;for(let p=0;p<this._addons.length;p++)if(this._addons[p]===i){l=p;break}if(l===-1)throw new Error("Could not dispose an addon that has not been loaded");i.isDisposed=!0,i.dispose.apply(i.instance),this._addons.splice(l,1)}}},8771:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferApiView=void 0;const l=i(3785),p=i(511);n.BufferApiView=class{constructor(a,h){this._buffer=a,this.type=h}init(a){return this._buffer=a,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(a){const h=this._buffer.lines.get(a);if(h)return new l.BufferLineApiView(h)}getNullCell(){return new p.CellData}}},3785:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferLineApiView=void 0;const l=i(511);n.BufferLineApiView=class{constructor(p){this._line=p}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(p,a){if(!(p<0||p>=this._line.length))return a?(this._line.loadCell(p,a),a):this._line.loadCell(p,new l.CellData)}translateToString(p,a,h){return this._line.translateToString(p,a,h)}}},8285:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferNamespaceApi=void 0;const l=i(8771),p=i(8460),a=i(844);class h extends a.Disposable{constructor(d){super(),this._core=d,this._onBufferChange=this.register(new p.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new l.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new l.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}n.BufferNamespaceApi=h},7975:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ParserApi=void 0,n.ParserApi=class{constructor(i){this._core=i}registerCsiHandler(i,l){return this._core.registerCsiHandler(i,p=>l(p.toArray()))}addCsiHandler(i,l){return this.registerCsiHandler(i,l)}registerDcsHandler(i,l){return this._core.registerDcsHandler(i,(p,a)=>l(p,a.toArray()))}addDcsHandler(i,l){return this.registerDcsHandler(i,l)}registerEscHandler(i,l){return this._core.registerEscHandler(i,l)}addEscHandler(i,l){return this.registerEscHandler(i,l)}registerOscHandler(i,l){return this._core.registerOscHandler(i,l)}addOscHandler(i,l){return this.registerOscHandler(i,l)}}},7090:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeApi=void 0,n.UnicodeApi=class{constructor(i){this._core=i}register(i){this._core.unicodeService.register(i)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(i){this._core.unicodeService.activeVersion=i}}},744:function(C,n,i){var l=this&&this.__decorate||function(t,s,o,r){var m,g=arguments.length,k=g<3?s:r===null?r=Object.getOwnPropertyDescriptor(s,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(t,s,o,r);else for(var D=t.length-1;D>=0;D--)(m=t[D])&&(k=(g<3?m(k):g>3?m(s,o,k):m(s,o))||k);return g>3&&k&&Object.defineProperty(s,o,k),k},p=this&&this.__param||function(t,s){return function(o,r){s(o,r,t)}};Object.defineProperty(n,"__esModule",{value:!0}),n.BufferService=n.MINIMUM_ROWS=n.MINIMUM_COLS=void 0;const a=i(8460),h=i(844),f=i(5295),d=i(2585);n.MINIMUM_COLS=2,n.MINIMUM_ROWS=1;let u=n.BufferService=class extends h.Disposable{get buffer(){return this.buffers.active}constructor(t){super(),this.isUserScrolling=!1,this._onResize=this.register(new a.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new a.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(t.rawOptions.cols||0,n.MINIMUM_COLS),this.rows=Math.max(t.rawOptions.rows||0,n.MINIMUM_ROWS),this.buffers=this.register(new f.BufferSet(t,this))}resize(t,s){this.cols=t,this.rows=s,this.buffers.resize(t,s),this._onResize.fire({cols:t,rows:s})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(t,s=!1){const o=this.buffer;let r;r=this._cachedBlankLine,r&&r.length===this.cols&&r.getFg(0)===t.fg&&r.getBg(0)===t.bg||(r=o.getBlankLine(t,s),this._cachedBlankLine=r),r.isWrapped=s;const m=o.ybase+o.scrollTop,g=o.ybase+o.scrollBottom;if(o.scrollTop===0){const k=o.lines.isFull;g===o.lines.length-1?k?o.lines.recycle().copyFrom(r):o.lines.push(r.clone()):o.lines.splice(g+1,0,r.clone()),k?this.isUserScrolling&&(o.ydisp=Math.max(o.ydisp-1,0)):(o.ybase++,this.isUserScrolling||o.ydisp++)}else{const k=g-m+1;o.lines.shiftElements(m+1,k-1,-1),o.lines.set(g,r.clone())}this.isUserScrolling||(o.ydisp=o.ybase),this._onScroll.fire(o.ydisp)}scrollLines(t,s,o){const r=this.buffer;if(t<0){if(r.ydisp===0)return;this.isUserScrolling=!0}else t+r.ydisp>=r.ybase&&(this.isUserScrolling=!1);const m=r.ydisp;r.ydisp=Math.max(Math.min(r.ydisp+t,r.ybase),0),m!==r.ydisp&&(s||this._onScroll.fire(r.ydisp))}};n.BufferService=u=l([p(0,d.IOptionsService)],u)},7994:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CharsetService=void 0,n.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(i){this.glevel=i,this.charset=this._charsets[i]}setgCharset(i,l){this._charsets[i]=l,this.glevel===i&&(this.charset=l)}}},1753:function(C,n,i){var l=this&&this.__decorate||function(r,m,g,k){var D,w=arguments.length,S=w<3?m:k===null?k=Object.getOwnPropertyDescriptor(m,g):k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(r,m,g,k);else for(var M=r.length-1;M>=0;M--)(D=r[M])&&(S=(w<3?D(S):w>3?D(m,g,S):D(m,g))||S);return w>3&&S&&Object.defineProperty(m,g,S),S},p=this&&this.__param||function(r,m){return function(g,k){m(g,k,r)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CoreMouseService=void 0;const a=i(2585),h=i(8460),f=i(844),d={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:r=>r.button!==4&&r.action===1&&(r.ctrl=!1,r.alt=!1,r.shift=!1,!0)},VT200:{events:19,restrict:r=>r.action!==32},DRAG:{events:23,restrict:r=>r.action!==32||r.button!==3},ANY:{events:31,restrict:r=>!0}};function u(r,m){let g=(r.ctrl?16:0)|(r.shift?4:0)|(r.alt?8:0);return r.button===4?(g|=64,g|=r.action):(g|=3&r.button,4&r.button&&(g|=64),8&r.button&&(g|=128),r.action===32?g|=32:r.action!==0||m||(g|=3)),g}const t=String.fromCharCode,s={DEFAULT:r=>{const m=[u(r,!1)+32,r.col+32,r.row+32];return m[0]>255||m[1]>255||m[2]>255?"":`\x1B[M${t(m[0])}${t(m[1])}${t(m[2])}`},SGR:r=>{const m=r.action===0&&r.button!==4?"m":"M";return`\x1B[<${u(r,!0)};${r.col};${r.row}${m}`},SGR_PIXELS:r=>{const m=r.action===0&&r.button!==4?"m":"M";return`\x1B[<${u(r,!0)};${r.x};${r.y}${m}`}};let o=n.CoreMouseService=class extends f.Disposable{constructor(r,m){super(),this._bufferService=r,this._coreService=m,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new h.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const g of Object.keys(d))this.addProtocol(g,d[g]);for(const g of Object.keys(s))this.addEncoding(g,s[g]);this.reset()}addProtocol(r,m){this._protocols[r]=m}addEncoding(r,m){this._encodings[r]=m}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(r){if(!this._protocols[r])throw new Error(`unknown protocol "${r}"`);this._activeProtocol=r,this._onProtocolChange.fire(this._protocols[r].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(r){if(!this._encodings[r])throw new Error(`unknown encoding "${r}"`);this._activeEncoding=r}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(r){if(r.col<0||r.col>=this._bufferService.cols||r.row<0||r.row>=this._bufferService.rows||r.button===4&&r.action===32||r.button===3&&r.action!==32||r.button!==4&&(r.action===2||r.action===3)||(r.col++,r.row++,r.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,r,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(r))return!1;const m=this._encodings[this._activeEncoding](r);return m&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(m):this._coreService.triggerDataEvent(m,!0)),this._lastEvent=r,!0}explainEvents(r){return{down:!!(1&r),up:!!(2&r),drag:!!(4&r),move:!!(8&r),wheel:!!(16&r)}}_equalEvents(r,m,g){if(g){if(r.x!==m.x||r.y!==m.y)return!1}else if(r.col!==m.col||r.row!==m.row)return!1;return r.button===m.button&&r.action===m.action&&r.ctrl===m.ctrl&&r.alt===m.alt&&r.shift===m.shift}};n.CoreMouseService=o=l([p(0,a.IBufferService),p(1,a.ICoreService)],o)},6975:function(C,n,i){var l=this&&this.__decorate||function(o,r,m,g){var k,D=arguments.length,w=D<3?r:g===null?g=Object.getOwnPropertyDescriptor(r,m):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(o,r,m,g);else for(var S=o.length-1;S>=0;S--)(k=o[S])&&(w=(D<3?k(w):D>3?k(r,m,w):k(r,m))||w);return D>3&&w&&Object.defineProperty(r,m,w),w},p=this&&this.__param||function(o,r){return function(m,g){r(m,g,o)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CoreService=void 0;const a=i(1439),h=i(8460),f=i(844),d=i(2585),u=Object.freeze({insertMode:!1}),t=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let s=n.CoreService=class extends f.Disposable{constructor(o,r,m){super(),this._bufferService=o,this._logService=r,this._optionsService=m,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new h.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new h.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new h.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new h.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,a.clone)(u),this.decPrivateModes=(0,a.clone)(t)}reset(){this.modes=(0,a.clone)(u),this.decPrivateModes=(0,a.clone)(t)}triggerDataEvent(o,r=!1){if(this._optionsService.rawOptions.disableStdin)return;const m=this._bufferService.buffer;r&&this._optionsService.rawOptions.scrollOnUserInput&&m.ybase!==m.ydisp&&this._onRequestScrollToBottom.fire(),r&&this._onUserInput.fire(),this._logService.debug(`sending data "${o}"`,()=>o.split("").map(g=>g.charCodeAt(0))),this._onData.fire(o)}triggerBinaryEvent(o){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${o}"`,()=>o.split("").map(r=>r.charCodeAt(0))),this._onBinary.fire(o))}};n.CoreService=s=l([p(0,d.IBufferService),p(1,d.ILogService),p(2,d.IOptionsService)],s)},9074:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DecorationService=void 0;const l=i(8055),p=i(8460),a=i(844),h=i(6106);let f=0,d=0;class u extends a.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new h.SortedList(o=>o==null?void 0:o.marker.line),this._onDecorationRegistered=this.register(new p.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new p.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,a.toDisposable)(()=>this.reset()))}registerDecoration(o){if(o.marker.isDisposed)return;const r=new t(o);if(r){const m=r.marker.onDispose(()=>r.dispose());r.onDispose(()=>{r&&(this._decorations.delete(r)&&this._onDecorationRemoved.fire(r),m.dispose())}),this._decorations.insert(r),this._onDecorationRegistered.fire(r)}return r}reset(){for(const o of this._decorations.values())o.dispose();this._decorations.clear()}*getDecorationsAtCell(o,r,m){var g,k,D;let w=0,S=0;for(const M of this._decorations.getKeyIterator(r))w=(g=M.options.x)!==null&&g!==void 0?g:0,S=w+((k=M.options.width)!==null&&k!==void 0?k:1),o>=w&&o<S&&(!m||((D=M.options.layer)!==null&&D!==void 0?D:"bottom")===m)&&(yield M)}forEachDecorationAtCell(o,r,m,g){this._decorations.forEachByKey(r,k=>{var D,w,S;f=(D=k.options.x)!==null&&D!==void 0?D:0,d=f+((w=k.options.width)!==null&&w!==void 0?w:1),o>=f&&o<d&&(!m||((S=k.options.layer)!==null&&S!==void 0?S:"bottom")===m)&&g(k)})}}n.DecorationService=u;class t extends a.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=l.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=l.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(o){super(),this.options=o,this.onRenderEmitter=this.register(new p.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new p.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=o.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.InstantiationService=n.ServiceCollection=void 0;const l=i(2585),p=i(8343);class a{constructor(...f){this._entries=new Map;for(const[d,u]of f)this.set(d,u)}set(f,d){const u=this._entries.get(f);return this._entries.set(f,d),u}forEach(f){for(const[d,u]of this._entries.entries())f(d,u)}has(f){return this._entries.has(f)}get(f){return this._entries.get(f)}}n.ServiceCollection=a,n.InstantiationService=class{constructor(){this._services=new a,this._services.set(l.IInstantiationService,this)}setService(h,f){this._services.set(h,f)}getService(h){return this._services.get(h)}createInstance(h,...f){const d=(0,p.getServiceDependencies)(h).sort((s,o)=>s.index-o.index),u=[];for(const s of d){const o=this._services.get(s.id);if(!o)throw new Error(`[createInstance] ${h.name} depends on UNKNOWN service ${s.id}.`);u.push(o)}const t=d.length>0?d[0].index:f.length;if(f.length!==t)throw new Error(`[createInstance] First service dependency of ${h.name} at position ${t+1} conflicts with ${f.length} static arguments`);return new h(...f,...u)}}},7866:function(C,n,i){var l=this&&this.__decorate||function(t,s,o,r){var m,g=arguments.length,k=g<3?s:r===null?r=Object.getOwnPropertyDescriptor(s,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(t,s,o,r);else for(var D=t.length-1;D>=0;D--)(m=t[D])&&(k=(g<3?m(k):g>3?m(s,o,k):m(s,o))||k);return g>3&&k&&Object.defineProperty(s,o,k),k},p=this&&this.__param||function(t,s){return function(o,r){s(o,r,t)}};Object.defineProperty(n,"__esModule",{value:!0}),n.traceCall=n.setTraceLogger=n.LogService=void 0;const a=i(844),h=i(2585),f={trace:h.LogLevelEnum.TRACE,debug:h.LogLevelEnum.DEBUG,info:h.LogLevelEnum.INFO,warn:h.LogLevelEnum.WARN,error:h.LogLevelEnum.ERROR,off:h.LogLevelEnum.OFF};let d,u=n.LogService=class extends a.Disposable{get logLevel(){return this._logLevel}constructor(t){super(),this._optionsService=t,this._logLevel=h.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),d=this}_updateLogLevel(){this._logLevel=f[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(t){for(let s=0;s<t.length;s++)typeof t[s]=="function"&&(t[s]=t[s]())}_log(t,s,o){this._evalLazyOptionalParams(o),t.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+s,...o)}trace(t,...s){var o,r;this._logLevel<=h.LogLevelEnum.TRACE&&this._log((r=(o=this._optionsService.options.logger)===null||o===void 0?void 0:o.trace.bind(this._optionsService.options.logger))!==null&&r!==void 0?r:console.log,t,s)}debug(t,...s){var o,r;this._logLevel<=h.LogLevelEnum.DEBUG&&this._log((r=(o=this._optionsService.options.logger)===null||o===void 0?void 0:o.debug.bind(this._optionsService.options.logger))!==null&&r!==void 0?r:console.log,t,s)}info(t,...s){var o,r;this._logLevel<=h.LogLevelEnum.INFO&&this._log((r=(o=this._optionsService.options.logger)===null||o===void 0?void 0:o.info.bind(this._optionsService.options.logger))!==null&&r!==void 0?r:console.info,t,s)}warn(t,...s){var o,r;this._logLevel<=h.LogLevelEnum.WARN&&this._log((r=(o=this._optionsService.options.logger)===null||o===void 0?void 0:o.warn.bind(this._optionsService.options.logger))!==null&&r!==void 0?r:console.warn,t,s)}error(t,...s){var o,r;this._logLevel<=h.LogLevelEnum.ERROR&&this._log((r=(o=this._optionsService.options.logger)===null||o===void 0?void 0:o.error.bind(this._optionsService.options.logger))!==null&&r!==void 0?r:console.error,t,s)}};n.LogService=u=l([p(0,h.IOptionsService)],u),n.setTraceLogger=function(t){d=t},n.traceCall=function(t,s,o){if(typeof o.value!="function")throw new Error("not supported");const r=o.value;o.value=function(...m){if(d.logLevel!==h.LogLevelEnum.TRACE)return r.apply(this,m);d.trace(`GlyphRenderer#${r.name}(${m.map(k=>JSON.stringify(k)).join(", ")})`);const g=r.apply(this,m);return d.trace(`GlyphRenderer#${r.name} return`,g),g}}},7302:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OptionsService=n.DEFAULT_OPTIONS=void 0;const l=i(8460),p=i(844),a=i(6114);n.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:a.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const h=["normal","bold","100","200","300","400","500","600","700","800","900"];class f extends p.Disposable{constructor(u){super(),this._onOptionChange=this.register(new l.EventEmitter),this.onOptionChange=this._onOptionChange.event;const t=Object.assign({},n.DEFAULT_OPTIONS);for(const s in u)if(s in t)try{const o=u[s];t[s]=this._sanitizeAndValidateOption(s,o)}catch(o){console.error(o)}this.rawOptions=t,this.options=Object.assign({},t),this._setupOptions()}onSpecificOptionChange(u,t){return this.onOptionChange(s=>{s===u&&t(this.rawOptions[u])})}onMultipleOptionChange(u,t){return this.onOptionChange(s=>{u.indexOf(s)!==-1&&t()})}_setupOptions(){const u=s=>{if(!(s in n.DEFAULT_OPTIONS))throw new Error(`No option with key "${s}"`);return this.rawOptions[s]},t=(s,o)=>{if(!(s in n.DEFAULT_OPTIONS))throw new Error(`No option with key "${s}"`);o=this._sanitizeAndValidateOption(s,o),this.rawOptions[s]!==o&&(this.rawOptions[s]=o,this._onOptionChange.fire(s))};for(const s in this.rawOptions){const o={get:u.bind(this,s),set:t.bind(this,s)};Object.defineProperty(this.options,s,o)}}_sanitizeAndValidateOption(u,t){switch(u){case"cursorStyle":if(t||(t=n.DEFAULT_OPTIONS[u]),!function(s){return s==="block"||s==="underline"||s==="bar"}(t))throw new Error(`"${t}" is not a valid value for ${u}`);break;case"wordSeparator":t||(t=n.DEFAULT_OPTIONS[u]);break;case"fontWeight":case"fontWeightBold":if(typeof t=="number"&&1<=t&&t<=1e3)break;t=h.includes(t)?t:n.DEFAULT_OPTIONS[u];break;case"cursorWidth":t=Math.floor(t);case"lineHeight":case"tabStopWidth":if(t<1)throw new Error(`${u} cannot be less than 1, value: ${t}`);break;case"minimumContrastRatio":t=Math.max(1,Math.min(21,Math.round(10*t)/10));break;case"scrollback":if((t=Math.min(t,4294967295))<0)throw new Error(`${u} cannot be less than 0, value: ${t}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(t<=0)throw new Error(`${u} cannot be less than or equal to 0, value: ${t}`);break;case"rows":case"cols":if(!t&&t!==0)throw new Error(`${u} must be numeric, value: ${t}`);break;case"windowsPty":t=t??{}}return t}}n.OptionsService=f},2660:function(C,n,i){var l=this&&this.__decorate||function(f,d,u,t){var s,o=arguments.length,r=o<3?d:t===null?t=Object.getOwnPropertyDescriptor(d,u):t;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(f,d,u,t);else for(var m=f.length-1;m>=0;m--)(s=f[m])&&(r=(o<3?s(r):o>3?s(d,u,r):s(d,u))||r);return o>3&&r&&Object.defineProperty(d,u,r),r},p=this&&this.__param||function(f,d){return function(u,t){d(u,t,f)}};Object.defineProperty(n,"__esModule",{value:!0}),n.OscLinkService=void 0;const a=i(2585);let h=n.OscLinkService=class{constructor(f){this._bufferService=f,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(f){const d=this._bufferService.buffer;if(f.id===void 0){const m=d.addMarker(d.ybase+d.y),g={data:f,id:this._nextId++,lines:[m]};return m.onDispose(()=>this._removeMarkerFromLink(g,m)),this._dataByLinkId.set(g.id,g),g.id}const u=f,t=this._getEntryIdKey(u),s=this._entriesWithId.get(t);if(s)return this.addLineToLink(s.id,d.ybase+d.y),s.id;const o=d.addMarker(d.ybase+d.y),r={id:this._nextId++,key:this._getEntryIdKey(u),data:u,lines:[o]};return o.onDispose(()=>this._removeMarkerFromLink(r,o)),this._entriesWithId.set(r.key,r),this._dataByLinkId.set(r.id,r),r.id}addLineToLink(f,d){const u=this._dataByLinkId.get(f);if(u&&u.lines.every(t=>t.line!==d)){const t=this._bufferService.buffer.addMarker(d);u.lines.push(t),t.onDispose(()=>this._removeMarkerFromLink(u,t))}}getLinkData(f){var d;return(d=this._dataByLinkId.get(f))===null||d===void 0?void 0:d.data}_getEntryIdKey(f){return`${f.id};;${f.uri}`}_removeMarkerFromLink(f,d){const u=f.lines.indexOf(d);u!==-1&&(f.lines.splice(u,1),f.lines.length===0&&(f.data.id!==void 0&&this._entriesWithId.delete(f.key),this._dataByLinkId.delete(f.id)))}};n.OscLinkService=h=l([p(0,a.IBufferService)],h)},8343:(C,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createDecorator=n.getServiceDependencies=n.serviceRegistry=void 0;const i="di$target",l="di$dependencies";n.serviceRegistry=new Map,n.getServiceDependencies=function(p){return p[l]||[]},n.createDecorator=function(p){if(n.serviceRegistry.has(p))return n.serviceRegistry.get(p);const a=function(h,f,d){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(u,t,s){t[i]===t?t[l].push({id:u,index:s}):(t[l]=[{id:u,index:s}],t[i]=t)})(a,h,d)};return a.toString=()=>p,n.serviceRegistry.set(p,a),a}},2585:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.IDecorationService=n.IUnicodeService=n.IOscLinkService=n.IOptionsService=n.ILogService=n.LogLevelEnum=n.IInstantiationService=n.ICharsetService=n.ICoreService=n.ICoreMouseService=n.IBufferService=void 0;const l=i(8343);var p;n.IBufferService=(0,l.createDecorator)("BufferService"),n.ICoreMouseService=(0,l.createDecorator)("CoreMouseService"),n.ICoreService=(0,l.createDecorator)("CoreService"),n.ICharsetService=(0,l.createDecorator)("CharsetService"),n.IInstantiationService=(0,l.createDecorator)("InstantiationService"),function(a){a[a.TRACE=0]="TRACE",a[a.DEBUG=1]="DEBUG",a[a.INFO=2]="INFO",a[a.WARN=3]="WARN",a[a.ERROR=4]="ERROR",a[a.OFF=5]="OFF"}(p||(n.LogLevelEnum=p={})),n.ILogService=(0,l.createDecorator)("LogService"),n.IOptionsService=(0,l.createDecorator)("OptionsService"),n.IOscLinkService=(0,l.createDecorator)("OscLinkService"),n.IUnicodeService=(0,l.createDecorator)("UnicodeService"),n.IDecorationService=(0,l.createDecorator)("DecorationService")},1480:(C,n,i)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeService=void 0;const l=i(8460),p=i(225);n.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new l.EventEmitter,this.onChange=this._onChange.event;const a=new p.UnicodeV6;this.register(a),this._active=a.version,this._activeProvider=a}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(a){if(!this._providers[a])throw new Error(`unknown Unicode version "${a}"`);this._active=a,this._activeProvider=this._providers[a],this._onChange.fire(a)}register(a){this._providers[a.version]=a}wcwidth(a){return this._activeProvider.wcwidth(a)}getStringCellWidth(a){let h=0;const f=a.length;for(let d=0;d<f;++d){let u=a.charCodeAt(d);if(55296<=u&&u<=56319){if(++d>=f)return h+this.wcwidth(u);const t=a.charCodeAt(d);56320<=t&&t<=57343?u=1024*(u-55296)+t-56320+65536:h+=this.wcwidth(t)}h+=this.wcwidth(u)}return h}}}},b={};function x(C){var n=b[C];if(n!==void 0)return n.exports;var i=b[C]={exports:{}};return v[C].call(i.exports,i,i.exports,x),i.exports}var E={};return(()=>{var C=E;Object.defineProperty(C,"__esModule",{value:!0}),C.Terminal=void 0;const n=x(9042),i=x(3236),l=x(844),p=x(5741),a=x(8285),h=x(7975),f=x(7090),d=["cols","rows"];class u extends l.Disposable{constructor(s){super(),this._core=this.register(new i.Terminal(s)),this._addonManager=this.register(new p.AddonManager),this._publicOptions=Object.assign({},this._core.options);const o=m=>this._core.options[m],r=(m,g)=>{this._checkReadonlyOptions(m),this._core.options[m]=g};for(const m in this._core.options){const g={get:o.bind(this,m),set:r.bind(this,m)};Object.defineProperty(this._publicOptions,m,g)}}_checkReadonlyOptions(s){if(d.includes(s))throw new Error(`Option "${s}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new h.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new f.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new a.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const s=this._core.coreService.decPrivateModes;let o="none";switch(this._core.coreMouseService.activeProtocol){case"X10":o="x10";break;case"VT200":o="vt200";break;case"DRAG":o="drag";break;case"ANY":o="any"}return{applicationCursorKeysMode:s.applicationCursorKeys,applicationKeypadMode:s.applicationKeypad,bracketedPasteMode:s.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:o,originMode:s.origin,reverseWraparoundMode:s.reverseWraparound,sendFocusMode:s.sendFocus,wraparoundMode:s.wraparound}}get options(){return this._publicOptions}set options(s){for(const o in s)this._publicOptions[o]=s[o]}blur(){this._core.blur()}focus(){this._core.focus()}resize(s,o){this._verifyIntegers(s,o),this._core.resize(s,o)}open(s){this._core.open(s)}attachCustomKeyEventHandler(s){this._core.attachCustomKeyEventHandler(s)}registerLinkProvider(s){return this._core.registerLinkProvider(s)}registerCharacterJoiner(s){return this._checkProposedApi(),this._core.registerCharacterJoiner(s)}deregisterCharacterJoiner(s){this._checkProposedApi(),this._core.deregisterCharacterJoiner(s)}registerMarker(s=0){return this._verifyIntegers(s),this._core.registerMarker(s)}registerDecoration(s){var o,r,m;return this._checkProposedApi(),this._verifyPositiveIntegers((o=s.x)!==null&&o!==void 0?o:0,(r=s.width)!==null&&r!==void 0?r:0,(m=s.height)!==null&&m!==void 0?m:0),this._core.registerDecoration(s)}hasSelection(){return this._core.hasSelection()}select(s,o,r){this._verifyIntegers(s,o,r),this._core.select(s,o,r)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(s,o){this._verifyIntegers(s,o),this._core.selectLines(s,o)}dispose(){super.dispose()}scrollLines(s){this._verifyIntegers(s),this._core.scrollLines(s)}scrollPages(s){this._verifyIntegers(s),this._core.scrollPages(s)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(s){this._verifyIntegers(s),this._core.scrollToLine(s)}clear(){this._core.clear()}write(s,o){this._core.write(s,o)}writeln(s,o){this._core.write(s),this._core.write(`\r
`,o)}paste(s){this._core.paste(s)}refresh(s,o){this._verifyIntegers(s,o),this._core.refresh(s,o)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(s){this._addonManager.loadAddon(this,s)}static get strings(){return n}_verifyIntegers(...s){for(const o of s)if(o===1/0||isNaN(o)||o%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...s){for(const o of s)if(o&&(o===1/0||isNaN(o)||o%1!=0||o<0))throw new Error("This API only accepts positive integers")}}C.Terminal=u})(),E})())})(Ga);var Ji={},Ya={get exports(){return Ji},set exports(e){Ji=e}};(function(e,c){(function(v,b){e.exports=b()})(self,()=>(()=>{var v={};return(()=>{var b=v;Object.defineProperty(b,"__esModule",{value:!0}),b.FitAddon=void 0,b.FitAddon=class{activate(x){this._terminal=x}dispose(){}fit(){const x=this.proposeDimensions();if(!x||!this._terminal||isNaN(x.cols)||isNaN(x.rows))return;const E=this._terminal._core;this._terminal.rows===x.rows&&this._terminal.cols===x.cols||(E._renderService.clear(),this._terminal.resize(x.cols,x.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const x=this._terminal._core,E=x._renderService.dimensions;if(E.css.cell.width===0||E.css.cell.height===0)return;const C=this._terminal.options.scrollback===0?0:x.viewport.scrollBarWidth,n=window.getComputedStyle(this._terminal.element.parentElement),i=parseInt(n.getPropertyValue("height")),l=Math.max(0,parseInt(n.getPropertyValue("width"))),p=window.getComputedStyle(this._terminal.element),a=i-(parseInt(p.getPropertyValue("padding-top"))+parseInt(p.getPropertyValue("padding-bottom"))),h=l-(parseInt(p.getPropertyValue("padding-right"))+parseInt(p.getPropertyValue("padding-left")))-C;return{cols:Math.max(2,Math.floor(h/E.css.cell.width)),rows:Math.max(1,Math.floor(a/E.css.cell.height))}}}})(),v})())})(Ya);const En="10.0.24223.355",Os={RESET:"\x1B[0m",BLACK:"\x1B[30m",RED:"\x1B[31m",GREEN:"\x1B[32m",LIGHT_YELLOW:"\x1B[93m",YELLOW:"\x1B[33m",YELLOW_BACKGROUND:"\x1B[43m",BLUE:"\x1B[34m",PURPLE:"\x1B[35m",CYAN:"\x1B[36m",WHITE:"\x1B[37m",BOLD:"\x1B[1m",UNBOLD:"\x1B[21m",UNDERLINE:"\x1B[4m",STOP_UNDERLINE:"\x1B[24m",BLINK:"\x1B[5m"};function Ja(e){const c=v=>{const b=nt.getState("USER_HOME").USER_HOME;let x=b,E="",C=0,n="",i=navigator.clipboard,l="",p=0,a=[],h=0;function f(y){x=y.replace(/\\+/g,"/"),E=x+">",C=E.length}f(b),G(e)&&f(e),me.readFile(b+"/.cmdHistory",(y,T)=>{!y&&G(T)&&T.text().then(A=>{try{a=JSON.parse(A),h=a.length-1}catch{}})});const d=new Yi.Terminal({cursorBlink:!0,cursorStyle:"underline",allowTransparency:!0,fontFamily:"Consolas"}),u=new Ji.FitAddon;d.loadAddon(u);let t;t=_("div",{className:"w-full h-full",onmousedown:w}),d.open(t);const s={cls:"Clears the screen.",dir:"Displays a list of files and subdirectories in a directory.",cd:"Displays the name of or changes the current directory.",mkdir:"Creates a directory.",rm:"Removes a directory.",print:"Prints a text file.",help:"Provides Help information for Windows commands.",exit:"Quits"};function o(){Object.keys(s).forEach(y=>{d.write(`\r
`+y+"	"+s[y])}),d.write(`\r
`),g()}const r=`[Version ${En}]`;function m(){return Os.GREEN+E+Os.WHITE}function g(){d.write(`\r
`+m())}r.split(`
`).map(y=>d.writeln(y)),g(),d.onKey(({key:y,domEvent:T})=>{const A=T.key;if(!/^(?!F[0-9]).*/g.test(A))return;const H=!T.altKey&&!T.ctrlKey&&!T.metaKey;if(T.ctrlKey){const P=A.toLowerCase();P==="l"?d.clear():P==="a"?d.selectAll():P==="c"?d.hasSelection()?k():(l="",g()):P==="v"&&D();return}if(A===Be.ArrowLeft)d.buffer.active.cursorX>C&&d.write("\x1B[1D");else if(A===Be.ArrowRight)d.buffer.active.cursorX<l.length+C&&d.write("\x1B[1C");else if(A===Be.ArrowUp)a.length>0&&(l=a[h],d.write("\x1B[2K\r"+m()+l),h>0&&(h-=1));else if(A===Be.ArrowDown)h+1<a.length&&(h+=1,l=a[h],d.write("\x1B[2K\r"+m()+l));else if(A===Be.BackSpace){if(d.buffer.active.cursorX>C)if(d.buffer.active.cursorX===C+l.length)l=l.slice(0,-1),d.write("\b \b");else{const P=l.slice(0,d.buffer.active.cursorX-C-1),F=l.slice(d.buffer.active.cursorX-C);l=P+F,p=C+l.length-d.buffer.active.cursorX+1,d.write("\x1B[2K\r"+m()+l+"\x1B["+p+"D")}}else if(A===Be.Delete){if(d.buffer.active.cursorX>=C&&d.buffer.active.cursorX<C+l.length){const P=E+l,F=P.slice(C,d.buffer.active.cursorX),L=P.slice(d.buffer.active.cursorX+1,P.length);l=F+L,p=C+l.length-d.buffer.active.cursorX,d.write("\x1B[2K\r"+m()+l+(L.length>0?"\x1B["+p+"D":""))}}else if(A===Be.Home)d.buffer.active.cursorX>C&&(p=d.buffer.active.cursorX-C,d.write("\x1B["+p+"D"));else if(A===Be.End){const P=E+l;d.buffer.active.cursorX<P.length&&(p=P.length-d.buffer.active.cursorX,d.write("\x1B["+p+"C"))}else{if(A===Be.Insert)return;if(A===Be.Enter)l.replace(/^\s+|\s+$/g,"").length!=0?M(l):g(),l="";else{if(A===Be.Tab)return;if(H){if(d.buffer.active.cursorX===C+l.length)l+=y,d.write(y);else if(d.buffer.active.cursorX<C+l.length){const P=E+l,F=P.slice(C,d.buffer.active.cursorX),L=P.slice(d.buffer.active.cursorX,P.length);l=F+y+L,p=C+l.length-d.buffer.active.cursorX-1,d.write("\x1B[2K\r"+m()+l+(L.length>0?"\x1B["+p+"D":""))}}}}});function k(){n=d.getSelection(),i.writeText(n)}function D(){i.readText().then(y=>{if(d.buffer.active.cursorX===C+l.length)d.write(y),l=l+y;else if(d.buffer.active.cursorX<C+l.length){const T=E+l,A=T.slice(C,d.buffer.active.cursorX),H=T.slice(d.buffer.active.cursorX,T.length);l=A+y+H,p=C+l.length-d.buffer.active.cursorX,d.write("\x1B[2K\r"+m()+l+(H.length>0?"\x1B["+p+"D":""))}})}function w(y){y.button===2&&(d.hasSelection()?(k(),d.clearSelection()):D())}function S(y){const T=y.replace(/\\+/g,"/").replace(/\/+/g,"/").split("/").filter(H=>H!=="");let A=x.split("/").filter(H=>H!=="");for(let H of T)H==="~"?A=b.split("/").filter(P=>P!==""):H===".."?A.length-1>0&&A.splice(A.length-1,1):A.push(H);return A.join("/")}function M(y){u.fit(),h=a.push(y)-1,me.writeFile(b+"/.cmdHistory",new Blob([JSON.stringify(a)]));let T=[];if(y.indexOf('"')>-1?T=y.split('"'):y.indexOf("'")>-1?T=y.split("'"):T=y.split(" "),T=T.filter(P=>P!==""),!T.length)return;const A=T[0].replace(/\s+/g,"");let H=T[1];if(G(s[A])){if(A==="dir"){let P=function(){d.write(`\r
The system cannot find the path specified.
`),g()},F=function(L){me.readFolder(L,(B,O)=>{if(B)I(B);else{d.write(`\r
Directory of `+L+`
`);const N=O.some(j=>j.type!=="folder"),z=O.some(j=>j.type==="folder"),W=O.every(j=>j.type!=="folder"),U=O.every(j=>j.type==="folder");O.forEach(j=>{const Y=new Date(j.mdate);d.write(`\r
`+Ui(Y)+"  "+It(Y)+"	"+(N&&z?(j.type==="folder"?"<DIR> 	 	":" 	")+(ji(j.size)?j.size.toPrecision()+"	":""):(U&&j.type==="folder"?"<DIR>	":"")+(W&&ji(j.size)?j.size.toPrecision()+"		":""))+j.name)}),d.write(`\r
`),g()}})};if(H||(H=x),Xe(H)||St(H))F(H);else if(Kt(H)){const L=S(H);F(L)}else P()}else if(A==="exit")g(),setTimeout(()=>{v.close()},200);else if(A==="cls")d.clear(),l="",d.write("\x1B[2K\r"+m());else if(A==="help")o();else if(A==="cd"){let P=function(){d.write(`\r
The system cannot find the path specified.
`),g()};if(!H)P();else if(Xe(H)||St(H))me.stats(H,F=>{F?(d.write(`\r
`+F.message),P()):(f(H),g())});else if(Kt(H)){const F=S(H);me.stats(F,L=>{L?P():(f(F),g())})}else P()}else if(A==="mkdir"){let P=function(F){F?d.write(`\r
`+F+`
`):d.write(`\r
The system cannot find the path specified.
`),g()};if(!H)P();else if(Xe(H))me.createFolder(H,F=>{F?P(F.message):g()});else if(Kt(H)){const F=S(H);me.createFolder(F,L=>{L?P(L.message):g()})}else St(H)?(d.write(`\r
Folder already exisist!`),g()):P()}else if(A==="rm"){let P=function(F){F?d.write(`\r
`+F+`
`):d.write(`\r
The system cannot find the path specified.
`),g()};if(!H)P();else{let F=function(L,B,O=0){const N=B[O];if(!G(N)){g();return}me.unlink(L+"/"+N.name,z=>{z?(P(z.message),g()):F(L,B,O+1)})};if(H=H.trim(),H==="*")me.readFolder(x,(L,B)=>{L?(P(L.message),g()):F(x,B),g()});else if(Xe(H)){const L=H.replace(/\\+/g,"/").replace(/\/+/g,"/");if(x.indexOf(L)>-1){P("Can not execute this action!");return}me.unlink(L,B=>{B?P(B.message):g()})}else if(Kt(H)){const L=S(H);if(x.indexOf(L)>-1){P("Can not execute this action!");return}me.unlink(L,B=>{B?P(B.message):g()})}else P()}}else if(A==="print"){let P=function(L){L?d.write(`\r
`+L+`
`):d.write(`\r
The system cannot find the path specified.
`),g()},F=function(L){if(x.indexOf(L)>-1){P("Can not execute this action!");return}me.readFile(L,(B,O)=>{B?P(B.message):G(O)?O.size>1e4?(d.write(`\r
Name: `+(O.name||rt(L))+" Size: "+O.size),g()):O.text().then(N=>{const z=N.split(`
`);for(let W of z)d.write(`\r
`+W);d.write(`\r
`),g()}):P()})};if(!H)P();else if(Xe(H)){const L=H.replace(/\\+/g,"/").replace(/\/+/g,"/");F(L)}else if(Kt(H)){const L=S(H);F(L)}else P()}}else G(Ci[A])?(g(),Ci[A](H)):(d.write(`\r
"`+A+`" is not recognized as an internal or external command, operable program or batch file.
`),d.write(`\r
Type "help" for available commands
`),g())}function I(y){d.write(`\r
`+y.message+`
`),g()}return v.addEventListener("focus",()=>{d.focus()}),v.addEventListener("close",()=>{d.dispose()}),v.addEventListener("passiveResize",Yo(()=>{u.fit()},200)),v.addEventListener("ready",()=>{u.fit()}),t};lt({icon:Q.cmd.icon,name:Q.cmd.name,title:Q.cmd.productName,top:100,left:100,width:800,height:450,center:!0,content:c,className:"cmd-app",extendContextMenu:[{divider:!0},{text:"Properties"}]})}function Za(e){lt({args:e,icon:yt.mediaPlayer.icon,hideIcon:!0,name:yt.mediaPlayer.name,title:yt.mediaPlayer.productName,autoHideTitleBar:!0,top:50,left:50,width:800,height:480,minWidth:300,minHeight:100,center:!0,singleInstance:!0,content:c=>{let v;function b(x){const E=gt(x);if(Di(E)){const C=_("div",{className:"w-full h-full relative"},[_("video",{className:"w-full h-full",controls:!0,autoplay:!0,style:{objectFit:"contain"},mySrc:x})]);return c.setSize({width:800,height:480}),c.setTitle(rt(x)),C}if(Fo(E)){const C=_("div",{className:"w-full h-full relative p-20"},[_("audio",{className:"w-full h-full",controls:!0,autoplay:!0,mySrc:x})]);return c.setSize({width:800,height:124}),c.setTitle(rt(x)),C}return _("div",{},"Not supported file")}return c.addEventListener("secondInstance",x=>{v=b(x),c.setContent(v),c.isVisible()||c.show(),c.focus()}),c.addEventListener("ready",()=>{v=b(e),c.setContent(v)}),null}})}function Qa(e){if(!G(e)){Fe("photos");return}lt({args:e,icon:yt.photoViewer.icon,hideIcon:!0,name:yt.photoViewer.name,title:yt.photoViewer.productName,hideTitle:!0,top:50,left:50,width:800,height:480,minWidth:580,minHeight:200,center:!0,singleInstance:!0,titlebarHeight:40,stretchTitlebarContent:!0,transprencyContent:!0,content:c=>{let v,b,x,E,C,n,i,l,p=0,a=0,h=0,f=0,d=0,u=0,t=0,s=0,o,r=0,m=0,g=0,k=0;b=_("div",{className:"photo-viewer-titlebar-content w-full h-full flex items-center"},[_("div",{className:"flex items-center flex-1 h-full"},[_("div",{className:"photo-viewer-titlebar-home flex items-center content-center flex-shrink-0",style:{width:"40px",height:"40px"},innerHTML:Js(20),onclick(){Fe("photos")}}),_("div",{["drag-region"]:"drag",className:"w-full h-full flex items-center",style:{padding:"0 10px"}},x=_("div",{className:"text-ellipsis line-clamp-1"}))]),_("div",{className:"flex items-center content-center h-full"},[_("div",{title:"Edit Image",className:"photo-viewer-titlebar-content-button",innerHTML:Pr()}),_("div",{title:"Rotate",className:"photo-viewer-titlebar-content-button",innerHTML:gr}),_("div",{title:"Delete",className:"photo-viewer-titlebar-content-button",innerHTML:Ur()}),_("div",{title:"Add to favorites",className:"photo-viewer-titlebar-content-button",innerHTML:jr()}),_("div",{title:"Print",className:"photo-viewer-titlebar-content-button",innerHTML:Vr()}),_("div",{title:"Share",className:"photo-viewer-titlebar-content-button",innerHTML:Kr()}),_("div",{title:"More options",className:"photo-viewer-titlebar-content-button",innerHTML:Ys(),onclick(W){const U=W.currentTarget,j=U.getBoundingClientRect();Ut({top:j.top+j.height,left:j.left},U,[{text:"Set as desktop wallpaper",onClick(){Xe(l)?ls(l,(R,$)=>{R||Y(URL.createObjectURL($))}):Y(l);function Y(R){rs(R,($,q)=>{const X=rt(l),V=nt.getState("USER_HOME").USER_HOME+"/AppData/Microsoft/Windows/Desktop/Background/"+"Thumbnails/"+X;me.writeFile(V,q,()=>{$e.setBackgroundImage({name:X,path:l,thumbnailPath:V})})})}c.focus()}},{text:"Resize image",onClick(){c.focus()}},{text:"Copy as path",onClick(){c.focus()}},{text:"Settings",onClick(){c.focus()}}],!1)}})]),_("div",{["drag-region"]:"drag",className:"flex items-center flex-1 h-full"})]),c.titlebar.setTitlebarContent(b),v=_("div",{className:"w-full h-full",style:{position:"relative",paddingBottom:"40px"}},[C=_("div",{className:"w-full h-full flex items-center content-center",style:{position:"relative",overflow:"hidden"},onwheel:I},E=_("div",{className:"photo-viewer-container w-full h-full",onmousedown:w})),_("div",{className:"photo-viewer-bottom flex items-center"},[_("div",{}),_("div",{className:"flex items-center",style:{marginLeft:"auto"}},[n=_("div",{style:{paddingRight:"10px"}}),_("div",{title:"Zoom out",className:"photo-viewer-bottom-button",innerHTML:Fr(18),onclick:()=>{F(-1)}}),_("div",{title:"Zoom in",className:"photo-viewer-bottom-button",innerHTML:Or(18),onclick:()=>{F(1)}}),_("div",{title:"Zoom to fit",className:"photo-viewer-bottom-button",innerHTML:zr(18),onclick:H}),_("div",{title:"Zoom to actual size",className:"photo-viewer-bottom-button",innerHTML:Wr(18),onclick:P}),_("div",{title:"Fullscreen",className:"photo-viewer-bottom-button",innerHTML:$r(14),onclick:()=>{c.toggleFullscreen()}})])])]);function D(W){const U=gt(W);if(!Ti(U)){E.textContent="Not supported file";return}Oo(W,Y=>{G(Y)&&(l=W,E.textContent="",E.style.myBackgroundImage=W,o=Y,T(),(o.width>i.width||o.height>i.height)&&H(),o.width<i.width&&o.height<i.height&&A())});const j=rt(W);c.setTitle(j),x.textContent=j}function w(W){W.button===0&&(W.preventDefault(),g=W.clientX,k=W.clientY,document.onmouseup=M,document.onmousemove=S)}function S(W){r=g-W.clientX,m=k-W.clientY,g=W.clientX,k=W.clientY;const U=E.offsetTop-m,j=E.offsetLeft-r;h>i.width&&(j>0?a=0:j+h<i.width?a=i.width-h:a=j,E.style.left=a+"px"),f>i.height&&(U>0?p=0:U+f<i.height?p=i.height-f:p=U,E.style.top=p+"px")}function M(){document.onmouseup=null,document.onmousemove=null}function I(W){let U=W.deltaY>0?-1:1;t=W.offsetX,s=W.offsetY,F(U)}function y(){i={width:C.offsetWidth,height:C.offsetHeight}}function T(){if(O())u=100;else{const W=i.width/i.height;let U=0;W<o.ratio?U=i.width:U=i.height*o.ratio,u=U/o.width*100}}function A(){p=(i.height-o.height)/2,a=(i.width-o.width)/2,h=o.width,f=o.height,u=100,d=100,ge(E,{top:p+"px",left:a+"px",width:h+"px",height:f+"px"}),B()}function H(){y();const W=i.width/i.height,U={};if(W<o.ratio){const j=i.width/o.ratio;p=(i.height-j)/2,a=0,h=i.width,f=j}else{const j=i.height*o.ratio,Y=(i.width-j)/2;p=0,a=Y,h=j,f=i.height}d=h/o.width*100,h<i.width&&f<i.height?u=100:u=d,U.top=p+"px",U.left=a+"px",U.width=h+"px",U.height=f+"px",B(),ge(E,U)}function P(){L(100)}function F(W){h<i.width&&(t=h/2),f<i.height&&(s=f/2);let U=h+h*.1*W;(h<o.width&&o.width<U||h>o.width&&o.width>U)&&(U=o.width);let j=t/h,Y=s/f,R=U/o.width*100;R<u&&(R=u,U=R*o.width/100),R>5e3&&(R=5e3,U=R*o.width/100),d=R,h=U,f=h/o.ratio;let $=j*h-t,q=Y*f-s;a-=$,p-=q,W===-1&&(h>i.width?(a>0&&(a=0),a+h<i.width&&(a=i.width-h)):a=(i.width-h)/2,f>i.height?(p>0&&(p=0),p+f<i.height&&(p=i.height-f)):p=(i.height-f)/2),h<i.width&&f<i.height&&(p=(i.height-f)/2,a=(i.width-h)/2),ge(E,{width:h+"px",height:f+"px",top:p+"px",left:a+"px"}),B()}function L(W){const U=W*o.width/100,j=U/o.ratio,Y=.5*U-h/2,R=.5*j-f/2;d=W,p-=R,a-=Y,h=U,f=j,ge(E,{top:p+"px",left:a+"px",width:h+"px",height:f+"px"}),B()}function B(){n.textContent=Math.round(d)+" %"}function O(){return y(),o.width<i.width&&o.height<i.height}function N(){d===u?O()?A():H():d>u&&(T(),a>0&&(a=0,E.style.left=a+"px"),h+a<i.width&&(a=(i.width-h)/2,E.style.left=a+"px"),p>0&&(p=0,E.style.top=p+"px"),f+p<i.height&&(p=(i.height-f)/2,E.style.top=p+"px"))}function z(){setTimeout(()=>{N()},250)}return c.addEventListener("resize",Ge(()=>{N()},50)),c.addEventListener("maximize",()=>{z()}),c.addEventListener("unmaximize",()=>{z()}),c.addEventListener("snap",()=>{z()}),c.addEventListener("unSnap",()=>{z()}),c.addEventListener("restore",()=>{z()}),c.addEventListener("fullscreen",()=>{z()}),c.addEventListener("secondInstance",W=>{c.isVisible()||c.show(),c.focus(),D(W)}),c.addEventListener("ready",()=>{c.setContent(v),D(e)}),null}})}const Ci={settings:qa,explorer:ma,notepad:ga,word:()=>{qe(Q.word)},powerpoint:()=>{qe(Q.powerpoint)},onenote:()=>{qe(Q.onenote)},mail:()=>{qe(Q.mail)},todo:()=>{qe(Q.todo)},store:()=>{qe(Q.store)},photos:Ta,photoViewer:Qa,mediaPlayer:Za,yourphone:()=>{qe(Q.yourphone)},whiteboard:()=>{qe(Q.whiteboard)},calculator:Xa,spotify:()=>{qe(Q.spotify)},twitter:()=>{qe(Q.twitter)},vscode:()=>{qe(Q.vscode)},terminal:()=>{qe(Q.terminal)},cmd:Ja,github:()=>{qe(Q.github)},discord:()=>{qe(Q.discord)}};String.prototype.toFirstUpperCase=function(){return this.charAt(0).toUpperCase()+this.substring(1,this.length)};const el=localStorage.getItem("OS_VERSION");G(el)||(Se.reset(),localStorage.setItem("OS_VERSION",En));Xo&&document.documentElement.classList.add("isWebkit");document.documentElement.style.setProperty("--taskbar-height",We.toString()+"px");document.addEventListener("dragover",e=>{e.preventDefault()});document.addEventListener("drop",e=>{e.preventDefault()});document.addEventListener("contextmenu",e=>{e.preventDefault()});const Ye=Se.getState();Ye.recentImages||(Ye.recentImages=[Ue[15],Ue[9],Ue[21],Ue[0],Ue[8]]);let ki=Ye.themeIndex>-1?Ye.themes[Ye.themeIndex]:Ye.customTheme;G(ki)||(ki=Ye.themes[0],Se.setState({themeIndex:0}));G(Ye.brightness)&&ni.setBrightness(Ye.brightness);Ye.nightlight&&ni.setNightLight(Ye.nightlight);Ki(Ye.roundedCorner);hn(Ye.useBorder);fn(ki);un(ki.background.thumbnailPath);function vi(e,c){const v=Ci[e];G(v)?Ci[e](c):qo()}function tl(e){if(e.type==="link")window.open(e.args,"_blank");else if(e.type==="app")vi(e.name,e.args);else if(e.type==="file"){const c=Wt(Go(e.args));vi(c.appName,e.args)}else e.type==="folder"&&vi(Q.explorer.name,e.args)}Ne(oe.createWindow,"index",({appName:e,args:c})=>{vi(e,c)});Ne(oe.startProcess,"index",e=>{tl(e)});Ne(oe.backgroundImageChange,"index",e=>{un(e.thumbnailPath)});me.addEventListener("ready","index",()=>{me.addEventListener("removed","index",e=>{ri.removeThumbnail(e)})});

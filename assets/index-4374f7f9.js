var qn=Object.defineProperty;var Xn=(e,c,_)=>c in e?qn(e,c,{enumerable:!0,configurable:!0,writable:!0,value:_}):e[c]=_;var Mt=(e,c,_)=>(Xn(e,typeof c!="symbol"?c+"":c,_),_);(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const k of document.querySelectorAll('link[rel="modulepreload"]'))y(k);new MutationObserver(k=>{for(const L of k)if(L.type==="childList")for(const C of L.addedNodes)C.tagName==="LINK"&&C.rel==="modulepreload"&&y(C)}).observe(document,{childList:!0,subtree:!0});function _(k){const L={};return k.integrity&&(L.integrity=k.integrity),k.referrerpolicy&&(L.referrerPolicy=k.referrerpolicy),k.crossorigin==="use-credentials"?L.credentials="include":k.crossorigin==="anonymous"?L.credentials="omit":L.credentials="same-origin",L}function y(k){if(k.ep)return;k.ep=!0;const L=_(k);fetch(k.href,L)}})();const Gn="imgs/icons/Apps/";function Me(e){return Gn+e}const se={settings:{name:"settings",productName:"Settings",icon:Me("settings.png")},notepad:{name:"notepad",productName:"NotePad",icon:Me("notepad.png")},explorer:{name:"explorer",productName:"File Explorer",icon:Me("explorer.png")},word:{name:"word",productName:"Word",icon:Me("word.png")},powerpoint:{name:"powerpoint",productName:"PowerPoint",icon:Me("powerpoint.png")},onenote:{name:"onenote",productName:"OneNote",icon:Me("onenote.png")},mail:{name:"mail",productName:"Mail",icon:Me("mail.png")},todo:{name:"todo",productName:"To Do",icon:Me("todo.png")},store:{name:"store",productName:"Store",icon:Me("store.png")},photos:{name:"photos",productName:"Photos (Demo)",icon:Me("photos.png")},yourphone:{name:"yourphone",productName:"Your Phone",icon:Me("yourphone.png")},whiteboard:{name:"whiteboard",productName:"White Board",icon:Me("whiteboard.png")},calculator:{name:"calculator",productName:"Calculator",icon:Me("calculator.png")},spotify:{name:"spotify",productName:"Spotify",icon:Me("spotify.png")},twitter:{name:"twitter",productName:"Twitter",icon:Me("twitter.png")},vscode:{name:"vscode",productName:"VS Code",icon:Me("vscode.png")},terminal:{name:"terminal",productName:"Terminal",icon:Me("terminal.png")},cmd:{name:"cmd",productName:"Command Promt",icon:Me("terminal.png")},github:{name:"github",productName:"GitHub",icon:Me("github.png")},discord:{name:"discord",productName:"Discord",icon:Me("discord.png")}},Yn=Object.keys(se).map(e=>se[e]);function Jn(e,c){return e.name>c.name?1:e.name<c.name?-1:0}function Zn(){const e=Yn.sort(Jn),c={},_=e.length;for(let y=0;y<_;y++){const k=e[y];let L=k.name.substring(0,1).toUpperCase();/[A-Z]/.test(L)||(/[0-9]/.test(L)?L="#":L="&"),c[L]||(c[L]=[]),c[L].push(k)}return c}const At={photoViewer:{name:"photoViewer",productName:"Photos Viewer",icon:Me("photos.png")},mediaPlayer:{name:"mediaPlayer",productName:"Media Player",icon:Me("media-player.png")}},$e=[];for(let e=0;e<6;e++){const c="IMG"+e+".jpg";$e.push({name:c,path:"imgs/Wallpapers/"+c,thumbnailPath:"imgs/Wallpapers/Thumbnails/"+c})}const Bt={useTitleBarAccentColor:!1,useTaskbarAndStartMenuAccentColor:!1,useWindowBorderAccentColor:!1},Qn={name:"Default Light",background:$e[0],accentColor:{h:200,s:100,l:50},dark:!1,transparency:!0,backgroundImageStyle:"Fill",...Bt},er={name:"Default Dark",background:$e[1],backgroundImageStyle:"Fill",accentColor:{h:200,s:100,l:50},dark:!0,transparency:!0,...Bt},tr=[{name:"Spring",background:$e[2],backgroundImageStyle:"Fill",accentColor:{h:120,s:100,l:40},dark:!1,transparency:!0,...Bt},{name:"Summer",background:$e[3],backgroundImageStyle:"Fill",accentColor:{h:48,s:100,l:49},dark:!1,transparency:!0,...Bt},{name:"Autumn",background:$e[4],backgroundImageStyle:"Fill",accentColor:{h:356,s:98,l:69},dark:!1,transparency:!0,...Bt},{name:"Winter",background:$e[5],backgroundImageStyle:"Fill",accentColor:{h:215,s:50,l:40},dark:!0,transparency:!1,...Bt}],ir=[Qn,er].concat(tr),Bs={showDesktopIcons:!0,volume:100,brightness:100,nightlight:!1,themes:ir,themeIndex:0,recentImages:[$e[0],$e[2],$e[3],$e[4],$e[5]],roundedCorner:!0,useBorder:!1},ve=Vi("preferences",Bs);function Vi(e,c={}){let _={};try{const C=localStorage.getItem(e);C?_=Ps(JSON.parse(C),c):_=c}catch{}function y(C){if(typeof C=="string")return{[C]:_[C]};if(C instanceof Array){const i={};for(let n=0;n<C.length;n++){const l=C[n];i[l]=_[l]}return i}return _}function k(C){_={..._,...C},localStorage.setItem(e,JSON.stringify(_))}function L(){_=Bs,localStorage.setItem(e,JSON.stringify(_))}return{getState:y,setState:k,reset:L}}const st=Vi("env",{USER_NAME:"User 1",USER_HOME:"c:/Users/User 1",VERSION:"10.0.23711.1466"}),lt="imgs/icons/",Ie={thisPC:lt+"Computer.png",driverC:lt+"Drives/Hardrive%20Windows.png",user:lt+"User.png",desktop:lt+"Desktop.png",document:lt+"Folder%20Documents.png",download:lt+"Folder%20Downloads.png",pictures:lt+"Folder%20Pictures.png",music:lt+"Folder%20Music.png",videos:lt+"Folder%20Videos.png"},ot="imgs/icons/Folder.png",ds=new Date(2023,0,1).getTime(),It={type:"mediumIcons",sortBy:"text",orderBy:"asc"};function Le(e){const c={...e,name:e.name,type:e.type||"folder",children:e.children||[],cdate:ds,mdate:ds};return G(e.text)&&(c.text=e.text),G(e.type)&&(e.type==="file"||e.type==="shortcut")&&(c.size=0),G(e.icon)&&(c.icon=e.icon),c}const{USER_NAME:sr,USER_HOME:zt}=st.getState(["USER_NAME","USER_HOME"]),Rs=Le({name:"c:",text:"Local Disk C",icon:"imgs/icons/Drives/Hardrive%20Windows.png",children:[Le({name:"windows",children:[Le({name:"system32",children:[Le({name:"cmd.exe",type:"file"})]})]}),Le({name:"Code",children:[Le({name:"App1"}),Le({name:"App2"}),Le({name:"App3"}),Le({name:"App4"})],view:{type:"mediumIcons",sortBy:"text",orderBy:"asc"}}),Le({name:"Users",children:[Le({name:sr,icon:Ie.user,children:[Le({name:"Desktop",icon:Ie.desktop}),Le({name:"Documents",icon:Ie.document,children:[Le({name:"Google"}),Le({name:"Microsoft"})]}),Le({name:"Downloads",icon:Ie.download}),Le({name:"Pictures",icon:Ie.pictures,children:[Le({name:"Natures",view:It}),Le({name:"Screenshots",view:It}),Le({name:"Art",view:It}),Le({name:"Abstract",view:It}),Le({name:"Wallpapers",view:It})],view:It}),Le({name:"Music",icon:Ie.music}),Le({name:"Videos",icon:Ie.videos})]})]})]});function nr(e){const c=e.transaction("tree","readwrite").objectStore("tree");let _=[];function y(k,L="",C=0){const i=k[C];let n=L===""?i.name:L+"/"+i.name;if(i.type==="folder"){const l={...i},m=i.children.map(s=>{const h={...s};return delete h.children,h});l.children=m,_.push({location:n,data:l})}i.children.length&&y(i.children,n),C<k.length-1&&y(k,L,C+1)}y([Rs]),console.log(_);for(let k of _)c.put(k.data,k.location)}window.createDefaultFolderTree=nr;function rr(){let e,c,_,y={};const k=indexedDB.open("Local Disk C");let L=Rs,C,i,n=!1,l=!1,m=0,s=0;k.onupgradeneeded=function(){e=k.result,e.createObjectStore("tree").put(L,"c"),e.createObjectStore("files",{autoIncrement:!0});const B=indexedDB.open("Local Disk C");B.onsuccess=()=>{e=B.result;for(let S=1;S<=5;S++)fetch(`imgs/Pictures/IMG ${S}.jpg`).then(M=>M.blob()).then(M=>{o(`${zt}/Pictures/Wallpapers/IMG ${S}.jpg`,M)});fetch("videos/VID 1.mp4").then(S=>S.blob()).then(S=>{o(`${zt}/Videos/VID 1.mp4`,S),o(`${zt}/Desktop/VID 1.mp4`,S)}),fetch("videos/VID 2.mp4").then(S=>S.blob()).then(S=>{o(`${zt}/Videos/VID 2.mp4`,S),o(`${zt}/Desktop/VID 2.mp4`,S)}),setTimeout(()=>{w("ready",e)},1e3)}},k.onsuccess=function(){e=k.result,window.db=e,h(),f();const B=c.get("c");B.onsuccess=function(){B.result&&(L=B.result)},w("ready",e)},k.onerror=function(B){w("error",B)};function h(){c=e.transaction("tree","readwrite").objectStore("tree")}function f(){_=e.transaction("files","readwrite").objectStore("files")}function d(B,S,M){const P=B.replace(/\\+/g,"/");h(),f();const H=P.split("/").filter(O=>O!=="");if(H.length===1){M(new Error("Invalid Path"));return}const N=Date.now(),F=H.length-1;let b=1,D=L;R();function R(){let O=D.children.findIndex(W=>W.name===H[b]),z;if(O===-1){const W=D.children.push({name:H[b],type:S.type,children:[],cdate:N,mdate:N})-1;if(z=D.children[W],b<F&&(z.type="folder"),b===F){c.put(L,"c"),S.type==="file"||S.type==="shortcut"?(z.type,S.type,delete z.children,_.put(null,P)):z.type,M(),w("added",P);return}else D=z,b+=1,R()}else if(z=D.children[O],b===F){M(new Error(S.type+" already exists"));return}else z.type==="folder"&&!G(z.children)&&(z.children=[]),D=z,b+=1,R()}}function u(B,S){d(B,{type:"folder"},S)}function t(B,S){const M=B.replace(/\\+/g,"/");h();const P=c.get("c");P.onsuccess=()=>{let H=P.result;const N=M.split("/").filter(F=>F!=="");if(N.length===0)S(new Error("Invalid path"));else if(N.length===1){if(_t(N[0])){const F=H.children.map(b=>(delete b.children,b));S(null,F);return}S(new Error("Invalid path"))}else{N.shift();let F;for(let D of N){const R=H.children.findIndex(O=>O.name===D);if(R>-1)H=H.children[R];else{F=new Error("Path is no longer exists");break}}if(H.type!=="folder"&&(F=new Error("Path is no longer exists")),F){S(F);return}const b=H.children.map(D=>(delete D.children,D));S(null,b)}}}function a(B,S){const M=B.replace(/\\+/g,"/"),P=indexedDB.open("Local Disk C");P.onsuccess=()=>{e=P.result,_=e.transaction("files","readwrite").objectStore("files");const H=M.replace(/\/+/g,"/"),N=_.get(H);N.onsuccess=()=>{S(null,N.result)},N.onerror=()=>{S(new Error("Unknow error"))}},P.onerror=()=>{S(new Error("Unknow error"))}}function o(B,S,M){const P=B.replace(/\\+/g,"/"),H=P.split("/").filter(z=>z!=="");if(H.length===1){Se(M)&&M(new Error("Invalid Path"));return}const N=H.length-1;let F=1,b=L;const D=Date.now();R();function R(){let z=b.children.findIndex(j=>j.name===H[F]),W;if(z===-1){const j=b.children.push({name:H[F],type:"folder",children:[],cdate:D,mdate:D})-1;if(W=b.children[j],F===N){W.type="file",delete W.children,W.size=S.size,f();const X=new File([S],nt(P)),ie=_.put(X,P);ie.onsuccess=()=>{Se(M)&&M(),O(),w("added",P)},ie.onerror=()=>{M(ie.error)};return}else b=W,F+=1,R()}else if(W=b.children[z],F===N){delete W.children,W.type="file",W.size=S.size,W.mdate=Date.now(),f();const j=_.put(S,P);j.onsuccess=()=>{Se(M)&&M(),O(),w("modified",P)},j.onerror=()=>{M(j.error)};return}else b=W,F+=1,R()}function O(){m+=1,n||(n=!0,h(),c.put(L,"c")),C&&clearTimeout(C),C=setTimeout(()=>{if(m>1){h();const z=c.put(L,"c");z.onerror=()=>{M(z.error)}}m=0,n=!1},200)}}function r(B,S){const M=B.replace(/\\+/g,"/");h();const P=c.get("c");P.onsuccess=()=>{let H=P.result,N;const F=M.split("/").filter(D=>D!=="");if(F.length===0){S(new Error("Invalid path",{cause:1}));return}if(F.length===1){const D=F[0],R=D.split(":")[0];_t(D)&&R==="c"?(delete H.children,S(null,H)):S(new Error("Invalid path",{cause:1}));return}F.shift();let b;for(let D of F){const R=H.children.findIndex(O=>O.name===D);if(R>-1)N=H.children[R],H=N;else{b=new Error("Path is no longer exists",{cause:2});break}}G(N)&&delete N.children,S(b,N)},P.onerror=()=>{S(new Error("Unknown error",{cause:0}))}}function p(B,S){const M=B.replace(/\\+/g,"/"),P=M.split("/").filter(D=>D!=="");if(P.length===1){S(new Error("Invalid Path"));return}const H=P.length-1;let N=1,F=L;b();function b(){const D=F.children.findIndex(O=>O.name===P[N]);if(D===-1){S(new Error("Item not exsist"));return}else if(N===H){const O=F.children[D];if(O.type==="file"||O.type==="shortcut"){F.children.splice(D,1),f();const z=_.delete(M);z.onsuccess=()=>{S(),R(),w("removed",M)},z.onerror=()=>S(z.error)}else O.type==="folder"?g(M,(z,W)=>{if(G(z))S(z);else{const j=W.filter(A=>A.type==="file"),X=j.length;f();for(let A=0;A<X;A++)_.delete(j[A].location);const ie=F.children.findIndex(A=>A.name===O.name);ie>-1?(F.children.splice(ie,1),R(),S(),w("removed",M)):S(new Error("Invalid Path"))}}):S(new Error("Unknown error"))}else F=F.children[D],N+=1,b();function R(){s+=1,l||(l=!0,h(),c.put(L,"c")),i&&clearTimeout(i),i=setTimeout(()=>{if(s>1){h();const O=c.put(L,"c");O.onerror=()=>{S(O.error)}}s=0,l=!1},200)}}}function g(B,S,M=[]){t(B,(P,H)=>{if(P)return S(P,M);let N=0;(function F(){var b=H[N++];if(!b)return S(null,M);let D=B+"/"+b.name;b.location=D,M.push(b),b.type==="folder"?g(D,(R,O)=>{if(P)return S(P,M);M=M.concat(O),F()}):F()})()})}function E(B,S,M){const P=B.replace(/\\+/g,"/");h();const H=P.split("/").filter(R=>R!=="");if(H.length===1){_t(H[0])?(L.view=S,c.put(L,"c"),Se(M)&&M()):Se(M)&&M(new Error("InValid Path"));return}const N=H.length-1;let F=1,b=L;D();function D(){let R=b.children.findIndex(z=>z.name===H[F]),O;if(R>-1)if(O=b.children[R],F===N){O.view=S,c.put(L,"c"),Se(M)&&M();return}else b=O,F+=1,D()}}function T(B,S,M){y[B]||(y[B]=Object.create(null)),y[B][S]=M}function w(B,S){if(!(typeof y[B]>"u"))for(let M in y[B])y[B][M](S)}function x(B,S){delete y[B][S]}function I(){return L}return{addEventListener:T,removeListeners:x,createItem:d,createFolder:u,readFolder:t,readFolderRecursive:g,readFile:a,writeFile:o,unlink:p,stats:r,check:I,setView:E}}const ue=rr();window.fs=ue;function us(e,c){return Math.floor(Math.random()*(c-e+1)+e)}function xi(e=8){for(var c="",_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",y=0;y<e;y++)c+=_.charAt(Math.floor(Math.random()*_.length));return c}const or=/webkit/.test(navigator.userAgent.toLowerCase());function As(e){return e.lastIndexOf(".")>-1?e.substring(e.lastIndexOf("."),e.length):null}function fs(e,c){Ge(e)?ue.readFile(e,(_,y)=>{_||!G(y)?(console.log(_,y),c("")):y.text().then(k=>{c(k)})}):fetch(e).then(_=>_.text()).then(_=>c(_)).catch(()=>c(""))}function nt(e){return e.substring(e.lastIndexOf("/")+1,e.length)}function vt(e){const c=e.lastIndexOf(".");return c>-1?e.substring(c,e.length):""}function Ki(e,c){const _=indexedDB.open("Local Disk C");_.onsuccess=()=>{const L=_.result.transaction("files","readwrite").objectStore("files").get(e);L.onsuccess=()=>{G(L.result)?c(null,L.result):c(new Error("Item has removed!"))},L.onerror=()=>{c(new Error("Invalid path"))}},_.onerror=()=>{c(new Error("Can not access"))}}function Ns(e,c){let _;return function y(){const k=y,L=arguments;clearTimeout(_),_=setTimeout(()=>e.apply(k,L),c)}}function ar(e,c=100){let _,y;return function k(){const L=k,C=arguments;y?(clearTimeout(_),_=setTimeout(function(){Date.now()-y>=c&&(e.apply(L,C),y=Date.now())},c-(Date.now()-y))):(e.apply(L,C),y=Date.now())}}function jt(e,c=0){return Number(Math.round(parseFloat(e+"e"+c))+"e-"+c)}function Ps(e,c){if(typeof e=="object")for(let _ in c)typeof e[_]!=typeof c[_]?e[_]=c[_]:typeof e[_]=="object"&&Ps(e[_],c[_]);return e}function Vt(e){return e>=1099511627776?{value:jt(e/1099511627776,1),unit:"TB"}:e>=1073741824?{value:jt(e/1073741824,1),unit:"GB"}:e>=104857600?{value:jt(e/1048576,1),unit:"MB"}:e>=1024?{value:jt(e/1024).toLocaleString(),unit:"KB"}:e>0?{value:1,unit:"KB"}:{value:0,unit:"B"}}function it(e,c){typeof c>"u"||c===null||(c instanceof HTMLElement?e.appendChild(c):c instanceof Array?Ct(e,c):e.appendChild(document.createTextNode(c.toString())))}function Ct(e,c){c instanceof Array?c.forEach(_=>{it(e,_)}):it(e,c)}function de(e,c){for(let _ in c)_.indexOf("-")>-1?e.style.setProperty(_,c[_]):_==="myBackgroundImage"?Ri(c[_],y=>{e.style.backgroundImage=`url(${y})`}):e.style[_]=c[_]}function Hs(e){for(let c of e){if(c.children.length>0){const _=Array.from(c.children);Hs(_)}Se(c.onBeforeRemove)&&c.onBeforeRemove()}}Element.prototype.remove=function(){var _;const e=Array.from(this.children);Hs(e);const c=this;Se(c.onBeforeRemove)&&c.onBeforeRemove(),(_=this.parentElement)==null||_.removeChild(this)};function v(e,c,_){let y=document.createElement(e);function k(L){Ri(L,C=>{y.src=C})}if((e==="img"||e==="audio"||e==="video")&&Object.defineProperty(y,"mySrc",{set:function(L){k(L)}}),c){const L=c;for(let C in L)if(C==="style"){const i=L[C];de(y,i)}else if(C==="mySrc"){const i=L[C];k(i)}else if(C.indexOf("-")>-1||C.indexOf(":")>-1){const i=L[C];y.setAttribute(C,i)}else y[C]=L[C]}return _&&Ct(y,_),Object.defineProperty(y.style,"myBackgroundImage",{set:function(L){Ri(L,C=>{y.style.backgroundImage=`url(${C})`})}}),y}function ft(e){let c=e.firstChild;for(;c;)c.remove(),c=e.firstChild}function Ri(e,c){Ge(e)?Ki(e,(_,y)=>{if(_)c(null);else{const k=URL.createObjectURL(y);c(k)}}):c(e)}function lr(e){let c;const _=Object.create(null);_.width=0,e.color&&(_.backgroundColor=e.color);let y=v("div",{className:"progress"},c=v("div",{className:"progress-value",style:_}));function k(L){c.style.width=L/e.maxValue*100+"%"}return{element:y,setValue:k}}const Os=`
<svg aria-hidden="true" version="1.1" viewbox="0 0 10 10" width="10" height="10" class="svg-fill">
<path d="M 0,5 10,5 10,6 0,6 Z"></path>
</svg>
`,Ai=`
<svg aria-hidden="true" version="1.1" viewbox="0 0 10 10" width="10" height="10" class="svg-fill">
<path d="m 2,1e-5 0,2 -2,0 0,8 8,0 0,-2 2,0 0,-8 z m 1,1 6,0 0,6 -1,0 0,-5 -5,0 z m -2,2 6,0 0,6 -6,0 z"></path>
</svg>
`,Ni=`
<svg aria-hidden="true" version="1.1" viewbox="0 0 10 10" width="10" height="10" class="svg-fill">
<path d="M 0,0 0,10 10,10 10,0 Z M 1,1 9,1 9,9 1,9 Z"></path>
</svg>
`,Fs=`
<svg aria-hidden="true" version="1.1" viewbox="0 0 10 10" width="10" height="10" class="svg-fill">
<path d="M 0,0 0,0.7 4.3,5 0,9.3 0,10 0.7,10 5,5.7 9.3,10 10,10 10,9.3 5.7,5 10,0.7 10,0 9.3,0 5,4.3 0.7,0 Z"></path>
</svg>
`;function cr(e){const c={};e&&(c.backgroundImage=`url("${e}")`);let _=v("div",{className:"window-titlebar-icon flex content-center items-center flex-shrink-0",style:c});function y(k){G(k)&&(_.style.backgroundImage=`url("${k}")`)}return{element:_,setWindowIcon:y}}const hr={window:{titlebar:{buttons:{minimize:"Minimize",maximize:"Restore Down",maximizeDown:"Maximize",close:"Close"}}}},dr={window:{titlebar:{buttons:{minimize:"Thu gọn",maximize:"Thu nhỏ",maximizeDown:"Phóng to",close:"Đóng"}}}},ur={"en-us":hr,"vi-vn":dr};function fr(e){return ur[e]}function mr(e,c){const _=fr("en-us");let y=i(e.isMaximized),k=v("div",{title:y.title,className:"window-titlebar-button window-titlebar-maximize-button flex items-center content-center"+(e.disableMaximize?" disabled":""),innerHTML:y.icon,onclick:c.onMaximizeButtonClick}),L=v("div",{className:"window-titlebar-buttons flex"},[v("div",{title:_.window.titlebar.buttons.minimize,className:"window-titlebar-button window-titlebar-minimize-button flex items-center content-center",innerHTML:Os,onclick:c.onMinimizeButtonClick}),k,v("div",{title:_.window.titlebar.buttons.close,className:"window-titlebar-button window-titlebar-close-button flex items-center content-center",innerHTML:Fs,onclick:c.onCloseButtonClick})]);function C(n){let l=i(n);k.title=l.title,k.innerHTML=n?Ai:Ni}function i(n){return{title:n?_.window.titlebar.buttons.maximize:_.window.titlebar.buttons.maximizeDown,icon:n?Ai:Ni}}return{element:L,setMaximize:C}}function pr(e,c,_,y){let k,L,C=v("div",{tabIndex:-1,className:"window-title h-full flex items-center"+(e.stretchTitlebarContent?" stretch":""),onfocus:y,oncontextmenu:_,ondblclick:e.disableMaximize?null:c},[v("div",{["drag-region"]:"drag",className:"absolute w-full h-full top left-0"}),e.hideTitle?null:v("div",{className:"window-title-text h-full flex items-center"},k=v("div",{title:e.title,className:"text-ellipsis"},e.title)),L=v("div",{className:"window-titlebar-content flex-1 h-full flex items-center relative"+(G(e.content)?"":" hide")},G(e.content)&&Se(e.content)?e.content():e.content)]);function i(l){G(k)&&(k.title=l,k.textContent=l)}function n(l){ft(L),L.classList.remove("hide"),L.appendChild(Se(l)?l():l)}return{element:C,setTitle:i,setContent:n}}function gr(e,c){let _=cr(e.icon),y=pr({title:e.title,hideTitle:e.hideTitle,disableMaximize:e.disableMaximize,content:e.content,stretchTitlebarContent:e.stretchTitlebarContent},c.onDoubleClick,c.onContextMenu,c.onTitleFocus),k=mr({isMaximized:e.maximized,disableMaximize:e.disableMaximize},{onMinimizeButtonClick:c.onMinimizeButtonClick,onMaximizeButtonClick:c.onMaximizeButtonClick,onCloseButtonClick:c.onCloseButtonClick}),L,C=!1;L=v("div",{className:"window-titlebar flex items-center"+(e.hideIcon?" no-icon":"")+(e.hideTitle?" no-title":"")},[_.element,y.element,k.element]),e.autoHide&&(L.addEventListener("mouseover",()=>{C=!0},!1),L.addEventListener("mouseout",()=>{C=!1},!1));function i(m){m?(L.classList.remove("titlebar-fade-in"),C||(L.classList.add("titlebar-fade-out"),c.onHidden&&c.onHidden())):(L.classList.add("titlebar-fade-in"),L.classList.remove("titlebar-fade-out"),c.onVisible&&c.onVisible())}function n(m){C=m}function l(m){m?L.classList.remove("hidden"):L.classList.add("hidden")}return{element:L,titleElem:y.element,setIcon:_.setWindowIcon,setTitle:y.setTitle,setTitlebarContent:y.setContent,setMaximize:k.setMaximize,setVisible:l,setAutoHide:i,setPreventHide:n}}function zs(e,c,_){var y=0,k=0,L=0,C=0;c?c.onmousedown=n:e.onmousedown=n;let i=!1;function n(s){s.button===0&&(s.preventDefault(),L=s.clientX,C=s.clientY,document.onmouseup=m,document.onmousemove=l,G(_)&&Se(_.onDragStart)&&_.onDragStart())}function l(s){y=L-s.clientX,k=C-s.clientY,L=s.clientX,C=s.clientY;let h=e.offsetTop-k,f=e.offsetLeft-y;i=Math.abs(f)>0||Math.abs(h)>0,e.style.top=h+"px",e.style.left=f+"px",G(_)&&Se(_.onDrag)&&_.onDrag({x:s.clientX,y:s.clientY},{top:h,left:f})}function m(){i&&G(_)&&Se(_.onDragEnd)&&_.onDragEnd(e),i=!1,document.onmouseup=null,document.onmousemove=null}}function Je(e,c,_,y,k){let L=_,C=y,i="default",n="";c.addEventListener("mousedown",T,!1);let l=0,m=0,s=0,h=0,f=0,d=0,u=0,t=0,a=0,o=0,r,p,g,E;function T(S){let M=window.getComputedStyle(e);s=parseInt(M.left),h=parseInt(M.top),f=e.offsetWidth,d=e.offsetHeight,a=parseInt(M.minHeight),o=parseInt(M.minWidth),l=S.clientX,m=S.clientY,window.addEventListener("mousemove",w,!1),window.addEventListener("mouseup",x,!1);var P=S.currentTarget;n=P.dataset.resize,G(k)&&Se(k.onResizeStart)&&k.onResizeStart()}function w(S){let M=S.clientX-l+u,P=S.clientY-m+t;u=0,t=0,l=S.clientX,m=S.clientY;var H=P,N=M;n==="t"?(i="ns-resize",d-H<a?t=H-(P=d-a):h+H<g&&(t=H-(P=g-h)),h+=P,d-=P,L&&(f=Math.round(d*C))):n==="l"?(i="ew-resize",f-N<o?u=N-(M=f-o):s+N<r&&(u=N-(M=r-s)),s+=M,f-=M,L&&(d=Math.round(f/C))):n==="tl"?(i="nw-resize",f-N<o?u=N-(M=f-o):s+N<r&&(u=N-(M=r-s)),s+=M,f-=M,d-H<a?t=H-(P=d-a):h+H<g&&(t=H-(P=g-h)),h+=P,L?Math.abs(M)>Math.abs(P)?d=Math.round(f/C):f=Math.round(d*C):d-=P):n==="b"?(i="ns-resize",d+H<a?t=H-(P=a-d):h+d+H>E&&(t=H-(P=E-h-d)),d+=P,L&&(f=Math.round(d*C))):n==="bl"?(i="ne-resize",f-N<o?u=N-(M=f-o):s+N<r&&(u=N-(M=r-s)),s+=M,f-=M,L?d=Math.round(f/C):(d+H<a?t=H-(P=a-d):h+d+H>E&&(t=H-(P=E-h-d)),d+=P)):n==="r"?(i="ew-resize",f+N<o?u=N-(M=o-f):s+f+N>p&&(u=N-(M=p-s-f)),f+=M,L&&(d=Math.round(f/C))):n==="tr"?(i="ne-resize",f+N<o?u=N-(M=o-f):s+f+N>p&&(u=N-(M=p-s-f)),f+=M,d-H<a?t=H-(P=d-a):h+H<g&&(t=H-(P=g-h)),h+=P,d-=P,L&&(f=Math.round(d*C))):n==="br"&&(i="nw-resize",f+N<o?u=N-(M=o-f):s+f+N>p&&(u=N-(M=p-s-f)),f+=M,d+H<a?t=H-(P=a-d):h+d+H>E&&(t=H-(P=E-h-d)),d+=P,L&&(f=Math.round(d*C))),e.style.top=h+"px",e.style.left=s+"px",e.style.width=f+"px",e.style.height=d+"px",document.body.style.pointerEvents="none",document.documentElement.style.cursor=i,G(k)&&Se(k.onResize)&&k.onResize({top:h,left:s,width:f,height:d})}function x(){u=0,t=0,G(k)&&Se(k.onResizeEnd)&&k.onResizeEnd(),document.body.style.pointerEvents="initial",document.documentElement.style.cursor="default",window.removeEventListener("mousemove",w,!1),window.removeEventListener("mouseup",x,!1)}function I(S){C=S}function B(S){L=S}return{setAspectRatio:I,setKeepAspectRatio:B}}const qi=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],vr=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Pi=["January","February","March","April","May","June","July","August","September","October","November","December"],kt=30,mi=38,Fe=46,_r="imgs/user.gif",xe={top:"top",left:"left",right:"right",topLeft:"topLeft",bottomLeft:"bottomLeft",bottomRight:"bottomRight",topRight:"topRight"},Ce=()=>"var(--window-icon-color)",wr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
<path
  d="M 3 3 L 11 3 L 11 11 L 3 11 L 3 3 z M 11 13 L 11 21 L 3 21 V 13 L 11 13 z M 13 3 L 21 3 V 11 L 13 11 V 3 z M 21 13 L 21 21 L 13 21 L 13 13 L 21 13 z" />
</svg>
`,Xi=`
<svg xmlns="http://www.w3.org/2000/svg" class="svg-stroke" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="${Ce()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" />
  <circle cx="12" cy="12" r="3" />
</svg>
`,br=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="${Ce()}"><path d="M20 5h-9.586L8.707 3.293A.997.997 0 0 0 8 3H4c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V7c0-1.103-.897-2-2-2z"></path></svg>
`,Ws=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="${Ce()}" fill="none" stroke-linecap="round">
  <circle cx="12" cy="17" r="1" style="fill: ${Ce()}" />
  <path d="M9.172 14a4 4 0 0 1 5.656 0" />
  <path d="M6.343 12a8 8 0 0 1 11.314 0" />
  <path d="M3.515 9.5c4.686 -4.687 12.284 -4.687 17 0" />
</svg>
`,$s=`
<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" stroke="${Ce()}"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
`,Us=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" fill="none" stroke-linejoin="round">
<rect x="5.5" y="7.5" width="14" height="9" stroke="${Ce()}"/>
<rect x="7" y="9" width="11" height="6" fill="${Ce()}"/>
<rect x="19.5" y="10" width="1.5" height="4" fill="${Ce()}"/>
</svg>
`,js=`
<svg aria-hidden="true" version="1.1" width="10" height="10">
<path d="M 0,0 0,0.7 4.3,5 0,9.3 0,10 0.7,10 5,5.7 9.3,10 10,10 10,9.3 5.7,5 10,0.7 10,0 9.3,0 5,4.3 0.7,0 Z"></path>
</svg>
`,Vs=`
<svg class="svg-stroke" width="14" height="14" viewBox="0 0 24 24" stroke-width="2" stroke="${Ce()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <line x1="18" y1="6" x2="6" y2="18" />
  <line x1="6" y1="6" x2="18" y2="18" />
</svg>
`,yr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" fill="none" stroke="${Ce()}" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<path d="M7 6a7.75 7.75 0 1 0 10 0" />
<line x1="12" y1="4" x2="12" y2="12" />
</svg>
`,Sr=`
 <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"  stroke="${Ce()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
 <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
 <path d="M19.95 11a8 8 0 1 0 -.5 4m.5 5v-5h-5" />
</svg>
`,Ks=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Ce()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<polyline points="6 15 12 9 18 15" />
</svg>
`,Ht=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke="${Ce()}" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round" class="svg-stroke">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<polyline points="9 6 15 12 9 18" />
</svg>
 `,xr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Ce()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<polyline points="7 8 17 16 12 20 12 4 17 8 7 16" />
</svg>
`,Cr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Ce()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<path d="M16 10h4a2 2 0 0 1 0 4h-4l-4 7h-3l2 -7h-4l-2 2h-3l2 -4l-2 -4h3l2 2h4l-2 -7h3z" />
</svg>
`,kr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Ce()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
</svg>
`,Er=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Ce()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<path d="M5 12l5 5l10 -10" />
</svg>
`,qs=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Ce()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<circle cx="10" cy="10" r="7" />
<line x1="21" y1="21" x2="15" y2="15" />
</svg>
`,Lr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="${Ce()}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<circle cx="12" cy="12" r="4" style="fill: ${Ce()}"/>
<circle cx="12" cy="12" r="9"/>
</svg>
`,Dr=`
<svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" class="no-stroke">
  <circle cx="12" cy="12" r="9" fill="#000" />
  <circle cx="12" cy="12" r="8" fill="#fff" />
  <path d="M12 21A2 2 1 0 1 12 3" fill="#000" />
</svg>
`,Tr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${Ce()}"
  stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
  <circle cx="12" cy="12" r="3"></circle>
  <line x1="12" y1="1" x2="12" y2="5"></line>
  <line x1="12" y1="19" x2="12" y2="23"></line>
  <line x1="4" y1="4" x2="7" y2="7"></line>
  <line x1="17" y1="17" x2="20" y2="20"></line>
  <line x1="1" y1="12" x2="5" y2="12"></line>
  <line x1="19" y1="12" x2="23" y2="12"></line>
  <line x1="4" y1="20" x2="7" y2="17"></line>
  <line x1="17" y1="7" x2="20" y2="4"></line>
</svg>
`,Mr=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${Ce()}"
stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
<circle cx="12" cy="12" r="5"></circle>
<circle cx="10" cy="11" r="2" fill="${Ce()}"></circle>
<line x1="12" y1="1" x2="12" y2="3"></line>
<line x1="12" y1="21" x2="12" y2="23"></line>
<line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
<line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
<line x1="1" y1="12" x2="3" y2="12"></line>
<line x1="21" y1="12" x2="23" y2="12"></line>
<line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
<line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>
`,Ir=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
stroke="${Ce()}" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
<path d="M2 16.1A5 5 0 0 1 5.9 20M2 12.05A9 9 0 0 1 9.95 20M2 8V6a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-6">
</path>
<line x1="2" y1="20" x2="2.01" y2="20"></line>
</svg>
`,Br=`
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" fill="none" stroke="${Ce()}">
<rect x="3" y="3" width="18" height="18" />
<line x1="6" x2="10" y1="10" y2="6" />
<line x1="6" x2="18" y1="18" y2="6" />
<line x1="14" x2="18" y1="18" y2="14" />
</svg>
`;function Gi(e=24,c=1.5,_=Ce()){return`
<svg xmlns="http://www.w3.org/2000/svg" class="svg-stroke" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="${_}" fill="none" stroke-linecap="round" stroke-linejoin="round">
<path stroke="none" d="M0 0h24v24H0z" fill="none"/>
<line x1="12" y1="5" x2="12" y2="19" />
<line x1="5" y1="12" x2="19" y2="12" />
</svg>
`}function Rr(e=20,c="var(--window-icon-color)"){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" stroke="${c}"
"><rect x="1" y="1" width="22" height="14" style="" stroke-width="2"></rect><path d="M8.5 1L8.5 15.5M11.5 15.5L11.5 20.5L2.5 20.5M11.5 20.5L21.5 20.5"></path></svg>`}function Ar(e=24,c="var(--window-icon-color)"){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="1.5" stroke="${c}" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(60 12 12)"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(120 12 12)"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(180 12 12)"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(240 12 12)"></path>
  <path d="M10 4l2 1l2 -1m-2 -2v6.5l3 1.72" transform="rotate(300 12 12)"></path>
</svg>`}function Nr(e=24){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="1.5" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l14 0" />
  <path d="M5 12l6 6" />
  <path d="M5 12l6 -6" />
</svg>`}function Pr(e=24){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="1.5" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l14 0" />
  <path d="M13 18l6 -6" />
  <path d="M13 6l6 6" />
</svg>`}function Hr(e=24){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="1.5" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M12 5l0 14" />
  <path d="M18 11l-6 -6" />
  <path d="M6 11l6 -6" />
</svg>`}function Or(e=24){return`<svg xmlns="http://www.w3.org/2000/svg"width="${e}" height="${e} "viewBox="0 0 24 24" stroke-width="1" stroke="var(--window-icon-color)" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M3.5 5.5l1.5 1.5l2.5 -2.5" />
  <path d="M3.5 11.5l1.5 1.5l2.5 -2.5" />
  <path d="M3.5 17.5l1.5 1.5l2.5 -2.5" />
  <path d="M11.5 6.5l9.5 0" />
  <path d="M11.5 12.5l9.5 0" />
  <path d="M11.5 18.5l9.5 0" />
</svg>`}function Fr(e=24){return`<svg xmlns="http://www.w3.org/2000/svg"width="${e}" height="${e} "viewBox="0 0 24 24" stroke-width="1" stroke="var(--window-icon-color)" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M15 8h.01" />
  <path d="M12.5 21h-6.5a3 3 0 0 1 -3 -3v-12a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v6.5" />
  <path d="M3 16l5 -5c.928 -.893 2.072 -.893 3 0l4 4" />
  <path d="M14 14l1 -1c.653 -.629 1.413 -.815 2.13 -.559" />
  <path d="M19 16v6" />
  <path d="M22 19l-3 3l-3 -3" />
</svg>`}function zr(e=24){return`<svg xmlns="http://www.w3.org/2000/svg"width="${e}" height="${e} "viewBox="0 0 24 24" stroke-width="1" stroke="var(--window-icon-color)" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M15 8h.01" />
  <path d="M12.5 21h-6.5a3 3 0 0 1 -3 -3v-12a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v6.5" />
  <path d="M3 16l5 -5c.928 -.893 2.072 -.893 3 0l4 4" />
  <path d="M14 14l1 -1c.67 -.644 1.45 -.824 2.182 -.54" />
  <path d="M16 19h6" />
  <path d="M19 16v6" />
</svg>`}function Wr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e} " viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M19.933 13.041a8 8 0 1 1 -9.925 -8.788c3.899 -1 7.935 1.007 9.425 4.747"></path>
   <path d="M20 4v5h-5"></path>
</svg>`}function Xs(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
  <path d="M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
  <path d="M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
</svg>`}function Gs(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path d="M15 8h.01" />
  <path d="M3 6a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3v-12z" />
  <path d="M3 16l5 -5c.928 -.893 2.072 -.893 3 0l5 5" />
  <path d="M14 14l1 -1c.928 -.893 2.072 -.893 3 0l3 3" />
</svg>`}function $r(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M15 8h.01" />
  <path d="M11 20h-4a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v4" />
  <path d="M4 15l4 -4c.928 -.893 2.072 -.893 3 0l3 3" />
  <path d="M14 14l1 -1c.31 -.298 .644 -.497 .987 -.596" />
  <path d="M18.42 15.61a2.1 2.1 0 0 1 2.97 2.97l-3.39 3.42h-3v-3l3.42 -3.39z" />
</svg>`}function Ur(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <rect x="1" y="3" width="4" height="4"/>
  <path d="M10 5h10" />
  <rect x="1" y="10" width="4" height="4"/>
  <path d="M10 12h10" />
  <rect x="1" y="17" width="4" height="4"/>
  <path d="M10 19h10" />
</svg>`}function jr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
  <path d="M7 10l6 0" />
  <path d="M10 7l0 6" />
  <path d="M21 21l-6 -6" />
</svg>`}function Vr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
  <path d="M7 10l6 0" />
  <path d="M21 21l-6 -6" />
</svg>`}function Kr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 16" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path d="M.5.5h23v15H.5z" />
  <path d="M3.5 6.5v-3h3m14 3v-3h-3m3 6v3h-3m-11 0h-3v-3" />
</svg>`}function qr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 16" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path d="M.5.5h23v15H.5zM6.5 4.5v7m11-7v7" />
  <circle cx="12" cy="5.5" r=".5" />
  <circle cx="12" cy="10.5" r=".5" />
</svg>`}function Xr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path d="M15 1h8v8m0-8L1 23v-8m0 8h8" />
</svg>`}function Gr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 7l16 0" />
  <path d="M10 11l0 6" />
  <path d="M14 11l0 6" />
  <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" />
  <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" />
</svg>`}function Yr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M19.5 12.572l-7.5 7.428l-7.5 -7.428a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572" />
</svg>`}function Jr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M17 17h2a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2h-14a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h2" />
  <path d="M17 9v-4a2 2 0 0 0 -2 -2h-6a2 2 0 0 0 -2 2v4" />
  <path d="M7 13m0 2a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2v4a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2z" />
</svg>`}function Zr(e=24,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M13 4v4c-6.575 1.028 -9.02 6.788 -10 12c-.037 .206 5.384 -5.962 10 -6v4l8 -7l-8 -7z" />
</svg>`}const xt={};function Be(e,c,_){typeof xt[e]>"u"&&(xt[e]=Object.create(null)),xt[e][c]=_}function Ee(e,c){if(!(typeof xt[e]>"u"))for(let _ in xt[e])xt[e][_](c)}function Jt(e,c){delete xt[e][c]}const re={backgroundImageChange:"background-image-change",backgroundImageStyleChange:"background-image-style-change",themeChange:"theme-change",blurChange:"blur-change",nightLightChange:"night-light-change",closePopup:"close-popup",showPopup:"show-popup",hidePopup:"hide-popup",createWindow:"create-window",startProcess:"start-process",viewWindow:"view-window",restoreView:"restore-view",showDesktopHover:"show-desktop-hover",showDesktopOut:"show-desktop-out",showDesktop:"show-desktop",blurAllWindow:"blur-all-window",brightnessChange:"brightness-change",transparentChange:"transparency-change",customThemeChange:"custom-theme-change"};function He(e,c){Ee(re.createWindow,{appName:e,args:c})}function Zt(e){Ee(re.startProcess,e)}let Ve,Xt;function Qr(){return Ve}function eo(e,c){if(Ve instanceof HTMLDivElement){Ve.innerHTML="",n();return}function _(){return e.map(l=>{const m=parseInt(l.element.style.width),s=parseInt(l.element.style.height),h=Array.from(l.element.getElementsByTagName("video")),f=l.element.cloneNode(!0),d=Array.from(f.getElementsByTagName("video")),u=Array.from(f.getElementsByTagName("audio"));for(let a=0;a<d.length;a++){const o=d[a];o.muted=!0,o.pause(),o.controls=!1,o.currentTime=h[a].currentTime}for(let a of u)a.muted=!0,a.pause(),a.controls=!1;f.style.pointerEvents="none",f.classList.add("taskbar-app-thumbnail-content");let t=120/s;return t*m>200&&(t=200/m),f.className.indexOf("fluid")===-1&&(f.style.height=s-kt+"px"),f.style.transform=`scale(${t})`,{container:v("div",{title:l.getTitle(),className:"taskbar-app-thumbnail"+(l.isFocused()?" active":""),onmouseover:y.bind(null,l.id),onmouseout:k.bind(null,l.id)},[v("div",{className:"taskbar-app-thumbnail-inner relative w-full h-full fade-in",onclick:C.bind(null,l)},[v("div",{className:"taskbar-app-thumbnail-heading flex items-center"},[v("div",{className:"taskbar-app-thumbnail-icon image-cover flex-shrink-0",style:{backgroundImage:`url("${l.icon}")`}}),v("div",{className:"taskbar-app-thumbnail-title"},v("div",{className:"text-ellipsis"},l.getTitle())),v("div",{title:"Close",className:"taskbar-app-thumbnail-close-button flex content-center items-center flex-shrink-0",innerHTML:js,onclick:()=>{l.close(),pi(),L()}})]),v("div",{className:"taskbar-app-thumbnail-container"},f)])]),thumbnail:f}})}function y(l){Ee(re.viewWindow,{id:l}),Ee(re.hidePopup)}function k(l){L(l),Ee(re.showPopup)}function L(l){Ee(re.restoreView,{id:l})}function C(l){l.show(),l.focus(),pi(),L()}function i(l){if(Ve){const m=Ve.getBoundingClientRect(),s=Math.round(c.left+c.width/2-m.width/2);Ve.style.left=s+"px",Ve.style.height=l+62+"px"}}function n(){const l=_();Ve&&Ct(Ve,l.map(s=>s.container));let m=0;l.forEach(s=>{const h=s.thumbnail.getBoundingClientRect();s.container.style.width=h.width+"px",s.container.style.height=h.height+32+"px",h.height>m&&(m=h.height)}),i(m),setTimeout(()=>{de(Ve,{visibility:"visible"})},50)}Ve=v("div",{className:"taskbar-app-thumbnails flex",style:{visibility:"hidden"},onmouseover:Ys,onmouseleave:Js}),document.body.appendChild(Ve),n()}function Ys(){Xt&&clearTimeout(Xt)}function Js(){Xt&&clearTimeout(Xt),Xt=setTimeout(()=>{pi()},500)}function pi(){Ve==null||Ve.remove(),Ve=void 0}function Zs(e,c){const _=Object.create(null);return _.className="taskbar-app-item-icon w-full h-full flex items-center content-center",c==="svg"?_.innerHTML=e:(_.className+=" image-icon",_.style||(_.style=Object.create(null)),_.style.backgroundImage=`url("${e}")`,_.style.pointerEvents="none"),_}function to(e,c,_){let y;const k=Object.create(null);k.title=e.productName,k.className="taskbar-item taskbar-app-item";const L=Zs(e.icon,e.iconType);return k.onmousedown=C=>C.stopImmediatePropagation(),k.onclick=c==null?void 0:c.onclick,k.oncontextmenu=c==null?void 0:c.oncontextmenu,y=v("div",k,v("div",L)),G(_)&&y.style.setProperty("--window-icon-color",_),{element:y}}function pt(e,c){let _;const y=[],k=Object.create(null);k.className="taskbar-item taskbar-app-item";const L=Zs(e.icon,e.iconType);let C;k.onmousedown=r=>{mt(),r.stopPropagation(),Ee(re.closePopup),C&&clearTimeout(C)},k.oncontextmenu=r=>{r.stopPropagation(),r.preventDefault(),mt(),typeof c.oncontextmenu=="function"&&c.oncontextmenu(r)};function i(){const r=y.map(p=>p.app);eo(r,_.getBoundingClientRect())}k.onmouseover=()=>{y.length&&(Ys(),C&&clearTimeout(C),Qr()?i():C=setTimeout(()=>{i()},500))},k.onmouseleave=()=>{C&&clearTimeout(C),y.length&&Js()},k.onclick=n;function n(){if(y.length===0)He(e.name);else if(y.length===1){pi();const r=y[0];r.app.isVisible()?r.app.isFocused()?r.app.hide():r.app.focus():(r.app.show(),r.app.focus())}else y.length>1&&i()}let l;_=v("div",k,[v("div",L),l=v("div",{className:"taskbar-app-item-status"})]),_.addEventListener("customdragover",m,!1),_.addEventListener("customdrop",s,!1);function m(r){}function s(r){}function h(){y.length?l.classList.add("active"):l.classList.remove("active")}function f(r,p){y.push({name:r,active:!0,app:p}),h()}function d(r){const p=y.findIndex(g=>g.name===r);p>-1&&(y.splice(p,1),y.length===0&&c!=null&&c.onRemove&&c.onRemove()),h()}function u(r){setTimeout(()=>{_.classList.add("active")},10)}function t(r){setTimeout(()=>{_.classList.remove("active")},0)}function a(){return y}function o(){_.remove()}return{element:_,addInstance:f,removeInstance:d,getInstances:a,setActive:u,removeActive:t,remove:o}}function Lt(e,c,_){const y="popup"+xi(32);let k="popup dropdown-box"+(e.noBorder?" no-border":""),L=!1,C={};e.className&&(k+=" "+e.className),G(e.top)&&(C.top=e.top+"px"),G(e.left)&&(C.left=e.left+"px"),G(e.width)&&(C.width=e.width+"px"),G(e.height)&&(C.height=e.height+"px");let i=v("div");function n(t){i=v("div",{tabIndex:-1,className:k,style:C},v("div",{className:"popup-inner relative w-full h-full"},t)),it(document.body,i),Ee(re.blurAllWindow),i.focus(),document.addEventListener("mousedown",f,!1)}function l(t){de(i,t)}function m(t){n(c),G(t)&&(G(t.top)&&(i.style.top=t.top+"px"),G(t.left)&&(i.style.left=t.left+"px"),G(t.width)&&(i.style.width=t.width+"px"),G(t.height)&&(i.style.height=t.height+"px")),L=!0,_&&_.onShow&&_.onShow()}function s(){i.remove(),document.removeEventListener("mousedown",f,!1),L=!1,_&&_.onHide&&_.onHide()}function h(t){L?s():m(t)}function f(t){const a=t.target;i.contains(a)||s()}function d(){i&&i.classList.add("hidden")}function u(){i&&i.classList.remove("hidden")}return Be(re.closePopup,y,t=>{L&&y!==t&&s()}),Be(re.showPopup,y,()=>{u()}),Be(re.hidePopup,y,()=>{d()}),{element:i,id:y,show:m,close:s,visible:u,hide:d,toggleShow:h,setStyle:l}}let Kt=class{constructor({startDate:c=null,endDate:_=null,siblingMonths:y=!1,weekNumbers:k=!1,weekStart:L=0}={}){Mt(this,"startDate");Mt(this,"endDate");Mt(this,"siblingMonths");Mt(this,"weekNumbers");Mt(this,"weekStart");this.startDate=c,this.endDate=_,this.siblingMonths=y,this.weekNumbers=k,this.weekStart=L}getCalendar(c,_){const y=new Date(Date.UTC(c,_,1,0,0,0,0));c=y.getUTCFullYear(),_=y.getUTCMonth();const k=[],L=y.getUTCDay(),C=-((7-this.weekStart+L)%7),i=Kt.daysInMonth(c,_),n=(i-C)%7,l=Kt.daysInMonth(c,_-1);let m=C,s,h,f=!1,d=null,u,t;const a=i-m+(n!==0?7-n:0)+C;for(;m<a;)h=m+1,s=((m<1?7+m:m)+L)%7,h<1||h>i?this.siblingMonths?(h<1?(u=_-1,t=c,u<0&&(u=11,t--),h=l+h):h>i&&(u=_+1,t=c,u>11&&(u=0,t++),h=m-i+1),u!==void 0&&t!==void 0&&(f={day:h,weekDay:s,month:u,year:t,siblingMonth:!0})):f=!1:f={day:h,weekDay:s,month:_,year:c},f&&this.weekNumbers&&(d===null?d=Kt.calculateWeekNumber(f):s===1&&d===52?d=1:s===1&&d++,f.weekNumber=d),f&&this.startDate&&(f.selected=this.isDateSelected(f)),k.push(f),m++;return k}isDateSelected(c){return this.startDate?c.year===this.startDate.year&&c.month===this.startDate.month&&c.day===this.startDate.day?!0:!(!this.endDate||c.year===this.startDate.year&&c.month===this.startDate.month&&c.day<this.startDate.day||c.year===this.endDate.year&&c.month===this.endDate.month&&c.day>this.endDate.day||c.year===this.startDate.year&&c.month<this.startDate.month||c.year===this.endDate.year&&c.month>this.endDate.month||c.year<this.startDate.year||c.year>this.endDate.year):!1}setStartDate(c){this.startDate=c}setEndDate(c){this.endDate=c}setDate(c){return this.setStartDate(c)}static diff(c,_){const y=new Date(Date.UTC(c.year,c.month,c.day,0,0,0,0)),k=new Date(Date.UTC(_.year,_.month,_.day,0,0,0,0));return Math.ceil((y.getTime()-k.getTime())/864e5)}static interval(c,_){return Math.abs(Kt.diff(c,_))+1}static compare(c,_){if(typeof c!="object"||typeof _!="object"||c===null||_===null)throw new TypeError("dates must be objects");return c.year<_.year?-1:c.year>_.year?1:c.month<_.month?-1:c.month>_.month?1:c.day<_.day?-1:c.day>_.day?1:0}static daysInMonth(c,_){return new Date(c,_+1,0).getDate()}static isLeapYear(c){return c%4===0&&c%100!==0||c%400===0}static calculateWeekNumber(c){const _=new Date(Date.UTC(c.year,c.month,c.day,0,0,0,0)),y=new Date(_.valueOf()),k=(_.getUTCDay()+6)%7;y.setUTCDate(y.getUTCDate()-k+3);const L=y.valueOf();return y.setUTCMonth(0,1),y.getUTCDay()!==4&&y.setUTCMonth(0,1+(4-y.getUTCDay()+7)%7),1+Math.ceil((L-y.getTime())/6048e5)}};function io(){let e,c,_=new Date().getDate(),y;const k=new Kt({siblingMonths:!0});function L(){c.innerHTML="";const l=new Date;e.innerHTML=Pi[l.getUTCMonth()];const m=qi.map(s=>s.substring(0,2));for(let s=0;s<m.length;s++){const h=m[s];c.appendChild(v("div",{className:"calendar-day -weekday"},v("div",{className:"w-full h-full flex items-center content-center"},h)))}k.getCalendar(l.getUTCFullYear(),l.getUTCMonth()).forEach(s=>{const h=v("div",{className:"calendar-day"+(s&&s.siblingMonth?" -sibling-month":"")},v("div",{"data-date":s?s.day:"",className:"calendar-day-inner w-full h-full flex items-center content-center"+(s&&l.getDate()===s.day&&!s.siblingMonth?" active":"")},s?s.day.toString():""));c.appendChild(h)})}function C(){const l=new Date,m=l.getDate();if(_!==m){const s=c.querySelector(`[data-date="${_}"`);s instanceof HTMLDivElement&&s.classList.remove("active");const h=c.querySelector(`[data-date="${m}"`);h instanceof HTMLDivElement&&h.classList.add("active"),_=m,e.innerHTML=Pi[l.getUTCMonth()]}}function i(){L(),y=setInterval(()=>{C()},1e3)}function n(){clearInterval(y)}return Lt({className:"calendar-popup"},v("div",{className:"calendar-content"},[e=v("div",{className:"calendar-month"}),c=v("div",{className:"calendar-items"})]),{onShow:i,onHide:n})}const ms=io();function so(){function e(){mt(),Ee(re.closePopup,ms.id),ms.toggleShow()}const c=v("div",{className:"taskbar-item taskbar-date-time taskbar-date h-full flex items-center flex-shrink-0",onclick:e,onmousedown:_=>_.stopPropagation()},Hi(new Date));return setInterval(()=>{c.textContent=Hi(new Date)},500),{element:c}}function no(){let e,c,_,y,k;function L(){const n=new Date,l=n.getSeconds(),m=l/60*360+90;e.style.transform=`rotate(${m}deg)`;const s=n.getMinutes(),h=s/60*360+l/60*6+90;c.style.transform=`rotate(${h}deg)`;const d=n.getHours()/12*360+s/60*30+90;_.style.transform=`rotate(${d}deg)`,y.textContent=Et(n,!0)}function C(){L(),setInterval(L,500)}function i(){clearInterval(k)}return Lt({className:"clock-popup"},v("div",{className:"clock-container flex"},[v("div",{className:"clock-inner"},[v("div",{className:"clock"},[v("div",{className:"outer-clock-face"},[v("div",{className:"clock-marking clock-marking-one"}),v("div",{className:"clock-marking clock-marking-two"}),v("div",{className:"clock-marking clock-marking-three"}),v("div",{className:"clock-marking clock-marking-four"}),v("div",{className:"inner-clock-face"},[_=v("div",{className:"clock-hand clock-hour-hand"}),c=v("div",{className:"clock-hand clock-min-hand"}),e=v("div",{className:"clock-hand clock-second-hand"})])])]),y=v("div",{className:"clock-time"})]),v("div",{className:"clock-divider"}),v("div",{className:"alarm-container flex flex-col flex-1 w-full"},[v("div",{className:"alarm-heading"},"Alarms"),v("div",{className:"alarm-items flex items-center content-center flex-1"},"No alarms")])]),{onShow:C,onHide:i})}const ps=no();function ro(){const e=v("div",{className:"taskbar-item taskbar-date-time taskbar-time h-full flex items-center",onclick:()=>{mt(),Ee(re.closePopup,ps.id),ps.toggleShow({left:Math.round(e.getBoundingClientRect().left)})},onmousedown:c=>c.stopPropagation()},Et(new Date));return setInterval(()=>{e.textContent=Et(new Date)},500),{element:e}}function oo(){let e,c;function _(){c=setInterval(()=>{e.textContent=Et(new Date)},500)}function y(){clearInterval(c)}function k(C,i){return v("div",{},[v("div",{},C),v("div",{style:{fontSize:"16px"}},i)])}return Lt({className:"weather-popup"},v("div",{className:"weather-container w-full h-full p-20"},[v("div",{className:"flex"},[e=v("div",{className:"weather-popup-time flex items-center"},Et(new Date)),v("div",{className:"flex items-center",style:{fontWeight:"bold",marginLeft:"auto"}},[v("div",{style:{marginRight:"10px"}},"Somewhere"),v("div",{className:"flex items-center",innerHTML:Xi})])]),v("div",{className:"flex items-center",style:{paddingBlock:"20px"}},[v("div",{style:{width:"80px",height:"80px",backgroundImage:'url("imgs/icons/Weather/sunny snow.png")',backgroundRepeat:"no-repeat",backgroundSize:"contain"}}),v("div",{className:"weather-popup-temperature",style:{marginLeft:"20px",fontSize:"32px"}},"-37°C"),v("div",{style:{marginLeft:"20px"}},[v("div",{style:{fontWeight:"bold",fontSize:"14px"}},"Snow"),v("div",{className:"flex",style:{marginTop:"10px"}},[v("div",{},"Feel like"),v("div",{style:{marginLeft:"10px",fontWeight:"bold",fontSize:"14px"}},"-37°C")])])]),v("div",{className:"weather-popup-index"},[k("Air quality","60"),k("Winds","4 km/h"),k("Humidity","50 %"),k("Visibility","10 km"),k("Pressure","1021 mb"),k("Dew point","10°")])]),{onShow:_,onHide:y})}function ao(){const e=oo(),c=v("div",{title:"Somewhere, -37°C, Snow",className:"taskbar-item taskbar-weather h-full flex items-center",onclick:()=>{mt(),Ee(re.closePopup,e.id),e.toggleShow({left:Math.round(c.getBoundingClientRect().left)})},onmousedown:_=>_.stopPropagation()},[v("div",{style:{height:"20px"},innerHTML:Ar(20,"var(--accent-color)")}),v("div",{style:{marginLeft:"5px"}},"-37°C")]);return{element:c}}function lo(){let{nightlight:e}=ve.getState("nightlight"),c,_,y=v("div",{className:"screen"},[c=v("div",{className:"screen-bright-overlay w-full h-full"}),_=v("div",{className:"screen-nightlight w-full h-full"+(e?" active":"")})]);it(document.body,y);function k(i){let n=jt(.7-i/100*.7,2);c.style.opacity=n.toString(),Ee(re.brightnessChange,i)}function L(i,n=!0){e=i,_.classList[e?"add":"remove"]("active"),n&&ve.setState({nightlight:e}),Ee(re.nightLightChange,e)}function C(){L(!e)}return{setBrightness:k,setNightLight:L,toogleNightLight:C}}const Qt=lo();function gs(e){let c,_,y,k,L,C,i=!1,n={top:0,left:0,width:0,height:0};function l(){n=y.getBoundingClientRect()}function m(r,p){let g=r-n.left;g<0?g=0:g>n.width&&(g=n.width);let E=g/n.width*100;p(E)}function s(r){typeof r=="number"&&m(r,p=>{c=p,k.style.width=p+"%",L.style.width=p+"%",typeof e.onChange=="function"?e.onChange(p,g=>{e.showBagde&&(C.textContent=g.toString())}):e.showBagde&&(C.textContent=Math.round(p).toString())})}function h(r){i=!0,_.classList.add("hoding"),l(),s(r.x),typeof e.onHoding=="function"&&e.onHoding(),document.addEventListener("mousemove",f,!1),document.addEventListener("mouseup",d,!1)}function f(r){i&&s(r.x)}function d(){i=!1,_.classList.remove("hoding"),typeof e.onRelease=="function"&&e.onRelease(c),document.removeEventListener("mousemove",f,!1),document.removeEventListener("mouseup",d,!1)}function u(){l()}function t(r){i||m(r.x,p=>{p||(p=0),L.style.width=p+"%",typeof e.onHoverMove=="function"?e.onHoverMove(p,g=>{e.showBagde&&(C.textContent=g.toString())}):e.showBagde&&(C.textContent=Math.round(p).toString())})}function a(){L.style.width="0%"}_=v("div",{className:"slider",onmousedown:h,onmouseover:u,onmousemove:t,onmouseleave:a},y=v("div",{className:"slider-inner"},[k=v("div",{className:"slider-thumb-primary"},v("div",{className:"slider-thumb-primary-inner"})),L=v("div",{className:"slider-thumb-secondary"},v("div",{className:"slider-thumb-secondary-inner"},e.showBagde?C=v("div",{className:"slider-thumb-secondary-text"}):null))]));function o(r){r>100&&(r=100),i||(k.style.width=r+"%")}return{element:_,update:o}}function ct(e){let c=e.active,_=v("div",{className:"action-center-button"+(c?" active":"")},[v("div",{className:"action-center-button-icon",innerHTML:e.icon,onclick:y}),v("div",{className:"action-center-button-text"},e.text)]);function y(){e.disableActiveOnClick||(c=!c,typeof e.onclick=="function"&&e.onclick(c))}function k(C){_.classList[C?"add":"remove"]("active")}function L(C){c=C,k(C)}return{element:_,setActive:L}}function co(){const{themes:e,themeIndex:c,customTheme:_,nightlight:y,brightness:k,volume:L}=ve.getState(["themes","themeIndex","customTheme","nightlight","brightness","volume"]),C=c>-1?e[c]:_,i=C.dark,n=C.transparency,l=ct({icon:Ws,text:"Wifi"}),m=ct({icon:xr,text:"Bluetooth"}),s=ct({icon:Cr,text:"Airplan Mode"}),h=ct({active:i,icon:Dr,text:"Dark Theme",onclick:g=>{Qi(g)}}),f=ct({icon:kr,text:"Focus Assist"}),d=ct({icon:Lr,text:"Location"}),u=ct({active:y,icon:Mr,text:"Night Light",onclick:()=>{Qt.toogleNightLight()}}),t=ct({icon:Ir,text:"Connect"}),a=ct({active:n,icon:Br,text:"Transparency",onclick:g=>{es(g)}});Be(re.themeChange,"actionCenter",g=>{h.setActive(g)});let o=!1;const r=gs({showBagde:!0,onHoding:()=>{o=!0},onChange:(g,E)=>{Qt.setBrightness(g),E(Math.round(g))},onRelease:g=>{o=!1,ve.setState({brightness:Math.round(g)})}});r.update(k);const p=gs({showBagde:!0,onRelease:g=>{ve.setState({volume:Math.round(g)})}});return p.update(L),Be(re.nightLightChange,"actionCenter",g=>{u.setActive(g)}),Be(re.brightnessChange,"actionCenter",g=>{o||r.update(g)}),Be(re.transparentChange,"actionCenter",g=>{a.setActive(g)}),Lt({className:"action-center"},[v("div",{className:"action-center-top"},[v("div",{className:"action-center-buttons"},[l.element,m.element,s.element,h.element,f.element,d.element,u.element,t.element,a.element]),v("div",{className:"action-center-sliders"},[v("div",{className:"action-center-slider w-full flex items-center"},[v("div",{className:"action-center-slider-icon",innerHTML:Tr}),r.element]),v("div",{className:"action-center-slider w-full flex items-center"},[v("div",{className:"action-center-slider-icon",innerHTML:$s}),p.element])])]),v("div",{className:"action-center-footer flex items-center"},[v("div",{className:"action-center-footer-item action-center-batery flex items-center"},[v("div",{className:"action-center-batery-icon flex items-center",innerHTML:Us}),v("div",{className:"action-center-batery-text"},"100%")]),v("div",{title:"Open Settings",className:"action-center-footer-item action-center-config",innerHTML:Xi,onclick:()=>{Ee(re.closePopup),He("settings")}})])])}const vs=co(),De={Tab:"Tab",Enter:"Enter",ArrowLeft:"ArrowLeft",ArrowRight:"ArrowRight",ArrowUp:"ArrowUp",ArrowDown:"ArrowDown",Escape:"Escape",Space:" ",BackSpace:"Backspace",Delete:"Delete",Home:"Home",End:"End",Insert:"Insert"};function Qs(e=16,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <polyline points="6 15 12 9 18 15" />
</svg>`}function Ci(e=16,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <polyline points="6 9 12 15 18 9" />
</svg>`}function en(e=16,c=1.5){return`<svg xmlns="http://www.w3.org/2000/svg" width="${e}" height="${e}" viewBox="0 0 24 24" stroke-width="${c}" stroke="var(--window-icon-color)" fill="none" stroke-linecap="round" stroke-linejoin="round" class="svg-stroke">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l5 5l10 -10" />
</svg>`}function tn(e,c,_){const y=typeof e.children<"u"&&e.children!==null&&e.children instanceof Array&&e.children.length>0;let k=v("div",{onBeforeRemove(){k=null}});k.className="menu-item",k.tabIndex=-1,e.disabled?k.classList.add("disabled"):(k.onclick=s,k.onkeydown=l),k.onfocus=m,k.onmouseenter=i;let L=document.createElement("div");L.className="menu-item-icon",e.checked?(k.classList.add("checked"),L.innerHTML=en()):e.icon&&(!e.iconType&&!(e.icon instanceof Node)||e.iconType==="svg"?L.innerHTML=e.icon:e.iconType==="image"?L.style.backgroundImage=`url("${e.icon}")`:(e.icon instanceof Node||e.iconType==="element")&&L.appendChild(e.icon)),e.emphasis&&k.classList.add("emphasis"),k.appendChild(L);let C=document.createElement("div");if(C.className="menu-item-text",C.textContent=e.text||"",k.appendChild(C),e.shortcut){let f=document.createElement("div");f.className="menu-item-shortcut",f.textContent=e.shortcut,k.appendChild(f)}if(y){let f=document.createElement("div");f.className="menu-item-arrow flex items-center",f.innerHTML=Ht,k.appendChild(f)}function i(f){f.stopPropagation(),f.currentTarget.focus(),_.onHover(c)}function n(){y||_.onEnter(e),typeof e.onClick=="function"&&e.onClick()}function l(f){f.key===De.Enter&&(f.stopPropagation(),n())}function m(f){f.stopPropagation(),_.onFocus(c)}function s(f){f.stopPropagation(),n()}function h(f){k.classList[f?"add":"remove"]("active")}return{element:k,setActive:h}}function gi(e,c){let _;e.addEventListener("mouseenter",y,!1);function y(){_=requestAnimationFrame(L),e.addEventListener("mouseleave",k,!1)}function k(){cancelAnimationFrame(_),setTimeout(()=>{cancelAnimationFrame(_)},50),e.removeEventListener("mouseleave",k,!1)}function L(){_=requestAnimationFrame(L),typeof c=="function"&&c()}}const St=6;function sn(e,c,_,y,k){const L=_.length;let C=0,i=[],n=-1,l,m={close:I},s=!1,h=document.createElement("div");h.className="sub-menu";let f=document.createElement("div");f.className="context-menu-scroll-button top",f.innerHTML=Qs(),h.appendChild(f);let d=document.createElement("div");d.className="context-menu-scroll-button bottom",d.innerHTML=Ci(),h.appendChild(d);let u=document.createElement("div");u.tabIndex=-1,u.className="context-menu-inner",u.onkeydown=g,u.addEventListener("scroll",()=>{t()},!1);function t(){u.scrollTop<=10?f.classList.remove("show"):f.classList.add("show"),u.scrollTop+u.getBoundingClientRect().height>=u.scrollHeight-10?d.classList.remove("show"):d.classList.add("show")}function a(){u.scrollTop+=4}function o(){u.scrollTop-=4}gi(f,o),gi(d,a),h.appendChild(u),c.element.appendChild(h);for(let B=0;B<L;B++){const S=_[B];if(!s&&G(S.shortcut)&&(s=!0),S.divider){let M=document.createElement("div");M.className="menu-item-divider",u.appendChild(M)}else{let M=tn(S,C,{onEnter:y,onFocus:E,onHover:p});u.appendChild(M.element),typeof S.children<"u"&&S.children!==null&&S.children instanceof Array&&S.children.length>0&&!S.disabled&&sn(h,M,S.children,y,r),i.push(M),C+=1}}s&&h.classList.add("has-shortcut");function r(B){l=B}function p(){x()}c.element.addEventListener("keydown",B=>{(B.key===De.ArrowRight||B.key===De.Enter)&&(B.stopPropagation(),w(!0))},!1),c.element.addEventListener("mouseenter",B=>{B.stopPropagation(),w(!1)},!1);function g(B){if(B.key===De.ArrowLeft&&(B.stopPropagation(),h.classList.remove("show"),c.setActive(!1),c.element.focus()),B.key===De.ArrowRight)B.stopPropagation(),n===-1&&(n=0,i[n].element.focus());else if(B.key===De.ArrowUp){if(B.stopPropagation(),B.preventDefault(),n===-1)n=i.length-1,i[n].element.focus();else{let S=i[n-1];S?S.element.focus():i[i.length-1].element.focus()}x()}else if(B.key===De.ArrowDown){if(B.stopPropagation(),B.preventDefault(),n===-1)n=0,i[n].element.focus();else{let S=i[n+1];S?S.element.focus():i[0].element.focus()}x()}}function E(B){n=B}let T;function w(B){const S=window.innerWidth,M=window.innerHeight;c.setActive(!0),h.classList.add("show");const P=e.getBoundingClientRect(),H=c.element.getBoundingClientRect();let N=P.left+P.width-St,F=H.top+2,b=h.getBoundingClientRect();T||(T=b);let D=u.getBoundingClientRect();P.left+P.width+b.width>S&&(N=P.left-b.width+St),F+b.height>=M?F=M-b.height-St/2:F-=St,D.height>=M&&(F=St,h.style.height=M-20+"px"),D=u.getBoundingClientRect(),u.scrollHeight>D.height&&(h.style.width=T.width+"px",u.style.width=T.width+20+"px"),h.style.top=F+"px",h.style.left=N+"px",t(),B&&i[0].element.focus(),k(m)}function x(){l&&l.close()}function I(){c.setActive(!1),h.classList.remove("show"),x()}return m}function Ot(e,c,_=[],y=!1,k,L=!0,C){window.lastContextMenu&&window.lastContextMenu.close(),window.contextMenuDirectionLTR=!0;const i=window.innerWidth,n=window.innerHeight;let l=!1,m,s=[],h=-1,f,d=0;const u=_.length;function t(b){if(b.key===De.ArrowRight)h===-1&&(h=0,s[h].element.focus());else if(b.key===De.ArrowUp){if(b.preventDefault(),h===-1)h=s.length-1,s[h].element.focus();else{let D=s[h-1];D?D.element.focus():s[s.length-1].element.focus()}o()}else if(b.key===De.ArrowDown){if(b.preventDefault(),h===-1)h=0,s[h].element.focus();else{let D=s[h+1];D?D.element.focus():s[0].element.focus()}o()}else b.key===De.Escape&&N()}function a(b){h=b}function o(){f&&f.close()}function r(){o()}let p=v("div",{className:"context-menu-scroll-button top",innerHTML:Qs()}),g=v("div",{className:"context-menu-scroll-button bottom",innerHTML:Ci()});m=v("div",{tabIndex:-1,className:"context-menu"+(G(C)?" "+C:"")},[p,g]);let E=v("div",{tabIndex:-1,className:"context-menu-inner",onkeydown:t,onscroll:()=>{T()}});function T(){E.scrollTop<=10?p.classList.remove("show"):p.classList.add("show");let b=E.getBoundingClientRect();E.scrollTop+b.height>=E.scrollHeight-10?g.classList.remove("show"):g.classList.add("show")}function w(){E.scrollTop+=4}function x(){E.scrollTop-=4}gi(p,x),gi(g,w),m.appendChild(E),document.body.appendChild(m),m.focus();for(let b=0;b<u;b++){const D=_[b];if(!l&&G(D.shortcut)&&(l=!0),D.divider){let R=v("div",{className:"menu-item-divider"});E.appendChild(R)}else{let R=tn(D,d,{onEnter:M,onFocus:a,onHover:r});E.appendChild(R.element),typeof D.children<"u"&&D.children!==null&&D.children instanceof Array&&D.children.length>0&&!D.disabled&&sn(m,R,D.children,M,F),s.push(R),d+=1}}l&&m.classList.add("has-shortcut"),setTimeout(()=>{y?s[0].element.focus():E.focus()},0);let I={top:e.top,left:e.left};const B=m.getBoundingClientRect();let S=E.getBoundingClientRect();I.left+B.width>i&&(I.left=I.left-B.width),I.top+B.height>n&&(I.top=n-B.height-St/2),S.height>n&&(I.top=St,m.style.height=n-20+"px"),S=E.getBoundingClientRect(),E.scrollHeight>S.height&&(m.style.width=B.width+"px",E.style.width=B.width+20+"px"),m.style.left=I.left+"px",m.style.top=I.top+"px",T();function M(){N()}function P(){N()}window.addEventListener("resize",P,!1),document.addEventListener("mousedown",H,!1);function H(b){m.contains(b.target)||N()}function N(){window.removeEventListener("scroll",P,!1),document.removeEventListener("mousedown",H,!1),m.remove(),L&&c.focus(),window.lastContextMenu=null,k&&k()}function F(b){f=b}window.lastContextMenu={close:N}}const{USER_HOME:Wt}=st.getState("USER_HOME"),ho=[{text:"Documents",icon:"imgs/icons/Folder%20Documents.png",iconType:"image",onclick:()=>{He("explorer",`${Wt}/Documents`)}},{text:"Downloads",icon:"imgs/icons/Folder%20Downloads.png",iconType:"image",onclick:()=>{He("explorer",`${Wt}/Downloads`)}},{text:"Music",icon:"imgs/icons/Library%20Music.png",iconType:"image",onclick:()=>{He("explorer",`${Wt}/Music`)}},{text:"Pictures",icon:"imgs/icons/Libray%20Pictures.png",iconType:"image",onclick:()=>{He("explorer",`${Wt}/Pictures`)}},{text:"Videos",icon:"imgs/icons/Library%20Videos.png",iconType:"image",onclick:()=>{He("explorer",`${Wt}/Videos`)}}],uo=[{text:"Accounts",icon:"imgs/user.gif",iconType:"image",onclick:()=>{Zt({type:"app",...se.settings,args:"accounts"})}},{text:"Settings",icon:Xi,onclick:()=>{He("settings")}},{text:"Power",icon:yr,preventClose:!0,onclick:e=>{Ot({top:e.y,left:e.x},e.currentTarget,[{text:"Sleep"},{text:"Restart"},{text:"Shutdown"}])}}];function fo(e){return v("div",{className:"start-menu-column start-menu-actions h-full flex flex-col scrollable scroll-y"},[v("div",{className:"start-menu-action-list start-menu-actions-top"},ho.map(c=>{const _={className:"start-menu-action-item-icon",style:{},innerHTML:""};return c.iconType==="image"?_.style.backgroundImage=`url(${c.icon})`:_.innerHTML=c.icon,v("div",{className:"start-menu-action-item flex items-center",onclick:()=>{c.onclick(),G(e)&&e(c)}},[v("div",_),v("div",null,c.text)])})),v("div",{className:"start-menu-action-list start-menu-actions-bottom"},uo.map(c=>{const _={className:"start-menu-action-item-icon",style:{},innerHTML:""};return c.iconType==="image"?_.style.backgroundImage=`url(${c.icon})`:_.innerHTML=c.icon,v("div",{className:"start-menu-action-item flex items-center",onclick:y=>{c.onclick(y),G(e)&&e(c)}},[v("div",_),v("div",null,c.text)])}))])}function mo(e){const c=Zn();return v("div",{className:"start-menu-column  start-menu-apps-list-container w-full h-full flex flex-col flex-1"},[v("div",{className:"start-menu-apps-list w-full h-full scrollable scroll-y"},Object.keys(c).map((y,k)=>v("div",{key:"app-item"+k,className:"start-menu-apps-list-section"},[v("div",{className:"start-menu-apps-list-label flex items-center"},y),v("div",{className:"start-menu-apps-list-items"},c[y].map((L,C)=>v("div",{key:"app-item"+C,className:"start-menu-apps-list-item flex items-center",onclick:e.bind(null,L)},[v("div",{className:"start-menu-apps-list-item-icon flex-shrink-0",style:{backgroundImage:`url(${L.icon})`}}),v("div",{className:"start-menu-apps-list-item-name"},v("div",{className:"text-ellipsis"},L.productName))])))])))])}function po(e){let c;function _(L){c.toggleShow(),He(L.name)}function y(){}function k(L){G(L)&&!L.preventClose&&c.toggleShow()}return c=Lt({noBorder:!0,width:524,height:(e==null?void 0:e.height)||540,className:"start-menu"},v("div",{className:"w-full h-full flex"},[fo(k),mo(_)]),{onHide:y}),c}const _s=po();function go(){let e=v("div",{className:"window-container",style:{position:"fixed",top:0,left:0}});document.body.appendChild(e);function c(L){e.appendChild(L)}function _(){e.style.display="none"}function y(){e.style.removeProperty("display")}function k(L){e.classList[L?"add":"remove"]("fullscreen")}return{addWindow:c,show:y,hide:_,toogleFullScreen:k}}const vi=go();function vo(e){let c;function _(L){const C=L.target;c!=null&&c.contains(C)||(k(),e.onClose&&e.onClose())}function y(){vi.hide(),We.showDesktopIcons(!1);const L=Eo().toReversed();c=v("div",{className:"taskview flex flex-col",style:{transform:"scale(1.2)"},onclick(){k()}},[v("div",{className:"taskview-header flex-shrink-0 flex items-center",style:{paddingInline:"40px"}},[v("div",{className:"taskview-header-button flex items-center",onclick(C){C.stopPropagation()}},[v("div",{className:"taskview-header-button-icon flex items-center content-center",innerHTML:Gi(),style:{width:"24px",height:"24px"}}),v("div",{className:"taskview-header-button-text",style:{marginLeft:"10px"}},"New windows group")])]),v("div",{className:"taskview-app-items flex-1"},L.map(C=>{const i=parseInt(C.element.style.width),n=parseInt(C.element.style.height),l=C.element.cloneNode(!0);l.classList.add("taskbar-app-item-window"),l.style.pointerEvents="none";const m=Array.from(C.element.getElementsByTagName("video")),s=Array.from(l.getElementsByTagName("video")),h=Array.from(l.getElementsByTagName("audio"));for(let a=0;a<s.length;a++){const o=s[a];o.muted=!0,o.pause(),o.controls=!1,o.currentTime=m[a].currentTime}for(let a of h)a.muted=!0,a.pause(),a.controls=!1;let f=160/n,d=!1;f*i>=400&&(d=!0,f=400/i);const u=Math.round(f*i);l.style.transform=`scale(${f})`;const t={width:u+"px"};return d&&(t.height=Math.round(f*n)+"px"),v("div",{className:"taskview-app-item",onclick(a){a.stopPropagation(),C.show(),C.focus(),k()}},[v("div",{className:"taskview-app-item-header flex",style:{marginBottom:"5px",width:u+"px"}},[v("div",{className:"taskview-app-item-icon flex-shrink-0",style:{width:"32px",height:"32px",backgroundImage:`url(${C.icon})`,backgroundRepeat:"no-repeat",backgroundSize:"24px",backgroundPosition:"center"}}),v("div",{className:"taskview-app-item-text flex items-center"},v("div",{title:C.title,className:"text-ellipsis line-clamp-1"},C.title)),v("div",{title:"Close",className:"taskview-app-item-close flex items-center content-center flex-shrink-0",style:{width:"32px",height:"32px",marginLeft:"auto"},innerHTML:Vs,onclick(a){a.stopPropagation(),C.close(),k()}})]),v("div",{className:"taskview-app-thumbnail",style:t},l)])}))]),document.body.appendChild(c),document.addEventListener("click",_,!1),setTimeout(()=>{c.style.transform="scale(1)"},0),e.onShow&&e.onShow()}function k(){document.removeEventListener("click",_,!1),G(c)&&de(c,{transform:"scale(1.5)",opacity:"0"}),vi.show(),ve.getState("showDesktopIcons").showDesktopIcons&&We.showDesktopIcons(!0),setTimeout(()=>{c==null||c.remove(),c=null,e.onClose&&e.onClose()},150)}return{element:c,show:y,close:k}}function _o(){let e=!1,c=vo({onClose:_});function _(){e=!1}return{element:v("div",{title:"Task View",className:"taskbar-item h-full flex-shrink-0",onclick:k=>{k.stopPropagation(),mt(),Ee(re.closePopup),e?(e=!1,c.close()):(e=!0,c.show())},onmousedown:k=>k.stopPropagation()},v("div",{className:"taskbar-item-button flex items-center content-center h-full",style:{width:"40px"},innerHTML:Rr(20)}))}}function nn(e){let c,_;const y={};e.width&&(y.width=Oi(e.width)?e.width+"px":e.width.toString());function k(s){s.preventDefault(),_.classList.add("focus")}function L(){_.classList.remove("focus")}_=v("div",{className:"textbox flex items-center",style:y},[c=v("input",{name:"search-input",autocomplete:"off",type:e.type||"text",className:"textbox-input",placeholder:e.placeholder,oninput:C,onfocus:k,onblur:L}),typeof e.optional=="function"?e.optional(e):e.optional]);function C(s){s.preventDefault(),typeof e.onChange=="function"&&e.onChange(c.value)}function i(s){c.value=s}function n(s){c.placeholder=s}function l(){c.focus()}function m(){c.value=""}return{element:_,setValue:i,setPlaceHolder:n,focus:l,clear:m}}function ki(e){const c=nn({placeholder:e.placeholder,value:e.value,onChange:e.onChange,optional:()=>v("div",{className:"search-box-icon flex items-center content-center",innerHTML:qs}),...e});return{element:c.element,setPlaceHolder:c.setPlaceHolder,focus:c.focus,clear:c.clear}}function wo(){let e=ki({placeholder:"Type here to search"});const c=[se.settings,se.notepad,se.explorer,se.photos,se.calculator];function _(){e.focus()}function y(){e.clear()}let k=Lt({className:"search-popup"},v("div",{className:"search-container flex flex-col p-20"},[v("div",{className:"search-popup-top flex-1"},[v("div",{style:{fontWeight:"bold"}},"Top Apps"),v("div",{className:"search-popup-apps"},[c.map(L=>v("div",{className:"search-popup-app-item",onclick(){k.close(),Zt({...L,type:"app"})}},[v("div",{className:"search-popup-app-item-icon",style:{backgroundImage:`url(${L.icon})`}}),v("div",{className:"search-popup-app-item-text"},L.productName)]))])]),v("div",{className:"search-popup-bottom"},[v("div",{className:"search-popup-filter flex"},[v("div",{className:"search-popup-filter-item selected"},"All"),v("div",{className:"search-popup-filter-item"},"Apps"),v("div",{className:"search-popup-filter-item"},"Settings"),v("div",{className:"search-popup-filter-item"},"Folders"),v("div",{className:"search-popup-filter-item"},"Documents"),v("div",{className:"search-popup-filter-item"},"Web"),v("div",{className:"search-popup-filter-item"},"Photos"),v("div",{className:"search-popup-filter-item"},"Music"),v("div",{className:"search-popup-filter-item"},"Videos")]),v("div",{className:"search-popup-input"},e.element)])]),{onShow:_,onHide:y});return k}function bo(){let e=wo();const c=v("div",{title:"Search",className:"taskbar-item h-full flex-shrink-0",onclick:()=>{mt(),Ee(re.closePopup,e.id),e.toggleShow({left:Math.round(c.getBoundingClientRect().left)})},onmousedown:_=>_.stopPropagation()},v("div",{className:"taskbar-item-button taskbar-item-button-search flex items-center content-center h-full",style:{width:"40px"},innerHTML:qs}));return{element:c}}function yo(){Ee(re.showDesktopHover)}function So(){Ee(re.showDesktopOut)}function rn(){Ee(re.showDesktop)}function xo(){function e(){mt(),Ee(re.closePopup,_s.id),_s.toggleShow()}function c(k){k.stopPropagation(),k.preventDefault(),Ot({top:k.y,left:k.x},k.currentTarget,[{text:"Apps and Features",onClick:()=>{He(se.settings.name,"apps")}},{text:"Mobility Center"},{text:"Power Options"},{text:"Event Viewer"},{text:"System"},{text:"Device Manager"},{text:"Network Connection"},{text:"Disk Management"},{text:"Computer Management"},{text:"Command Prompt(Admin)",onClick:()=>{He(se.terminal.name)}},{divider:!0},{text:"Task Manager"},{text:"Settings",onClick:()=>{He(se.settings.name)}},{text:"File Explorer",onClick:()=>{He(se.explorer.name)}},{text:"Search"},{text:"Run"},{divider:!0},{text:"Shutdown or signout",children:[{text:"Sign out"},{text:"Sleep"},{text:"Shut down"},{text:"Restart"}]},{text:"Desktop",onClick:()=>{rn()}}])}const y=[{name:"startMenu",item:to({isSystemApp:!0,name:"start-menu",productName:"Start",icon:wr,iconType:"svg"},{onclick:e,oncontextmenu:c})}].map(k=>k.item.element);return v("div",{className:"taskbar-app-items h-full flex flex-shrink-0 items-center content-center"},y)}function Co(){let e=[],c=localStorage.getItem("taskbarItems");if(typeof c>"u"||c===null)e=[{name:"explorer",item:pt(se.explorer,{onRemove:k}),pinned:!0},{name:"settings",item:pt(se.settings,{onRemove:k}),pinned:!0},{name:"notepad",item:pt(se.notepad,{onRemove:k}),pinned:!0},{name:"calculator",item:pt(se.calculator,{onRemove:k}),pinned:!0},{name:"photos",item:pt(se.photos,{onRemove:k}),pinned:!0},{name:"cmd",item:pt(se.cmd,{onRemove:k}),pinned:!0}];else try{c&&(c=JSON.parse(c),c instanceof Array&&(e=c.map(d=>({name:d,item:pt(se[d],{onRemove:k}),pinned:!0}))))}catch{}let _;const y=v("div",{className:"w-full h-full flex content-center"},[_=v("div",{className:"taskbar-app-items h-full flex items-center content-center"},e.map(d=>d.item.element))]);function k(){}function L(d){return e.find(u=>u.name===d)}function C(d,u){const t={name:d,item:u};return e.push(t),_.appendChild(u.element),t}function i(d){e=e.filter(u=>u.name!==d)}function n(d,u,t){d.item.addInstance&&d.item.addInstance(u,t)}function l(d,u,t){const a=L(d);if(a)n(a,u,t);else{let o=pt({name:t.name,productName:t.productName,icon:t.icon});const r=C(d,o);n(r,u,t),e.push({name:d,item:o})}}function m(d,u){const t=L(d);t&&(t.item.removeInstance(u),t.item.getInstances().length||(t.pinned?t.item.removeActive(u):(t.item.remove(),i(d))))}function s(d,u){const t=L(d);t&&t.item.setActive(u)}function h(d,u){const t=L(d);t&&t.item.removeActive(u)}function f(d){return L(d).item.element.getBoundingClientRect()}return{element:y,addInstance:l,removeAppItem:i,removeInstance:m,setActiveWindow:s,removeActiveWindow:h,getAppItemBounds:f}}function ko(){const e=Co(),c=v("div",{className:"taskbar fixed bottom w-full",style:{height:Fe+"px"}},v("div",{className:"taskbar-inner flex h-full",oncontextmenu:_},[v("div",{className:"taskbar-left h-full flex-1 flex-shrink-0 flex items-center"},[xo(),ro().element,ao().element,_o().element,bo().element]),v("div",{className:"taskbar-center flex-2 h-full"},e.element),v("div",{className:"taskbar-right h-full flex-1 flex-shrink-0 relative flex items-center content-end",style:{paddingRight:"6px"}},[v("div",{title:"Show hidden icons",className:"taskbar-item flex items-center content-center flex-shrink-0 taskbar-item-more",innerHTML:Ks}),v("div",{className:"taskbar-item flex items-center content-center flex-shrink-0",onmousedown:y=>y.stopPropagation(),onclick:()=>{mt(),Ee(re.closePopup,vs.id),vs.toggleShow()}},[v("div",{className:"taskbar-item-button flex items-center content-center h-full flex-shrink-0",style:{width:Fe+"px"},innerHTML:$s}),v("div",{className:"taskbar-item-button flex items-center content-center h-full flex-shrink-0",style:{width:Fe+"px"},innerHTML:Ws}),v("div",{className:"taskbar-item-button flex items-center content-center h-full flex-shrink-0",style:{width:Fe+"px"},innerHTML:Us})]),so().element,v("div",{className:"show-desktop flex-shrink-0",onmouseover:yo,onmouseout:So,onclick:rn})])]));function _(y){Ot({top:y.y,left:y.x},y.currentTarget,[{text:"Taskbar Settings",onClick:()=>{He("settings","personalization/taskbar")}},{text:"Lock the taskbar",checked:!0,onClick:()=>{console.log("Lock taskbar")}}])}return it(document.body,c),e}const Rt=ko(),Oe=[],et=[];let Gt=[],li=!1;function Eo(){return et}function Lo(e){const c=Gt.findIndex(_=>_.window.id===e);c>-1&&Gt.splice(c,1)}function Do(e){const c=et.findIndex(_=>_.id===e.id);c>-1&&et.splice(c,1),et.push(e)}function To(e){const c=et.findIndex(_=>_.id===e);if(c>-1&&(et.splice(c,1),et.length>0)){const _=et[et.length-1];_.isVisible()&&_.focus()}}function Yi(e){const c=Oe.length;for(let _=0;_<c;_++)e(Oe[_])}function Ji(e){return Oe.find(c=>c.appName===e)}function Mo(e,c,_){li=!1;const y=Oe.length;for(let k=0;k<y;k++){const L=Oe[k];L.window.decrementZIndex(),L.window.blur()}Oe.push({appName:e,id:c,window:_}),Rt.addInstance(e,c,_)}function Io(e,c){const _=Oe.findIndex(y=>y.id===c);_>-1&&(Oe.splice(_,1),Rt.removeInstance(e,c)),To(c),Lo(c)}function Bo(e,c,_){_.restoreZIndex(),Do(_);const y=Oe.length;for(let k=0;k<y;k++){const L=Oe[k];L.id!==c&&(L.window.decrementZIndex(),L.window.blur())}}function Ro(e){const c=Oe.length;for(let _=0;_<c;_++){const y=Oe[_];y.id!==e?y.window.isVisible()&&y.window.makeTransparent():y.window.element.classList.add("top-view")}}function Ao(e){if(e){const c=Oe.length;for(let _=0;_<c;_++){const y=Oe[_];y.id!==e?y.window.isVisible()&&y.window.removeTransparent():y.window.element.classList.remove("top-view")}}else{const c=Oe.length;for(let _=0;_<c;_++){const y=Oe[_];y.window.isVisible()&&y.window.removeTransparent()}}}function No(){Yi(e=>{e.window.blur()})}function Po(){const e=Oe.some(c=>c.window.isFullScreen);vi.toogleFullScreen(e)}window.addEventListener("resize",()=>{const e=Oe.length;for(let c=0;c<e;c++){const _=Oe[c];_.window.isMaximized()&&_.window.maximize()}},!1);function Ho(){if(!li)Gt=Oe.filter(e=>e.window.isVisible()),Gt.forEach(e=>{e.window.removeTransparent(),e.window.hide()});else{Gt.forEach(c=>{c.window.removeTransparent(),c.window.show()});const e=et[et.length-1];e&&e.isVisible()&&e.focus()}li=!li}Be(re.viewWindow,"window-manager",e=>{Ro(e.id)});Be(re.restoreView,"window-manager",e=>{Ao(e.id)});Be(re.showDesktopHover,"window-manager",()=>{Yi(e=>{e.window.isVisible()&&e.window.makeTransparent()})});Be(re.showDesktopOut,"window-manager",()=>{Yi(e=>{e.window.isVisible()&&e.window.removeTransparent()})});Be(re.showDesktop,"window-manager",()=>{Ho()});Be(re.blurAllWindow,"window-manager",()=>{No()});function Oo(){let e=0,c=0;function _(){e=window.innerWidth,c=window.innerHeight}return _(),window.addEventListener("resize",_,!1),{get width(){return e},get height(){return c}}}let ye=Oo();const ws=1e5,Ke=30;function at(e){let c={...e};const _={};if(e.singleInstance){let U=Ji(e.name);if(U)return U.window.executeListeners("secondInstance",e.args),U.window}let y,k=ws;const L=xi(32);let C,i=!1,n=!1,l=!1,m=!1,s=!1,h=!1,f="",d=!1,u=!1,t=!1,a,o=!1;function r(U,oe){_[U]||(_[U]=[]),_[U].push(oe)}function p(U,oe){const Ae=_[U];if(Ae)for(let rt=0;rt<Ae.length;rt++)Ae[rt](oe)}let g=e.title||"",E=gr({icon:e.icon,hideIcon:e.hideIcon,title:e.title,hideTitle:e.hideTitle,disableMaximize:e.disableMaximize,maximized:e.maximized,autoHide:e.autoHideTitleBar,content:e.titlebarContent,stretchTitlebarContent:e.stretchTitlebarContent},{onMinimizeButtonClick:he,onMaximizeButtonClick:ze,onCloseButtonClick:On,onVisible:()=>p("ontitlebarshow"),onHidden:()=>p("ontitlebarhide")}),T={top:0,left:0,width:0,height:0};const w={zIndex:k.toString()};let x=0,I=0,B=300,S=200,M=300,P=200,H=!1,N=0;e.keepAspectRatio&&(H=e.keepAspectRatio),e.minWidth&&(M=e.minWidth),e.minHeight&&(P=e.minHeight),e.top&&(x=Number(e.top)),e.left&&(I=Number(e.left)),e.width&&(B=Number(e.width),B<M&&(B=M)),e.height&&(S=Number(e.height),S<P&&(S=P)),e.center&&(x=Math.round((window.innerHeight-S-Fe)/2),I=Math.round((window.innerWidth-B)/2)),H&&(N=B/S),w.top=x+"px",w.left=I+"px",w.minWidth=M+"px",w.width=B+"px",w.height=S+"px",w.minHeight=P+"px",T={top:x,left:I,width:B,height:S};let F="";e.noBorder&&(F+=" no-border"),e.className&&(F+=" "+e.className);let b="window-content";e.fluidContent&&(b+=" fluid"),e.transprencyContent||(b+=" theme-background");let D,R,O,z,W,j,X,ie,A,$,q,V,K,Z={top:!1,left:!1,right:!1,topLeft:!1,topRight:!1,bottomLeft:!1,bottomRight:!1},ce=!0;const ke=()=>{let oe=[{text:"Restore",icon:v("i",{className:"window-titlebar-context-icon",innerHTML:Ai}),disabled:!n,onClick:()=>{Tt()},emphasis:n},{text:"Move",disabled:!0},{text:"Size",disabled:!0},{text:"Minimize",icon:v("i",{className:"window-titlebar-context-icon",innerHTML:Os}),onClick:()=>{si()}},{text:"Maximize",icon:v("i",{className:"window-titlebar-context-icon",innerHTML:Ni}),onClick:()=>{Tt()},disabled:e.disableMaximize||n},{divider:!0},{text:"Close",icon:v("i",{className:"window-titlebar-context-icon",innerHTML:Fs}),onClick:()=>{Ti()},shortcut:"Alt+X"}];return G(e.extendContextMenu)&&(oe=oe.concat(e.extendContextMenu)),oe},ee=e.disableResize?" disabled":"";K=v("div",{tabIndex:-1,className:"window"+F,style:w,id:L},[v("div",{className:"window-background absolute w-full h-full"}),v("div",{className:"window-inner relative w-full h-full"},[E.element,C=v("div",{className:b})]),D=v("div",{"data-resize":"t",className:"window-resize-handle window-resize-horizontal window-resize-top"+ee}),O=v("div",{"data-resize":"b",className:"window-resize-handle window-resize-horizontal window-resize-bottom"+ee}),R=v("div",{"data-resize":"l",className:"window-resize-handle window-resize-vertical window-resize-left"+ee}),z=v("div",{"data-resize":"r",className:"window-resize-handle window-resize-vertical window-resize-right"+ee}),W=v("div",{"data-resize":"tl",className:"window-resize-handle window-resize-conner window-resize-nw window-resize-tl window-resize-tl-v"+ee}),j=v("div",{"data-resize":"tl",className:"window-resize-handle window-resize-conner window-resize-nw window-resize-tl window-resize-tl-h"+ee}),A=v("div",{"data-resize":"br",className:"window-resize-handle window-resize-conner window-resize-nw window-resize-br window-resize-br-v"+ee}),$=v("div",{"data-resize":"br",className:"window-resize-handle window-resize-conner window-resize-nw window-resize-br window-resize-br-h"+ee}),X=v("div",{"data-resize":"bl",className:"window-resize-handle window-resize-conner window-resize-ne window-resize-bl window-resize-bl-v"+ee}),ie=v("div",{"data-resize":"bl",className:"window-resize-handle window-resize-conner window-resize-ne window-resize-bl window-resize-bl-h"+ee}),q=v("div",{"data-resize":"tr",className:"window-resize-handle window-resize-conner window-resize-ne window-resize-tr window-resize-tr-v"+ee}),V=v("div",{"data-resize":"tr",className:"window-resize-handle window-resize-conner window-resize-ne window-resize-tr window-resize-tr-h"+ee})]),K.addEventListener("customdrop",U=>{p("customdrop",U.detail)},!1),typeof e.titlebarHeight=="number"&&e.titlebarHeight>0&&J(e.titlebarHeight);function J(U){K.style.setProperty("--titlebar-height",U+"px")}vi.addWindow(K);let Y=!1;K.addEventListener("animationend",()=>{Y||(p("ready"),Y=!0),p("animationend")});let te=new ResizeObserver(U=>{if(!o&&!u){if(n||h){const oe=U[0].contentRect;x=oe.top,I=oe.left,B=oe.width,S=oe.height}l||p("passiveResize")}});te.observe(K);let ae;e.autoHideTitleBar&&(K.addEventListener("mouseover",fe,!1),K.addEventListener("mouseout",ne,!1),K.addEventListener("mousemove",pe,!1)),K.addEventListener("mousedown",Q,!1);function fe(){ae&&clearTimeout(ae),E.setAutoHide(!1),t&&E.setAutoHide(!0)}function pe(){ae&&clearTimeout(ae),E.setAutoHide(!1),ae=setTimeout(()=>{t&&E.setAutoHide(!0)},100)}function ne(){ae&&clearTimeout(ae),t&&E.setAutoHide(!0)}function le(U){t=U,E.setAutoHide(U)}function Te(U){ft(C),it(C,U),be()}function ge(U,oe){let Ae=[Je(U,D,H,N,oe),Je(U,O,H,N,oe),Je(U,R,H,N,oe),Je(U,z,H,N,oe),Je(U,W,H,N,oe),Je(U,j,H,N,oe),Je(U,X,H,N,oe),Je(U,ie,H,N,oe),Je(U,A,H,N,oe),Je(U,$,H,N,oe),Je(U,q,H,N,oe),Je(U,V,H,N,oe)];function rt(Ii){for(let yt=0;yt<Ae.length;yt++)Ae[yt].setAspectRatio(Ii)}function Mi(Ii){for(let yt=0;yt<Ae.length;yt++)Ae[yt].setKeepAspectRatio(Ii)}return{setAspectRatio:rt,setKeepAspectRatio:Mi}}function Ue(){o=!1,T=bt(),p("resizeend"),ss()}e.disableResize||(a=ge(K,{onResizeStart:()=>p("resizestart"),onResize:U=>{o=!0,x=U.top,I=U.left,B=U.width,S=U.height,p("resize",{width:B,height:S})},onResizeEnd:Ue})),document.addEventListener("mousedown",we,!1);function we(U){const oe=U.target;K.contains(oe)||as()}function Q(){Ft()}function he(){si()}function _e(){p("minimize")}function Re(){p("maximize")}function me(){K.offsetWidth,n||K.classList.remove("window-maximized"),p("restore")}function ze(){Tt()}function be(){Array.from(K.querySelectorAll("[drag-region=drag]")).forEach(oe=>{oe.oncontextmenu=In,oe.ondblclick=Mn,zs(K,oe,{onDragStart:()=>p("dragstart"),onDrag:kn,onDragEnd:ss})})}be();function Xe(U,oe){Z[U]||(Z[U]=!0,K.classList.add("max-z-index"),Object.keys(Z).forEach(Ae=>{Ae!==U&&(Z[Ae]=!1)}),ce=!1,oe())}function ii(U){ce||(ce=!0,K.classList.remove("max-z-index"),Object.keys(Z).forEach(oe=>{Z[oe]=!1}),U())}function kn(U,oe){x=oe.top,I=oe.left,is(U),p("drag",U)}function is(U){setTimeout(()=>{if(n||d){const oe=bt(),Ae=Math.round((U.x-oe.left)/oe.width*T.width),rt=U.x-Ae;let Mi=U.y-oe.top;Ze({...T,top:n?0:U.y-Mi,left:rt}),d&&(d=!1,Dn()),n&&(n=!1,E.setMaximize(n),K.classList.remove("window-maximized"),p("unmaximize"))}},0),e.disableResize||(U.y<=0&&U.x<=Ke||U.x<=0&&U.y<=Ke?Xe(xe.topLeft,()=>{f=xe.topLeft,We.showShape(xe.topLeft,T)}):U.y<=0&&U.x>=ye.width-Ke||U.x>=ye.width-1&&U.y<=Ke?Xe(xe.topRight,()=>{f=xe.topRight,We.showShape(xe.topRight,T)}):U.y>=ye.height-Fe&&U.x<=Ke||U.x<=0&&U.y>=ye.height-Fe-Ke?Xe(xe.bottomLeft,()=>{f=xe.bottomLeft,We.showShape(xe.bottomLeft,T)}):U.y>=ye.height-Fe&&U.x>=ye.width-Ke||U.x>=ye.width-1&&U.y>=ye.height-Fe-Ke?Xe(xe.bottomRight,()=>{f=xe.bottomRight,We.showShape(xe.bottomRight,T)}):U.y<=0&&U.x>Ke&&U.x<ye.width-Ke?Xe(xe.top,()=>{f=xe.top,We.showShape(xe.top,T)}):U.x<=0&&U.y>Ke&&U.y<ye.height-Fe-Ke?Xe(xe.left,()=>{f=xe.left,We.showShape(xe.left,T)}):U.x>=ye.width-1&&U.y>Ke&&U.y<ye.height-Fe-Ke?Xe(xe.right,()=>{f=xe.right,We.showShape(xe.right,T)}):ii(()=>{f="",We.removeShape()}))}function En(){K.classList.add("window-restore-down"),setTimeout(()=>{K.classList.remove("window-restore-down")},100),p("unmaximize")}function Ln(){K.offsetTop<0&&(K.style.top=0+"px"),window.innerHeight-K.offsetTop<Fe+kt&&(K.style.top=window.innerHeight-(Fe+kt)+"px"),K.offsetLeft+K.offsetWidth<30&&(K.style.left=-100+"px"),window.innerWidth-K.offsetLeft<30&&(K.style.left=window.innerWidth-100+"px")}function Dt(){K.classList.add("win-snap")}function Dn(){K.classList.remove("win-snap"),p("unSnap")}function ss(){ns(),p("dragend",T)}function ns(){if(!n&&!c.disableMaximize&&!c.disableResize){if(f!==""&&!e.disableMaximize){d=!0;let U=Math.floor(ye.width/2),oe=ye.height-Fe,Ae=Math.floor(oe/2),rt=oe-Ae;U=Math.max(U,c.minWidth),Ae=Math.max(Ae,c.minHeight),f===xe.top?Tt(!0):f===xe.left?(Ze({top:0,left:0,width:U,height:oe}),Dt()):f===xe.right?(Ze({top:0,left:ye.width-U,width:U,height:oe}),Dt()):f===xe.topLeft?(Ze({top:0,left:0,width:U,height:Ae}),Dt()):f===xe.bottomLeft?(Ze({top:Ae,left:0,width:U,height:rt}),Dt()):f===xe.bottomRight?(Ze({top:Ae,left:ye.width-U,width:U,height:rt}),Dt()):f===xe.topRight&&(Ze({top:0,left:ye.width-U,width:U,height:Ae}),Dt()),p("snap")}else T=bt(),Ln();for(let U in Z)if(Z[U]){We.removeShape();break}}}function Ei(){f="",n=!0,e.disableMaximize||(Ze({top:0,left:0,width:window.innerWidth,height:window.innerHeight-Fe}),K.classList.add("window-maximized"),Re())}function Tn(){n=!1,e.disableMaximize||(Ze(T),K.classList.remove("window-maximized"),En())}function Tt(U){e.disableMaximize||(n=!n,n?(!U&&!d&&(T=bt()),T.top<0&&(T.top=0),Ei()):Tn(),E.setMaximize(n),K.focus())}function Mn(){Tt()}function In(U){U.preventDefault(),Ft(),Ot({top:U.y,left:U.x},U.currentTarget,ke(),!1,()=>{setTimeout(()=>{K&&!l&&Ft()},10)},!1)}function Ze(U){G(U.top)&&(x=U.top,K.style.top=U.top+"px"),G(U.left)&&(I=U.left,K.style.left=U.left+"px"),G(U.width)&&(B=U.width,K.style.width=U.width+"px"),G(U.height)&&(S=U.height,K.style.height=U.height+"px"),e.disableResize||a.setAspectRatio(B/S)}function bt(){const U=K.getBoundingClientRect();return{top:U.top,left:U.left,width:U.width,height:U.height}}function Bn(U){B=U.width,S=U.height,K.style.width=U.width+"px",K.style.height=U.height+"px",e.disableResize||a.setAspectRatio(B/S)}function rs(){K.style.zIndex=k.toString()}function Rn(){k-=1,rs()}function os(){k=ws,rs()}function Li(){K.classList.remove("top-view")}function Ft(){m||(K.focus(),K.classList.add("focus"),Li(),Bo(y.name,L,y),Rt.setActiveWindow(y.name,L),m=!0),setTimeout(()=>{p("focus",m)},0)}function as(){m=!1,K.classList.remove("focus"),Rt.removeActiveWindow(y.name,L),p("blur")}function ls(){K.classList.add("transparent"),i=!0}function cs(){K.classList.remove("transparent"),i=!1}function An(){i?cs():ls()}function Nn(){h=!h,h?(!n&&!d&&(T=bt()),K.classList.add("fullscreen"),E.setVisible(!1)):(n||Ze(T),E.setVisible(!0),K.classList.remove("fullscreen")),Po(),p("fullscreen",h)}function Pn(){return n}function hs(){u=!1,K.classList.remove("show"),K.removeEventListener("animationend",hs,!1)}function Di(){K.classList.remove("minimized"),Li(),l?(K.classList.add("window-restored"),K.style.transform="translate3d(0px,0px,0px)",setTimeout(()=>{me(),K.classList.remove("window-restored"),K.style.removeProperty("transform")},300)):s||(u=!0,K.classList.add("show"),K.addEventListener("animationend",hs,!1)),s=!0,l=!1,os(),n&&Ei()}function si(){Li();const U=Rt.getAppItemBounds(e.name);K.classList.remove("window-restored"),K.classList.remove("show"),K.classList.remove("focus"),K.classList.add("minimized");const oe=bt();setTimeout(()=>{K.style.transform=`translate3d(${U.left-oe.left}px, ${U.top}px, 0) scale(0.2)`},0),s=!1,m=!1,l=!0,e.name,Rt.removeActiveWindow(e.name,L),_e()}function Hn(){s?si():Di()}function On(){Ti()}function Ti(){te.disconnect(),document.removeEventListener("mousedown",we,!1),G(K)&&(K.className="window closing",p("close"),u=!0,K.addEventListener("animationend",()=>{u=!1,E.element.remove(),K.remove(),K=void 0,Io(e.name,L)}))}function Fn(){return s}function zn(){return m}function Wn(U){c.icon=U,E.setIcon(U)}function $n(U){g=U,E.setTitle(U)}function Un(){return g}function jn(U){K.style.top=U.top+"px",K.style.left=U.left+"px"}function Vn(){let U=Math.round((window.innerHeight-S-Fe)/2),oe=Math.round((window.innerWidth-B)/2);jn({top:U,left:oe})}function Kn(U){C.classList[U?"add":"remove"]("fluid")}return y={id:L,get icon(){return c.icon},get name(){return c.name},get productName(){return c.productName},get title(){return g},get isFullScreen(){return h},element:K,setContent:Te,show:Di,hide:si,titlebar:E,setAutoHideTitleBar:le,setIcon:Wn,setTitle:$n,getTitle:Un,setMaximize:E.setMaximize,toggleMaximize:Tt,maximize:Ei,decrementZIndex:Rn,restoreZIndex:os,focus:Ft,blur:as,makeTransparent:ls,removeTransparent:cs,toggleTransprent:An,toggleFullscreen:Nn,isMaximized:Pn,close:Ti,toggleShow:Hn,isVisible:Fn,isFocused:zn,getBounds:bt,setBounds:Ze,setSize:Bn,makeCenter:Vn,addEventListener:r,executeListeners:p,updateDragHandle:be,setTitlebarHeight:J,checkWindowSnap:is,setWindowSnap:ns,setFluidContent:Kn},typeof e.content=="function"&&Te(e.content(y)),Mo(e.name,L,y),Di(),setTimeout(()=>{Ft()},0),y}function on(e){let c;const _=lr({maxValue:e.maxValue,color:"#00b521"}),y=at({name:"explorer-transfer",title:"Copying...",icon:se.explorer.icon,width:500,height:120,minHeight:100,center:!0,disableMaximize:!0,disableResize:!0,content:()=>v("div",{className:"p-20 w-full h-full"},[c=v("div",{style:{marginBottom:"10px"},innerHTML:e.description}),v("div",{className:"w-full"},_.element)])});function k(n){_.setValue(n)}function L(n){y.setTitle(n)}function C(n){c.innerHTML=n}function i(){y.close()}return{setTitle:L,setDescription:C,setValue:k,close:i}}function Zi(e){let c,_,y,k=!0;function L(){const h={maxWidth:e.width+"px",maxHeight:e.height+"px",width:"100%",height:"100%"};if(G(e.parent)){const f=e.parent.getBoundingClientRect();h.top=Math.round((f.height-e.height)/2)+"px",h.left=Math.round((f.width-e.width)/2)+"px"}else h.top=Math.round((ye.height-kt)/2-Math.round(e.height/2))+"px",h.left=ye.width/2-Math.round(e.width/2)+"px";c=v("div",{className:"dialog-content zoom-in focus relative flex flex-col",style:h},[v("div",{className:"dialog-titlebar flex"},[y=v("div",{className:"dialog-titlebar-text w-full flex items-center"},v("div",{className:"text-ellipsis line-clamp-1"},e.title)),v("div",{className:"dialog-titlebar-buttons flex-shrink-0 flex items-center",style:{marginLeft:"auto"}},[v("div",{title:"Close",className:"window-titlebar-button window-titlebar-close-button flex items-center content-center",innerHTML:js,onclick:l})])]),v("div",{className:"w-full flex-1"},e.content),e.hideButtons?null:v("div",{className:"dialog-footer flex"},[v("button",{className:"dialog-footer-button button",onclick(){Se(e.onOK)&&e.onOK(),s()}},"OK"),_=v("button",{className:"dialog-footer-button button",onclick:()=>{s()}},"Cancel")])]),it(G(e.parent)?e.parent:document.body,c),e.hideButtons||_.focus(),zs(c,y),document.addEventListener("mousedown",C,!1)}L();function C(h){const f=h.target;c.contains(f)?k||(k=!0,i()):n()}function i(){c.classList.add("focus")}function n(){k=!1,c.classList.remove("focus")}function l(){s()}function m(){c.remove()}function s(){c.classList.add("closing"),document.removeEventListener("mousedown",C,!1),k=!1,c.addEventListener("animationend",m,!1)}return{element:c,close:s}}function Fo(e){return Zi({title:e.title,width:e.width||300,height:e.height||160,content:e.content,onOK:e.onOK})}function Hi(e){let c=e.getDate().toString();return e.getDate()<10&&(c="0"+c),`${qi[e.getDay()]}, ${vr[e.getMonth()]} ${c}, ${e.getFullYear()}`}function Et(e,c=!1){let _=e.getHours(),y=e.getMinutes(),k=e.getSeconds(),L=_>=12?"PM":"AM";return _=_%12,_=_||12,y=y<10?"0"+y:y,k=k<10?"0"+k:k,_+":"+y+(c?":"+k:"")+" "+L}function mt(){window.lastContextMenu&&window.lastContextMenu.close()}function zo(e,c){const _=v("img");_.onload=()=>{const y=_.naturalWidth,k=_.naturalHeight,L=y/k;c({width:y,height:k,ratio:L})},_.onerror=()=>{c()},Ge(e)?_.mySrc=e:_.src=e}function an(e){switch(e){case".jpg":case".png":case".webp":case".jfif":case".jpeg":return!0;default:return!1}}function ln(e,c,_=200){const y=document.createElement("canvas"),k=y.getContext("2d"),L=new Image,C=_;L.height=C,L.src=e,L.onload=()=>{const i=L.naturalWidth/L.naturalHeight,n=Math.round(C*i);y.width=n,y.height=C,k.drawImage(L,0,0,n,C);const l=y.toDataURL("image/png");fetch(l).then(m=>m.blob()).then(m=>{const s=URL.createObjectURL(m);c(s,m)})}}function Qi(e,c=!0){document.documentElement.classList[e?"add":"remove"]("dark"),c&&ut({dark:e}),Ee(re.themeChange,e)}function es(e,c=!0){document.documentElement.classList[e?"add":"remove"]("glass"),c&&ut({transparency:e}),Ee(re.transparentChange,e)}function G(e){return e!=null}function Oi(e){return typeof e=="number"}function Se(e){return typeof e=="function"}function Fi(e,c){switch(e.style.backgroundColor="var(--theme-background)",e.style.backgroundRepeat="no-repeat",e.style.backgroundPosition="center",c){case"fill":e.style.backgroundSize="cover";break;case"fit":e.style.backgroundSize="contain";break;case"stretch":e.style.backgroundSize="100% 100%";break;case"center":e.style.backgroundSize="cover";break;case"tile":e.style.backgroundSize="contain",e.style.backgroundRepeat="repeat";break;case"span":e.style.backgroundSize="cover",e.style.backgroundPosition="left top";break;default:e.style.backgroundSize="cover";break}}function zi(e){document.documentElement.classList.toggle("no-border-radius",!e),document.documentElement.classList.toggle("rounded-corner",e)}function Nt(e,c){document.documentElement.classList.toggle(e,c)}function cn(e){document.documentElement.classList.toggle("use-border",e)}function ci(e,c){e.addEventListener("mousedown",n,!1);let _,y,k=0,L=0,C={x:0,y:0},i=!1;function n(s){s.button===0&&(document.addEventListener("mousemove",l,!1),document.addEventListener("mouseup",m,!1),C.x=s.x,C.y=s.y)}function l(s){if(document.documentElement.style.cursor=s.ctrlKey?"copy":"default",(Math.abs(s.x-C.x)>1||Math.abs(s.y-C.y)>1)&&!i){i=!0;const f=e.getBoundingClientRect();k=s.x-f.left,L=s.y-f.top,_=e.cloneNode(!0),_.classList.add("drag-item"),de(_,{width:f.width+"px",height:f.height+"px"}),document.body.appendChild(_),e.dispatchEvent(new CustomEvent("customdragstart",{bubbles:!0,detail:c}))}G(_)&&de(_,{top:s.y-L+"px",left:s.x-k+"px"});const h=document.elementFromPoint(s.x,s.y);h instanceof Element&&(y!==h?(y=h,y.dispatchEvent(new CustomEvent("customdragover",{bubbles:!0,detail:c}))):y.dispatchEvent(new CustomEvent("customdrag",{bubbles:!0,detail:c})))}function m(s){document.documentElement.style.cursor="default",i&&(y.dispatchEvent(new CustomEvent("customdrop",{bubbles:!0,detail:c})),document.body.removeChild(_),i=!1),document.removeEventListener("mousemove",l,!1),document.removeEventListener("mouseup",m,!1)}}function ni(e,c){c.parentNode.insertBefore(e,c.nextSibling)}function hn(e,c=!0){document.documentElement.style.setProperty("--accent-color",`hsl(${e.h}, ${e.s}%, ${e.l}%)`),document.documentElement.style.setProperty("--accent-color-value",e.h.toString()),c&&ut({accentColor:e})}function Ge(e){let _=/[a-z]:[\\/](?:[^\\/:*?"<>|\r\n]+[\\/])*[^\\/:*?"<>|\r\n]*/.exec(e);return G(_)&&_[0]===_.input}function _t(e){const _=/^[a-zA-Z]:[\\/]?/.exec(e);return G(_)&&_[0]===_.input}function $t(e){const _=/(?:[\\/]?[^\\/:*?"<>|\r\n]+[\\/]?)*/.exec(e);return G(_)&&_[0]===_.input}function bs(e,c){return e.reduce((_,y)=>((_[c(y)]=_[c(y)]||[]).push(y),_),{})}function Wo(e,c){var _=5,y={r:0,g:0,b:0},k=document.createElement("canvas"),L=k.getContext("2d"),C,i,n=-4,l,m={r:0,g:0,b:0},s=0;const h=new Image;h.height=200,h.src=e,h.onload=()=>{const f=h.naturalWidth/h.naturalHeight;i=Math.round(200*f),L.drawImage(h,0,0,i,200);try{C=L.getImageData(0,0,i,200)}catch{c(y)}for(l=C.data.length;(n+=_*4)<l;)++s,m.r+=C.data[n],m.g+=C.data[n+1],m.b+=C.data[n+2];m.r=Math.floor(m.r/s),m.g=Math.floor(m.g/s),m.b=Math.floor(m.b/s),L.clearRect(0,0,i,200),c(m)}}function $o({r:e,g:c,b:_}){return e*.299+c*.587+_*.114>186?"#000":"#fff"}function ys(e){Wo(e,c=>{const _=$o(c);document.documentElement.style.setProperty("--contrast-text-color",_)})}function dn(e){Ge(e)?Ki(e,(c,_)=>{if(!c)try{const y=URL.createObjectURL(_);ys(y)}catch{}}):ys(e)}function un(e){Nt("use-titlebar-accent-color",e.useTitleBarAccentColor),Nt("use-startmenu-and-taskbar-accent-color",e.useTaskbarAndStartMenuAccentColor),Nt("use-window-border-accent-color",e.useWindowBorderAccentColor),hn(e.accentColor,!1),Qi(e.dark,!1),es(e.transparency,!1),We.setBackgroundImage(e.background,!1),We.setBackgroundStyle(e.backgroundImageStyle)}function ut(e){let{themes:c,themeIndex:_,customTheme:y}=ve.getState(["themes","themeIndex","customTheme"]);_>-1?y={...c[_],...e}:y={...y,...e},ve.setState({customTheme:y,themeIndex:-1}),Ee(re.customThemeChange)}function Uo(e){const c=ve.getState("recentImages").recentImages;if(G(c)){const _=c.find(y=>y.path===e.path);_?(c.splice(c.indexOf(_),1),c.unshift(e),ve.setState({recentImages:c})):(c.pop(),c.unshift(e)),ve.setState({recentImages:c})}}function ri(){window.location.reload()}function jo(){Fo({title:"Reset This PC",text:"Reset",content:v("div",{},[v("div",{style:{paddingInline:"10px",fontWeight:"bold"}},"Reseting will:"),v("ul",{},[v("li",null,"Change settings back to their defaults"),v("li",null,"Remove personal files")])]),onOK(){ve.reset();const e=indexedDB.deleteDatabase("Local Disk C");e.onsuccess=()=>{ri()},e.onerror=()=>{ri()},e.onblocked=()=>{ri()},e.onupgradeneeded=()=>{ri()}}})}function Vo(e){He("cmd",e)}function qt(e,c=0,_,y,k=[],L){const C=e.length-1,i=e[c];if(L=L||"",c>C){y(k);return}if(i.isFile)i.file(n=>{k.push({type:"file",path:_+L+"/"+n.name,file:n}),qt(e,c+1,_,y,k,L)});else if(i.isDirectory){let n=function(){m.readEntries(function(h){h.length>0?(s=s.concat(h),n()):s.length===0?qt(e,c+1,_,y,k,L):qt(s,0,_,f=>{const d=f.length;for(let u=0;u<d;u++)k.push(f[u]);qt(e,c+1,_,y,k,L)},[],l)})},l=L;l+="/"+i.name,k.push({type:"dir",path:_+l});let m=i.createReader(),s=[];n()}}function hi(e,c){const _=Array.from(c).map(y=>y.webkitGetAsEntry());qt(_,0,e,y=>{const k=y.length;let L=0;for(let l=0;l<k;l++)y[l].type==="file"&&(L+=y[l].file.size);let C=0;const i=on({maxValue:L,title:"Copying...",description:`Copying ${_.length} items from <span style="color: var(--blue-color)">Local machine</span> to <span style="color: var(--blue-color)">${nt(e)}</span>`});function n(l=0){if(l>=k){setTimeout(()=>{i.close()},1e3);return}const m=y[l];m.type==="file"?(C+=m.file.size,ue.writeFile(m.path,m.file,s=>{s&&console.log(s),i.setValue(C),n(l+1)})):m.type==="dir"&&ue.createFolder(m.path,s=>{n(l+1)})}n()})}function Ko(e,c){_((y,k)=>{if(!y){let L=function(m=0){if(m>=C){setTimeout(()=>{l.close()},1e3);return}const s=k[m];ue.unlink(s.location,h=>{h&&console.log(h),s.type==="file"&&(n+=s.size,l.setValue(n)),L(m+1)})};const C=k.length;let i=0;for(let m=0;m<C;m++)k[m].type==="file"&&(i+=k[m].size);if(i<10485760&&C<10){e.forEach(m=>{ue.unlink(m.location,s=>{s&&console.log(s)})});return}let n=0;const l=on({maxValue:i,title:"Removing...",description:`Removing ${C} items from <span style="color: var(--blue-color)">${nt(c)}</span>`});L()}});function _(y){let k=0,L=[];C();function C(){if(k===e.length){const n=L.concat(e);y(null,n);return}const i=e[k];i.type==="folder"?ue.readFolderRecursive(i.location,(n,l)=>{if(n){y(n);return}const m=l.map(s=>{const h={type:s.type,location:s.location};return s.type==="file"&&(h.size=s.size),h}).toReversed();L=L.concat(m),k++,C()}):(k++,C())}}}function fn(e){Lt({width:300,height:400,className:"openWith-popup"},v("div",{className:"w-full h-full p-20"},"How do you want to open this file?")).show()}function Qe(e){return`imgs/icons/${encodeURIComponent(e)}`}const je={blank:Qe("Blank.png"),image:Qe("Pictures file.png"),videos:Qe("Videos file.png"),audio:Qe("Audio file.png")},qo={"":{icon:je.blank,appName:"",description:"File"},".jpg":{icon:je.image,appName:"photoViewer",description:"Picture file"},".png":{icon:je.image,appName:"photoViewer",description:"Picture file"},".jfif":{icon:je.image,appName:"photoViewer",description:"Picture file"},".webp":{icon:je.image,appName:"photoViewer",description:"Picture file"},".jpeg":{icon:je.image,appName:"photoViewer",description:"Picture file"},".mp3":{icon:je.audio,appName:"mediaPlayer",description:"Audio file"},".aac":{icon:je.audio,appName:"mediaPlayer",description:"Audio file"},".ogg":{icon:je.audio,appName:"mediaPlayer",description:"Audio file"},".m4a":{icon:je.audio,appName:"mediaPlayer",description:"Audio file"},".flac":{icon:je.audio,appName:"mediaPlayer",description:"Audio file"},".wav":{icon:je.audio,appName:"mediaPlayer",description:"Audio file"},".mp4":{icon:je.videos,appName:"mediaPlayer",description:"Video file"},".mkv":{icon:je.videos,appName:"mediaPlayer",description:"Video file"},".webm":{icon:je.videos,appName:"mediaPlayer",description:"Video file"},".txt":{icon:Qe("Notes.png"),appName:"notepad",description:"Text Document File"},".exe":{icon:Qe("Notes.png"),appName:"",description:"Application"},".html":{icon:Qe("Notes.png"),appName:"notepad",description:"HTML Document"},".js":{icon:Qe("Notes.png"),appName:"notepad",description:"Javascript Source File"},".json":{icon:Qe("Notes.png"),appName:"notepad",description:"JSON File"},".css":{icon:Qe("Notes.png"),appName:"notepad",description:"CSS Source File"},".md":{icon:Qe("Notes.png"),appName:"notepad",description:"Markdown File"}},Pt=e=>{let c=qo[e];return G(c)||(c={appName:"",description:e.substring(1,e.length).toUpperCase()+" file",icon:je.blank,iconType:"image"}),c};function Xo(e){const{showDesktopIcons:c}=ve.getState("showDesktopIcons");return[{text:"View",children:[{text:"Large Icons",value:"large-icons"},{text:"Medium Icons",value:"medium-icons",checked:!0},{text:"Small Icons",value:"small-icons"},{divider:!0},{text:"Auto arrange icons"},{text:"Align icons to grid",checked:!0},{divider:!0},{text:"Show desktop icons",checked:c,onClick:e.onShowDesktopIconsClick}]},{text:"Sort by",children:[{text:"Name"},{text:"Size"},{text:"Item type"},{text:"Date Modified"}]},{text:"Refresh"},{divider:!0},{text:"Paste",disabled:!0},{text:"Paste shortcut",disabled:!0},{text:"Open command window here",icon:"imgs/icons/Apps/terminal.png",iconType:"image",onClick(){Vo(st.getState("USER_HOME").USER_HOME+"/Desktop")}},{divider:!0},{text:"New",children:[{text:"Folder",icon:"imgs/icons/Folder.png",iconType:"image"},{text:"Shortcut",iconType:"image",icon:"imgs/icons/Emblems/1010.png"},{divider:!0},{text:"Bitmap Image"},{text:"Rich Text Document"},{text:"Text Document",icon:"imgs/icons/Notes.png",iconType:"image",onClick:()=>{He(se.notepad.name)}}],emphasis:!0},{divider:!0},{icon:"imgs/icons/Desktop.png",iconType:"image",text:"Display settings",onClick:()=>{Zt({...se.settings,type:"app",args:"system/display"})}},{icon:"imgs/icons/Personalization.png",iconType:"image",text:"Personalize",onClick:()=>{Zt({...se.settings,type:"app",args:"personalization"})}}]}const di=st.getState("USER_HOME").USER_HOME+"/Desktop";function Go(){let e=[],c=[];const _=[{icon:"imgs/icons/Trash Empty.png",name:"explorer",productName:"Recycle Bin",args:"Recycle Bin",type:"app"},{...se.settings,type:"app"},{...se.notepad,type:"app"},{...se.explorer,type:"app"},{...se.photos,type:"app"},{...se.github,type:"link",args:"https://github.com/chrishtu/windows11"}];function y(s){n(),Zt(s)}const k=v("div",{className:"desktop-app-items absolute top flex flex-col flex-wrap"},_.map(s=>L(s)));ue.addEventListener("ready","desktop",()=>{const s=di;ue.readFolder(s,(h,f)=>{h||f.forEach(d=>{const u={type:d.type,args:s+"/"+d.name,name:d.name,productName:d.name,icon:d.icon||(d.type==="folder"?ot:null),iconType:"image"},t=L(u);k.appendChild(t)})})}),ue.addEventListener("added","desktop",s=>{ue.stats(s,(h,f)=>{const d=s.substring(di.length+1,s.length).split("/");if(!h&&s.includes(di)&&d.length===1){const u={type:f.type,args:s,name:f.name,productName:f.name,icon:f.icon||(f.type==="folder"?ot:null),iconType:"image"},t=L(u);k.appendChild(t)}})}),ue.addEventListener("removed","desktop",s=>{const h=k.querySelector(`[system-location="${s}"]`);G(h)&&h.remove()});function L(s){const h=Object.create(null);h.className="desktop-app-item-icon";let f=s.productName;if(h.style=Object.create(null),s.icon&&(s.iconType==="svg"?h.innerHTML=s.icon:h.style.backgroundImage=`url("${s.icon}")`),s.type==="file"){const u=Pt(As(s.args));u.icon?u.iconType==="svg"?h.innerHTML=u.icon:h.style.backgroundImage=`url("${u.icon}")`:h.style.backgroundImage='url("imgs/icons/Blank.png")',f=nt(s.args)}const d=v("div",{["system-location"]:s.args,className:"desktop-app-item",ondblclick:y.bind(null,s),onclick:u=>{const t=u.currentTarget;u.shiftKey||n(),t.classList.add("desktop-app-item-selected"),e.push(t)}},[v("div",h),v("div",{title:f,className:"desktop-app-item-label"},v("div",{className:"text-ellipsis line-clamp-2"},f))]);return ci(d,s),d}function C(s,h=!1){Array.from(k.children).forEach(d=>{const u=d.getBoundingClientRect();u.left+u.width<s.x1||u.left>s.x2||u.top+u.height<s.y1||u.top>s.y2?h||d.classList.remove("desktop-app-item-selected"):d.classList.add("desktop-app-item-selected")})}function i(){const s=Array.from(k.children);return e=s.filter(h=>h.classList.contains("desktop-app-item-selected")),c=s.filter(h=>!h.classList.contains("desktop-app-item-selected")),{items:s,selectedItems:e,notSelectedItems:c}}function n(){e.forEach(s=>{s.classList.remove("desktop-app-item-selected")}),e=[]}function l(s){k.classList.toggle("hidden",!s)}function m(){const{showDesktopIcons:s}=ve.getState("showDesktopIcons");l(!s),ve.setState({showDesktopIcons:!s})}return{element:k,selectItems:C,getItems:i,removeSelection:n,setShowDesktopIcons:l,toggleDesktopIcons:m}}function Yo(){const{backgroundImageStyle:e,showDesktopIcons:c}=ve.getState(["backgroundImageStyle","showDesktopIcons"]),_=Go();function y(r){r.preventDefault(),Ot({top:r.y,left:r.x},r.currentTarget,Xo({onShowDesktopIconsClick:_.toggleDesktopIcons}),!1,null,!1,"desktop-context-menu")}function k(r){r.preventDefault(),hi(di,r.dataTransfer.items)}let L=v("div",{className:"desktop-shape-presentation"}),C=v("div",{className:"desktop-selection-presentation"}),i=v("div",{className:"desktop fade-in",ondrop:k},[v("div",{className:"desktop-selection-handler",onmousedown:m,oncontextmenu:y}),C]),n=!1,l=null;function m(r){ve.getState("showDesktopIcons").showDesktopIcons&&(r.shiftKey||_.removeSelection(),r.button===0&&(n=!0,l={x:r.x,y:r.y},document.onmousemove=s,document.onmouseup=h))}function s(r){if(!n||Math.abs(r.x-l.x)<2&&Math.abs(r.y-l.y)<2)return;let p=0,g=0,E=0,T=0;r.x>l.x?(g=l.x,E=r.x-l.x):(g=r.x,E=l.x-r.x),r.y>l.y?(p=l.y,T=r.y-l.y):(p=r.y,T=l.y-r.y),de(C,{visibility:"visible",top:p+"px",left:g+"px",width:E+"px",height:T+"px"}),_.selectItems({x1:g,x2:g+E,y1:p,y2:p+T},r.shiftKey)}function h(){n=!1,de(C,{visibility:"hidden",width:"0px",height:"0px"}),_.getItems()}let f,d=!1;o(e),it(document.body,i),it(document.body,L),setTimeout(()=>{it(i,_.element),_.setShowDesktopIcons(c)},500);function u(r,p=!0){i.style.myBackgroundImage=r.path,p&&(ut({background:r}),Uo(r)),Ee(re.backgroundImageChange,r)}function t(r,p){f&&clearTimeout(f);const g=Math.floor(ye.width/2),E=ye.height-Fe,T=Math.floor(E/2);d||(r==="top"?de(L,{top:"10px",left:g+"px"}):r==="left"?de(L,{top:T+"px",left:"10px"}):r==="right"?de(L,{top:T+"px",left:ye.width+"px"}):r==="topLeft"?de(L,{top:"10px",left:"10px"}):r==="topRight"?de(L,{top:"10px",left:ye.width+"px"}):r==="bottomLeft"?de(L,{top:E+"px",left:"10px"}):r==="bottomRight"&&de(L,{top:E+"px",left:ye.width+"px"}),d=!0),f=setTimeout(()=>{r==="top"?de(L,{top:"10px",left:"10px",height:E-20+"px",width:ye.width-20+"px",transformOrigin:"top"}):r==="left"?de(L,{top:"10px",left:"10px",height:E-20+"px",width:g-10+"px",transformOrigin:"left"}):r==="right"?de(L,{top:"10px",left:g+"px",height:E-20+"px",width:g-10+"px",transformOrigin:"center right"}):r==="topLeft"?de(L,{top:"10px",left:"10px",height:T-10+"px",width:g-10+"px",transformOrigin:"left top"}):r==="topRight"?de(L,{top:"10px",left:g+"px",height:T-10+"px",width:g-10+"px",transformOrigin:"right top"}):r==="bottomLeft"?de(L,{top:T+"px",left:"10px",height:T-10+"px",width:g-10+"px",transformOrigin:"left bottom"}):r==="bottomRight"&&de(L,{top:T+"px",left:g+"px",height:T-10+"px",width:g-10+"px",transformOrigin:"right bottom"}),L.classList.add("show")},150)}function a(){d=!1,f&&clearTimeout(f),L.classList.remove("show"),L.style.top="0",L.style.left="0",L.style.width="0",L.style.height="0"}function o(r){Fi(i,r)}return{element:i,setBackgroundImage:u,setBackgroundStyle:o,showShape:t,removeShape:a,showDesktopIcons:_.setShowDesktopIcons}}const We=Yo();function Jo(e,c,_){let y,k,L,C=xi(32);const i={...e},n=20;G(i.id)?C=e.id:i.id=C;const l={};G(i.icon)&&(l.backgroundImage=`url(${i.icon})`);function m(){H(!0),c.onTabChange(i),c.onDragOver(i)}const s={};G(_)&&(s.position="absolute",s.left=_+"px"),y=v("div",{className:"tab",style:s},[v("div",{className:"tab-inner w-full h-full flex items-center",onmousedown:I,oncontextmenu:c.onContextMenu},[k=v("div",{className:"tab-icon h-full flex-shrink-0 background-icon",style:l}),v("div",{className:"tab-text h-full flex-1"},L=v("div",{className:"w-full h-full flex items-center"},i.text))]),v("div",{className:"tab-close-button h-full flex-shrink-0 flex items-center content center",innerHTML:Vs,onclick:()=>{b()}})]),y.addEventListener("customdragover",m,!1);let h,f,d,u=0,t=0,a=0,o=0,r=0,p=0,g=!1,E=!1,T=!1,w=0,x=!1;function I(D){D.button===0&&(Se(c.onTabChange)&&c.onTabChange(i),h=y.getBoundingClientRect(),d=y.parentElement.parentElement.getBoundingClientRect(),r=h.x,p=h.y,u=D.x-d.x,a=D.x,t=D.y-d.y,o=D.y,c.getTabCount()===1&&(x=!0),document.addEventListener("mousemove",B,!1),document.addEventListener("mouseup",S,!1))}function B(D){if(!g&&(Math.abs(D.x-a)>10||Math.abs(D.y-o)>10))x?(c.moveWindow({...i,element:y},{left:h.left,top:h.top,dl:D.x-h.left,width:h.width,height:h.height,deltaLeft:D.x-d.x,deltaTop:D.y-h.top+8}),S()):(g=!0,y.style.position="relative",y.style.removeProperty("left"),f=y.cloneNode(!0),f.classList.add("active"),f.classList.add("tab-clone"),de(f,{position:"absolute",top:h.top+"px",left:h.left+"px",width:h.width+"px",height:h.height+"px",pointerEvents:"none",zIndex:"10000000"}),document.body.appendChild(f),y.style.visibility="hidden",Se(c.onDragStart)&&c.onDragStart());else if(!x){if(g){let R=T?D.x-w:D.x-d.left-u+r;if(R<d.left&&(R=d.left),R+h.width>d.left+d.width&&(R=d.left+d.width-h.width),f.style.left=R+"px",R>=0){let O=document.elementFromPoint(D.x,D.y);if(G(O)){let z=O.closest(".tab");G(z)&&(D.x-a>0?ni(y,z):D.x-a<0&&ni(z,y)),a=D.x}}}if(D.x<d.left-n||D.x>d.left+d.width+n||D.y<d.top-n||D.y>d.top+d.height+n){let R=D.y-d.top-t+p;if(f.style.top=R+"px",!E){E=!0;const O=f.getBoundingClientRect();c.onDragOut({...i,element:y},{left:O.left,top:O.top,dl:D.x-O.left,width:h.width,height:h.height,deltaLeft:D.x-d.x,deltaTop:D.y-O.top+8}),S(),b(E)}}}}function S(){G(f)&&f.remove(),y.style.removeProperty("visibility"),document.removeEventListener("mousemove",B,!1),document.removeEventListener("mouseup",S,!1),Se(c.onDragEnd)&&c.onDragEnd(i,T),x=!1,T=!1,g=!1}function M(D){i.text=D,L.innerText=D}function P(D){i.icon=D,k.style.backgroundImage=`url(${D})`}function H(D){var R;y.classList[D?"add":"remove"]("active"),(R=y.previousElementSibling)==null||R.classList[D?"add":"remove"]("no-divider")}function N(D){T=!0,h=y.getBoundingClientRect(),d=y.parentElement.parentElement.getBoundingClientRect(),r=h.x,p=h.y,u=D.detail.x-d.x,a=D.detail.x,t=D.detail.y-d.y,o=D.detail.y;let R=D.detail.x-D.detail.dx;if(w=D.detail.dx,g=!0,f=y.cloneNode(!0),f.classList.add("active"),f.classList.add("tab-clone"),de(f,{position:"fixed",top:h.top+"px",left:R+"px",width:h.width+"px",height:h.height+"px",pointerEvents:"none",zIndex:"10000000"}),document.body.appendChild(f),y.style.visibility="hidden",Se(c.onDragStart)&&c.onDragStart(),R>=0){let O=document.elementFromPoint(D.detail.x,D.detail.y);if(G(O)){let z=O.closest(".tab");G(z)&&(D.detail.x-a>0?ni(y,z):D.detail.x-a<0&&ni(z,y)),a=D.detail.x}}document.addEventListener("mousemove",B,!1),document.addEventListener("mouseup",S,!1)}function F(D){i.content=D}function b(D){Se(c.onClose)&&c.onClose(i,D),y.remove()}return{id:i.id,element:y,setTitle:M,setIcon:P,setActive:H,triggerMouseMove:N,setContent:F,close:b}}function mn(e){let c,_;const y=[];function k(f){y.forEach(u=>u.setActive(!1));const d=y.find(u=>u.id===f);G(d)&&d.setActive(!0)}function L(f){return y.find(u=>u.id===f)}function C(f){return k(f.id),e.onTabChange(f),y.length}function i(f){const d=Jo(f,{onTabChange:C,onClose:e.onTabClose,onContextMenu:e.onContextMenu,updateDragHandle:e.updateDragHandle,onDrag:e.onDrag,onDragStart:e.onTabDragStart,onDragOver:e.onDragOver,onDragOut:e.onDragOut,onDragEnd:e.onDragEnd,getTabCount:e.getTabCount,moveWindow:e.moveWindow});return y.push(d),c.insertBefore(d.element,_),_.scrollIntoView(),k(d.id),d}function n(f){y.splice(y.findIndex(d=>d.id===f),1)}c=v("div",{className:"tabs w-full h-full flex"},[_=v("div",{className:"tabs-action-new flex items-center content-center"},v("div",{title:"New Tab",className:"tabs-action-new-button flex items-center content-center",onclick:e.onNewTabActionClick,innerHTML:Gi(18,2)})),v("div",{["drag-region"]:"drag",className:"h-full flex-1"})]);function l(){_.style.visibility="hidden"}function m(){_.style.visibility="visible"}function s(){c.classList.remove("no-scrollbar")}function h(){c.classList.add("no-scrollbar")}return{element:c,add:i,remove:n,getTab:L,setActiveTab:k,showNewButton:m,hideNewButton:l,enabledScrollbar:s,disabledScrollbar:h}}function Ss(e,c){let _,y=[];_=v("div",{className:"tree-view"+(c.className?" "+c.className:"")});function L(n,l,m=0,s=0,h=""){const f=l[m];let d,u;function t(o,r,p){var g;(g=p.children)!=null&&g.length?o.isShow===!1&&(L(d,p.children,0,s+10,h+=p.text+"/"),o.isShow=!0):typeof c.requestChildren=="function"&&c.requestChildren(p.location,E=>{p.children=E,L(d,E,0,s+10,h+=p.text+"/"),o.isShow=!0}),o.classList.toggle("show"),r.classList.toggle("show")}function a(o){c==null||c.onChange(o)}if(G(f)){const o={backgroundImage:`url(${f.icon})`};d=v("div",{isShow:!1,className:"tree-node"},v("div",{className:"tree-node-inner",style:{paddingLeft:s+"px"}},[v("div",{className:"tree-display flex items-center",ondblclick:r=>{r.stopPropagation(),!f.noToggle&&G(f.children)&&f.children.length>0&&t(d,u,f)},onclick:a.bind(null,f)},[f.noToggle?v("div",{className:"tree-node-action flex-shrink-0 flex items-center"}):u=v("div",{className:"tree-node-action flex-shrink-0 flex items-center",innerHTML:Ht,onclick:r=>{r.stopPropagation(),t(d,u,f)}}),v("div",{className:"tree-node-icon",style:o}),v("div",{className:"tree-node-text"},f.text)])])),n.appendChild(d),L(n,l,m+1,s,h),y.push({path:h+f.text,target:d,actionElement:u,currentData:f,toggleShow:t})}}L(_,[e]);function C(n){L(_,[n])}function i(n){return y.find(l=>l.path===n)}return{element:_,appendChild:C,getItem:i}}function Zo(e){let c;const{USER_HOME:_}=st.getState("USER_HOME");let y;function k(i){e==null||e.onChange({location:i.location,text:i.text,icon:i.icon,children:i.children,type:i.type})}function L(i,n){ue.readFolder(i,(l,m)=>{const s=m.filter(h=>h.type==="folder").map(h=>({text:h.name,icon:h.icon||ot,location:i+"/"+h.name,properties:h,type:"folder"}));n(s)})}const C=Ss({text:"Favourites",icon:"imgs/icons/Quick%20Access.png",location:"",type:"root",children:[{icon:"imgs/icons/Folder%20Documents.png",text:"Documents",location:_+"/Documents",children:[],type:"folder",noToggle:!0},{icon:"imgs/icons/Folder%20Downloads.png",text:"Downloads",location:_+"/Downloads",children:[],type:"folder",noToggle:!0}]},{onChange:k,className:"explorer-sidebar-item",requestChildren:L});return c=v("div",{tabIndex:-1,className:"explorer-sidebar scrollable flex-shrink-0"},C.element),indexedDB.databases().then(i=>{y=Ss({text:"This PC",icon:"imgs/icons/Computer.png",location:"",type:"root",children:[{text:"Code",icon:ot,location:"c:/Code",children:[],type:"folder"},{text:"Desktop",icon:Ie.desktop,location:_+"/Desktop",children:[],type:"folder"},{icon:Ie.document,text:"Documents",location:_+"/Documents",children:[],type:"folder"},{icon:Ie.download,text:"Downloads",location:_+"/Downloads",children:[],type:"folder"},{icon:Ie.pictures,text:"Pictures",location:_+"/Pictures",children:[],type:"folder"},{icon:Ie.music,text:"Music",location:_+"/Music",children:[],type:"folder"},{icon:Ie.videos,text:"Videos",location:_+"/Videos",children:[],type:"folder"}].concat(i.map(l=>{const m=l.name.split(" ");let s=m[m.length-1].toLowerCase()+":";return{text:l.name,location:s,icon:"imgs/icons/Drives/Hardrive%20Windows.png",children:[],type:"driver"}}))},{className:"explorer-sidebar-item",onChange:k,requestChildren:L});const n=y.getItem("This PC");G(n)&&n.toggleShow(n.target,n.actionElement,n.currentData),c.appendChild(y.element),setTimeout(()=>{c.focus()},200)}),{element:c}}function Qo(e){let c="",_=Zi({title:e.title,width:e.width||300,height:e.height||160,parent:e.parent,content:v("div",{className:"text-dialog flex items-center content-center h-full"},nn({placeholder:e.placholder,type:"text",value:e.text,onChange:y}).element),onOK:k});function y(L){c=L}function k(){typeof e.onSubmit=="function"&&e.onSubmit(c),_.close()}return _}function ea(e){let c;const _=e.options.map(n=>{let l={style:{}};return G(n.icon)&&(n.iconType==="svg"?l.innerHTML=n.icon:l.style.backgroundImage=`url(${n.icon})`),v("div",{className:"dropdown-option"+(n.disabled?" disabled":""),onclick:n.disabled?null:n.onClick},[v("div",{className:"dropdown-option-icon image-icon",...l}),v("div",{className:"dropdown-option-label"},n.text)])}),{offsetLeft:y,offsetTop:k,offsetHeight:L}=e.triggerElement;c=v("div",{className:"dropdown",style:{top:k+L+"px",left:y+"px"},onclick:n=>n.stopPropagation()},_),e.triggerElement.appendChild(c);function C(n){const l=n.target;c.contains(l)||i()}setTimeout(()=>{document.onmousedown=C,document.onkeydown=n=>{n.key===De.Escape&&i()}},10);function i(){c.remove(),G(e.triggerElement)&&e.triggerElement.focus()}return{element:c,close:i}}function ta(e){let c=v("div",{style:{width:"100%",height:"100%",backgroundImage:`url(${e.url})`,backgroundSize:e.imageSize||"100% 100%",backgroundPosition:"center center",backgroundRepeat:"no-repeat"}});function _(y){c.style.backgroundImage=`url(${y})`}return{element:c,setImage:_}}function Wi(){const{USER_HOME:e}=st.getState("USER_HOME"),c=[{name:"Code",icon:ot,path:"This PC/Code",location:"c:/Code",type:"folder"},{name:"Desktop",icon:Ie.desktop,path:"Desktop",location:e+"/Desktop",type:"folder"},{name:"Documents",icon:Ie.document,path:"Documents",location:e+"/Documents",type:"folder"},{name:"Downloads",icon:Ie.download,path:"Downloads",location:e+"/Downloads",type:"folder"},{name:"Pictures",icon:Ie.pictures,path:"Pictures",location:e+"/Pictures",type:"folder"},{name:"Music",icon:Ie.music,path:"Music",location:e+"/Music",type:"folder"},{name:"Videos",icon:Ie.videos,path:"Videos",location:e+"/Videos",type:"folder"},{name:"Local Disk (C:)",icon:Ie.driverC,path:"c:/",location:"c:",type:"driver"}],{USER_NAME:_}=st.getState("USER_HOME");return[...[{name:"Favourites",icon:"imgs/icons/Quick%20Access.png",path:"Favourites",location:"Favourites",type:"root",children:[c[2],c[3]],view:"mediumIcons",sortBy:"text",orderBy:"asc"},{name:"Recycle Bin",icon:"imgs/icons/Trash Empty.png",path:"Recycle Bin",location:"Recycle Bin",type:"root",children:[]},{name:"This PC",icon:Ie.thisPC,path:"This PC",location:"This PC",type:"root",children:c,group:{by:"type",orderBy:"desc"},view:"tiles",sortBy:"text",orderBy:"asc"},{name:_,icon:Ie.user,path:_,location:e,type:"folder"}],...c]}function ui(e){return e==="This PC"||e==="Favourites"||e==="Recycle Bin"}function ia(e){let c,_=s(e.actionEvents),y=n(e.history),k,L;c=v("div",{className:"explorer-toolbar flex-shrink-0"},[v("div",{className:"explorer-toolbar-drag w-full h-full",["drag-region"]:"drag"}),_.element,y.element]);let C=new ResizeObserver(()=>{y.toolbarPath.checkOverflow(),_.checkOverflow()});_.disableButtons(["undo","redo","paste"]),C.observe(c);function i(){let d,u,t,a,o,r=!1;function p(){r||(r=!0,d.value=a.path,d.select(),d.focus(),u.style.borderColor="var(--blue-color)",t.style.display="none")}function g(S=!1){r=!1,d.value="",u.style.borderColor="var(--border-color)",t.style.display="flex",S&&w.focus()}function E(S){if(S.key===De.Enter){const M=T(d.value);e.onItemClick({text:M,location:M}),g(!0)}}function T(S){return S.charAt(S.length-1)==="/"?S.substring(0,S.length-1):S}o=ta({url:ot,imageSize:"18px 18px"});let w=v("div",{className:"explorer-toolbar-path w-full flex",style:{height:"28px"},tabIndex:-1},[u=v("div",{className:"explorer-toolbar-path-box w-full h-full flex",style:{border:"1px solid var(--border-color)"}},[v("div",{className:"explorer-toolbar-path-icon h-full",style:{width:"32px"}},o.element),v("div",{className:"relative w-full h-full"},[v("div",{className:"absolute w-full h-full flex"},[d=v("input",{name:"path-input",autocomplete:"off",className:"explorer-toolbar-path-input w-full h-full",style:{left:0,top:0,border:0,outline:0,background:"none",color:"var(--primary-text-color)",font:"inherit"},onblur:()=>{g()},onkeydown:E}),v("div",{className:"explorer-toolbar-path-history flex-shrink-0 h-full flex items-center content-center",style:{width:"28px"},innerHTML:Ci()})]),t=v("div",{className:"explorer-toolbar-path-items w-full h-full absolute flex items-center",onclick:p,style:{left:0,top:0,zIndex:1,overflowX:"auto"}})])]),v("div",{className:"explorer-toolbar-path-refresh flex-shrink-0 flex items-center content-center",style:{width:"28px",border:"1px solid var(--border-color)",borderLeft:0},innerHTML:Wr(14,2)})]);function x(S){return v("div",{className:"explorer-toolbar-path-item flex h-full flex-shrink-0",onclick:P=>{P.stopPropagation()}},[v("div",{className:"explorer-toolbar-path-item-text flex items-center",onclick:()=>{const P=T(S.location);e.onItemClick({text:P,location:P})},title:S.text},v("div",{className:"text-ellipsis"},S.text)),v("div",{className:"explorer-toolbar-path-item-icon flex items-center content-center",innerHTML:Ht})])}function I(S){if(a=S,G(S.icon)&&o.setImage(S.icon),Ge(S.path)||_t(S.path)){let M="";const P=Wi(),H=S.path.replace(/\\+/g,"/").split("/").filter(N=>N!=="").map((N,F)=>{M+=N+"/";let b=N;if(F===0){const D=P.findIndex(R=>R.path===M);D>-1&&(b=P[D].name)}return{text:b,location:M}}).map(N=>x(N));H.unshift(x({text:"This PC",location:"This PC"})),ft(t),Ct(t,H)}else{const M=Wi(),P=S.path.replace(/\\/,"/").split("/").filter(H=>H!=="").map((H,N)=>{let F=H,b=H;const D=M.findIndex(R=>R.path===(N===0?H+"/":H));return D>-1&&(F=M[D].name,b=M[D].location),{text:F,location:b}}).map(H=>x(H));ft(t),Ct(t,P)}B()}function B(){const S=t.offsetWidth;t.scrollWidth>S&&(t.scrollLeft=S+t.scrollWidth)}return{element:w,setPath:I,checkOverflow:B}}function n(d){let u,t,a,o,r=ki({placeholder:"Search "}),p=i(),g="";u=v("div",{className:"explorer-toolbar-top flex items-center"},[v("div",{className:"explorer-toolbar-top-col explorer-toolbar-actions flex items-center"},[t=v("div",{className:"explorer-toolbar-actions-button",innerHTML:Nr(),onclick:d.onBackward}),a=v("div",{className:"explorer-toolbar-actions-button",innerHTML:Pr(),onclick:d.onForward}),o=v("div",{className:"explorer-toolbar-actions-button",innerHTML:Hr(),onclick:()=>{d.onGoUp(g)}})]),v("div",{className:"explorer-toolbar-top-col explorer-toolbar-path"},[p.element]),v("div",{className:"explorer-toolbar-top-col explorer-toolbar-search"},r.element)]);function E(w){r.setPlaceHolder(`Search ${w}`)}function T(w,x,I){const B=w.length;t.classList[x>0?"remove":"add"]("disabled"),a.classList[x>=B-1?"add":"remove"]("disabled");const S=I.split("/").filter(M=>M!=="");if(S.length>1){let M=[...S];M.pop(),g=M.join("/")}o.classList[S.length<=1?"add":"remove"]("disabled")}return{element:u,toolbarPath:p,setPlaceHolder:E,checkHistoryButtons:T}}function l(){Qo({title:k,placholder:"Enter folder name",parent:e.getContainer(),onSubmit(d){ue.createFolder(k+"/"+d,u=>{u&&Zi({title:"",width:300,height:150,parent:e.getContainer(),content:v("div",{className:"w-full h-full flex items-center content-center"},v("div",{className:"text-ellipsis line-clamp-1"},u.message))})})}}),L.close()}function m(d){const u=d.currentTarget,t=[{icon:"imgs/icons/Folder.png",iconType:"image",text:"Folder",onClick:()=>{l()},disabled:!G(k)||k===""||k==="This PC"||k==="Favourites"}];L=ea({triggerElement:u,options:t})}function s(d){let u,t,a,o,r=!1,p=!1,g={new:{onclick:m},undo:{onclick:d.onUndo},redo:{onclick:d.onRedo},copy:{onclick:d.onCopy},cut:{onclick:d.onCut},paste:{onclick:d.onPaste},open:{onclick:d.onOpen},delete:{onclick:d.onDelete},rename:{onclick:d.onRename}};u=v("div",{className:"explorer-toolbar-bottom flex items-center"},[t=v("div",{className:"explorer-toolbar-bottom-items h-full flex items-center"},[v("div",{className:"explorer-toolbar-group"},[g.new.elem=v("div",{className:"explorer-toolbar-bottom-item",onclick:m},[v("div",{className:"explorer-toolbar-bottom-item-icon",innerHTML:Gi(20,1.5)}),v("div",{className:"explorer-toolbar-bottom-item-text"},"New")])]),v("div",{className:"explorer-toolbar-group"},[g.undo.elem=v("div",{className:"explorer-toolbar-bottom-item",onclick:g.undo.onclick},[v("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/Undo.png)"}}),v("div",{className:"explorer-toolbar-bottom-item-text"},"Undo")]),g.redo.elem=v("div",{className:"explorer-toolbar-bottom-item",onclick:g.redo.onclick},[v("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/Redo.png)"}}),v("div",{className:"explorer-toolbar-bottom-item-text"},"Redo")])]),v("div",{className:"explorer-toolbar-group"},[g.copy.elem=v("div",{className:"explorer-toolbar-bottom-item",onclick:g.copy.onclick},[v("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/copy.png)"}}),v("div",{className:"explorer-toolbar-bottom-item-text"},"Copy")]),g.cut.elem=v("div",{className:"explorer-toolbar-bottom-item",onclick:g.cut.onclick},[v("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/scissors.png)"}}),v("div",{className:"explorer-toolbar-bottom-item-text"},"Cut")]),g.paste.elem=v("div",{className:"explorer-toolbar-bottom-item",onclick:g.paste.onclick},[v("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/clipboard.png)"}}),v("div",{className:"explorer-toolbar-bottom-item-text"},"Paste")])]),v("div",{className:"explorer-toolbar-group"},[g.open.elem=v("div",{className:"explorer-toolbar-bottom-item",onclick:g.open.onclick},[v("div",{className:"explorer-toolbar-bottom-item-icon",innerHTML:br}),v("div",{className:"explorer-toolbar-bottom-item-text"},"Open")])]),v("div",{className:"explorer-toolbar-group"},[g.delete.elem=v("div",{className:"explorer-toolbar-bottom-item",onclick:g.delete.onclick},[v("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Emblems/170.png)"}}),v("div",{className:"explorer-toolbar-bottom-item-text"},"Delete")]),g.rename.elem=v("div",{className:"explorer-toolbar-bottom-item",onclick:g.rename.onclick},[v("div",{className:"explorer-toolbar-bottom-item-icon",style:{backgroundImage:"url(imgs/icons/Misc/Rename.png)"}}),v("div",{className:"explorer-toolbar-bottom-item-text"},"Rename")])])]),o=v("div",{className:"explorer-overflow-action-more",style:{width:"30px",height:"30px",display:"none",marginInline:"10px"},innerHTML:Xs()},a=v("div",{className:"explorer-overflow-actions flex flex-col"})),v("div",{["drag-region"]:"drag",className:"h-full flex-1"})]);function E(){const I=t.offsetWidth,B=[];if(t.scrollWidth>I){const S=Array.from(t.children);for(let M of S)M.offsetLeft+M.offsetWidth>I?(B.push(M.cloneNode(!0)),M.style.visibility="hidden"):M.style.visibility="visible";ft(a),B.forEach(M=>{M.style.visibility="visible",a.appendChild(M)}),r||(r=!0,p=!1,o.style.display="block")}else if(!p){p=!0,r=!1;const S=Array.from(t.children);for(let M of S)M.style.visibility="visible";o.style.display="none"}}function T(I){var B,S;for(let M of I)(S=(B=g[M])==null?void 0:B.elem)==null||S.classList.remove("disabled")}function w(I){var B,S;for(let M of I)(S=(B=g[M])==null?void 0:B.elem)==null||S.classList.add("disabled")}function x(){const I=Object.keys(g);for(let B of I)g[B].elem.classList.add("disabled")}return{element:u,checkOverflow:E,enableButtons:T,disableButtons:w,disableAllButtons:x}}function h(d){k=d}function f(d,u){if(ui(u))_.disableButtons(["new","copy","cut","paste","open","delete","rename"]);else{const t=d.length;t===0?(_.enableButtons(["new"]),_.disableButtons(["copy","cut","open","delete","rename"])):t===1?_.enableButtons(["new","copy","cut","open","delete","rename"]):t>1&&(_.disableButtons(["rename"]),_.enableButtons(["new","copy","cut","open","delete"]))}}return{element:c,toolbarActions:_,toolbarNavigation:y,setLocation:h,setSelectedItems:f}}const sa=e=>({"":"",folder:"File Folder",file:e.type==="file"?Pt(vt(e.text)).description:"File Folder",driver:"Local Disk"})[e.type];function na(e,c){let _,y,k,L=0,C=0,i={...e},n=[],l=v("div",{className:"pannel-selection",style:{visibility:"hidden"}}),m=!1,s,h;_=v("div",{className:"pannel w-full h-full scrollable",onmousedown:S},[l,k=d(i.view)]);function f(b){c.onChange(b)}function d(b="details"){switch(b){case"extraLargeIcons":case"largeIcons":case"mediumIcons":case"smallIcons":return u(b);case"list":return g();case"details":return p();case"tiles":return E();default:return p()}}function u(b){if(G(i.group)){let R=bs(e.items,W=>W[i.group.by]);const O=Object.keys(R).map(W=>W).sort((W,j)=>i.group.orderBy==="asc"?W.localeCompare(j):j.localeCompare(W));y=v("div",{className:"pannel-items-group-container"});const z=O.length;for(let W=0;W<z;W++){const j=O[W];let X=R[j];G(i.sortBy)&&(X=X.sort((A,$)=>i.orderBy==="asc"?A[i.sortBy].localeCompare($[i.sortBy]):$[i.sortBy].localeCompare(A[i.sortBy])));const ie=o(j.toFirstUpperCase()+` (${X.length})`,a(X,b));y.appendChild(ie)}return y}let D=i.items.sort((R,O)=>{const z=O.type.localeCompare(R.type),W=R.text.localeCompare(O.text);return z||W});return G(i.sortBy)&&(D=D.sort((R,O)=>i.orderBy==="asc"?R[i.sortBy].localeCompare(O[i.sortBy]):O[i.sortBy].localeCompare(R[i.sortBy]))),y=a(D,b)}function t(b){const D=v("div",{className:"pannel-item-icon",style:{backgroundImage:`url(${b.icon})`}});if(b.type==="file"){const R=vt(b.name||b.text);an(R)&&Ge(b.location)&&(D.style.myBackgroundImage=b.location)}return D}function a(b,D){let R=b.sort((O,z)=>{const W=z.type.localeCompare(O.type),j=O.text.localeCompare(z.text);return W||j});return v("div",{className:"pannel-items pannel-items-thumbnail "+D},R.map(O=>{let z,W;return z=v("div",{className:"w-full h-full"},W=v("div",{className:"pannel-item flex flex-col items-center content-center",info:O,ondblclick:f.bind(null,O),onmousedown:r,ondragover(j){c.onPannelItemDragover(j,O),z.classList.add("pannel-item-selected")},ondragleave(){z.classList.remove("pannel-item-selected")},ondrop(j){z.classList.remove("pannel-item-selected"),c.onPannelItemDrop(j,O)}},[t(O),v("div",{className:"pannel-item-text"},O.text)])),ci(W,O),z}))}function o(b,D){return v("div",{className:"pannel-items-group"},[v("div",{className:"pannel-items-group-header flex items-center",style:{padding:"3px 5px"}},[v("div",{className:"pannel-items-group-header-icon flex-shrink-0 flex items-center content-center",innerHTML:Ci(18)}),v("div",{className:"pannel-items-group-header-label flex-shrink-0"},b),v("div",{className:"pannel-items-group-header-line w-full",style:{height:"1px",backgroundColor:"var(--border-color)",marginLeft:"5px"}})]),v("div",{className:"pannel-items-group-body"},D)])}function r(b){if(b.button!==0)return;b.stopPropagation(),c.onItemMouseDown();const D=b.currentTarget;if(!b.shiftKey)if(b.ctrlKey)if(D.classList.contains("pannel-item-selected")){D.classList.remove("pannel-item-selected");const R=n.findIndex(O=>O.info.location===D.info.location);R>-1&&n.splice(R,1)}else D.classList.add("pannel-item-selected"),n.push(D);else N(),D.classList.add("pannel-item-selected"),n.push(D);Se(c.onSelect)&&c.onSelect(n)}function p(){let b=i.items.sort((D,R)=>{const O=R.type.localeCompare(D.type),z=D.text.localeCompare(R.text);return O||z});return v("div",{className:"pannel-detail w-full"},v("table",{},[v("thead",{},v("tr",{className:"pannel-detail-header"},[v("td",{className:"pannel-detail-header-col pannel-detail-name",colSpan:2},"Name"),v("td",{className:"pannel-detail-header-col pannel-detail-date"},"Date modified"),v("td",{className:"pannel-detail-header-col pannel-detail-type"},"Type"),v("td",{className:"pannel-detail-header-col pannel-detail-size"},"Size")])),y=v("tbody",{className:"pannel-items pannel-items-details"},b.map(D=>{let R,O="";if(D.size){const z=Vt(parseInt(D.size));O=z.value+" "+z.unit}return R=v("tr",{className:"pannel-item",info:D,ondblclick:f.bind(null,D),onmousedown:r,ondragover(z){c.onPannelItemDragover(z,D),R.classList.add("pannel-item-selected")},ondragleave(){R.classList.remove("pannel-item-selected")},ondrop(z){R.classList.remove("pannel-item-selected"),c.onPannelItemDrop(z,D)}},[v("td",{className:"pannel-item-icon",style:{backgroundImage:`url(${D.icon})`}}),v("td",{className:"pannel-item-col"},v("div",{className:"text-ellipsis line-clamp-1"},D.text)),v("td",{className:"pannel-item-col pannel-item-mdate pannel-detail-date"},v("div",{className:"text-ellipsis line-clamp-1"},D.properties.mdate?B(D.properties.mdate):"")),v("td",{className:"pannel-item-col pannel-item-type pannel-detail-type"},v("div",{className:"text-ellipsis line-clamp-1"},sa(D))),v("td",{className:"pannel-item-col pannel-item-size pannel-detail-size"},O)]),ci(R,D),R}))]))}function g(){return v("div")}function E(){if(G(i.group)){let b=bs(e.items,O=>O.type);const D=Object.keys(b).map(O=>O).sort((O,z)=>i.group.orderBy==="asc"?O.localeCompare(z):z.localeCompare(O));y=v("div",{className:"pannel-items-group-container"});const R=D.length;for(let O=0;O<R;O++){const z=D[O];let W=b[z];G(i.sortBy)&&(W=W.sort((X,ie)=>i.orderBy==="asc"?X[i.sortBy].localeCompare(ie[i.sortBy]):ie[i.sortBy].localeCompare(X[i.sortBy])));const j=o(z.toFirstUpperCase()+` (${W.length})`,T(W));y.appendChild(j)}return y}return y=T(e.items)}function T(b){return v("div",{className:"pannel-items pannel-items-tiles"},b.map(D=>{let R,O;return R=v("div",{className:"w-full h-full flex items-center content-center"},O=v("div",{className:"pannel-item flex items-center",info:D,ondblclick:f.bind(null,D),onmousedown:r,ondragover(z){c.onPannelItemDragover(z,D),R.classList.add("pannel-item-selected")},ondragleave(){R.classList.remove("pannel-item-selected")},ondrop(z){R.classList.remove("pannel-item-selected"),c.onPannelItemDrop(z,D)}},[v("div",{className:"pannel-item-icon",style:{backgroundImage:`url(${D.icon})`}}),v("div",{className:"pannel-item-info w-full"},[v("div",{className:"pannel-item-text"},D.text),v("div",{className:"pannel-item-desc"},D.type==="driver"?v("div",{className:"progress w-full"},x()):""),v("div",{className:"pannel-item-size"},D.type==="driver"?I():"")])])),ci(O,D),R}))}function w(b){navigator.storage.estimate().then(({quota:D,usage:R})=>{let O=R/D*100,z=Vt(D),W=Vt(D-R);D>2e10&&(O=(R+2e10)/D*100,W=Vt(D-2e10-R)),b({available:z,free:W,percent:O})})}function x(){const b=v("div",{className:"progress-value",style:{width:"80%"}});return w(({percent:D})=>{b.style.width=D+"%"}),b}function I(){const b=v("div",{},"4 GB free of 20 GB");return w(({available:D,free:R})=>{b.textContent=`${R.value} ${R.unit} free of ${D.value} ${D.unit}`}),b}function B(b){const D=new Date(b),R=D.getDate();return qi[D.getDay()]+", "+(R<10?"0"+R:R)+"-"+Pi[D.getMonth()]+"-"+D.getFullYear()+" "+Et(D)}function S(b){b.button===0&&(b.shiftKey||N(),m=!0,s={x:b.x+_.scrollLeft,y:b.y+_.scrollTop},h=_.getBoundingClientRect(),document.addEventListener("mousemove",M,!1),document.addEventListener("mouseup",P,!1))}function M(b){const D={top:_.scrollTop,left:_.scrollLeft};if(L=Math.abs(b.x+D.left-s.x),C=Math.abs(b.y+D.top-s.y),!m||L<2&&C<2)return;let R=0,O=0,z=Math.abs(b.x+D.left-s.x),W=Math.abs(b.y+D.top-s.y);b.x+D.left>s.x?O=s.x-h.left:O=b.x-h.left+D.left,b.y+D.top>s.y?R=s.y-h.top:R=b.y-h.top+D.top,de(l,{visibility:"visible",top:R+"px",left:O+"px",width:z+"px",height:W+"px"}),(O+z>h.width+D.left||O<D.left)&&_.scrollTo({top:b.y-h.top,left:b.x-h.left}),H({x1:O,x2:O+z,y1:R,y2:R+W},b.shiftKey)}function P(){m=!1,document.removeEventListener("mousemove",M,!1),document.removeEventListener("mouseup",P,!1),de(l,{visibility:"hidden",width:"0px",height:"0px"}),n=Array.from(y.getElementsByClassName("pannel-item-selected")),Se(c.onSelected)&&c.onSelected(n)}function H(b,D){const R=Array.from(y.getElementsByClassName("pannel-item")).map(z=>z),O=[];for(let z of R){let W=z.offsetLeft,j=z.offsetTop,X=z.offsetWidth,ie=z.offsetHeight;W+X<b.x1||W>b.x2||j+ie<b.y1||j>b.y2?D||z.classList.remove("pannel-item-selected"):(O.push(z),z.classList.add("pannel-item-selected"))}Se(c.onSelect)&&c.onSelect(O)}function N(){for(let b of n)b.classList.remove("pannel-item-selected");n=[],Se(c.onSelect)&&c.onSelect([])}function F(b){G(k)&&k.remove(),k=d(b),_.appendChild(k)}return{element:_,setView:F}}function ra(e){let c,_,y,k,L,C;c=v("div",{className:"explorer-status-bar flex items-center flex-shrink-0"},[_=v("div",{className:"explorer-status-bar-item"},"0 items"),y=v("div",{className:"explorer-status-bar-item"}),k=v("div",{className:"explorer-status-bar-item"}),v("div",{className:"explorer-status-bar-item",style:{marginLeft:"auto",marginRight:"10px"}},[L=v("div",{className:"explorer-status-bar-view button-presentation",innerHTML:Ur(16),onclick:i.bind(null,"details")}),C=v("div",{className:"explorer-status-bar-view button-presentation",innerHTML:Gs(16),onclick:i.bind(null,"mediumIcons")})])]);function i(h){e.onViewChange(h)}function n(h){L.classList.remove("selected"),C.classList.remove("selected"),h==="details"?L.classList.add("selected"):h==="mediumIcons"&&C.classList.add("selected")}function l(h=0){_.textContent=h+" items"}function m(h=0){y.textContent=h>0?h+" items selected":""}function s(h){k.textContent=h}return{element:c,setItemCount:l,setSelectedItem:m,setView:n,setSize:s}}const pn=(e,c,_=!1)=>{let y;const k=[];let L,C=[],i;const n=Wi(),l=mn({onTabChange:f,onTabClose:u,onNewTabActionClick:x,onDragOut:r,onDragOver:()=>{},onDragEnd(I,B){B&&l.showNewButton()},getTabCount:h,moveWindow:s}),m=v("div",{className:"window-tabs-container explorer-tabs-container w-full"},[v("div",{className:"tabs-drag-handle w-full h-full absolute",["drag-region"]:"drag"}),l.element]);m.addEventListener("tabdragover",o,!1);function s(I,B){de(y.element,{pointerEvents:"none"}),document.addEventListener("mousemove",M,!1),document.addEventListener("mouseup",P,!1);let S;function M(H){y.checkWindowSnap({x:H.x,y:H.y}),y.setBounds({top:H.y-B.deltaTop,left:H.x-B.deltaLeft});const N=document.elementFromPoint(H.x,H.y);if(N instanceof Element){const F=N.closest(".explorer-tabs-container");G(F)&&S!==F&&(S=F,P(),y.close(),F.dispatchEvent(new CustomEvent("tabdragover",{bubbles:!0,detail:{x:H.x,dx:B.dl,y:H.y,tabId:I.id,windowId:I.windowId,icon:I.icon,text:I.text,content:L.content}})))}}function P(){y.setWindowSnap(),de(y.element,{pointerEvents:"initial"}),document.removeEventListener("mousemove",M,!1),document.removeEventListener("mouseup",P,!1)}}function h(){return k.length}function f(I){if(i===I.id)return;i=I.id,L=d(I.id);const B=C.findLastIndex(S=>S===I.id);B>-1&&C.splice(B,1),C.unshift(I.id),l.setActiveTab(I.id),y.setContent(L.content.element),a(L.id,L.text,L.icon)}function d(I){return k.find(B=>B.id===I)}function u(I,B){const S=k.findIndex(P=>P.id===I.id);l.remove(I.id),S>-1&&(B||k[S].content.dispose(),k.splice(S,1));const M=C.findIndex(P=>P===I.id);M>-1&&C.splice(M,1),k.length===0?y.close():(L=d(C[0]),l.setActiveTab(L.id),a(L.id,L.text,L.icon),y.setContent(L.content.element))}function t(I){let B,S="wtct"+xi(),M;const P=[];let H=0,N="",F=[],b;const D=J=>{b=J},R=ia({onItemClick:J=>{let Y=!(Ge(J.location)||_t(J.location));W(J,!0,Y)},history:{onBackward:X,onForward:ie,onGoUp:A},getContainer:()=>y.element,getCurrentLocation:()=>N,actionEvents:{onDelete(){const J=F.map(Y=>{const te={type:Y.info.type,location:Y.info.location};return Y.info.type==="file"&&(te.size=Y.info.properties.size),te});Ko(J,N)}}}),O=Zo({onChange:J=>{W(J,!0,!0)}}),z=ra({onViewChange:J=>{B.setView(J),z.setView(J),ue.setView(N,{type:J,sortBy:"name",orderBy:"asc"})}});function W(J,Y=!0,te=!1){var fe;if(z.setSelectedItem(0),R.setLocation(J.location),Y&&(P.splice(H+1,P.length),((fe=P[P.length-1])==null?void 0:fe.text)!==J.text&&(H=P.push(J)-1)),te){const pe=n.findIndex(le=>le.name===J.text||le.path===J.text),ne=n[pe];if(pe>-1)if(N=ne.location,$(),ne.type==="root"){const le=ne.children.filter(ge=>ge.type==="folder").map(ge=>new Promise((Ue,we)=>{ue.stats(ge.location,(Q,he)=>{Q?we(Q):Ue({...he,location:ge.location})})})),Te=ne.children.filter(ge=>ge.type!=="folder");Promise.all(le).then(ge=>{const we=Te.concat(ge).map(Q=>({icon:Q.icon||(Q.type==="file"?Pt(vt(Q.name)).icon:ot),text:Q.name,properties:{...Q},type:Q.type,location:Q.location}));Z(we,{view:ne.view,group:ne.group,sortBy:ne.sortBy,orderBy:ne.orderBy})}),R.toolbarNavigation.toolbarPath.setPath({text:ne.name,icon:ne.icon,path:ne.path,location:ne.location}),R.toolbarNavigation.setPlaceHolder(ne.name),Se(b)&&b(I,ne.name,ne.icon)}else(ne.type==="folder"||ne.type==="driver")&&ae(ne.location,ne.path,{view:ne.view,group:ne.group,sortBy:ne.sortBy,orderBy:ne.orderBy});else ae(J.location)}else ae(J.location);function ae(pe,ne,le){ue.readFolder(pe,(Te,ge)=>{if(Te)console.log(Te);else{N=pe,$();const Ue=ge.map(we=>{var Q;return{icon:we.icon||(we.type==="file"?Pt(vt(we.name)).icon:ot),text:we.name,properties:{...we},type:we.type,location:pe+"/"+we.name,name:we.name,cdate:we.cdate.toString(),size:(Q=we.size)==null?void 0:Q.toString()}});ue.stats(pe,(we,Q)=>{we?console.log(we):(R.toolbarNavigation.toolbarPath.setPath({text:Q.text||Q.name,icon:Q.icon||ot,path:G(ne)?ne:pe,location:pe}),Se(b)&&b(I,Q.text||Q.name,Q.icon||ot),R.toolbarNavigation.setPlaceHolder(Q.text||Q.name))}),ue.stats(pe,(we,Q)=>{if(we)return;let he={};G(Q.view)?Object.assign(he,{...Q.view,view:Q.view.type}):G(le)&&(he=le),Z(Ue,he)})}})}}function j(){function J(Y){return Y.substring(N.length+1,Y.length).split("/")}ue.addEventListener("added",S,Y=>{Y.includes(N)&&J(Y).length===1&&W({location:N,text:N},!1)}),ue.addEventListener("modified",S,Y=>{Y.includes(N)&&J(Y).length===1&&W({location:N,text:N},!1)}),ue.addEventListener("removed",S,Ns(Y=>{Y.includes(N)&&J(Y).length===1&&W({location:N,text:N},!1)},500))}j();function X(){H-=1,W(P[H],!1,!0)}function ie(){H+=1,W(P[H],!1,!0)}function A(J){W({text:J,location:J})}function $(){R.toolbarNavigation.checkHistoryButtons(P,H,N)}function q(J){J.preventDefault(),ui(N)||hi(N,J.dataTransfer.items)}function V(J){J.preventDefault(),J.stopPropagation(),J.dataTransfer.dropEffect="copy"}function K(J,Y){J.preventDefault(),J.stopPropagation(),Y.type==="folder"||Y.type==="driver"?hi(Y.location,J.dataTransfer.items):ui(N)||hi(N,J.dataTransfer.items)}function Z(J,Y){setTimeout(()=>{ft(M),R.setSelectedItems([],N),z.setItemCount(J.length),z.setView(Y.view),!G(J)||(J==null?void 0:J.length)===0?M.appendChild(v("div",{style:{textAlign:"center",padding:"20px 0"}},"This folder is empty")):(B=na({selectable:!0,items:J,...Y},{onItemMouseDown(){y.focus()},onChange:te=>{if(te.type==="folder"||te.type==="driver")W({text:te.location,location:te.location},!0);else{const ae=vt(te.text);if(ae===".exe")fn(te.location);else{const fe=Pt(ae);He(fe.appName,te.location)}}},onSelect(te){if(F=te,R.setSelectedItems(te,N),z.setSelectedItem(te.length),te.length>0&&te.every(fe=>fe.info.type==="file")){const fe=Vt(ce(te));z.setSize(fe.value+" "+fe.unit)}else z.setSize("")},onPannelItemDragover:V,onPannelItemDrop:K}),M.appendChild(B.element))},50)}function ce(J){let Y=0,te=J.length;for(let ae=0;ae<te;ae++){const fe=J[ae];fe.info.type==="file"&&(Y+=fe.info.properties.size)}return Y}const ke=v("div",{className:"explorer-container w-full h-full relative"},[R.element,v("div",{className:"explorer-body flex flex-col w-full h-full"},[v("div",{className:"w-full flex",style:{height:"calc(100% - 25px)"}},[O.element,M=v("div",{className:"explorer-content h-full flex-1",ondragover(J){ui(N)&&(J.dataTransfer.dropEffect="none")},ondrop:q})]),z.element])]);function ee(){ue.removeListeners("added",S),ue.removeListeners("modified",S),ue.removeListeners("removed",S)}return{element:ke,toolbar:R,listenEvent:D,routeTo:W,listenFileChange:j,dispose:ee}}function a(I,B,S){y.setTitle(B),G(S)&&y.setIcon(S);const M=l.getTab(I);G(M)&&(M.setTitle(B),G(S)&&M.setIcon(S));const P=d(I);G(P)&&(P.text=B,P.icon=S)}function o(I){l.hideNewButton(),y.focus();const B=I,S={icon:B.detail.icon,text:B.detail.text,content:B.detail.content},M=l.add(S);M.triggerMouseMove(B),L={id:M.id,text:S.text,icon:S.icon,content:S.content},L.content.listenEvent((P,H,N)=>{a(M.id,H,N)}),L.content.listenFileChange(),C.unshift(M.id),k.push(L),y.setContent(S.content.element)}function r(I,B){const S=y.getBounds(),M={top:B.top-B.deltaTop,left:B.left-B.deltaLeft,width:S.width,height:S.height},P=d(I.id);P.content.listenEvent(null),I.content=P.content,pn(null,M,!0).addTabAndMoveWindow(I,{...B,windowBounds:M})}function p(I,B){const S=l.add(I);l.disabledScrollbar(),de(S.element,{position:"absolute",left:B.deltaLeft-B.dl+"px"}),L={id:S.id,text:I.text,icon:I.icon,content:I.content},C.unshift(S.id),L.content.listenEvent((M,P,H)=>{a(L.id,P,H)}),L.content.listenFileChange(),k.push(L),y.setContent(L.content.element),a(L.id,L.text,L.icon),g(I,B,S),l.hideNewButton()}function g(I,B,S){de(y.element,{pointerEvents:"none"}),document.addEventListener("mousemove",P,!1),document.addEventListener("mouseup",H,!1);let M;function P(N){y.checkWindowSnap({x:N.x,y:N.y}),y.setBounds({top:N.y-B.deltaTop,left:N.x-B.deltaLeft});const F=document.elementFromPoint(N.x,N.y);if(F instanceof Element){const b=F.closest(".explorer-tabs-container");G(b)&&M!==b&&(M=b,H(),y.close(),b.dispatchEvent(new CustomEvent("tabdragover",{bubbles:!0,detail:{x:N.x,dx:B.dl,y:N.y,tabId:I.id,windowId:I.windowId,icon:I.icon,text:I.text,content:L.content}})))}}function H(){l.enabledScrollbar(),y.setWindowSnap(),l.showNewButton(),de(y.element,{pointerEvents:"initial"}),S.element.style.removeProperty("position"),S.element.style.removeProperty("left"),document.removeEventListener("mousemove",P,!1),document.removeEventListener("mouseup",H,!1)}}function E(I){const B={text:I,icon:"imgs/icons/Folder.png"},S=l.add(B),M=t(S.id);M.listenEvent((P,H,N)=>{a(P,H,N)}),M.routeTo({text:I,location:I},!0,!0),L={id:S.id,text:B.text,icon:B.icon,content:M},C.unshift(S.id),k.push(L),y.setContent(M.element),a(B.id,B.text,B.icon)}function T(I){const B=l.add({...I,windowId:y.id});let S=t(B.id);S.listenEvent(a),L={id:B.id,text:I.text,icon:I.icon,content:S},C.unshift(B.id),k.push(L),y.setContent(S.element),S.routeTo({text:I.text},!0,!0),a(I.id,I.text,I.icon)}function w(){T({text:"This PC",windowId:y.id,icon:"imgs/icons/Computer.png"})}function x(){w()}return y=at({args:e,icon:se.explorer.icon,hideIcon:!0,name:se.explorer.name,title:se.explorer.productName,hideTitle:!0,titlebarHeight:mi,titlebarContent:m,top:(c==null?void 0:c.top)||50,left:(c==null?void 0:c.left)||50,width:(c==null?void 0:c.width)||800,height:(c==null?void 0:c.height)||520,className:"explorer-app-window",transprencyContent:!0}),_||(G(e)?E(e):w()),y.addEventListener("close",()=>{for(let I=0;I<k.length;I++)k[I].content.dispose()}),y.addEventListener("secondInstance",I=>{y.isVisible()||y.show(),y.focus(),G(I)?E(I):w()}),y.addEventListener("restore",()=>{y.isMaximized()||y.setTitlebarHeight(mi)}),y.addEventListener("maximize",()=>{y.setTitlebarHeight(kt)}),{addTabAndMoveWindow:p,tabs:l,window:y}};function oa(e){let c=Ji(se.explorer.name);G(c)?c.window.executeListeners("secondInstance",e):pn(e)}function qe(e,c){const _=us(50,200),y=us(50,200);at({icon:e.icon,name:e.name,title:e.productName,top:_,left:y,width:450,height:300,content:()=>v("div",{className:"w-full h-full flex content-center items-center"},v("h3",{},"In Progress"))})}function aa(e,c){let _;_=v("div",{tabIndex:0,className:"menu-strip flex items-center",onfocus:c.onfocus,onblur:c.onblur});for(let L=0;L<e.length;L++){const C=e[L],i=v("div",{className:"menu-strip-item flex-shrink-0"},v("div",{className:"h-full flex items-center"},C.text));y(i,C.children),_.appendChild(i)}function y(L,C){if(G(C)){const i=v("div",{className:"context-menu"});C.forEach(n=>[k(i,n)]),L.appendChild(i)}}function k(L,C){if(C.divider){let l=v("div",{className:"menu-item-divider"});L.appendChild(l);return}const i=G(C.children)&&C.children.length>0,n=v("div",{className:"menu-item"+(C.disabled?" disabled":"")+(C.emphasis?" emphasis":"")+(C.checked?" checked":""),onclick:()=>{!C.disabled&&!i&&Se(c.onItemClick)&&c.onItemClick(C)}},[v("div",{className:"menu-item-icon",innerHTML:C.checked?en():"",style:{pointerEvents:"none"}}),v("div",{className:"menu-item-text",style:{pointerEvents:"none"}},C.text||"")]);if(C.shortcut){let l=v("div",{className:"menu-item-shortcut",style:{pointerEvents:"none"}},C.shortcut);n.appendChild(l)}if(i){let l=v("div",{className:"menu-item-arrow flex items-center",innerHTML:Ht});n.appendChild(l)}L.appendChild(n),y(n,C.children)}return _}function gn(e,c,_=!1){let y,k;const L=[];let C,i=[],n;const l=mn({onTabChange:h,onTabClose:d,onNewTabActionClick:u,onDragOver:()=>{},onDragOut:g,onDragEnd(x,I){I&&l.showNewButton()},getTabCount:s,moveWindow:m});function m(x,I){de(k.element,{pointerEvents:"none"}),document.addEventListener("mousemove",S,!1),document.addEventListener("mouseup",M,!1);let B;function S(P){k.checkWindowSnap({x:P.x,y:P.y}),k.setBounds({top:P.y-I.deltaTop,left:P.x-I.deltaLeft});const H=document.elementFromPoint(P.x,P.y);if(H instanceof Element){const N=H.closest(".notepad-tabs-container");G(N)&&B!==N&&(B=N,M(),k.close(),N.dispatchEvent(new CustomEvent("tabdragover",{bubbles:!0,detail:{x:P.x,dx:I.dl,y:P.y,tabId:x.id,windowId:x.windowId,icon:x.icon,text:x.text,content:C.element}})))}}function M(){k.setWindowSnap(),de(k.element,{pointerEvents:"initial"}),setTimeout(()=>{C.element.input.focus()},10),document.removeEventListener("mousemove",S,!1),document.removeEventListener("mouseup",M,!1)}}function s(){return L.length}function h(x){if(n===x.id)return;n=x.id,C=f(x.id);const I=i.findLastIndex(B=>B===x.id);I>-1&&i.splice(I,1),i.unshift(x.id),l.setActiveTab(x.id),k.setContent(C.element.element),setTimeout(()=>{C.element.input.focus()},10),r(x.id,x.text,x.icon)}function f(x){return L.find(I=>I.id===x)}function d(x){const I=L.findIndex(S=>S.id===x.id);I>-1&&L.splice(I,1);const B=i.findIndex(S=>S===x.id);B>-1&&i.splice(B,1),L.length===0?k.close():(C=f(i[0]),l.setActiveTab(C.id),r(C.id,C.text),k.setContent(C.element.element))}function u(){t()}function t(){a({text:"Untitled - Notepad",icon:"imgs/icons/Apps/notepad.png"})}function a(x,I){const B=l.add({...x,windowId:k.id});let S;G(I)?S=I:S=o(),C={id:B.id,text:x.text,element:S},i.unshift(B.id),L.push(C),k.setContent(S.element),setTimeout(()=>{S.input.focus()},10),r(x.id,x.text)}function o(){let x,I,B,S;x=v("div",{className:"w-full h-full flex flex-col"},[aa([{text:"File",children:[{text:"New",shortcut:"Ctrl+N"},{text:"Open",shortcut:"Ctrl+O"},{text:"Save",shortcut:"Ctrl+S"},{text:"SaveAs",shortcut:"Ctrl+Shift+S"},{divider:!0},{text:"Close",shortcut:"Alt+W"}]},{text:"Edit",children:[{text:"Undo",disabled:!0,shortcut:"Ctrl+Z"},{divider:!0},{text:"Cut",disabled:!0,shortcut:"Ctrl+X"},{text:"Copy",disabled:!0,shortcut:"Ctrl+C"},{text:"Paste",disabled:!0,shortcut:"Ctrl+V"},{text:"Delete",disabled:!0,shortcut:"Del"},{divider:!0},{text:"Find",shortcut:"Ctrl+F"},{text:"Replace...",shortcut:"Ctrl+H"},{divider:!0},{text:"Select All",shortcut:"Ctrl+A"}]},{text:"Format",children:[{text:"Wordwrap",checked:!0},{text:"Font..."}]},{text:"View",children:[{text:"Zoom",children:[{text:"Zoom In",shortcut:"Ctrl+Plus"},{text:"Zoom Out",shortcut:"Ctrl+Minus"},{text:"Restore Default Zoom",shortcut:"Ctrl+0"}]},{text:"Status Bar",checked:!0}]},{text:"Help",children:[{text:"View Help"},{text:"Send Feedback"},{divider:!0},{text:"About Notepad"}]}],{onItemClick(){I.focus()}}),I=v("textarea",{tabIndex:0,name:"notepad-input",className:"w-full h-full scrollable scroll-y",style:{display:"block",border:0,borderTop:"1px solid var(--border-color)",outline:0,padding:"5px",color:"var(--primary-text-color)",backgroundColor:"transparent",font:"400 14px Consolas",cursor:"default",resize:"none"},onselect(N){N.preventDefault()},onkeydown:()=>{P(),document.onkeyup=H},onmousedown:()=>{P(),H(),document.onmousemove=()=>{P(),H()},document.onmouseup=H}}),v("div",{className:"note-pad-status-bar w-full flex items-center flex-shrink-0",style:{borderTop:"1px solid var(--border-color)",minHeight:"25px",paddingInline:"10px"}},[v("div",{className:"note-pad-status-left h-full"}),v("div",{className:"note-pad-status-right flex h-full",style:{marginLeft:"auto"}},[B=v("div",{className:"note-pad-status-bar-item"}),S=v("div",{className:"note-pad-status-bar-item"}),v("div",{className:"note-pad-status-bar-item"},"100%"),v("div",{className:"note-pad-status-bar-item"},"Windows (CRLF)"),v("div",{className:"note-pad-status-bar-item"},"UTF-8")])])]),P(),H();function P(){setTimeout(()=>{const N=I.value.substring(0,I.selectionStart).split(`
`),F=N.length,b=N[N.length-1].length;S.textContent=`Ln ${F}, Col ${b}`},150)}function H(){setTimeout(()=>{const N=I.value.substring(I.selectionStart,I.selectionEnd);B.textContent=(N.length>0?N.length:0)+" selected"},100)}return{element:x,input:I}}function r(x,I,B){k.setTitle(I);const S=l.getTab(x);G(S)&&(S.setIcon(B||"imgs/icons/Apps/notepad.png"),S.setTitle(I))}function p(x){l.hideNewButton(),k.focus();const I=x,B={icon:I.detail.icon,text:I.detail.text,content:I.detail.content},S=l.add(B);S.triggerMouseMove(I),C={id:S.id,text:B.text,element:B.content},i.unshift(S.id),L.push(C),k.setContent(B.content.element),setTimeout(()=>{C.element.input.focus()},10),r(S.id,C.text)}function g(x,I){const B=k.getBounds(),S={top:I.top-I.deltaTop,left:I.left-I.deltaLeft,width:B.width,height:B.height},M=f(x.id);x.content=M.element,gn(null,S,!0).addTabAndMoveWindow(x,{...I,windowBounds:S})}function E(x,I){const B=l.add(x);de(B.element,{position:"absolute",left:I.deltaLeft-I.dl+"px"}),C={id:B.id,text:x.text,element:x.content},i.unshift(B.id),L.push(C),k.setContent(C.element.element),setTimeout(()=>{C.element.input.focus()},10),r(B.id,x.text,x.icon),T(x,I,B),l.hideNewButton()}function T(x,I,B){de(k.element,{pointerEvents:"none"}),document.addEventListener("mousemove",M,!1),document.addEventListener("mouseup",P,!1);let S;function M(H){k.checkWindowSnap({x:H.x,y:H.y}),k.setBounds({top:H.y-I.deltaTop,left:H.x-I.deltaLeft,width:I.windowBounds.width,height:I.windowBounds.height});const N=document.elementFromPoint(H.x,H.y);if(N instanceof Element){const F=N.closest(".notepad-tabs-container");G(F)&&S!==F&&(S=F,P(),k.close(),F.dispatchEvent(new CustomEvent("tabdragover",{bubbles:!0,detail:{x:H.x,dx:I.dl,y:H.y,tabId:x.id,windowId:x.windowId,icon:x.icon,text:x.text,content:C.element}})))}}function P(){k.setWindowSnap(),l.showNewButton(),de(k.element,{pointerEvents:"initial"}),B.element.style.removeProperty("position"),B.element.style.removeProperty("left"),setTimeout(()=>{C.element.input.focus()},10),document.removeEventListener("mousemove",M,!1),document.removeEventListener("mouseup",P,!1)}}function w(x){fs(x,I=>{const B=nt(x)+" - Notepad";k.setTitle(B);const S={text:B,icon:"imgs/icons/Apps/notepad.png"},M=l.add({...S,windowId:k.id}),P=o();P.input.value=I,C={id:M.id,text:B,element:P},i.unshift(M.id),L.push(C),k.setContent(P.element),P.input.focus(),r(M.id,S.text,S.icon)})}return y=v("div",{className:"window-tabs-container notepad-tabs-container w-full"},[v("div",{className:"tabs-drag-handle w-full h-full absolute",["drag-region"]:"drag"}),l.element]),y.addEventListener("tabdragover",p,!1),k=at({args:e,icon:se.notepad.icon,hideIcon:!0,name:se.notepad.name,title:se.notepad.productName,hideTitle:!0,top:(c==null?void 0:c.top)||50,left:(c==null?void 0:c.left)||100,width:(c==null?void 0:c.width)||700,height:(c==null?void 0:c.height)||450,titlebarHeight:mi,titlebarContent:y,className:"notepad-app-window",transprencyContent:!0}),_||(G(e)?w(e):t()),k.addEventListener("customdrop",x=>{x!=null&&x.type&&x.type==="file"&&vt(x.args)===".txt"&&fs(x.args,I=>{C.element.input.value=I,k.focus(),r(C.id,nt(x.args)+" - NotePad")})}),k.addEventListener("secondInstance",x=>{k.isVisible()||k.show(),G(x)?w(x):t(),k.focus()}),k.addEventListener("restore",()=>{k.isMaximized()||k.setTitlebarHeight(mi)}),k.addEventListener("maximize",()=>{k.setTitlebarHeight(kt)}),{addTabAndMoveWindow:E,tabs:l,window:k}}const la=e=>{let c=Ji(se.notepad.name);G(c)?c.window.executeListeners("secondInstance",e):gn(e)};const _i=1.7777777777777777,Yt=120,ht=140,wi=160,dt=8,wt=48,xs=200,ca=200,Cs=40,$i=wt,ha=60,ks=45,Ut=4,da="#bbb",ua=`
<svg width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="#333" fill="none" stroke-linecap="round" stroke-linejoin="round" style="stroke: var(--stroke-color)">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="12" y1="5" x2="12" y2="19" />
  <line x1="16" y1="9" x2="12" y2="5" />
  <line x1="8" y1="9" x2="12" y2="5" />
</svg>`,fa=`
<svg width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="#333" fill="none" stroke-linecap="round" stroke-linejoin="round" style="stroke: var(--stroke-color)">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="12" y1="5" x2="12" y2="19" />
  <line x1="16" y1="15" x2="12" y2="19" />
  <line x1="8" y1="15" x2="12" y2="19" />
</svg>
`;function Es(e,c){typeof c>"u"||c===null||(c instanceof HTMLElement?e.appendChild(c):c instanceof Array?vn(e,c):e.appendChild(document.createTextNode(c.toString())))}function vn(e,c){c instanceof Array?c.forEach(_=>{Es(e,_)}):Es(e,c)}function ma(e,c){for(let _ in c)_.indexOf("-")>-1?e.style.setProperty(_,c[_]):e.style[_]=c[_]}function Ne(e,c,_){let y=document.createElement(e);if(c){const k=c;for(let L in k)if(L==="style"){const C=k[L];ma(y,C)}else if(L.indexOf("-")>-1||L.indexOf(":")>-1){const C=k[L];y.setAttribute(L,C)}else y[L]=k[L]}return _&&vn(y,_),y}function Ls(e){let c=e.firstChild;for(;c;)e.removeChild(c),c=e.firstChild}function _n(e=0,c=[],_=4){const y=c.length;let k=[0],L=!1,C=0;function i(h=[],f=0,d=0,u=0,t){const a=c[d];if(!a)return h;const o=d+1-f,r=o>1?(o-1)*_:0;u+=a.ratio;const p=u*ht,g=(e-r)/u,E=g<=wi+C&&g>=Yt,T=e-p<=0?g/wi:g/Yt,w=Math.pow(Math.abs(T),3)*100,x=u;if(E)h.push({edge:d,badness:w,rowHeight:g,flag:1,itemCount:o,boxSpacing:_,ratio:x}),C=0,L=!1;else{if(p+r>e)return L?(C=0,h.length===0&&(g<Yt||!t?h.push({edge:d,badness:w,rowHeight:g,flag:o>1?-1:0,ratio:x,itemCount:o,boxSpacing:_}):t&&h.push(t)),h):(L=!0,C=20,i(h,f,d,u-a.ratio,t));if(d===(y>1?y-1:0))return h.push({edge:d,badness:w,flag:0,rowHeight:ht,ratio:x,itemCount:o,boxSpacing:_}),h;t={edge:d,badness:w,rowHeight:g,flag:o>1?1:0,ratio:x,itemCount:o,boxSpacing:_}}return i(h,f,d+1,u,t)}let n=[];function l(){let h=k.shift();if(typeof h>"u"||h===null||!c[h])return;let f=i([],h,h),d;d=f[0];for(let t=1;t<f.length;t++){const a=f[t];a.badness<d.badness&&(d=a)}const u={flag:d.flag,row:[h,d.edge],ratio:d.ratio||_i,itemCount:d.itemCount,boxSpacing:d.boxSpacing,rowHeight:d.rowHeight||ht};n.push(u),d.edge+1<=y&&k.push(d.edge+1)}for(;k.length>0;)l();let m=n.length,s=n[m-1];return m>1&&s.flag===0&&(s.rowHeight=n[m-2].rowHeight),{paths:n,rowCount:n.length}}function pa(e=0,c=[],_=48){const y=c.length;let k=[0];function L(n=[],l=0,m=0,s=0,h=0,f){const d=c[m];if(!d)return n;h+=d.itemCount>1?(d.itemCount-1)*dt:0;const u=m+1-l,t=(u>1?(u-1)*_:0)+h;s+=d.ratio;const a=s*ht,o=(e-t)/s,r=o<=wi&&o>=Yt,p=e-a<=0?o/wi:o/Yt,g=Math.pow(Math.abs(p),3)*100;if(r)n.push({edge:m,badness:g,rowHeight:o,flag:1,itemCount:u,boxSpacing:_,ratio:s});else{if(a+t>e)return n.length===0&&(f?n.push(f):n.push({edge:m,badness:g,rowHeight:o,flag:1,itemCount:u,boxSpacing:_,ratio:s})),n;if(m===(y>1?y-1:0))return n.push({edge:m,badness:g,flag:0,rowHeight:ht,ratio:s,itemCount:u,boxSpacing:_}),n;f={edge:m,badness:g,rowHeight:ht,flag:0,itemCount:u,boxSpacing:_,ratio:s}}return L(n,l,m+1,s,h,f)}let C=[];function i(){let n=k.shift();if(typeof n>"u"||n===null||!c[n])return;const l=c[n];let m=c[n+1];if(l.rowCount>1||typeof m<"u"&&m.rowCount>1)C.push({flag:1,row:[n,n],boxSpacing:_,rowHeight:ht,ratio:l.ratio||_i}),n+1<=y&&k.push(n+1);else{let s=L([],n,n,0,0),h=s[0];for(let d=1;d<s.length;d++){const u=s[d];u.badness<h.badness&&(h=u)}const f={flag:h.flag,row:[n,h.edge],rowHeight:h.rowHeight||ht,boxSpacing:h.boxSpacing,ratio:h.ratio||_i};C.push(f),h.edge+1<=y&&k.push(h.edge+1)}}for(;k.length>0;)i();return{paths:C,rowCount:C.length}}function Ds(e=300,c){const _=c.segments.map(l=>{const{paths:m,rowCount:s}=_n(e,l.items),h=m[0];return{rows:m,rowCount:s,ratio:h.ratio||_i,itemCount:s===1?h.row[1]+1-h.row[0]:0}}),y=_.map(({rowCount:l,ratio:m,itemCount:s})=>({rowCount:l,ratio:m,itemCount:s})),k=pa(e,y,wt),L={index:c.index,name:c.name,loaded:!0,left:0,width:e,height:0,segments:[],segmentInfo:[]};let C=0,i=0;for(let l=0;l<k.paths.length;l++){const m=k.paths[l],s=m.flag,h=m.row[1]+1-m.row[0];let f=0;for(let d=m.row[0];d<=m.row[1];d++){const u=_[d];var n=c.segments[d];const t={index:n.index,name:n.name,top:C,left:f,width:0,height:0,items:[],flag:s};let a=0,o=0;for(let r=0;r<u.rows.length;r++){const p=u.rows[r],g=m.rowHeight||p.rowHeight||ht,E=Math.floor(g);let T=0;for(let w=p.row[0];w<=p.row[1];w++){const x=n.items[w],I=Math.round(x.ratio*g);let B={...x,top:a+wt,left:T,width:s===0?I:h>1?d===m.row[1]&&w===p.row[1]?e-(f+T):I:p.flag===0?I:w===p.row[1]&&p.itemCount>1?e-T:I,height:E};t.items.push(B),T+=B.width+dt}o=T-dt,a+=E+dt,f+=T-dt+wt}t.width=u.rowCount===1?o:e,i=a-dt+$i,t.height=i,d===m.row[1]&&(C+=i),L.segments.push(t),L.segmentInfo.push({index:t.index,top:t.top,height:t.height})}}return L.height=C,L}function Ts(e=300,c){const _={index:c.index,name:c.name,left:0,width:e,height:0,segments:[],segmentInfo:[],loaded:!0},y=c.segments;let k=0;for(let L=0;L<y.length;L++){const C=y[L],{paths:i,rowCount:n}=_n(e,C.items),l={index:C.index,name:C.name,top:k,left:0,width:e,height:0,items:[]};let m=0;for(let s=0;s<n;s++){const h=i[s],f=h.rowHeight,d=Math.floor(f);let u=0;for(let t=h.row[0];t<=h.row[1];t++){const a=C.items[t],o=Math.round(a.ratio*f);let r={...a,top:m+wt,left:u,width:h.flag===0?o:t===h.row[1]&&h.itemCount>1?e-u:o,height:d+$i};l.items.push(r),u+=r.width+dt}m+=d+dt+wt}l.height=m-dt+$i,k+=l.height,_.segments.push(l),_.segmentInfo.push({index:l.index,top:l.top,height:l.height})}return _.height=k,_}function wn(e,c,_,y){let k=0;return e+c<y-xs&&(k=-1),e>y+_+xs&&(k=-1),k===0}function ga(e=0,c=[],_,y){const k=[];for(let L=0;L<c.length;L++){const C=c[L];wn(e+C.top,C.height,_,y)&&k.push(C.index)}return k}function oi(e,c,_,y=10,k){let L,C,i,n;return function(){const l=this,m=arguments;window.cancelAnimationFrame(n),n=window.requestAnimationFrame(()=>{typeof k=="function"&&k.apply(l,m,n)}),window.clearTimeout(i),i=window.setTimeout(()=>{typeof _=="function"&&_.apply(l,m)},y),C?(window.clearTimeout(L),L=window.setTimeout(function(){Date.now()-C>=c&&(e.apply(l,m),C=Date.now())},c-(Date.now()-C))):(e.apply(l,m),C=Date.now())}}function va(e=[],c,_,y={},k){var L;let C=e.length,i={position:"absolute",top:"0",bottom:"0",right:"0",width:ha+"px",height:"100%",margin:"auto",background:"none",fontFamily:"inherit",cursor:"ns-resize"};y.style&&(i={...i,...y.style});let n=[],l=48,m=(l-2)/2,s=c,h,f,d,u,t,a,o,r,p,g,E;const T=k.getBounds();let w={width:T.width,height:T.height},x=!1,I=!1,B=!1,S=!1,M=0,P=0,H=!1,N,F=!1,b=!1,D=!1;d=Ne("div",{className:"grid-scrollbar",style:i},u=Ne("div",{className:"scrollbar-wrapper w-full h-full"},[t=Ne("div",{className:"grid-scrollbar-inner w-full",style:{top:m+(y.hideButton?0:ks)+"px",bottom:m+(y.hideButton?0:ks)+2+"px",cursor:i.cursor},onmouseover:W,onmouseleave:j},[Ne("div",{className:"w-full h-full",onmousemove:K,onmousedown:O},[a=Ne("div",{className:"grid-scrollbar-thumb-primary"}),o=Ne("div",{className:"grid-scrollbar-thumb-secondary",tabIndex:0,style:{top:-(l/2-1)+"px",height:l+"px",cursor:i.cursor},onmouseover:W,onmouseleave:j,onkeydown:X,onclick:ie},Ne("div",{className:"grid-scrollbar-thumb-secondary-inner"},[p=Ne("div",{className:"grid-scrollbar-thumb-text"}),Ne("div",{className:"grid-scrollbar-thumb-line",style:{top:m+"px"}})]))]),r=Ne("div",{className:"grid-scrollbar-parts"})]),y.hideButton?null:g=Ne("button",{className:"grid-scrollbar-button grid-scrollbar-button-up disabled",innerHTML:ua}),y.hideButton?null:E=Ne("button",{className:"grid-scrollbar-button grid-scrollbar-button-down",innerHTML:fa})])),(L=_.parentElement)==null||L.appendChild(d),R();function R(){_.scrollHeight/_.getBoundingClientRect().height<=1?d.style.display="none":d.style.display="initial"}if(ce(),Z(),ee(),pe(0),ne(0),k.addEventListener("passiveResize",oi($,100),!1),k.addEventListener("resize",oi($,100),!1),y.autoHide){let Q=function(){S=!0,u.classList.add("mouse-over"),u.classList.remove("fade-out"),u.classList.add("fade-in")},he=function(){S=!1,!I&&!F&&(u.classList.remove("fade-in"),u.classList.add("fade-out"),u.classList.remove("mouse-over"))};u.classList.add("auto-hide"),u.addEventListener("mouseover",Q,!1),u.addEventListener("mouseleave",he,!1),setTimeout(()=>{_.addEventListener("scroll",A,!1)},50)}y.hideButton||(ae(g,b,()=>{ge()}),ae(E,D,()=>{Te()}));function O(){a.style.visibility="hidden",I=!0,document.addEventListener("mousemove",K,!1),document.addEventListener("mouseup",z,!1)}function z(){a.style.visibility="visible",I=!1,document.removeEventListener("mousemove",K,!1),document.removeEventListener("mouseup",z,!1)}function W(){x=!0}function j(){x=!1}function X(Q){Q.key==="ArrowUp"?ge():Q.key==="ArrowDown"&&Te()}function ie(Q){let he=Q.y-h.top;le(he),te()}function A(){F||(setTimeout(()=>{H||(S||(u.classList.remove("fade-out"),u.classList.add("fade-in")),u.classList.add("scrolling"))},1e3),F=!0),N&&clearTimeout(N),N=setTimeout(()=>{u.classList.remove("scrolling"),S||(u.classList.add("fade-out"),u.classList.remove("fade-in"),u.classList.remove("mouse-over")),H=!1,F=!1},2e3)}function $(){const Q=k.getBounds();w.height!==Q.height&&(w={width:Q.width,height:Q.height},ce(),Z(),ee(),q(!0),te(),R())}function q(Q){const he=_.scrollTop/(_.scrollHeight-f.height)*h.height;pe(he),(Q||!x)&&ne(he),te()}function V(Q=0,he=0){M=Q,P=he;const _e=M/(P-f.height)*h.height;pe(_e),x||ne(_e),te()}function K(Q){Q.stopPropagation();let he=Q.y-h.top;I?(le(he),ne(he)):x&&ne(he)}function Z(){f=_.getBoundingClientRect()}function ce(){h=t.getBoundingClientRect()}function ke(Q,he){e=Q,C=Q.length,s=he,ee();const _e=M/(P-f.height)*h.height;pe(_e),x||ne(_e),R(),te()}function ee(){J(),Y()}function J(){let Q=0,he=[];function _e(ze){const be=he[ze+1];return be?be.isMileStone?be:_e(ze+1):null}for(let ze=0;ze<C;ze++){const be=e[ze];let Xe=be.height/s*h.height;he.push({index:be.index,name:be.name,top:Q,height:Xe,isMileStone:be.isMileStone,year:be.year}),Q+=Xe}let Re=-20,me=0;for(let ze=0;ze<C;ze++){const be=he[ze];if(be.isMileStone)be.top+be.height-me>=20&&(be.visible=!1,be.displayMileStone=!0,me=be.top),Re=be.top;else{const Xe=_e(ze),ii=be.top-Re>=10;Xe?ii&&Xe.top-be.top>=10&&(be.visible=!0,Re=be.top):ii&&(be.visible=!0,Re=be.top)}}n=he}function Y(){r.innerHTML="";let Q=n.length;for(let he=0;he<Q;he++){const _e=n[he];(_e.visible||_e.isMileStone)&&r.appendChild(Ne("div",{style:{position:"absolute",top:_e.top+_e.height-Ut+"px",right:"10px",width:Ut+"px",height:Ut+"px",display:"flex",alignItem:"center",justifyContent:"flex-end",boxSizing:"border-box"}},[_e.displayMileStone?Ne("div",{className:"grid-scrollbar-point-text",style:{position:"absolute",top:"-5px",right:"-2px"}},_e.year):null,_e.visible?Ne("div",{style:{width:Ut+"px",height:Ut+"px",borderRadius:"100%",background:da,boxSizing:"border-box"}}):null]))}}function te(){y.hideButton||(M===0?(b=!0,D=!1,g.classList.add("disabled"),E.classList.remove("disabled")):M+f.height===P?(b=!1,D=!0,E.classList.add("disabled"),g.classList.remove("disabled")):(b=!1,D=!1,B||(g.classList.remove("disabled"),E.classList.remove("disabled"))))}function ae(Q,he=!1,_e){if(he)return;let Re;Q.addEventListener("mousedown",me,!1);function me(){B=!0,Re=requestAnimationFrame(be),document.addEventListener("mouseup",ze,!1)}function ze(){cancelAnimationFrame(Re),setTimeout(()=>{cancelAnimationFrame(Re),B=!1,te()},50),document.removeEventListener("mouseup",ze,!1)}function be(){Re=requestAnimationFrame(be),typeof _e=="function"&&_e()}}function fe(Q){p.textContent=Q}function pe(Q=0){a.style.transform=`translate3d(0px, ${Q}px, 0px)`}function ne(Q=0){if(Q>=0&&Q<=h.height){o.style.transform=`translate3d(0px, ${Q}px, 0px)`;let he,_e=n.length;for(let Re=0;Re<_e;Re++){const me=n[Re];Q>=me.top&&Q<me.top+me.height&&(he=me)}he&&fe(he.name)}}function le(Q=0){_.scroll({top:Q/h.height*(_.scrollHeight-f.height)})}function Te(){_.scrollTop+=Cs}function ge(){_.scrollTop-=Cs}function Ue(){k.removeEventListener("resize",oi($,100),!1),k.removeEventListener("passiveResize",oi($,100),!1)}function we(){o.focus()}return{element:d,getContainerInfo:ce,update:ke,updateScroll:V,focus:we,destroy:Ue}}function _a(e,c,_,y,k,L,C,i,n){let l=0,m=[],s=[],h=0,f=0,d=y.padding||120,u=[],t=c,a,o,r,p,g=!1,E,T=0,w=0;const x=Ne("div",{className:"justified-layout w-full"},r=Ne("div",{tabIndex:-1,className:"grid-scroll-panel w-full h-full scrollable scroll-y"+(y.useNativeScrollbar?" use-native-scrollbar":""),style:{position:"relative"},onkeydown:ee=>{ee.altKey&&ee.key==="s"&&(y.useNativeScrollbar||o.focus())},onscroll:R}));e.appendChild(x),t.length===0?(n instanceof HTMLElement&&(Ls(r),r.appendChild(n)),M()):(r.appendChild(I()),B(),_!==null?(N(),M(),setTimeout(()=>{r.scrollTop=_.scrollTop,T=_.scrollTop,T===0&&ie(u)},10)):S()),y.resizeSmooth?(k.addEventListener("passiveResize",F,!1),k.addEventListener("resize",F,!1)):(k.addEventListener("passiveResize",b,!1),k.addEventListener("resize",b,!1));function I(){return p=Ne("div",{className:"grid-layout-container",style:{position:"relative",marginBottom:wt+"px"}},a=Ne("div",{className:"layout"}))}function B(){const ee=r.getBoundingClientRect();f=ee.height;let J=Math.round(ee.width)-d;k.getBounds().width<600&&(J=J-J*.2+d),h=J-J%2,A(h)}function S(){P(),M(),j(),ie(u),z()}function M(){y.useNativeScrollbar||(o=va(s,l,r,y.scrollbar,k))}function P(){const ee=[],J=[];let Y=0;for(let te=0;te<t.length;te++){const ae=t[te],fe=y.useNavieLayout?Ts(h,ae):Ds(h,ae);J.push({index:ae.index,name:ae.name,top:Y,width:h,height:fe.height,loaded:!0,isMileStone:ae.isMileStone,year:ae.year}),ee.push(fe),Y+=fe.height}m=ee,s=J,l=Y,$(Y)}function H(){typeof i=="function"&&i({layoutHeight:l,scrollTop:T,loadedSections:m,sectionBounds:s,lastSectionInViewport:u})}function N(){l=_.layoutHeight,m=_.loadedSections,s=_.sectionBounds,u=_.lastSectionInViewport,$(l)}function F(){t.length!==0&&(E&&cancelAnimationFrame(E),E=requestAnimationFrame(()=>{D()}))}function b(){t.length!==0&&(E&&clearTimeout(E),E=setTimeout(()=>{D()},50))}function D(){q(),B(),P(),y.useNativeScrollbar||o.update(s,l),j(),ie(u),z()}function R(){g||(requestAnimationFrame(()=>{T=r.scrollTop,w=r.scrollHeight,O(),y.useNativeScrollbar||o.updateScroll(T,w),g=!1,setTimeout(()=>{z()},ca)}),g=!0)}function O(){j(),ie(u)}function z(){H(),W()}function W(){const ee=j(!0),J=ee.map(te=>te.index).toString(),Y=u.map(te=>te.index).toString();J!==Y&&(u=ee,z())}function j(ee){const J=[];let Y=s.length;for(let te=0;te<Y;te++){const ae=s[te];wn(ae.top,ae.height,f,T)&&J.push(ae)}return ee||(u=J),J}function X(ee){let J=a.querySelector(`.grid-section[data-index="${ee.index}"]`);if(J||(J=Ne("div",{className:"grid-section",sectionIndex:ee.index,"data-index":ee.index,style:{top:ee.top+"px",height:ee.height+"px"}}),a.appendChild(J)),ee.loaded){const Y=m[ee.index],te=ga(ee.top,Y.segmentInfo,f,T),ae=[...J.getElementsByClassName("grid-segment")];for(let fe=0;fe<ae.length;fe++){const pe=ae[fe];let ne=!1;for(let le=0;le<te.length;le++){const Te=te[le];if(parseInt(pe.dataset.index||"")===Te){ne=!0;break}}ne||pe.remove()}for(let fe=0;fe<te.length;fe++){const pe=te[fe],ne=Y.segments[pe];if(!J.querySelector(`.grid-segment[data-index="${pe}"]`)){const le=Ne("div",{className:"grid-segment",segmentIndex:pe,"data-index":pe,style:{top:ne.top+"px",left:ne.left+"px",width:ne.width+"px",height:ne.height+"px"}},C(ne)),Te=ne.items.length;for(let ge=0;ge<Te;ge++){const Ue=ne.items[ge];let we=L(Ue);le.appendChild(we)}J.appendChild(le)}}}}function ie(ee=[]){const J=[...a.getElementsByClassName("grid-section")];for(let Y=0;Y<J.length;Y++){const te=J[Y];let ae=!1;for(let fe=0;fe<ee.length;fe++){const pe=ee[fe];if(parseInt(te.dataset.index||"")===pe.index){ae=!0;break}}ae||te.remove()}for(let Y=0;Y<ee.length;Y++){const te=ee[Y];X(te)}}function A(ee=0){p.style.width=ee+"px"}function $(ee=0){a.style.height=ee+"px"}function q(){a.innerHTML=""}function V(){t=[],m=[],s=[],y.useNativeScrollbar||o.update(s,0)}function K(ee){ee.length>0?(Ls(r),r.appendChild(I()),t=ee,D(),y.useNativeScrollbar||(o.getContainerInfo(),o.update(s,l)),r.scrollTop=T):(V(),r.innerHTML="",n instanceof HTMLElement&&r.appendChild(n),$(f-wt),y.useNativeScrollbar||o.update([],0))}function Z(ee){const{sectionName:J,sections:Y}=ee;t=Y;const te=s.find(le=>le.name===J);if(!te)return;let ae;y.useNavieLayout?ae=Ts(h,t[te.index]):ae=Ds(h,t[te.index]);let fe=te.height-ae.height;s[te.index].height=ae.height,m[te.index]=ae;let pe=s.length;for(let le=te.index+1;le<pe;le++)s[le].top-=fe;l-=fe,$(l),j();let ne=u.length;for(let le=0;le<ne;le++){const Te=u[le];let ge=a.querySelector(`.grid-section[data-index="${Te.index}"]`);ge instanceof HTMLElement&&ge.remove()}ie(u),y.useNativeScrollbar||(o.getContainerInfo(),o.update(s,l))}function ce(){y.useNativeScrollbar||o.destroy(),y.resizeSmooth?k.removeEventListener("resize",F,!1):k.removeEventListener("resize",b,!1)}function ke(){y.useNativeScrollbar||o.getContainerInfo()}return{element:x,update:K,updateItem:Z,recalculateLayout:D,updateScrollbar:ke,destroy:ce}}function bi(e){let c,_,y,k=!1,L=e.options.find(u=>u.value===e.value),C=[];function i(u){L=u,c.textContent=u.text,e.onChange&&e.onChange(u),h(),m()}const n=e.value?e.options.find(u=>u.value===e.value).text:"Select",l=e.options.map(u=>{const t=u.value===e.value,a=v("div",{className:"select-option"+(t?" selected":""),onclick:i.bind(null,u)},[v("div",{className:"select-option-decorator"}),v("div",{className:"select-option-label"},u.text)]);return C.push({id:u.value,element:a}),a});_=v("div",{className:"select-options"},l);function m(){_.classList.remove("show"),k=!1,y.classList.remove("show"),document.removeEventListener("click",s)}function s(u){u.target!==y&&!y.contains(u.target)&&m()}function h(){C.forEach(u=>{u.element.classList.remove("selected"),L&&u.id===L.value&&u.element.classList.add("selected")})}function f(){k=!k,y.classList[k?"add":"remove"]("show"),k&&(h(),document.addEventListener("click",s)),_.classList.toggle("show")}y=v("div",{className:"select"+(e.noBackground?" no-background":"")},[v("div",{className:"select-placeholder flex items-center",onclick:f},[c=v("div",{className:"select-placeholder-text flex-1"},n),v("div",{className:"select-placeholder-icon",innerHTML:Ks})]),_=v("div",{className:"select-options"},l)]);function d(u){const t=e.options.find(a=>a.value===u);t&&i(t)}return{element:y,setValue:d}}const bn="imgs/apps/photos/",wa=bn+"Thumbnails/",ba=e=>{if(G(e)){_(e);return}const c=y=>{const k=window.photoData;let L,C,i,n;C=v("div",{className:"app-photos w-full h-full standard-content"},v("div",{className:"w-full h-full flex flex-col theme-background"},[v("div",{className:"photos-app-toolbar flex items-center"},[v("div",{className:"photos-app-toolbar-col flex-1"},[v("div",{className:"photos-app-toolbar-nav flex items-center"},[v("div",{className:"photos-app-toolbar-nav-item active"},"Collection"),v("div",{className:"photos-app-toolbar-nav-item"},"Albums"),v("div",{className:"photos-app-toolbar-nav-item"},"Folders")])]),v("div",{className:"photos-app-toolbar-col flex-1 flex content-center"},ki({placeholder:"Search photos or things..."}).element),v("div",{className:"photos-app-toolbar-col photos-app-toolbar-actions flex-1 flex content-end"},[v("div",{className:"photos-app-toolbar-action flex items-center"},[v("div",{className:"photos-app-toolbar-action-icon",innerHTML:zr(20)}),v("div",{className:"photos-app-toolbar-action-text"},"New")]),v("div",{className:"photos-app-toolbar-action flex items-center"},[v("div",{className:"photos-app-toolbar-action-icon",innerHTML:Or(20)}),v("div",{className:"photos-app-toolbar-action-text"},"Select")]),v("div",{className:"photos-app-toolbar-action flex items-center"},[v("div",{className:"photos-app-toolbar-action-icon",innerHTML:Fr(20)}),v("div",{className:"photos-app-toolbar-action-text"},"Import")])])]),i=v("div",{className:"photos-app-content w-full"})])),y.addEventListener("secondInstance",h=>{y.isVisible()||y.show(),y.focus(),_(h)}),y.addEventListener("dragend",()=>{G(L)&&L.updateScrollbar()}),y.addEventListener("ready",()=>{it(i,l()),L=_a(n,k,null,{},y,m,s,()=>{})}),y.addEventListener("restore",()=>{L.recalculateLayout()}),y.addEventListener("snap",()=>{L.recalculateLayout()});function l(){return v("div",{className:"w-full h-full"},[v("div",{className:"photos-app-grid-header flex items-center w-full"},[v("div",{className:"flex items-center flex-1"},[v("div",{className:"flex-shrink-0",style:{marginRight:"10px"}},"View By"),bi({value:"datetaken",options:[{text:"Date taken",value:"datetaken"},{text:"Recently added",value:"recentlyadded"}]}).element]),v("div",{className:"flex items-center flex-1"})]),n=v("div",{className:"photos-app-grid w-full"})])}function m(h){const f=window.encodeURI(wa+h.name),d=window.encodeURI(bn+h.name);let u={};return h.name&&(u.backgroundImage=`url('${f}')`),v("div",{title:h.name,className:"grid-item",style:{top:h.top+"px",left:h.left+"px",width:h.width+"px",height:h.height+"px"}},[v("div",{className:"grid-item-content w-full h-full",style:u,onclick:()=>{_(d)}})])}function s(h){return v("div",{className:"segment-heading flex items-center"},v("div",{className:"segment-heading-inner flex items-center full-height"},v("div",{title:h.name,className:"segment-heading-text text-ellipsis line-clamp-1"},h.name)))}return C};function _(y){G(y)&&He("photoViewer",y)}at({args:e,icon:se.photos.icon,hideIcon:!0,name:se.photos.name,title:se.photos.productName,top:100,left:100,width:980,height:585,center:!0,fluidContent:!0,singleInstance:!0,transprencyContent:!0,content:c})},ei={system:{icon:"imgs/icons/Desktop.png",iconType:"image",text:"System",items:{display:{icon:"",text:"Display",desc:"Monitors, brightness, nightlight, display profile"},sound:{icon:"",text:"Sound",desc:"Volume levels, ouput, input sound devices"},noitification:{icon:"",text:"Noitification",desc:"Alerts from apps and system"},focusAssist:{icon:"",text:"Focus Assist",desc:"Notifications, automatic rules"},powerAndBatery:{icon:"",text:"Power & batery",desc:"Sleep, batery usage, batery saver"},storage:{icon:"",text:"Storage",desc:"View storage usage on driver"},troubleshoot:{icon:"",text:"Troubleshoot",desc:"Recommended troubleshooters, preferences, history"},recovery:{icon:"",text:"Recovery",desc:"Reset, advanced startup, go back"}}},bluetoothAndDevice:{icon:"imgs/icons/Misc/Bluetooth.png",text:"Bluetooth & Devices"},networkAndInternet:{icon:"imgs/icons/Misc/wifi.png",text:"Network & Intenet"},personalization:{icon:"imgs/icons/Personalization.png",iconType:"image",text:"Personalization",items:{background:{icon:"",text:"Background",desc:"Change desktop background image"},colors:{icon:"",text:"Colors",desc:"Accent color, transparency, dark theme"},lockScreen:{icon:"",text:"Lock Screen",desc:"Background image, notifications"},theme:{icon:"",text:"Themes",desc:"Customize window theme"},font:{icon:"",text:"Fonts",desc:"Browser installed fonts or install new fonts"},start:{icon:"",text:"Start",desc:"Pinned apps, remommended"},taskbar:{icon:"",text:"Taskbar",desc:"Taskbar arrangement, position"}}},apps:{icon:"imgs/icons/Misc/15.png",text:"Apps"},accounts:{icon:"imgs/icons/Users.png",iconType:"image",text:"Accounts"},timeAndLanguage:{icon:"imgs/icons/Misc/Time And Language.png",text:"Time & Language"},gaming:{icon:"imgs/icons/Misc/Gaming.png",text:"Gaming"},accessibility:{icon:"imgs/icons/Help.png",text:"Accessibility"},privacyAndSecurity:{icon:"imgs/icons/Security.png",text:"Privacy & Security"},windowUpdate:{icon:"imgs/icons/Emblems/1401.png",text:"Window Update"}},Ms=Object.keys(ei).map((e,c)=>{const _=ei[e];let y=Object.create(null);return y={name:e,icon:_.icon,text:_.text},c===0&&(y.active=!0),y});function ya(e){return v("label",{className:"button "+(e.className||"")},[v("input",{type:"file",accept:e.accept||"",className:"button "+(e.className||""),style:{display:"none"},onchange:e.onChange}),e.children])}function gt(e){return v("div",{className:"setting-nav-row flex flex-wrap"+(e.hasIcon?" has-icon":"")},[v("div",{className:"setting-nav-row-left flex-1"+(G(e.contentCenter)||G(e.itemsCenter)?" flex":"")+(e.contentCenter?" content-center":"")+(e.itemsCenter?" items-center":"")},e==null?void 0:e.contentLeft),v("div",{className:"setting-nav-row-right flex-shrink-0"},e==null?void 0:e.contentRight)])}function tt(e,c){let _=!1,y,k,L;function C(){if(e.isNav){c(e.path);return}_=!_,y.classList[_?"add":"remove"]("expanded"),k.classList[_?"add":"remove"]("show"),L.classList[_?"add":"remove"]("rotate"),k.scrollIntoView()}y=v("div",{className:"setting-nav-item"+(e.isNav?"":" no-hover"),onclick:e.isNav?c.bind(null,e.path):null},[v("div",{className:"setting-nav-item-header flex"},[e.icon?v("div",{className:"setting-nav-item-icon flex items-center content-center flex-shrink-0",innerHTML:e.icon}):null,v("div",{className:"setting-nav-item-info flex-1 flex flex-col content-center"},[v("div",{className:"setting-nav-item-name flex items-center"},e.text),e.desc?v("div",{className:"setting-nav-item-desc flex items-center"},e.desc):null]),e.control?v("div",{className:"setting-nav-item-control flex items-center"},e.control):null,L=v("div",{className:"setting-nav-item-icon setting-nav-item-icon-more flex items-center content-center flex-shrink-0",innerHTML:Ht,onclick:n=>{n.stopPropagation(),C()}})]),e.isNav?null:k=v("div",{className:"setting-nav-item-content"},e.content)]),e.expanded&&C();function i(n){ft(k),Ct(k,n)}return{element:y,setContent:i}}function ts(e,c){return v("div",{className:"setting-nav-list"},e.map(_=>tt(_,c).element))}function Sa(e,c,_){return v("div",{className:"setting-group"},[v("div",{className:"setting-label"},e),v("div",{className:"setting-items"},ts(c,_))])}function xa(e){let c,_,y=[];function k(C){e(C)}c=v("div",{className:"settings-recent-images-container"},[v("div",{className:"settings-recent-images-header"},"Recent Images"),_=v("div",{className:"settings-recent-images flex flex-wrap"},L())]);function L(){return ve.getState("recentImages").recentImages.map((i,n)=>{let l=v("div",{key:n,className:"settings-recent-image",onclick:k.bind(null,i)},v("div",{className:"settings-recent-image-inner",style:{myBackgroundImage:i.thumbnailPath}}));return y.push({id:i.path,element:l}),l})}return Be(re.backgroundImageChange,"settingRecentImage",()=>{ft(_),Ct(_,L())}),c}function yn(e){const{themes:c,themeIndex:_,customTheme:y}=ve.getState(["themes","themeIndex","customTheme"]),L=(_>-1?c[_]:y).backgroundImageStyle,C={};G(e.backgroundImage)&&(C.myBackgroundImage=e.backgroundImage);let i=v("div",{className:"settings-screen-preview",style:C},v("div",{className:"settings-screen-preview-inner"},[v("div",{className:"settings-screen-preview-taskbar"}),v("div",{className:"settings-screen-preview-card"},[v("div",{className:"settings-screen-preview-card-placeholder"},[v("div",{className:"settings-screen-preview-card-placeholder-line"}),v("div",{className:"settings-screen-preview-card-placeholder-line"}),v("div",{className:"settings-screen-preview-card-placeholder-line"}),v("div",{className:"settings-screen-preview-card-placeholder-line half"})]),v("div",{className:"settings-screen-preview-card-button"})])]));Fi(i,L);function n(m){i.style.myBackgroundImage=m}function l(m){Fi(i,m)}return{element:i,changeBackground:n,setBackgroundStyle:l}}function Ca(){const{themeIndex:e,themes:c,customTheme:_}=ve.getState(["themeIndex","themes","customTheme"]),k=(e>-1?c[e]:_).background,L=yn({});let C,i;C=bi({options:[{id:"solid",text:"Solid Color",value:"solid"},{id:"slideshow",text:"Slideshow",value:"slideshow"},{id:"picture",text:"Picture",value:"picture"}],value:"picture",onChange:d=>{i.setContent(m(d.value))}});function n(d){const t=d.target.files[0];if(!t)return;const a=URL.createObjectURL(t),o=st.getState("USER_HOME").USER_HOME+"/AppData/Microsoft/Windows/Desktop/Background/",r=o+t.name,p=o+"Thumbnails/"+t.name;ue.writeFile(o+t.name,t,g=>{g||ln(a,(E,T)=>{ue.writeFile(p,T,w=>{if(!w){const x={name:t.name,path:r,thumbnailPath:p};We.setBackgroundImage(x),L.changeBackground(E)}})})})}function l(){const{themeIndex:d,themes:u,customTheme:t}=ve.getState(["themeIndex","themes","customTheme"]),o=(d>-1?u[d]:t).backgroundImageStyle;return[gt({contentLeft:xa(f)}),gt({contentLeft:"Choose a photo",contentRight:ya({accept:"image/png, image/jpeg",children:"Choose a photo",onChange:n}),itemsCenter:!0}),gt({contentLeft:"Choose a fit for your desktop image",contentRight:bi({options:[{id:"fill",text:"Fill",value:"fill"},{id:"fit",text:"Fit",value:"fit"},{id:"stretch",text:"Stretch",value:"stretch"},{id:"center",text:"Center",value:"center"},{id:"tile",text:"Tile",value:"tile"},{id:"span",text:"Span",value:"span"}],value:o.toLowerCase(),onChange:r=>{L.setBackgroundStyle(r.value),We.setBackgroundStyle(r.value),ut({backgroundImageStyle:r.text})}}).element,itemsCenter:!0})]}function m(d){switch(d){case"solid":return gt({contentLeft:"Solid Color"});case"slideshow":return gt({contentLeft:"Slideshow"});case"picture":return l()}return""}i=tt({name:"background",text:"Personalize your Background",icon:"",desc:"A picture background applies to your current desktop. Solid color or slideshow background apply to all your desktops.",path:"background",control:C.element,expanded:!0,content:l()});let s=v("div",{className:"setting-system flex flex-wrap"},[v("div",{className:"w-full background-selector"},[L.element,i.element,Sa("Related Settings",[{name:"contras theme",text:"Contrast Theme",icon:"",desc:"Color themes for low vision light sensitvity",path:"contras theme"}])])]);h(k);function h(d){L.changeBackground(d.thumbnailPath)}function f(d){h(d),We.setBackgroundImage(d)}return{element:s,dispose:()=>{}}}function Bi(e,c,_){let y,k;function L(l){const m=l.target;typeof _=="function"&&_(m.checked),C(m.checked)}function C(l){i.classList[l?"add":"remove"]("checked"),k.innerHTML=l?Er:""}const i=v("div",{className:"checkbox"},v("label",{className:"flex items-center"},[y=v("input",{type:"checkbox",style:{display:"none"},checked:c,onchange:L}),k=v("div",{className:"checkbox-mark flex items-center content-center"}),v("div",{className:"checkbox-label"},e)]));C(c);function n(l){y.checked=l,C(l)}return{element:i,setChecked:n}}function ka(e){let c,_,y,k=0;function L(m){y=c.getBoundingClientRect(),k=n(m.clientX),l(k),document.addEventListener("mousemove",C,!1),document.addEventListener("mouseup",i,!1),e!=null&&e.onChange&&e.onChange(k),e!=null&&e.onDidChange&&e.onDidChange(k)}function C(m){m.clientX<y.left||m.clientX>y.left+y.width||(k=n(m.clientX),l(k),e!=null&&e.onChange&&e.onChange(k))}function i(){e!=null&&e.onDidChange&&e.onDidChange(k),document.removeEventListener("mousemove",C,!1),document.removeEventListener("mouseup",i,!1)}c=v("div",{className:"hue-picker",style:{position:"relative",width:"360px",height:"30px"},onmousedown:L},_=v("div",{className:"hue-picker-mark"}));function n(m=0){return m-y.left}function l(m=0){_.style.left=m-1+"px"}return{element:c,setValue:l}}function ti(e){let c=!1,_;_=v("div",{className:"toggle",onclick:()=>{y(),e.onChange&&e.onChange(c)}},[v("div",{className:"toggle-button"}),v("div",{className:"toggle-indicator"}),e.showLabel?v("div",{className:"toggle-label"},e.label):null]),k(e.checked);function y(){c=!c,_.classList.toggle("checked",c)}function k(L){c=L,_.classList.toggle("checked",c)}return{element:_,get checked(){return c},set checked(L){k(L)}}}const ai="setting-color";function Ea(){let{themes:e,themeIndex:c,customTheme:_}=ve.getState(["themes","themeIndex","customTheme"]);const y=c>-1?e[c]:_,{useTitleBarAccentColor:k,useTaskbarAndStartMenuAccentColor:L,useWindowBorderAccentColor:C,accentColor:i,transparency:n,dark:l}=y;let m=ti({label:"Dark Theme",checked:l,onChange:a=>{Qi(a)}}),s=ti({label:"Dark Theme",checked:n,onChange:a=>{es(a)}}),h=ka({onChange:d,onDidChange:u}),f=v("div",{className:"setting-personalization-colors"},[tt({name:"darktheme",text:"Dark Theme",icon:"",desc:"Dark theme for all windows",path:"personalization/colors/darktheme",control:m.element}).element,tt({name:"transparency",text:"Transparency",icon:"",desc:"Transparency for all windows",path:"personalization/colors/transparency",control:s.element}).element,tt({name:"accentColor",text:"Accent Color",icon:"",desc:"Choose your accent color",path:"personalization/colors/accentColor",expanded:!0,content:gt({contentLeft:v("div",null,h.element)})}).element,tt({name:"showAccentColor",text:"Show Accent Color",icon:"",expanded:!0,desc:"Show accent color on the following surfaces",path:"personalization/colors/showAccentColor",content:gt({contentLeft:[v("div",null,Bi("Window Titlebar",k,a=>{Nt("use-titlebar-accent-color",a),ut({useTitleBarAccentColor:a})}).element),v("div",null,Bi("Start menu, Taskbar,...",L,a=>{Nt("use-startmenu-and-taskbar-accent-color",a),ut({useTaskbarAndStartMenuAccentColor:a})}).element),v("div",null,Bi("Window Borders",C,a=>{Nt("use-window-border-accent-color",a),ut({useWindowBorderAccentColor:a})}).element)]})}).element]);h.setValue(i.h);function d(a){hn({h:a,s:y.dark?100:70,l:y.dark?60:50},!1)}function u(a){ut({accentColor:{h:a,s:y.dark?100:70,l:y.dark?60:50}})}Be(re.themeChange,ai,a=>{m.checked=a}),Be(re.transparentChange,ai,a=>{s.checked=a});function t(){f.remove(),f=null,Jt(re.themeChange,ai),Jt(re.nightLightChange,ai)}return{element:f,dispose:t}}function La(e){const{themes:c,themeIndex:_}=ve.getState(["themes","themeIndex"]);let y=_,k;function L(C,i,n){const{themeIndex:l}=ve.getState(["themeIndex"]);l>-1&&n===y||(y=n,Array.from(k.children).forEach(m=>{m.classList.remove("selected-item")}),C.classList.add("selected-item"),e(i,n))}return Be(re.customThemeChange,"quicktheme",()=>{Array.from(k.children).forEach(C=>{C.classList.remove("selected-item")})}),k=v("div",{className:"setting-quick-theme flex",onBeforeRemove(){Jt(re.customThemeChange,"quicktheme")}},c.map((C,i)=>v("div",{className:"setting-quick-theme-item"+(i===y?" active selected-item":""),onclick:n=>{L(n.currentTarget,C,i)}},v("div",{className:"setting-quick-theme-item-inner"},[v("div",{className:"setting-quick-theme-item-image",style:{backgroundImage:`url("${C.background.thumbnailPath}")`}}),v("div",{className:"setting-quick-theme-item-color flex items-end content-center",style:{backgroundColor:C.dark?"#333":"#f8f8f8"}},v("div",{className:"setting-quick-theme-item-color-accent",style:{backgroundColor:`hsl(${C.accentColor.h},${C.accentColor.s}%,${C.accentColor.l}%)`}}))])))),k}function Da(e){let c=ei.personalization.items,_;_=Object.keys(c).map(u=>{const t=c[u];return{isNav:!0,name:u,text:t.text,icon:t.icon,desc:t.desc,path:"personalization/"+u}});const{roundedCorner:y,useBorder:k,themes:L,themeIndex:C,customTheme:i}=ve.getState(["roundedCorner","useBorder","backgroundImage","themes","themeIndex","customTheme"]),n=C>-1?L[C]:i;zi(y);const l={isNav:!1,name:"roundedCorner",icon:"",text:"Rounded Corner",desc:"Atjust window and controls corner radius",path:"personalization/roundedCorner",control:ti({label:"Rounded Corner",checked:y,onChange:u=>{zi(u),ve.setState({roundedCorner:u})}}).element},m={isNav:!1,name:"useBorder",icon:"",text:"Window Border",desc:"Show window border",path:"personalization/useBorder",control:ti({checked:k,onChange:u=>{cn(u),ve.setState({useBorder:u})}}).element},s=yn({});function h(u,t,a=!0){un(u),d(u.background),a&&ve.setState({themeIndex:t})}let f=v("div",{className:"setting-personalization"},[v("div",{className:"w-full flex flex-wrap"},[v("div",{style:{marginTop:"28px",marginRight:"40px"}},s.element),v("div",{className:"flex-1"},[v("div",{style:{height:"26px",fontWeight:"bold",fontSize:"14px"}},"Select a theme to apply"),La(h)])]),ts(_,e),tt(l,e).element,tt(m,e).element]);d(n.background);function d(u){s.changeBackground(u.thumbnailPath)}return{element:f,dispose:()=>{}}}function Sn(e){return e?v("div",{className:"setting-help flex-shrink-0"},[e.relates&&v("div",{className:"setting-system-help-items"},e.relates.map(c=>{var _;return v("div",{className:"setting-system-help-item",onclick:(_=c.onClick)==null?void 0:_.bind(null,c.name)},[v("div",{className:"setting-system-help-item-label"},c.text),v("div",{className:"setting-system-help-item-content"},c.desc)])})),e.actions&&v("div",{className:"setting-system-help-actions"},[v("div",{className:"setting-system-help-item-label"},"Have a question?"),v("div",{className:"setting-system-help-actions-list"},e.actions.map(c=>{var _;return v("div",{onclick:(_=c.onClick)==null?void 0:_.bind(null,c.name),className:"setting-system-help-item-link"},c.text)}))])]):null}function Ta(){const e=()=>"settings/system/",{nightlight:c}=ve.getState("nightlight"),_=ti({checked:c,onChange:()=>{Qt.toogleNightLight()}});Be(re.nightLightChange,"settings-display-nightlight",n=>{_.checked=n});const y=[{path:"",text:"Night light",desc:"Use warmer colors to help block blue light",icon:"",name:"nightlight",control:_.element,content:gt({itemsCenter:!0,contentLeft:"Atjust the color of the screen to help block blue light"})},{path:"",text:"HDR",desc:"More about HDR",icon:"",name:"nightlight"}],k=tt(y[0]),L=tt(y[1]);let C=v("div",{className:"setting-system-display flex flex-wrap",onBeforeRemove(){Jt(re.nightLightChange,"settings-display-nightlight")}},[v("div",{className:"flex-1"},v("div",{className:"setting-system-main-content"},[k.element,L.element])),Sn({relates:[{name:e()+"nightlight",text:"Sleep better",desc:"Nightlight can help you get to sleep by displaying warmer colors at night. Select Night light settings to set things up."}],actions:[{name:"",text:"Changing screen brightness",desc:""},{name:"",text:"Adjusting font size",desc:""}]})]);function i(){C.remove(),C=null}return{element:C,dispose:i}}function Ma(e){return v("button",{className:"button "+(e.className||""),onclick:e.onclick},e.children)}function Ia(){let e=v("div",{className:"setting-recovery"},[v("div",{},"If you're having problems with your PC or want to reset it, these recovery options might help"),v("div",{},[tt({path:"",text:"Reset this PC",desc:"Choose or keep your personal files, then reinstall Windows",icon:"",name:"recovery",control:Ma({children:"Reset PC",onclick(){jo()}})}).element])]);function c(){e=null}return{element:e,dispose:c}}function Ba(){const{themes:e,themeIndex:c,customTheme:_}=ve.getState(["themes","themeIndex","customTheme"]),k=(c>-1?e[c]:_).background;let L;const{USER_NAME:C}=st.getState("USER_NAME");let i=v("div",{className:"setting-system-overall",onBeforeRemove(){Jt(re.backgroundImageChange,"setting-system")}},[v("div",{className:"flex"},[v("div",{className:"setting-system-desktop relative"},L=v("div",{className:"setting-system-desktop-inner image-cover"})),v("div",{className:"setting-system-info"},[v("div",{className:"setting-system-info-name"},`${C}`),v("div",{className:"setting-system-info-role"},"Administrator"),v("div",{className:"setting-system-info-action"},"Rename")])]),v("div",{className:"setting-system-office flex"},[v("div",{className:"setting-system-office-onedrive flex"},[v("div",{className:"setting-system-office-onedrive-icon flex items-center content-center"}),v("div",{className:"setting-system-office-onedrive-info"},[v("div",{className:"setting-system-office-onedrive-info-name"},"OneDrive"),v("div",{className:"setting-system-office-onedrive-info-action"},"Manage")])])])]);k&&n(k.path),Be(re.backgroundImageChange,"setting-system",l=>{n(l.path)});function n(l){L.style.myBackgroundImage=l}return i}function Ra(e){let c=ei.system.items,_;_=Object.keys(c).map(L=>{const C=c[L];return{isNav:!0,name:L,text:C.text,icon:C.icon,iconType:C.iconType,desc:C.desc,path:"system/"+L}});let y=v("div",{className:"setting-system flex flex-wrap"},[v("div",{className:"flex-1"},v("div",{className:"setting-system-main-content"},[Ba(),ts(_,e)])),Sn()]);function k(){y.remove(),y=null}return{element:y,dispose:k}}function Pe(){let e=v("div",{},"In progress");function c(){e.remove(),e=null}return{element:e,dispose:c}}const Aa={system:{content:Ra,children:{display:{content:Ta},sound:{content:Pe},noitification:{content:Pe},focusAssist:{content:Pe},powerAndBatery:{content:Pe},storage:{content:Pe},troubleshoot:{content:Pe},recovery:{content:Ia}}},bluetoothAndDevice:{content:Pe},networkAndInternet:{content:Pe},personalization:{content:Da,children:{background:{content:Ca},colors:{content:Ea},lockScreen:{content:Pe},theme:{content:Pe},font:{content:Pe},start:{content:Pe},taskbar:{content:Pe}}},apps:{content:Pe},accounts:{content:Pe},timeAndLanguage:{content:Pe},gaming:{content:Pe},accessibility:{content:Pe},privacyAndSecurity:{content:Pe},windowUpdate:{content:Pe}};function Na(e,c,_){let y=v("div",{className:"setting-sidebar-nav-item flex items-center"+(e.active?" active":""),onclick:()=>_(e,y,c)},[v("div",{className:"setting-sidebar-nav-item-icon flex-shrink-0",style:{backgroundImage:`url("${e.icon}")`}}),v("div",{className:"setting-sidebar-nav-item-text"},e.text)]);return y}function Pa(e){const c=Ms.map((n,l)=>Na(n,l,C));let _=0,y=c[0];y.classList.add("active");let k=ki({placeholder:"Find a Setting"}),L=v("div",{className:"setting-sidebar h-full flex-shrink-0"},v("div",{className:"setting-sidebar-inner standard-content w-full h-full"},v("div",{className:"w-full h-full flex flex-col"},[v("div",{className:"setting-sidebar-heading"},k.element),v("div",{tabIndex:0,className:"setting-sidebar-nav scrollable scroll-y"},c)])));function C(n,l,m){m!==_&&(y.classList.remove("active"),l.classList.add("active"),_=m,y=l,e(n.name))}function i(n){const l=n.split("/")[0];if(l){const m=Ms.findIndex(s=>s.name===l);if(m>-1){y.classList.remove("active");let s=c[m];_=m,s.classList.add("active"),y=s}}}return{element:L,setRoute:i}}function Ha(e){let c;const _=v("div",{className:"setting-content-heading flex-shrink-0 flex items-center"},c=v("div",{className:"setting-content-heading-item"},"System"));function y(k){const L=v("div",{className:"w-full flex items-center"},k.map((C,i)=>{let n=v("div",{className:"setting-content-heading-route flex items-center"+(i===k.length-1&&i>0?" disabled":""),onclick:k.length-1?e.bind(null,C.path):null},C.text);return i>0&&n.prepend(v("div",{className:"setting-content-heading-route-divider flex-center",innerHTML:Ht})),n}));c.innerHTML="",c.appendChild(L)}return{element:_,setRoute:y}}function Oa(e){let c;const _=Ha(e);let y,k=v("div",{className:"setting-content w-full h-full"},v("div",{className:"setting-content-inner standard-content w-full h-full flex flex-col"},[_.element,y=v("div",{tabIndex:0,className:"setting-content-main scrollable scroll-y"})]));function L(C){const i=C.split("/"),n=i.length;if(n===0)return;let l=Aa[i[0]];if(!l)return;c&&c.dispose();let m;n===1?m=l.content(e):n===2&&(m=l.children[i[1]].content(e)),c=m;const s=i.reduce((h,f,d)=>(h.path+=f,h.currentSetting=d===0?ei[f]:h.currentSetting.items[f],h.routes.push({text:h.currentSetting.text,path:h.path}),d<n-1&&(h.path+="/"),h),{routes:[],path:"",currentSetting:Object.create(null)});_.setRoute(s.routes),ft(y),y.scrollTop=0,y.appendChild(m.element)}return{element:k,update:L}}const Fa=e=>{const c=function(y){let k=Pa(i),L=Oa(i);function C(n){k.setRoute(n),L.update(n)}e?C(e):L.update("system"),y.addEventListener("secondInstance",n=>{y.isVisible()||y.show(),y.focus(),n&&C(n)});function i(n){L.update(n)}return v("div",{className:"app-settings w-full h-full"},v("div",{className:"setting-inner flex w-full h-full"},[k.element,L.element]))},_=v("div",{className:"w-full h-full flex items-center"},[v("div",{["drag-region"]:"drag",className:"flex-1 h-full"}),v("div",{className:"setting-user-info-avatar",style:{padding:"6px"}},v("div",{className:"setting-user-info-avatar-image w-full h-full",style:{marginLeft:"auto",backgroundImage:`url("${_r}")`,backgroundSize:"cover"}}))]);at({args:e,icon:se.settings.icon,name:se.settings.name,title:se.settings.productName,singleInstance:!0,titlebarHeight:36,titlebarContent:_,top:200,left:300,minWidth:700,minHeight:400,width:1e3,height:540,center:!0,fluidContent:!0,transprencyContent:!0,content:c})};function za(e){const k=Vi("calculator",{top:50,left:ye.width-380-50});let{top:L,left:C}=k.getState();L>ye.height-Fe-kt&&(L=50),C>ye.width-380-50&&(C=ye.width-380-50);let i,n;const l=bi({options:[{id:"standard",value:"standard",text:"Standard"},{id:"scientific",value:"scientific",text:"Scientific"},{id:"programmer",value:"programmer",text:"Programmer"}],value:"standard",noBackground:!0,onChange(u){m(u.value),i.setContent(n)}});i=at({icon:se.calculator.icon,name:se.calculator.name,title:se.calculator.productName,titlebarHeight:36,titlebarContent:l.element,top:L,left:C,width:380,height:500,disableResize:!0,disableMaximize:!0,transprencyContent:!0}),i.addEventListener("dragend",u=>{k.setState({top:u.top,left:u.left})}),i.addEventListener("focus",()=>{n.focus()}),m("standard"),i.setContent(n);function m(u){switch(u){case"standard":n=h();break;case"scientific":n=f();break;case"programmer":n=d();break;default:n=h();break}}function s(u,t){const a={};return u.type==="command"&&u.value==="="&&(a.color="var(--accent-color)"),v("div",{className:"calculator-button flex flex-1 items-center content-center"+(u.type==="number"?" emphasis":""),onclick:t.bind(null,u.type,u.value),innerHTML:u.content,style:a})}function h(){let u,t,a,o="",r="",p="",g=48;function E(){let N;const F=parseFloat(o);let b=parseFloat(r);if(!(isNaN(F)||isNaN(b))){switch(p){case"+":N=F+b;break;case"-":N=F-b;break;case"x":N=F*b;break;case"/":N=F/b;break}r=N.toString(),p=null,o=""}}function T(){o="",p="",w()}function w(){r="0",t.style.removeProperty("font-size")}function x(N){const F=N.toString(),b=parseFloat(F.split(".")[0]),D=F.split(".")[1];let R;return isNaN(b)?R="":R=b.toLocaleString("en",{maximumFractionDigits:0}),D!=null?`${R}.${D}`:R}function I(N){N==="."&&r.includes(".")||(r=r.toString()+N.toString())}function B(N){r!==""&&(o!==""&&E(),p=N,o=r,r="")}function S(N){t.scrollWidth>t.offsetWidth&&(N-=2,t.style.fontSize=N+"px",S(N))}function M(){u.textContent=x(parseFloat(r)),S(g),G(p)?a.textContent=`${x(parseFloat(o))} ${p}`:a.textContent=""}function P(N,F){if(N==="number")I(F),M();else if(N==="operator")B(F),M();else if(N==="command"){switch(F){case"c":T();break;case"ce":w();break;case"=":E();break;case"sqrt":r=Math.sqrt(parseFloat(r)).toString();break;case"negative":r=(parseFloat(r)*-1).toString();break}M()}}function H(N){let F=/[0-9]/g,b=/[+\-*\/]/g;N.key.match(F)&&(N.preventDefault(),I(N.key),M()),N.key==="."&&(N.preventDefault(),I(N.key),M()),N.key.match(b)&&(N.preventDefault(),B(N.key),M()),(N.key==="Enter"||N.key==="=")&&(N.preventDefault(),E(),M()),N.key==="Backspace"&&(N.preventDefault(),w(),M()),N.key==="Delete"&&(N.preventDefault(),T(),M())}return v("div",{tabIndex:-1,className:"w-full h-full flex flex-col",onkeydown:H},[v("div",{className:"w-full calculator-display flex flex-col"},[a=v("div",{className:"calculator-display-input flex items-center content-end"}),t=v("div",{className:"calculator-display-result flex-1 flex items-center content-end no-scrollbar"},u=v("div",{className:"w-full"},"0"))]),v("div",{className:"w-full h-full calculator-buttons flex flex-col"},[v("div",{className:"w-full calculator-buttons-row flex flex-1"},[s({type:"command",value:"sqrt",content:'<svg class="svg-icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M277.7 843.7h-35.6L93.6 483.2h-76V445h105.6l132.6 330.4 159.6-635.1h37.8L277.7 843.7zM831.6 773.7L697.7 578.8 563.4 773.7h-45.1l155.4-223.6-148.1-212.5h46.8l125.3 183.7 124.9-183.7h47.2L722.2 549.2l157.1 224.4h-47.7z"  /><path d="M984.5 176h-568v-37.1h568V176z"  /></svg>'},P),s({type:"command",value:"ce",content:"CE"},P),s({type:"command",value:"c",content:"C"},P),s({type:"operator",value:"/",content:"/"},P)]),v("div",{className:"w-full calculator-buttons-row flex flex-1"},[s({type:"number",value:"7",content:"7"},P),s({type:"number",value:"8",content:"8"},P),s({type:"number",value:"9",content:"9"},P),s({type:"operator",value:"x",content:"&#215;"},P)]),v("div",{className:"w-full calculator-buttons-row flex flex-1"},[s({type:"number",value:"4",content:"4"},P),s({type:"number",value:"5",content:"5"},P),s({type:"number",value:"6",content:"6"},P),s({type:"operator",value:"-",content:"&#8722;"},P)]),v("div",{className:"w-full calculator-buttons-row flex flex-1"},[s({type:"number",value:"1",content:"1"},P),s({type:"number",value:"2",content:"2"},P),s({type:"number",value:"3",content:"3"},P),s({type:"operator",value:"+",content:"+"},P)]),v("div",{className:"w-full calculator-buttons-row flex flex-1"},[s({type:"command",value:"negative",content:"+/-"},P),s({type:"number",value:"0",content:"0"},P),s({type:"number",value:".",content:"."},P),s({type:"command",value:"=",content:"="},P)])])])}function f(){return v("div",{className:"w-full h-full flex content-center items-center"},v("h1",{},"Scientific Calculator"))}function d(){return v("div",{className:"w-full h-full flex content-center items-center"},v("h1",{},"Programmer Calculator"))}}var Ui={},Wa={get exports(){return Ui},set exports(e){Ui=e}};(function(e,c){(function(_,y){e.exports=y()})(self,()=>(()=>{var _={4567:function(C,i,n){var l=this&&this.__decorate||function(r,p,g,E){var T,w=arguments.length,x=w<3?p:E===null?E=Object.getOwnPropertyDescriptor(p,g):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(r,p,g,E);else for(var I=r.length-1;I>=0;I--)(T=r[I])&&(x=(w<3?T(x):w>3?T(p,g,x):T(p,g))||x);return w>3&&x&&Object.defineProperty(p,g,x),x},m=this&&this.__param||function(r,p){return function(g,E){p(g,E,r)}};Object.defineProperty(i,"__esModule",{value:!0}),i.AccessibilityManager=void 0;const s=n(9042),h=n(6114),f=n(9924),d=n(844),u=n(5596),t=n(4725),a=n(3656);let o=i.AccessibilityManager=class extends d.Disposable{constructor(r,p){super(),this._terminal=r,this._renderService=p,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let g=0;g<this._terminal.rows;g++)this._rowElements[g]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[g]);if(this._topBoundaryFocusListener=g=>this._handleBoundaryFocus(g,0),this._bottomBoundaryFocusListener=g=>this._handleBoundaryFocus(g,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new f.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(g=>this._handleResize(g.rows))),this.register(this._terminal.onRender(g=>this._refreshRows(g.start,g.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(g=>this._handleChar(g))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(g=>this._handleTab(g))),this.register(this._terminal.onKey(g=>this._handleKey(g.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new u.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,a.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,d.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(r){for(let p=0;p<r;p++)this._handleChar(" ")}_handleChar(r){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==r&&(this._charsToAnnounce+=r):this._charsToAnnounce+=r,r===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=s.tooMuchOutput)),h.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,h.isMac&&this._liveRegion.remove()}_handleKey(r){this._clearLiveRegion(),/\p{Control}/u.test(r)||this._charsToConsume.push(r)}_refreshRows(r,p){this._liveRegionDebouncer.refresh(r,p,this._terminal.rows)}_renderRows(r,p){const g=this._terminal.buffer,E=g.lines.length.toString();for(let T=r;T<=p;T++){const w=g.translateBufferLineToString(g.ydisp+T,!0),x=(g.ydisp+T+1).toString(),I=this._rowElements[T];I&&(w.length===0?I.innerText=" ":I.textContent=w,I.setAttribute("aria-posinset",x),I.setAttribute("aria-setsize",E))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(r,p){const g=r.target,E=this._rowElements[p===0?1:this._rowElements.length-2];if(g.getAttribute("aria-posinset")===(p===0?"1":`${this._terminal.buffer.lines.length}`)||r.relatedTarget!==E)return;let T,w;if(p===0?(T=g,w=this._rowElements.pop(),this._rowContainer.removeChild(w)):(T=this._rowElements.shift(),w=g,this._rowContainer.removeChild(T)),T.removeEventListener("focus",this._topBoundaryFocusListener),w.removeEventListener("focus",this._bottomBoundaryFocusListener),p===0){const x=this._createAccessibilityTreeNode();this._rowElements.unshift(x),this._rowContainer.insertAdjacentElement("afterbegin",x)}else{const x=this._createAccessibilityTreeNode();this._rowElements.push(x),this._rowContainer.appendChild(x)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(p===0?-1:1),this._rowElements[p===0?1:this._rowElements.length-2].focus(),r.preventDefault(),r.stopImmediatePropagation()}_handleResize(r){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let p=this._rowContainer.children.length;p<this._terminal.rows;p++)this._rowElements[p]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[p]);for(;this._rowElements.length>r;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const r=document.createElement("div");return r.setAttribute("role","listitem"),r.tabIndex=-1,this._refreshRowDimensions(r),r}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let r=0;r<this._terminal.rows;r++)this._refreshRowDimensions(this._rowElements[r])}}_refreshRowDimensions(r){r.style.height=`${this._renderService.dimensions.css.cell.height}px`}};i.AccessibilityManager=o=l([m(1,t.IRenderService)],o)},3614:(C,i)=>{function n(h){return h.replace(/\r?\n/g,"\r")}function l(h,f){return f?"\x1B[200~"+h+"\x1B[201~":h}function m(h,f,d,u){h=l(h=n(h),d.decPrivateModes.bracketedPasteMode&&u.rawOptions.ignoreBracketedPasteMode!==!0),d.triggerDataEvent(h,!0),f.value=""}function s(h,f,d){const u=d.getBoundingClientRect(),t=h.clientX-u.left-10,a=h.clientY-u.top-10;f.style.width="20px",f.style.height="20px",f.style.left=`${t}px`,f.style.top=`${a}px`,f.style.zIndex="1000",f.focus()}Object.defineProperty(i,"__esModule",{value:!0}),i.rightClickHandler=i.moveTextAreaUnderMouseCursor=i.paste=i.handlePasteEvent=i.copyHandler=i.bracketTextForPaste=i.prepareTextForTerminal=void 0,i.prepareTextForTerminal=n,i.bracketTextForPaste=l,i.copyHandler=function(h,f){h.clipboardData&&h.clipboardData.setData("text/plain",f.selectionText),h.preventDefault()},i.handlePasteEvent=function(h,f,d,u){h.stopPropagation(),h.clipboardData&&m(h.clipboardData.getData("text/plain"),f,d,u)},i.paste=m,i.moveTextAreaUnderMouseCursor=s,i.rightClickHandler=function(h,f,d,u,t){s(h,f,d),t&&u.rightClickSelect(h),f.value=u.selectionText,f.select()}},7239:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ColorContrastCache=void 0;const l=n(1505);i.ColorContrastCache=class{constructor(){this._color=new l.TwoKeyMap,this._css=new l.TwoKeyMap}setCss(m,s,h){this._css.set(m,s,h)}getCss(m,s){return this._css.get(m,s)}setColor(m,s,h){this._color.set(m,s,h)}getColor(m,s){return this._color.get(m,s)}clear(){this._color.clear(),this._css.clear()}}},3656:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.addDisposableDomListener=void 0,i.addDisposableDomListener=function(n,l,m,s){n.addEventListener(l,m,s);let h=!1;return{dispose:()=>{h||(h=!0,n.removeEventListener(l,m,s))}}}},6465:function(C,i,n){var l=this&&this.__decorate||function(t,a,o,r){var p,g=arguments.length,E=g<3?a:r===null?r=Object.getOwnPropertyDescriptor(a,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(t,a,o,r);else for(var T=t.length-1;T>=0;T--)(p=t[T])&&(E=(g<3?p(E):g>3?p(a,o,E):p(a,o))||E);return g>3&&E&&Object.defineProperty(a,o,E),E},m=this&&this.__param||function(t,a){return function(o,r){a(o,r,t)}};Object.defineProperty(i,"__esModule",{value:!0}),i.Linkifier2=void 0;const s=n(3656),h=n(8460),f=n(844),d=n(2585);let u=i.Linkifier2=class extends f.Disposable{get currentLink(){return this._currentLink}constructor(t){super(),this._bufferService=t,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new h.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new h.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,f.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,f.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}registerLinkProvider(t){return this._linkProviders.push(t),{dispose:()=>{const a=this._linkProviders.indexOf(t);a!==-1&&this._linkProviders.splice(a,1)}}}attachToDom(t,a,o){this._element=t,this._mouseService=a,this._renderService=o,this.register((0,s.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,s.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,s.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,s.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(t){if(this._lastMouseEvent=t,!this._element||!this._mouseService)return;const a=this._positionFromMouseEvent(t,this._element,this._mouseService);if(!a)return;this._isMouseOut=!1;const o=t.composedPath();for(let r=0;r<o.length;r++){const p=o[r];if(p.classList.contains("xterm"))break;if(p.classList.contains("xterm-hover"))return}this._lastBufferCell&&a.x===this._lastBufferCell.x&&a.y===this._lastBufferCell.y||(this._handleHover(a),this._lastBufferCell=a)}_handleHover(t){if(this._activeLine!==t.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(t,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,t)||(this._clearCurrentLink(),this._askForLink(t,!0))}_askForLink(t,a){var o,r;this._activeProviderReplies&&a||((o=this._activeProviderReplies)===null||o===void 0||o.forEach(g=>{g==null||g.forEach(E=>{E.link.dispose&&E.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=t.y);let p=!1;for(const[g,E]of this._linkProviders.entries())a?!((r=this._activeProviderReplies)===null||r===void 0)&&r.get(g)&&(p=this._checkLinkProviderResult(g,t,p)):E.provideLinks(t.y,T=>{var w,x;if(this._isMouseOut)return;const I=T==null?void 0:T.map(B=>({link:B}));(w=this._activeProviderReplies)===null||w===void 0||w.set(g,I),p=this._checkLinkProviderResult(g,t,p),((x=this._activeProviderReplies)===null||x===void 0?void 0:x.size)===this._linkProviders.length&&this._removeIntersectingLinks(t.y,this._activeProviderReplies)})}_removeIntersectingLinks(t,a){const o=new Set;for(let r=0;r<a.size;r++){const p=a.get(r);if(p)for(let g=0;g<p.length;g++){const E=p[g],T=E.link.range.start.y<t?0:E.link.range.start.x,w=E.link.range.end.y>t?this._bufferService.cols:E.link.range.end.x;for(let x=T;x<=w;x++){if(o.has(x)){p.splice(g--,1);break}o.add(x)}}}}_checkLinkProviderResult(t,a,o){var r;if(!this._activeProviderReplies)return o;const p=this._activeProviderReplies.get(t);let g=!1;for(let E=0;E<t;E++)this._activeProviderReplies.has(E)&&!this._activeProviderReplies.get(E)||(g=!0);if(!g&&p){const E=p.find(T=>this._linkAtPosition(T.link,a));E&&(o=!0,this._handleNewLink(E))}if(this._activeProviderReplies.size===this._linkProviders.length&&!o)for(let E=0;E<this._activeProviderReplies.size;E++){const T=(r=this._activeProviderReplies.get(E))===null||r===void 0?void 0:r.find(w=>this._linkAtPosition(w.link,a));if(T){o=!0,this._handleNewLink(T);break}}return o}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(t){if(!this._element||!this._mouseService||!this._currentLink)return;const a=this._positionFromMouseEvent(t,this._element,this._mouseService);a&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,a)&&this._currentLink.link.activate(t,this._currentLink.link.text)}_clearCurrentLink(t,a){this._element&&this._currentLink&&this._lastMouseEvent&&(!t||!a||this._currentLink.link.range.start.y>=t&&this._currentLink.link.range.end.y<=a)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,f.disposeArray)(this._linkCacheDisposables))}_handleNewLink(t){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const a=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);a&&this._linkAtPosition(t.link,a)&&(this._currentLink=t,this._currentLink.state={decorations:{underline:t.link.decorations===void 0||t.link.decorations.underline,pointerCursor:t.link.decorations===void 0||t.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,t.link,this._lastMouseEvent),t.link.decorations={},Object.defineProperties(t.link.decorations,{pointerCursor:{get:()=>{var o,r;return(r=(o=this._currentLink)===null||o===void 0?void 0:o.state)===null||r===void 0?void 0:r.decorations.pointerCursor},set:o=>{var r,p;!((r=this._currentLink)===null||r===void 0)&&r.state&&this._currentLink.state.decorations.pointerCursor!==o&&(this._currentLink.state.decorations.pointerCursor=o,this._currentLink.state.isHovered&&((p=this._element)===null||p===void 0||p.classList.toggle("xterm-cursor-pointer",o)))}},underline:{get:()=>{var o,r;return(r=(o=this._currentLink)===null||o===void 0?void 0:o.state)===null||r===void 0?void 0:r.decorations.underline},set:o=>{var r,p,g;!((r=this._currentLink)===null||r===void 0)&&r.state&&((g=(p=this._currentLink)===null||p===void 0?void 0:p.state)===null||g===void 0?void 0:g.decorations.underline)!==o&&(this._currentLink.state.decorations.underline=o,this._currentLink.state.isHovered&&this._fireUnderlineEvent(t.link,o))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(o=>{if(!this._currentLink)return;const r=o.start===0?0:o.start+1+this._bufferService.buffer.ydisp,p=this._bufferService.buffer.ydisp+1+o.end;if(this._currentLink.link.range.start.y>=r&&this._currentLink.link.range.end.y<=p&&(this._clearCurrentLink(r,p),this._lastMouseEvent&&this._element)){const g=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);g&&this._askForLink(g,!1)}})))}_linkHover(t,a,o){var r;!((r=this._currentLink)===null||r===void 0)&&r.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(a,!0),this._currentLink.state.decorations.pointerCursor&&t.classList.add("xterm-cursor-pointer")),a.hover&&a.hover(o,a.text)}_fireUnderlineEvent(t,a){const o=t.range,r=this._bufferService.buffer.ydisp,p=this._createLinkUnderlineEvent(o.start.x-1,o.start.y-r-1,o.end.x,o.end.y-r-1,void 0);(a?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(p)}_linkLeave(t,a,o){var r;!((r=this._currentLink)===null||r===void 0)&&r.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(a,!1),this._currentLink.state.decorations.pointerCursor&&t.classList.remove("xterm-cursor-pointer")),a.leave&&a.leave(o,a.text)}_linkAtPosition(t,a){const o=t.range.start.y*this._bufferService.cols+t.range.start.x,r=t.range.end.y*this._bufferService.cols+t.range.end.x,p=a.y*this._bufferService.cols+a.x;return o<=p&&p<=r}_positionFromMouseEvent(t,a,o){const r=o.getCoords(t,a,this._bufferService.cols,this._bufferService.rows);if(r)return{x:r[0],y:r[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(t,a,o,r,p){return{x1:t,y1:a,x2:o,y2:r,cols:this._bufferService.cols,fg:p}}};i.Linkifier2=u=l([m(0,d.IBufferService)],u)},9042:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.tooMuchOutput=i.promptLabel=void 0,i.promptLabel="Terminal input",i.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(C,i,n){var l=this&&this.__decorate||function(u,t,a,o){var r,p=arguments.length,g=p<3?t:o===null?o=Object.getOwnPropertyDescriptor(t,a):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(u,t,a,o);else for(var E=u.length-1;E>=0;E--)(r=u[E])&&(g=(p<3?r(g):p>3?r(t,a,g):r(t,a))||g);return p>3&&g&&Object.defineProperty(t,a,g),g},m=this&&this.__param||function(u,t){return function(a,o){t(a,o,u)}};Object.defineProperty(i,"__esModule",{value:!0}),i.OscLinkProvider=void 0;const s=n(511),h=n(2585);let f=i.OscLinkProvider=class{constructor(u,t,a){this._bufferService=u,this._optionsService=t,this._oscLinkService=a}provideLinks(u,t){var a;const o=this._bufferService.buffer.lines.get(u-1);if(!o)return void t(void 0);const r=[],p=this._optionsService.rawOptions.linkHandler,g=new s.CellData,E=o.getTrimmedLength();let T=-1,w=-1,x=!1;for(let I=0;I<E;I++)if(w!==-1||o.hasContent(I)){if(o.loadCell(I,g),g.hasExtendedAttrs()&&g.extended.urlId){if(w===-1){w=I,T=g.extended.urlId;continue}x=g.extended.urlId!==T}else w!==-1&&(x=!0);if(x||w!==-1&&I===E-1){const B=(a=this._oscLinkService.getLinkData(T))===null||a===void 0?void 0:a.uri;if(B){const S={start:{x:w+1,y:u},end:{x:I+(x||I!==E-1?0:1),y:u}};let M=!1;if(!(p!=null&&p.allowNonHttpProtocols))try{const P=new URL(B);["http:","https:"].includes(P.protocol)||(M=!0)}catch{M=!0}M||r.push({text:B,range:S,activate:(P,H)=>p?p.activate(P,H,S):d(0,H),hover:(P,H)=>{var N;return(N=p==null?void 0:p.hover)===null||N===void 0?void 0:N.call(p,P,H,S)},leave:(P,H)=>{var N;return(N=p==null?void 0:p.leave)===null||N===void 0?void 0:N.call(p,P,H,S)}})}x=!1,g.hasExtendedAttrs()&&g.extended.urlId?(w=I,T=g.extended.urlId):(w=-1,T=-1)}}t(r)}};function d(u,t){if(confirm(`Do you want to navigate to ${t}?

WARNING: This link could potentially be dangerous`)){const a=window.open();if(a){try{a.opener=null}catch{}a.location.href=t}else console.warn("Opening link blocked as opener could not be cleared")}}i.OscLinkProvider=f=l([m(0,h.IBufferService),m(1,h.IOptionsService),m(2,h.IOscLinkService)],f)},6193:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.RenderDebouncer=void 0,i.RenderDebouncer=class{constructor(n,l){this._parentWindow=n,this._renderCallback=l,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(n){return this._refreshCallbacks.push(n),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(n,l,m){this._rowCount=m,n=n!==void 0?n:0,l=l!==void 0?l:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,n):n,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,l):l,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const n=Math.max(this._rowStart,0),l=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(n,l),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const n of this._refreshCallbacks)n(0);this._refreshCallbacks=[]}}},5596:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ScreenDprMonitor=void 0;const l=n(844);class m extends l.Disposable{constructor(h){super(),this._parentWindow=h,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,l.toDisposable)(()=>{this.clearListener()}))}setListener(h){this._listener&&this.clearListener(),this._listener=h,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var h;this._outerListener&&((h=this._resolutionMediaMatchList)===null||h===void 0||h.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}i.ScreenDprMonitor=m},3236:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Terminal=void 0;const l=n(3614),m=n(3656),s=n(6465),h=n(9042),f=n(3730),d=n(1680),u=n(3107),t=n(5744),a=n(2950),o=n(1296),r=n(428),p=n(4269),g=n(5114),E=n(8934),T=n(3230),w=n(9312),x=n(4725),I=n(6731),B=n(8055),S=n(8969),M=n(8460),P=n(844),H=n(6114),N=n(8437),F=n(2584),b=n(7399),D=n(5941),R=n(9074),O=n(2585),z=n(5435),W=n(4567),j=typeof window<"u"?window.document:null;class X extends S.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(A={}){super(A),this.browser=H,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new P.MutableDisposable),this._onCursorMove=this.register(new M.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new M.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new M.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new M.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new M.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new M.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new M.EventEmitter),this._onBlur=this.register(new M.EventEmitter),this._onA11yCharEmitter=this.register(new M.EventEmitter),this._onA11yTabEmitter=this.register(new M.EventEmitter),this._onWillOpen=this.register(new M.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(s.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(f.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(R.DecorationService),this._instantiationService.setService(O.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows(($,q)=>this.refresh($,q))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport($=>this._reportWindowsOptions($))),this.register(this._inputHandler.onColor($=>this._handleColorEvent($))),this.register((0,M.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,M.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,M.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,M.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize($=>this._afterResize($.cols,$.rows))),this.register((0,P.toDisposable)(()=>{var $,q;this._customKeyEventHandler=void 0,(q=($=this.element)===null||$===void 0?void 0:$.parentNode)===null||q===void 0||q.removeChild(this.element)}))}_handleColorEvent(A){if(this._themeService)for(const $ of A){let q,V="";switch($.index){case 256:q="foreground",V="10";break;case 257:q="background",V="11";break;case 258:q="cursor",V="12";break;default:q="ansi",V="4;"+$.index}switch($.type){case 0:const K=B.color.toColorRGB(q==="ansi"?this._themeService.colors.ansi[$.index]:this._themeService.colors[q]);this.coreService.triggerDataEvent(`${F.C0.ESC}]${V};${(0,D.toRgbString)(K)}${F.C1_ESCAPED.ST}`);break;case 1:if(q==="ansi")this._themeService.modifyColors(Z=>Z.ansi[$.index]=B.rgba.toColor(...$.color));else{const Z=q;this._themeService.modifyColors(ce=>ce[Z]=B.rgba.toColor(...$.color))}break;case 2:this._themeService.restoreColor($.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(A){A?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(W.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(A){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(F.C0.ESC+"[I"),this.updateCursorStyle(A),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var A;return(A=this.textarea)===null||A===void 0?void 0:A.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(F.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const A=this.buffer.ybase+this.buffer.y,$=this.buffer.lines.get(A);if(!$)return;const q=Math.min(this.buffer.x,this.cols-1),V=this._renderService.dimensions.css.cell.height,K=$.getWidth(q),Z=this._renderService.dimensions.css.cell.width*K,ce=this.buffer.y*this._renderService.dimensions.css.cell.height,ke=q*this._renderService.dimensions.css.cell.width;this.textarea.style.left=ke+"px",this.textarea.style.top=ce+"px",this.textarea.style.width=Z+"px",this.textarea.style.height=V+"px",this.textarea.style.lineHeight=V+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,m.addDisposableDomListener)(this.element,"copy",$=>{this.hasSelection()&&(0,l.copyHandler)($,this._selectionService)}));const A=$=>(0,l.handlePasteEvent)($,this.textarea,this.coreService,this.optionsService);this.register((0,m.addDisposableDomListener)(this.textarea,"paste",A)),this.register((0,m.addDisposableDomListener)(this.element,"paste",A)),H.isFirefox?this.register((0,m.addDisposableDomListener)(this.element,"mousedown",$=>{$.button===2&&(0,l.rightClickHandler)($,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,m.addDisposableDomListener)(this.element,"contextmenu",$=>{(0,l.rightClickHandler)($,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),H.isLinux&&this.register((0,m.addDisposableDomListener)(this.element,"auxclick",$=>{$.button===1&&(0,l.moveTextAreaUnderMouseCursor)($,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,m.addDisposableDomListener)(this.textarea,"keyup",A=>this._keyUp(A),!0)),this.register((0,m.addDisposableDomListener)(this.textarea,"keydown",A=>this._keyDown(A),!0)),this.register((0,m.addDisposableDomListener)(this.textarea,"keypress",A=>this._keyPress(A),!0)),this.register((0,m.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,m.addDisposableDomListener)(this.textarea,"compositionupdate",A=>this._compositionHelper.compositionupdate(A))),this.register((0,m.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,m.addDisposableDomListener)(this.textarea,"input",A=>this._inputEvent(A),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(A){var $;if(!A)throw new Error("Terminal requires a parent element.");A.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=A.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),A.appendChild(this.element);const q=j.createDocumentFragment();this._viewportElement=j.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),q.appendChild(this._viewportElement),this._viewportScrollArea=j.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=j.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=j.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),q.appendChild(this.screenElement),this.textarea=j.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",h.promptLabel),H.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(g.CoreBrowserService,this.textarea,($=this._document.defaultView)!==null&&$!==void 0?$:window),this._instantiationService.setService(x.ICoreBrowserService,this._coreBrowserService),this.register((0,m.addDisposableDomListener)(this.textarea,"focus",V=>this._handleTextAreaFocus(V))),this.register((0,m.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(r.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(x.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(I.ThemeService),this._instantiationService.setService(x.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(p.CharacterJoinerService),this._instantiationService.setService(x.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(T.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(x.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(V=>this._onRender.fire(V))),this.onResize(V=>this._renderService.resize(V.cols,V.rows)),this._compositionView=j.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(a.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(q);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(E.MouseService),this._instantiationService.setService(x.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(d.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(V=>this.scrollLines(V.amount,V.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(w.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(x.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(V=>this.scrollLines(V.amount,V.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(V=>this._renderService.handleSelectionChanged(V.start,V.end,V.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(V=>{this.textarea.value=V,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(V=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,m.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(u.BufferDecorationRenderer,this.screenElement)),this.register((0,m.addDisposableDomListener)(this.element,"mousedown",V=>this._selectionService.handleMouseDown(V))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(W.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",V=>this._handleScreenReaderModeOptionChange(V))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(t.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",V=>{!this._overviewRulerRenderer&&V&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(t.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(o.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const A=this,$=this.element;function q(Z){const ce=A._mouseService.getMouseReportCoords(Z,A.screenElement);if(!ce)return!1;let ke,ee;switch(Z.overrideType||Z.type){case"mousemove":ee=32,Z.buttons===void 0?(ke=3,Z.button!==void 0&&(ke=Z.button<3?Z.button:3)):ke=1&Z.buttons?0:4&Z.buttons?1:2&Z.buttons?2:3;break;case"mouseup":ee=0,ke=Z.button<3?Z.button:3;break;case"mousedown":ee=1,ke=Z.button<3?Z.button:3;break;case"wheel":if(A.viewport.getLinesScrolled(Z)===0)return!1;ee=Z.deltaY<0?0:1,ke=4;break;default:return!1}return!(ee===void 0||ke===void 0||ke>4)&&A.coreMouseService.triggerMouseEvent({col:ce.col,row:ce.row,x:ce.x,y:ce.y,button:ke,action:ee,ctrl:Z.ctrlKey,alt:Z.altKey,shift:Z.shiftKey})}const V={mouseup:null,wheel:null,mousedrag:null,mousemove:null},K={mouseup:Z=>(q(Z),Z.buttons||(this._document.removeEventListener("mouseup",V.mouseup),V.mousedrag&&this._document.removeEventListener("mousemove",V.mousedrag)),this.cancel(Z)),wheel:Z=>(q(Z),this.cancel(Z,!0)),mousedrag:Z=>{Z.buttons&&q(Z)},mousemove:Z=>{Z.buttons||q(Z)}};this.register(this.coreMouseService.onProtocolChange(Z=>{Z?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(Z)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&Z?V.mousemove||($.addEventListener("mousemove",K.mousemove),V.mousemove=K.mousemove):($.removeEventListener("mousemove",V.mousemove),V.mousemove=null),16&Z?V.wheel||($.addEventListener("wheel",K.wheel,{passive:!1}),V.wheel=K.wheel):($.removeEventListener("wheel",V.wheel),V.wheel=null),2&Z?V.mouseup||($.addEventListener("mouseup",K.mouseup),V.mouseup=K.mouseup):(this._document.removeEventListener("mouseup",V.mouseup),$.removeEventListener("mouseup",V.mouseup),V.mouseup=null),4&Z?V.mousedrag||(V.mousedrag=K.mousedrag):(this._document.removeEventListener("mousemove",V.mousedrag),V.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,m.addDisposableDomListener)($,"mousedown",Z=>{if(Z.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(Z))return q(Z),V.mouseup&&this._document.addEventListener("mouseup",V.mouseup),V.mousedrag&&this._document.addEventListener("mousemove",V.mousedrag),this.cancel(Z)})),this.register((0,m.addDisposableDomListener)($,"wheel",Z=>{if(!V.wheel){if(!this.buffer.hasScrollback){const ce=this.viewport.getLinesScrolled(Z);if(ce===0)return;const ke=F.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(Z.deltaY<0?"A":"B");let ee="";for(let J=0;J<Math.abs(ce);J++)ee+=ke;return this.coreService.triggerDataEvent(ee,!0),this.cancel(Z,!0)}return this.viewport.handleWheel(Z)?this.cancel(Z):void 0}},{passive:!1})),this.register((0,m.addDisposableDomListener)($,"touchstart",Z=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(Z),this.cancel(Z)},{passive:!0})),this.register((0,m.addDisposableDomListener)($,"touchmove",Z=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(Z)?void 0:this.cancel(Z)},{passive:!1}))}refresh(A,$){var q;(q=this._renderService)===null||q===void 0||q.refreshRows(A,$)}updateCursorStyle(A){var $;!(($=this._selectionService)===null||$===void 0)&&$.shouldColumnSelect(A)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(A,$,q=0){var V;q===1?(super.scrollLines(A,$,q),this.refresh(0,this.rows-1)):(V=this.viewport)===null||V===void 0||V.scrollLines(A)}paste(A){(0,l.paste)(A,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(A){this._customKeyEventHandler=A}registerLinkProvider(A){return this.linkifier2.registerLinkProvider(A)}registerCharacterJoiner(A){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const $=this._characterJoinerService.register(A);return this.refresh(0,this.rows-1),$}deregisterCharacterJoiner(A){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(A)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(A){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+A)}registerDecoration(A){return this._decorationService.registerDecoration(A)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(A,$,q){this._selectionService.setSelection(A,$,q)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var A;(A=this._selectionService)===null||A===void 0||A.clearSelection()}selectAll(){var A;(A=this._selectionService)===null||A===void 0||A.selectAll()}selectLines(A,$){var q;(q=this._selectionService)===null||q===void 0||q.selectLines(A,$)}_keyDown(A){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(A)===!1)return!1;const $=this.browser.isMac&&this.options.macOptionIsMeta&&A.altKey;if(!$&&!this._compositionHelper.keydown(A))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;$||A.key!=="Dead"&&A.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const q=(0,b.evaluateKeyboardEvent)(A,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(A),q.type===3||q.type===2){const V=this.rows-1;return this.scrollLines(q.type===2?-V:V),this.cancel(A,!0)}return q.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,A)||(q.cancel&&this.cancel(A,!0),!q.key||!!(A.key&&!A.ctrlKey&&!A.altKey&&!A.metaKey&&A.key.length===1&&A.key.charCodeAt(0)>=65&&A.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(q.key!==F.C0.ETX&&q.key!==F.C0.CR||(this.textarea.value=""),this._onKey.fire({key:q.key,domEvent:A}),this._showCursor(),this.coreService.triggerDataEvent(q.key,!0),!this.optionsService.rawOptions.screenReaderMode||A.altKey||A.ctrlKey?this.cancel(A,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(A,$){const q=A.isMac&&!this.options.macOptionIsMeta&&$.altKey&&!$.ctrlKey&&!$.metaKey||A.isWindows&&$.altKey&&$.ctrlKey&&!$.metaKey||A.isWindows&&$.getModifierState("AltGraph");return $.type==="keypress"?q:q&&(!$.keyCode||$.keyCode>47)}_keyUp(A){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(A)===!1||(function($){return $.keyCode===16||$.keyCode===17||$.keyCode===18}(A)||this.focus(),this.updateCursorStyle(A),this._keyPressHandled=!1)}_keyPress(A){let $;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(A)===!1)return!1;if(this.cancel(A),A.charCode)$=A.charCode;else if(A.which===null||A.which===void 0)$=A.keyCode;else{if(A.which===0||A.charCode===0)return!1;$=A.which}return!(!$||(A.altKey||A.ctrlKey||A.metaKey)&&!this._isThirdLevelShift(this.browser,A)||($=String.fromCharCode($),this._onKey.fire({key:$,domEvent:A}),this._showCursor(),this.coreService.triggerDataEvent($,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(A){if(A.data&&A.inputType==="insertText"&&(!A.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const $=A.data;return this.coreService.triggerDataEvent($,!0),this.cancel(A),!0}return!1}resize(A,$){A!==this.cols||$!==this.rows?super.resize(A,$):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(A,$){var q,V;(q=this._charSizeService)===null||q===void 0||q.measure(),(V=this.viewport)===null||V===void 0||V.syncScrollArea(!0)}clear(){var A;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let $=1;$<this.rows;$++)this.buffer.lines.push(this.buffer.getBlankLine(N.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(A=this.viewport)===null||A===void 0||A.reset(),this.refresh(0,this.rows-1)}}reset(){var A,$;this.options.rows=this.rows,this.options.cols=this.cols;const q=this._customKeyEventHandler;this._setup(),super.reset(),(A=this._selectionService)===null||A===void 0||A.reset(),this._decorationService.reset(),($=this.viewport)===null||$===void 0||$.reset(),this._customKeyEventHandler=q,this.refresh(0,this.rows-1)}clearTextureAtlas(){var A;(A=this._renderService)===null||A===void 0||A.clearTextureAtlas()}_reportFocus(){var A;!((A=this.element)===null||A===void 0)&&A.classList.contains("focus")?this.coreService.triggerDataEvent(F.C0.ESC+"[I"):this.coreService.triggerDataEvent(F.C0.ESC+"[O")}_reportWindowsOptions(A){if(this._renderService)switch(A){case z.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const $=this._renderService.dimensions.css.canvas.width.toFixed(0),q=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${F.C0.ESC}[4;${q};${$}t`);break;case z.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const V=this._renderService.dimensions.css.cell.width.toFixed(0),K=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${F.C0.ESC}[6;${K};${V}t`)}}cancel(A,$){if(this.options.cancelEvents||$)return A.preventDefault(),A.stopPropagation(),!1}}i.Terminal=X},9924:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TimeBasedDebouncer=void 0,i.TimeBasedDebouncer=class{constructor(n,l=1e3){this._renderCallback=n,this._debounceThresholdMS=l,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(n,l,m){this._rowCount=m,n=n!==void 0?n:0,l=l!==void 0?l:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,n):n,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,l):l;const s=Date.now();if(s-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=s,this._innerRefresh();else if(!this._additionalRefreshRequested){const h=s-this._lastRefreshMs,f=this._debounceThresholdMS-h;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},f)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const n=Math.max(this._rowStart,0),l=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(n,l)}}},1680:function(C,i,n){var l=this&&this.__decorate||function(a,o,r,p){var g,E=arguments.length,T=E<3?o:p===null?p=Object.getOwnPropertyDescriptor(o,r):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(a,o,r,p);else for(var w=a.length-1;w>=0;w--)(g=a[w])&&(T=(E<3?g(T):E>3?g(o,r,T):g(o,r))||T);return E>3&&T&&Object.defineProperty(o,r,T),T},m=this&&this.__param||function(a,o){return function(r,p){o(r,p,a)}};Object.defineProperty(i,"__esModule",{value:!0}),i.Viewport=void 0;const s=n(3656),h=n(4725),f=n(8460),d=n(844),u=n(2585);let t=i.Viewport=class extends d.Disposable{constructor(a,o,r,p,g,E,T,w){super(),this._viewportElement=a,this._scrollArea=o,this._bufferService=r,this._optionsService=p,this._charSizeService=g,this._renderService=E,this._coreBrowserService=T,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new f.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,s.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(x=>this._activeBuffer=x.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(x=>this._renderDimensions=x)),this._handleThemeChange(w.colors),this.register(w.onChangeColors(x=>this._handleThemeChange(x))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(a){this._viewportElement.style.backgroundColor=a.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(a){if(a)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const o=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==o&&(this._lastRecordedBufferHeight=o,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const a=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==a&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=a),this._refreshAnimationFrame=null}syncScrollArea(a=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(a);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(a)}_handleScroll(a){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const o=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:o,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const a=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(a*(this._smoothScrollState.target-this._smoothScrollState.origin)),a<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(a,o){const r=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(o<0&&this._viewportElement.scrollTop!==0||o>0&&r<this._lastRecordedBufferHeight)||(a.cancelable&&a.preventDefault(),!1)}handleWheel(a){const o=this._getPixelsScrolled(a);return o!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+o:this._smoothScrollState.target+=o,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=o,this._bubbleScroll(a,o))}scrollLines(a){if(a!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const o=a*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+o,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:a,suppressScrollEvent:!1})}_getPixelsScrolled(a){if(a.deltaY===0||a.shiftKey)return 0;let o=this._applyScrollModifier(a.deltaY,a);return a.deltaMode===WheelEvent.DOM_DELTA_LINE?o*=this._currentRowHeight:a.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(o*=this._currentRowHeight*this._bufferService.rows),o}getBufferElements(a,o){var r;let p,g="";const E=[],T=o??this._bufferService.buffer.lines.length,w=this._bufferService.buffer.lines;for(let x=a;x<T;x++){const I=w.get(x);if(!I)continue;const B=(r=w.get(x+1))===null||r===void 0?void 0:r.isWrapped;if(g+=I.translateToString(!B),!B||x===w.length-1){const S=document.createElement("div");S.textContent=g,E.push(S),g.length>0&&(p=S),g=""}}return{bufferElements:E,cursorElement:p}}getLinesScrolled(a){if(a.deltaY===0||a.shiftKey)return 0;let o=this._applyScrollModifier(a.deltaY,a);return a.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(o/=this._currentRowHeight+0,this._wheelPartialScroll+=o,o=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):a.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(o*=this._bufferService.rows),o}_applyScrollModifier(a,o){const r=this._optionsService.rawOptions.fastScrollModifier;return r==="alt"&&o.altKey||r==="ctrl"&&o.ctrlKey||r==="shift"&&o.shiftKey?a*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:a*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(a){this._lastTouchY=a.touches[0].pageY}handleTouchMove(a){const o=this._lastTouchY-a.touches[0].pageY;return this._lastTouchY=a.touches[0].pageY,o!==0&&(this._viewportElement.scrollTop+=o,this._bubbleScroll(a,o))}};i.Viewport=t=l([m(2,u.IBufferService),m(3,u.IOptionsService),m(4,h.ICharSizeService),m(5,h.IRenderService),m(6,h.ICoreBrowserService),m(7,h.IThemeService)],t)},3107:function(C,i,n){var l=this&&this.__decorate||function(t,a,o,r){var p,g=arguments.length,E=g<3?a:r===null?r=Object.getOwnPropertyDescriptor(a,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(t,a,o,r);else for(var T=t.length-1;T>=0;T--)(p=t[T])&&(E=(g<3?p(E):g>3?p(a,o,E):p(a,o))||E);return g>3&&E&&Object.defineProperty(a,o,E),E},m=this&&this.__param||function(t,a){return function(o,r){a(o,r,t)}};Object.defineProperty(i,"__esModule",{value:!0}),i.BufferDecorationRenderer=void 0;const s=n(3656),h=n(4725),f=n(844),d=n(2585);let u=i.BufferDecorationRenderer=class extends f.Disposable{constructor(t,a,o,r){super(),this._screenElement=t,this._bufferService=a,this._decorationService=o,this._renderService=r,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,s.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(p=>this._removeDecoration(p))),this.register((0,f.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const t of this._decorationService.decorations)this._renderDecoration(t);this._dimensionsChanged=!1}_renderDecoration(t){this._refreshStyle(t),this._dimensionsChanged&&this._refreshXPosition(t)}_createElement(t){var a,o;const r=document.createElement("div");r.classList.add("xterm-decoration"),r.classList.toggle("xterm-decoration-top-layer",((a=t==null?void 0:t.options)===null||a===void 0?void 0:a.layer)==="top"),r.style.width=`${Math.round((t.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,r.style.height=(t.options.height||1)*this._renderService.dimensions.css.cell.height+"px",r.style.top=(t.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",r.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const p=(o=t.options.x)!==null&&o!==void 0?o:0;return p&&p>this._bufferService.cols&&(r.style.display="none"),this._refreshXPosition(t,r),r}_refreshStyle(t){const a=t.marker.line-this._bufferService.buffers.active.ydisp;if(a<0||a>=this._bufferService.rows)t.element&&(t.element.style.display="none",t.onRenderEmitter.fire(t.element));else{let o=this._decorationElements.get(t);o||(o=this._createElement(t),t.element=o,this._decorationElements.set(t,o),this._container.appendChild(o),t.onDispose(()=>{this._decorationElements.delete(t),o.remove()})),o.style.top=a*this._renderService.dimensions.css.cell.height+"px",o.style.display=this._altBufferIsActive?"none":"block",t.onRenderEmitter.fire(o)}}_refreshXPosition(t,a=t.element){var o;if(!a)return;const r=(o=t.options.x)!==null&&o!==void 0?o:0;(t.options.anchor||"left")==="right"?a.style.right=r?r*this._renderService.dimensions.css.cell.width+"px":"":a.style.left=r?r*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(t){var a;(a=this._decorationElements.get(t))===null||a===void 0||a.remove(),this._decorationElements.delete(t),t.dispose()}};i.BufferDecorationRenderer=u=l([m(1,d.IBufferService),m(2,d.IDecorationService),m(3,h.IRenderService)],u)},5871:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ColorZoneStore=void 0,i.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(n){if(n.options.overviewRulerOptions){for(const l of this._zones)if(l.color===n.options.overviewRulerOptions.color&&l.position===n.options.overviewRulerOptions.position){if(this._lineIntersectsZone(l,n.marker.line))return;if(this._lineAdjacentToZone(l,n.marker.line,n.options.overviewRulerOptions.position))return void this._addLineToZone(l,n.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=n.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=n.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=n.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=n.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:n.options.overviewRulerOptions.color,position:n.options.overviewRulerOptions.position,startBufferLine:n.marker.line,endBufferLine:n.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(n){this._linePadding=n}_lineIntersectsZone(n,l){return l>=n.startBufferLine&&l<=n.endBufferLine}_lineAdjacentToZone(n,l,m){return l>=n.startBufferLine-this._linePadding[m||"full"]&&l<=n.endBufferLine+this._linePadding[m||"full"]}_addLineToZone(n,l){n.startBufferLine=Math.min(n.startBufferLine,l),n.endBufferLine=Math.max(n.endBufferLine,l)}}},5744:function(C,i,n){var l=this&&this.__decorate||function(p,g,E,T){var w,x=arguments.length,I=x<3?g:T===null?T=Object.getOwnPropertyDescriptor(g,E):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(p,g,E,T);else for(var B=p.length-1;B>=0;B--)(w=p[B])&&(I=(x<3?w(I):x>3?w(g,E,I):w(g,E))||I);return x>3&&I&&Object.defineProperty(g,E,I),I},m=this&&this.__param||function(p,g){return function(E,T){g(E,T,p)}};Object.defineProperty(i,"__esModule",{value:!0}),i.OverviewRulerRenderer=void 0;const s=n(5871),h=n(3656),f=n(4725),d=n(844),u=n(2585),t={full:0,left:0,center:0,right:0},a={full:0,left:0,center:0,right:0},o={full:0,left:0,center:0,right:0};let r=i.OverviewRulerRenderer=class extends d.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(p,g,E,T,w,x,I){var B;super(),this._viewportElement=p,this._screenElement=g,this._bufferService=E,this._decorationService=T,this._renderService=w,this._optionsService=x,this._coreBrowseService=I,this._colorZoneStore=new s.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(B=this._viewportElement.parentElement)===null||B===void 0||B.insertBefore(this._canvas,this._viewportElement);const S=this._canvas.getContext("2d");if(!S)throw new Error("Ctx cannot be null");this._ctx=S,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,d.toDisposable)(()=>{var M;(M=this._canvas)===null||M===void 0||M.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,h.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const p=Math.floor(this._canvas.width/3),g=Math.ceil(this._canvas.width/3);a.full=this._canvas.width,a.left=p,a.center=g,a.right=p,this._refreshDrawHeightConstants(),o.full=0,o.left=0,o.center=a.left,o.right=a.left+a.center}_refreshDrawHeightConstants(){t.full=Math.round(2*this._coreBrowseService.dpr);const p=this._canvas.height/this._bufferService.buffer.lines.length,g=Math.round(Math.max(Math.min(p,12),6)*this._coreBrowseService.dpr);t.left=g,t.center=g,t.right=g}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const g of this._decorationService.decorations)this._colorZoneStore.addDecoration(g);this._ctx.lineWidth=1;const p=this._colorZoneStore.zones;for(const g of p)g.position!=="full"&&this._renderColorZone(g);for(const g of p)g.position==="full"&&this._renderColorZone(g);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(p){this._ctx.fillStyle=p.color,this._ctx.fillRect(o[p.position||"full"],Math.round((this._canvas.height-1)*(p.startBufferLine/this._bufferService.buffers.active.lines.length)-t[p.position||"full"]/2),a[p.position||"full"],Math.round((this._canvas.height-1)*((p.endBufferLine-p.startBufferLine)/this._bufferService.buffers.active.lines.length)+t[p.position||"full"]))}_queueRefresh(p,g){this._shouldUpdateDimensions=p||this._shouldUpdateDimensions,this._shouldUpdateAnchor=g||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};i.OverviewRulerRenderer=r=l([m(2,u.IBufferService),m(3,u.IDecorationService),m(4,f.IRenderService),m(5,u.IOptionsService),m(6,f.ICoreBrowserService)],r)},2950:function(C,i,n){var l=this&&this.__decorate||function(u,t,a,o){var r,p=arguments.length,g=p<3?t:o===null?o=Object.getOwnPropertyDescriptor(t,a):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(u,t,a,o);else for(var E=u.length-1;E>=0;E--)(r=u[E])&&(g=(p<3?r(g):p>3?r(t,a,g):r(t,a))||g);return p>3&&g&&Object.defineProperty(t,a,g),g},m=this&&this.__param||function(u,t){return function(a,o){t(a,o,u)}};Object.defineProperty(i,"__esModule",{value:!0}),i.CompositionHelper=void 0;const s=n(4725),h=n(2585),f=n(2584);let d=i.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(u,t,a,o,r,p){this._textarea=u,this._compositionView=t,this._bufferService=a,this._optionsService=o,this._coreService=r,this._renderService=p,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(u){this._compositionView.textContent=u.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(u){if(this._isComposing||this._isSendingComposition){if(u.keyCode===229||u.keyCode===16||u.keyCode===17||u.keyCode===18)return!1;this._finalizeComposition(!1)}return u.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(u){if(this._compositionView.classList.remove("active"),this._isComposing=!1,u){const t={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let a;this._isSendingComposition=!1,t.start+=this._dataAlreadySent.length,a=this._isComposing?this._textarea.value.substring(t.start,t.end):this._textarea.value.substring(t.start),a.length>0&&this._coreService.triggerDataEvent(a,!0)}},0)}else{this._isSendingComposition=!1;const t=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(t,!0)}}_handleAnyTextareaChanges(){const u=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const t=this._textarea.value,a=t.replace(u,"");this._dataAlreadySent=a,t.length>u.length?this._coreService.triggerDataEvent(a,!0):t.length<u.length?this._coreService.triggerDataEvent(`${f.C0.DEL}`,!0):t.length===u.length&&t!==u&&this._coreService.triggerDataEvent(t,!0)}},0)}updateCompositionElements(u){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const t=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),a=this._renderService.dimensions.css.cell.height,o=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,r=t*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=r+"px",this._compositionView.style.top=o+"px",this._compositionView.style.height=a+"px",this._compositionView.style.lineHeight=a+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const p=this._compositionView.getBoundingClientRect();this._textarea.style.left=r+"px",this._textarea.style.top=o+"px",this._textarea.style.width=Math.max(p.width,1)+"px",this._textarea.style.height=Math.max(p.height,1)+"px",this._textarea.style.lineHeight=p.height+"px"}u||setTimeout(()=>this.updateCompositionElements(!0),0)}}};i.CompositionHelper=d=l([m(2,h.IBufferService),m(3,h.IOptionsService),m(4,h.ICoreService),m(5,s.IRenderService)],d)},9806:(C,i)=>{function n(l,m,s){const h=s.getBoundingClientRect(),f=l.getComputedStyle(s),d=parseInt(f.getPropertyValue("padding-left")),u=parseInt(f.getPropertyValue("padding-top"));return[m.clientX-h.left-d,m.clientY-h.top-u]}Object.defineProperty(i,"__esModule",{value:!0}),i.getCoords=i.getCoordsRelativeToElement=void 0,i.getCoordsRelativeToElement=n,i.getCoords=function(l,m,s,h,f,d,u,t,a){if(!d)return;const o=n(l,m,s);return o?(o[0]=Math.ceil((o[0]+(a?u/2:0))/u),o[1]=Math.ceil(o[1]/t),o[0]=Math.min(Math.max(o[0],1),h+(a?1:0)),o[1]=Math.min(Math.max(o[1],1),f),o):void 0}},9504:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.moveToCellSequence=void 0;const l=n(2584);function m(t,a,o,r){const p=t-s(t,o),g=a-s(a,o),E=Math.abs(p-g)-function(T,w,x){let I=0;const B=T-s(T,x),S=w-s(w,x);for(let M=0;M<Math.abs(B-S);M++){const P=h(T,w)==="A"?-1:1,H=x.buffer.lines.get(B+P*M);H!=null&&H.isWrapped&&I++}return I}(t,a,o);return u(E,d(h(t,a),r))}function s(t,a){let o=0,r=a.buffer.lines.get(t),p=r==null?void 0:r.isWrapped;for(;p&&t>=0&&t<a.rows;)o++,r=a.buffer.lines.get(--t),p=r==null?void 0:r.isWrapped;return o}function h(t,a){return t>a?"A":"B"}function f(t,a,o,r,p,g){let E=t,T=a,w="";for(;E!==o||T!==r;)E+=p?1:-1,p&&E>g.cols-1?(w+=g.buffer.translateBufferLineToString(T,!1,t,E),E=0,t=0,T++):!p&&E<0&&(w+=g.buffer.translateBufferLineToString(T,!1,0,t+1),E=g.cols-1,t=E,T--);return w+g.buffer.translateBufferLineToString(T,!1,t,E)}function d(t,a){const o=a?"O":"[";return l.C0.ESC+o+t}function u(t,a){t=Math.floor(t);let o="";for(let r=0;r<t;r++)o+=a;return o}i.moveToCellSequence=function(t,a,o,r){const p=o.buffer.x,g=o.buffer.y;if(!o.buffer.hasScrollback)return function(w,x,I,B,S,M){return m(x,B,S,M).length===0?"":u(f(w,x,w,x-s(x,S),!1,S).length,d("D",M))}(p,g,0,a,o,r)+m(g,a,o,r)+function(w,x,I,B,S,M){let P;P=m(x,B,S,M).length>0?B-s(B,S):x;const H=B,N=function(F,b,D,R,O,z){let W;return W=m(D,R,O,z).length>0?R-s(R,O):b,F<D&&W<=R||F>=D&&W<R?"C":"D"}(w,x,I,B,S,M);return u(f(w,P,I,H,N==="C",S).length,d(N,M))}(p,g,t,a,o,r);let E;if(g===a)return E=p>t?"D":"C",u(Math.abs(p-t),d(E,r));E=g>a?"D":"C";const T=Math.abs(g-a);return u(function(w,x){return x.cols-w}(g>a?t:p,o)+(T-1)*o.cols+1+((g>a?p:t)-1),d(E,r))}},1296:function(C,i,n){var l=this&&this.__decorate||function(S,M,P,H){var N,F=arguments.length,b=F<3?M:H===null?H=Object.getOwnPropertyDescriptor(M,P):H;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(S,M,P,H);else for(var D=S.length-1;D>=0;D--)(N=S[D])&&(b=(F<3?N(b):F>3?N(M,P,b):N(M,P))||b);return F>3&&b&&Object.defineProperty(M,P,b),b},m=this&&this.__param||function(S,M){return function(P,H){M(P,H,S)}};Object.defineProperty(i,"__esModule",{value:!0}),i.DomRenderer=void 0;const s=n(3787),h=n(2550),f=n(2223),d=n(6171),u=n(4725),t=n(8055),a=n(8460),o=n(844),r=n(2585),p="xterm-dom-renderer-owner-",g="xterm-rows",E="xterm-fg-",T="xterm-bg-",w="xterm-focus",x="xterm-selection";let I=1,B=i.DomRenderer=class extends o.Disposable{constructor(S,M,P,H,N,F,b,D,R,O){super(),this._element=S,this._screenElement=M,this._viewportElement=P,this._linkifier2=H,this._charSizeService=F,this._optionsService=b,this._bufferService=D,this._coreBrowserService=R,this._themeService=O,this._terminalClass=I++,this._rowElements=[],this.onRequestRedraw=this.register(new a.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add(g),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add(x),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,d.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(z=>this._injectCss(z))),this._injectCss(this._themeService.colors),this._rowFactory=N.createInstance(s.DomRendererRowFactory,document),this._element.classList.add(p+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(z=>this._handleLinkHover(z))),this.register(this._linkifier2.onHideLinkUnderline(z=>this._handleLinkLeave(z))),this.register((0,o.toDisposable)(()=>{this._element.classList.remove(p+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new h.WidthCache(document),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const S=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*S,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*S),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/S),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/S),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const P of this._rowElements)P.style.width=`${this.dimensions.css.canvas.width}px`,P.style.height=`${this.dimensions.css.cell.height}px`,P.style.lineHeight=`${this.dimensions.css.cell.height}px`,P.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const M=`${this._terminalSelector} .${g} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=M,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(S){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let M=`${this._terminalSelector} .${g} { color: ${S.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;M+=`${this._terminalSelector} .${g} .xterm-dim { color: ${t.color.multiplyOpacity(S.foreground,.5).css};}`,M+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`,M+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  border-bottom-style: hidden; }}",M+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${S.cursor.css};  color: ${S.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${S.cursor.css}; }}`,M+=`${this._terminalSelector} .${g}.${w} .xterm-cursor.xterm-cursor-blink:not(.xterm-cursor-block) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${g}.${w} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-block { background-color: ${S.cursor.css}; color: ${S.cursorAccent.css};}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${S.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${S.cursor.css} inset;}${this._terminalSelector} .${g} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${S.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,M+=`${this._terminalSelector} .${x} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${x} div { position: absolute; background-color: ${S.selectionBackgroundOpaque.css};}${this._terminalSelector} .${x} div { position: absolute; background-color: ${S.selectionInactiveBackgroundOpaque.css};}`;for(const[P,H]of S.ansi.entries())M+=`${this._terminalSelector} .${E}${P} { color: ${H.css}; }${this._terminalSelector} .${E}${P}.xterm-dim { color: ${t.color.multiplyOpacity(H,.5).css}; }${this._terminalSelector} .${T}${P} { background-color: ${H.css}; }`;M+=`${this._terminalSelector} .${E}${f.INVERTED_DEFAULT_COLOR} { color: ${t.color.opaque(S.background).css}; }${this._terminalSelector} .${E}${f.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${t.color.multiplyOpacity(t.color.opaque(S.background),.5).css}; }${this._terminalSelector} .${T}${f.INVERTED_DEFAULT_COLOR} { background-color: ${S.foreground.css}; }`,this._themeStyleElement.textContent=M}_setDefaultSpacing(){const S=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${S}px`,this._rowFactory.defaultSpacing=S}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(S,M){for(let P=this._rowElements.length;P<=M;P++){const H=document.createElement("div");this._rowContainer.appendChild(H),this._rowElements.push(H)}for(;this._rowElements.length>M;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(S,M){this._refreshRowElements(S,M),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(w)}handleFocus(){this._rowContainer.classList.add(w),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(S,M,P){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(S,M,P),this.renderRows(0,this._bufferService.rows-1),!S||!M)return;const H=S[1]-this._bufferService.buffer.ydisp,N=M[1]-this._bufferService.buffer.ydisp,F=Math.max(H,0),b=Math.min(N,this._bufferService.rows-1);if(F>=this._bufferService.rows||b<0)return;const D=document.createDocumentFragment();if(P){const R=S[0]>M[0];D.appendChild(this._createSelectionElement(F,R?M[0]:S[0],R?S[0]:M[0],b-F+1))}else{const R=H===F?S[0]:0,O=F===N?M[0]:this._bufferService.cols;D.appendChild(this._createSelectionElement(F,R,O));const z=b-F-1;if(D.appendChild(this._createSelectionElement(F+1,0,this._bufferService.cols,z)),F!==b){const W=N===b?M[0]:this._bufferService.cols;D.appendChild(this._createSelectionElement(b,0,W))}}this._selectionContainer.appendChild(D)}_createSelectionElement(S,M,P,H=1){const N=document.createElement("div");return N.style.height=H*this.dimensions.css.cell.height+"px",N.style.top=S*this.dimensions.css.cell.height+"px",N.style.left=M*this.dimensions.css.cell.width+"px",N.style.width=this.dimensions.css.cell.width*(P-M)+"px",N}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const S of this._rowElements)S.replaceChildren()}renderRows(S,M){const P=this._bufferService.buffer,H=P.ybase+P.y,N=Math.min(P.x,this._bufferService.cols-1),F=this._optionsService.rawOptions.cursorBlink,b=this._optionsService.rawOptions.cursorStyle,D=this._optionsService.rawOptions.cursorInactiveStyle;for(let R=S;R<=M;R++){const O=R+P.ydisp,z=this._rowElements[R],W=P.lines.get(O);if(!z||!W)break;z.replaceChildren(...this._rowFactory.createRow(W,O,O===H,b,D,N,F,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${p}${this._terminalClass}`}_handleLinkHover(S){this._setCellUnderline(S.x1,S.x2,S.y1,S.y2,S.cols,!0)}_handleLinkLeave(S){this._setCellUnderline(S.x1,S.x2,S.y1,S.y2,S.cols,!1)}_setCellUnderline(S,M,P,H,N,F){P<0&&(S=0),H<0&&(M=0);const b=this._bufferService.rows-1;P=Math.max(Math.min(P,b),0),H=Math.max(Math.min(H,b),0),N=Math.min(N,this._bufferService.cols);const D=this._bufferService.buffer,R=D.ybase+D.y,O=Math.min(D.x,N-1),z=this._optionsService.rawOptions.cursorBlink,W=this._optionsService.rawOptions.cursorStyle,j=this._optionsService.rawOptions.cursorInactiveStyle;for(let X=P;X<=H;++X){const ie=X+D.ydisp,A=this._rowElements[X],$=D.lines.get(ie);if(!A||!$)break;A.replaceChildren(...this._rowFactory.createRow($,ie,ie===R,W,j,O,z,this.dimensions.css.cell.width,this._widthCache,F?X===P?S:0:-1,F?(X===H?M:N)-1:-1))}}};i.DomRenderer=B=l([m(4,r.IInstantiationService),m(5,u.ICharSizeService),m(6,r.IOptionsService),m(7,r.IBufferService),m(8,u.ICoreBrowserService),m(9,u.IThemeService)],B)},3787:function(C,i,n){var l=this&&this.__decorate||function(E,T,w,x){var I,B=arguments.length,S=B<3?T:x===null?x=Object.getOwnPropertyDescriptor(T,w):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(E,T,w,x);else for(var M=E.length-1;M>=0;M--)(I=E[M])&&(S=(B<3?I(S):B>3?I(T,w,S):I(T,w))||S);return B>3&&S&&Object.defineProperty(T,w,S),S},m=this&&this.__param||function(E,T){return function(w,x){T(w,x,E)}};Object.defineProperty(i,"__esModule",{value:!0}),i.DomRendererRowFactory=void 0;const s=n(2223),h=n(643),f=n(511),d=n(2585),u=n(8055),t=n(4725),a=n(4269),o=n(6171),r=n(3734);let p=i.DomRendererRowFactory=class{constructor(E,T,w,x,I,B,S){this._document=E,this._characterJoinerService=T,this._optionsService=w,this._coreBrowserService=x,this._coreService=I,this._decorationService=B,this._themeService=S,this._workCell=new f.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(E,T,w){this._selectionStart=E,this._selectionEnd=T,this._columnSelectMode=w}createRow(E,T,w,x,I,B,S,M,P,H,N){const F=[],b=this._characterJoinerService.getJoinedCharacters(T),D=this._themeService.colors;let R,O=E.getNoBgTrimmedLength();w&&O<B+1&&(O=B+1);let z=0,W="",j=0,X=0,ie=0,A=!1,$=0,q=!1,V=0;const K=[],Z=H!==-1&&N!==-1;for(let ce=0;ce<O;ce++){E.loadCell(ce,this._workCell);let ke=this._workCell.getWidth();if(ke===0)continue;let ee=!1,J=ce,Y=this._workCell;if(b.length>0&&ce===b[0][0]){ee=!0;const me=b.shift();Y=new a.JoinedCellData(this._workCell,E.translateToString(!0,me[0],me[1]),me[1]-me[0]),J=me[1]-1,ke=Y.getWidth()}const te=this._isCellInSelection(ce,T),ae=w&&ce===B,fe=Z&&ce>=H&&ce<=N;let pe=!1;this._decorationService.forEachDecorationAtCell(ce,T,void 0,me=>{pe=!0});let ne=Y.getChars()||h.WHITESPACE_CELL_CHAR;if(ne===" "&&(Y.isUnderline()||Y.isOverline())&&(ne=" "),V=ke*M-P.get(ne,Y.isBold(),Y.isItalic()),R){if(z&&(te&&q||!te&&!q&&Y.bg===j)&&(te&&q&&D.selectionForeground||Y.fg===X)&&Y.extended.ext===ie&&fe===A&&V===$&&!ae&&!ee&&!pe){W+=ne,z++;continue}z&&(R.textContent=W),R=this._document.createElement("span"),z=0,W=""}else R=this._document.createElement("span");if(j=Y.bg,X=Y.fg,ie=Y.extended.ext,A=fe,$=V,q=te,ee&&B>=ce&&B<=J&&(B=ce),!this._coreService.isCursorHidden&&ae){if(K.push("xterm-cursor"),this._coreBrowserService.isFocused)S&&K.push("xterm-cursor-blink"),K.push(x==="bar"?"xterm-cursor-bar":x==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(I)switch(I){case"outline":K.push("xterm-cursor-outline");break;case"block":K.push("xterm-cursor-block");break;case"bar":K.push("xterm-cursor-bar");break;case"underline":K.push("xterm-cursor-underline")}}if(Y.isBold()&&K.push("xterm-bold"),Y.isItalic()&&K.push("xterm-italic"),Y.isDim()&&K.push("xterm-dim"),W=Y.isInvisible()?h.WHITESPACE_CELL_CHAR:Y.getChars()||h.WHITESPACE_CELL_CHAR,Y.isUnderline()&&(K.push(`xterm-underline-${Y.extended.underlineStyle}`),W===" "&&(W=" "),!Y.isUnderlineColorDefault()))if(Y.isUnderlineColorRGB())R.style.textDecorationColor=`rgb(${r.AttributeData.toColorRGB(Y.getUnderlineColor()).join(",")})`;else{let me=Y.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&Y.isBold()&&me<8&&(me+=8),R.style.textDecorationColor=D.ansi[me].css}Y.isOverline()&&(K.push("xterm-overline"),W===" "&&(W=" ")),Y.isStrikethrough()&&K.push("xterm-strikethrough"),fe&&(R.style.textDecoration="underline");let le=Y.getFgColor(),Te=Y.getFgColorMode(),ge=Y.getBgColor(),Ue=Y.getBgColorMode();const we=!!Y.isInverse();if(we){const me=le;le=ge,ge=me;const ze=Te;Te=Ue,Ue=ze}let Q,he,_e,Re=!1;switch(this._decorationService.forEachDecorationAtCell(ce,T,void 0,me=>{me.options.layer!=="top"&&Re||(me.backgroundColorRGB&&(Ue=50331648,ge=me.backgroundColorRGB.rgba>>8&16777215,Q=me.backgroundColorRGB),me.foregroundColorRGB&&(Te=50331648,le=me.foregroundColorRGB.rgba>>8&16777215,he=me.foregroundColorRGB),Re=me.options.layer==="top")}),!Re&&te&&(Q=this._coreBrowserService.isFocused?D.selectionBackgroundOpaque:D.selectionInactiveBackgroundOpaque,ge=Q.rgba>>8&16777215,Ue=50331648,Re=!0,D.selectionForeground&&(Te=50331648,le=D.selectionForeground.rgba>>8&16777215,he=D.selectionForeground)),Re&&K.push("xterm-decoration-top"),Ue){case 16777216:case 33554432:_e=D.ansi[ge],K.push(`xterm-bg-${ge}`);break;case 50331648:_e=u.rgba.toColor(ge>>16,ge>>8&255,255&ge),this._addStyle(R,`background-color:#${g((ge>>>0).toString(16),"0",6)}`);break;default:we?(_e=D.foreground,K.push(`xterm-bg-${s.INVERTED_DEFAULT_COLOR}`)):_e=D.background}switch(Q||Y.isDim()&&(Q=u.color.multiplyOpacity(_e,.5)),Te){case 16777216:case 33554432:Y.isBold()&&le<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(le+=8),this._applyMinimumContrast(R,_e,D.ansi[le],Y,Q,void 0)||K.push(`xterm-fg-${le}`);break;case 50331648:const me=u.rgba.toColor(le>>16&255,le>>8&255,255&le);this._applyMinimumContrast(R,_e,me,Y,Q,he)||this._addStyle(R,`color:#${g(le.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(R,_e,D.foreground,Y,Q,void 0)||we&&K.push(`xterm-fg-${s.INVERTED_DEFAULT_COLOR}`)}K.length&&(R.className=K.join(" "),K.length=0),ae||ee||pe?R.textContent=W:z++,V!==this.defaultSpacing&&(R.style.letterSpacing=`${V}px`),F.push(R),ce=J}return R&&z&&(R.textContent=W),F}_applyMinimumContrast(E,T,w,x,I,B){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,o.excludeFromContrastRatioDemands)(x.getCode()))return!1;const S=this._getContrastCache(x);let M;if(I||B||(M=S.getColor(T.rgba,w.rgba)),M===void 0){const P=this._optionsService.rawOptions.minimumContrastRatio/(x.isDim()?2:1);M=u.color.ensureContrastRatio(I||T,B||w,P),S.setColor((I||T).rgba,(B||w).rgba,M??null)}return!!M&&(this._addStyle(E,`color:${M.css}`),!0)}_getContrastCache(E){return E.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(E,T){E.setAttribute("style",`${E.getAttribute("style")||""}${T};`)}_isCellInSelection(E,T){const w=this._selectionStart,x=this._selectionEnd;return!(!w||!x)&&(this._columnSelectMode?w[0]<=x[0]?E>=w[0]&&T>=w[1]&&E<x[0]&&T<=x[1]:E<w[0]&&T>=w[1]&&E>=x[0]&&T<=x[1]:T>w[1]&&T<x[1]||w[1]===x[1]&&T===w[1]&&E>=w[0]&&E<x[0]||w[1]<x[1]&&T===x[1]&&E<x[0]||w[1]<x[1]&&T===w[1]&&E>=w[0])}};function g(E,T,w){for(;E.length<w;)E=T+E;return E}i.DomRendererRowFactory=p=l([m(1,t.ICharacterJoinerService),m(2,d.IOptionsService),m(3,t.ICoreBrowserService),m(4,d.ICoreService),m(5,d.IDecorationService),m(6,t.IThemeService)],p)},2550:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.WidthCache=void 0,i.WidthCache=class{constructor(n){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=n.createElement("div"),this._container.style.position="absolute",this._container.style.top="-50000px",this._container.style.width="50000px",this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const l=n.createElement("span"),m=n.createElement("span");m.style.fontWeight="bold";const s=n.createElement("span");s.style.fontStyle="italic";const h=n.createElement("span");h.style.fontWeight="bold",h.style.fontStyle="italic",this._measureElements=[l,m,s,h],this._container.appendChild(l),this._container.appendChild(m),this._container.appendChild(s),this._container.appendChild(h),n.body.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(n,l,m,s){n===this._font&&l===this._fontSize&&m===this._weight&&s===this._weightBold||(this._font=n,this._fontSize=l,this._weight=m,this._weightBold=s,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${m}`,this._measureElements[1].style.fontWeight=`${s}`,this._measureElements[2].style.fontWeight=`${m}`,this._measureElements[3].style.fontWeight=`${s}`,this.clear())}get(n,l,m){let s=0;if(!l&&!m&&n.length===1&&(s=n.charCodeAt(0))<256)return this._flat[s]!==-9999?this._flat[s]:this._flat[s]=this._measure(n,0);let h=n;l&&(h+="B"),m&&(h+="I");let f=this._holey.get(h);if(f===void 0){let d=0;l&&(d|=1),m&&(d|=2),f=this._measure(n,d),this._holey.set(h,f)}return f}_measure(n,l){const m=this._measureElements[l];return m.textContent=n.repeat(32),m.offsetWidth/32}}},2223:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TEXT_BASELINE=i.DIM_OPACITY=i.INVERTED_DEFAULT_COLOR=void 0;const l=n(6114);i.INVERTED_DEFAULT_COLOR=257,i.DIM_OPACITY=.5,i.TEXT_BASELINE=l.isFirefox||l.isLegacyEdge?"bottom":"ideographic"},6171:(C,i)=>{function n(l){return 57508<=l&&l<=57558}Object.defineProperty(i,"__esModule",{value:!0}),i.createRenderDimensions=i.excludeFromContrastRatioDemands=i.isRestrictedPowerlineGlyph=i.isPowerlineGlyph=i.throwIfFalsy=void 0,i.throwIfFalsy=function(l){if(!l)throw new Error("value must not be falsy");return l},i.isPowerlineGlyph=n,i.isRestrictedPowerlineGlyph=function(l){return 57520<=l&&l<=57527},i.excludeFromContrastRatioDemands=function(l){return n(l)||function(m){return 9472<=m&&m<=9631}(l)},i.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.SelectionModel=void 0,i.SelectionModel=class{constructor(n){this._bufferService=n,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const n=this.selectionStart[0]+this.selectionStartLength;return n>this._bufferService.cols?n%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)-1]:[n%this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)]:[n,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const n=this.selectionStart[0]+this.selectionStartLength;return n>this._bufferService.cols?[n%this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)]:[Math.max(n,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const n=this.selectionStart,l=this.selectionEnd;return!(!n||!l)&&(n[1]>l[1]||n[1]===l[1]&&n[0]>l[0])}handleTrim(n){return this.selectionStart&&(this.selectionStart[1]-=n),this.selectionEnd&&(this.selectionEnd[1]-=n),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(C,i,n){var l=this&&this.__decorate||function(t,a,o,r){var p,g=arguments.length,E=g<3?a:r===null?r=Object.getOwnPropertyDescriptor(a,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(t,a,o,r);else for(var T=t.length-1;T>=0;T--)(p=t[T])&&(E=(g<3?p(E):g>3?p(a,o,E):p(a,o))||E);return g>3&&E&&Object.defineProperty(a,o,E),E},m=this&&this.__param||function(t,a){return function(o,r){a(o,r,t)}};Object.defineProperty(i,"__esModule",{value:!0}),i.CharSizeService=void 0;const s=n(2585),h=n(8460),f=n(844);let d=i.CharSizeService=class extends f.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(t,a,o){super(),this._optionsService=o,this.width=0,this.height=0,this._onCharSizeChange=this.register(new h.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new u(t,a,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const t=this._measureStrategy.measure();t.width===this.width&&t.height===this.height||(this.width=t.width,this.height=t.height,this._onCharSizeChange.fire())}};i.CharSizeService=d=l([m(2,s.IOptionsService)],d);class u{constructor(a,o,r){this._document=a,this._parentElement=o,this._optionsService=r,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const a={height:Number(this._measureElement.offsetHeight),width:Number(this._measureElement.offsetWidth)};return a.width!==0&&a.height!==0&&(this._result.width=a.width/32,this._result.height=Math.ceil(a.height)),this._result}}},4269:function(C,i,n){var l=this&&this.__decorate||function(a,o,r,p){var g,E=arguments.length,T=E<3?o:p===null?p=Object.getOwnPropertyDescriptor(o,r):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(a,o,r,p);else for(var w=a.length-1;w>=0;w--)(g=a[w])&&(T=(E<3?g(T):E>3?g(o,r,T):g(o,r))||T);return E>3&&T&&Object.defineProperty(o,r,T),T},m=this&&this.__param||function(a,o){return function(r,p){o(r,p,a)}};Object.defineProperty(i,"__esModule",{value:!0}),i.CharacterJoinerService=i.JoinedCellData=void 0;const s=n(3734),h=n(643),f=n(511),d=n(2585);class u extends s.AttributeData{constructor(o,r,p){super(),this.content=0,this.combinedData="",this.fg=o.fg,this.bg=o.bg,this.combinedData=r,this._width=p}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(o){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}i.JoinedCellData=u;let t=i.CharacterJoinerService=class xn{constructor(o){this._bufferService=o,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new f.CellData}register(o){const r={id:this._nextCharacterJoinerId++,handler:o};return this._characterJoiners.push(r),r.id}deregister(o){for(let r=0;r<this._characterJoiners.length;r++)if(this._characterJoiners[r].id===o)return this._characterJoiners.splice(r,1),!0;return!1}getJoinedCharacters(o){if(this._characterJoiners.length===0)return[];const r=this._bufferService.buffer.lines.get(o);if(!r||r.length===0)return[];const p=[],g=r.translateToString(!0);let E=0,T=0,w=0,x=r.getFg(0),I=r.getBg(0);for(let B=0;B<r.getTrimmedLength();B++)if(r.loadCell(B,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==x||this._workCell.bg!==I){if(B-E>1){const S=this._getJoinedRanges(g,w,T,r,E);for(let M=0;M<S.length;M++)p.push(S[M])}E=B,w=T,x=this._workCell.fg,I=this._workCell.bg}T+=this._workCell.getChars().length||h.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-E>1){const B=this._getJoinedRanges(g,w,T,r,E);for(let S=0;S<B.length;S++)p.push(B[S])}return p}_getJoinedRanges(o,r,p,g,E){const T=o.substring(r,p);let w=[];try{w=this._characterJoiners[0].handler(T)}catch(x){console.error(x)}for(let x=1;x<this._characterJoiners.length;x++)try{const I=this._characterJoiners[x].handler(T);for(let B=0;B<I.length;B++)xn._mergeRanges(w,I[B])}catch(I){console.error(I)}return this._stringRangesToCellRanges(w,g,E),w}_stringRangesToCellRanges(o,r,p){let g=0,E=!1,T=0,w=o[g];if(w){for(let x=p;x<this._bufferService.cols;x++){const I=r.getWidth(x),B=r.getString(x).length||h.WHITESPACE_CELL_CHAR.length;if(I!==0){if(!E&&w[0]<=T&&(w[0]=x,E=!0),w[1]<=T){if(w[1]=x,w=o[++g],!w)break;w[0]<=T?(w[0]=x,E=!0):E=!1}T+=B}}w&&(w[1]=this._bufferService.cols)}}static _mergeRanges(o,r){let p=!1;for(let g=0;g<o.length;g++){const E=o[g];if(p){if(r[1]<=E[0])return o[g-1][1]=r[1],o;if(r[1]<=E[1])return o[g-1][1]=Math.max(r[1],E[1]),o.splice(g,1),o;o.splice(g,1),g--}else{if(r[1]<=E[0])return o.splice(g,0,r),o;if(r[1]<=E[1])return E[0]=Math.min(r[0],E[0]),o;r[0]<E[1]&&(E[0]=Math.min(r[0],E[0]),p=!0)}}return p?o[o.length-1][1]=r[1]:o.push(r),o}};i.CharacterJoinerService=t=l([m(0,d.IBufferService)],t)},5114:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CoreBrowserService=void 0,i.CoreBrowserService=class{constructor(n,l){this._textarea=n,this.window=l,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(C,i,n){var l=this&&this.__decorate||function(d,u,t,a){var o,r=arguments.length,p=r<3?u:a===null?a=Object.getOwnPropertyDescriptor(u,t):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(d,u,t,a);else for(var g=d.length-1;g>=0;g--)(o=d[g])&&(p=(r<3?o(p):r>3?o(u,t,p):o(u,t))||p);return r>3&&p&&Object.defineProperty(u,t,p),p},m=this&&this.__param||function(d,u){return function(t,a){u(t,a,d)}};Object.defineProperty(i,"__esModule",{value:!0}),i.MouseService=void 0;const s=n(4725),h=n(9806);let f=i.MouseService=class{constructor(d,u){this._renderService=d,this._charSizeService=u}getCoords(d,u,t,a,o){return(0,h.getCoords)(window,d,u,t,a,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,o)}getMouseReportCoords(d,u){const t=(0,h.getCoordsRelativeToElement)(window,d,u);if(this._charSizeService.hasValidSize)return t[0]=Math.min(Math.max(t[0],0),this._renderService.dimensions.css.canvas.width-1),t[1]=Math.min(Math.max(t[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(t[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(t[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(t[0]),y:Math.floor(t[1])}}};i.MouseService=f=l([m(0,s.IRenderService),m(1,s.ICharSizeService)],f)},3230:function(C,i,n){var l=this&&this.__decorate||function(p,g,E,T){var w,x=arguments.length,I=x<3?g:T===null?T=Object.getOwnPropertyDescriptor(g,E):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(p,g,E,T);else for(var B=p.length-1;B>=0;B--)(w=p[B])&&(I=(x<3?w(I):x>3?w(g,E,I):w(g,E))||I);return x>3&&I&&Object.defineProperty(g,E,I),I},m=this&&this.__param||function(p,g){return function(E,T){g(E,T,p)}};Object.defineProperty(i,"__esModule",{value:!0}),i.RenderService=void 0;const s=n(3656),h=n(6193),f=n(5596),d=n(4725),u=n(8460),t=n(844),a=n(7226),o=n(2585);let r=i.RenderService=class extends t.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(p,g,E,T,w,x,I,B){if(super(),this._rowCount=p,this._charSizeService=T,this._renderer=this.register(new t.MutableDisposable),this._pausedResizeTask=new a.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new u.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new u.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new u.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new u.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new h.RenderDebouncer(I.window,(S,M)=>this._renderRows(S,M)),this.register(this._renderDebouncer),this._screenDprMonitor=new f.ScreenDprMonitor(I.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(x.onResize(()=>this._fullRefresh())),this.register(x.buffers.onBufferActivate(()=>{var S;return(S=this._renderer.value)===null||S===void 0?void 0:S.clear()})),this.register(E.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(w.onDecorationRegistered(()=>this._fullRefresh())),this.register(w.onDecorationRemoved(()=>this._fullRefresh())),this.register(E.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(x.cols,x.rows),this._fullRefresh()})),this.register(E.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(x.buffer.y,x.buffer.y,!0))),this.register((0,s.addDisposableDomListener)(I.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(B.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in I.window){const S=new I.window.IntersectionObserver(M=>this._handleIntersectionChange(M[M.length-1]),{threshold:0});S.observe(g),this.register({dispose:()=>S.disconnect()})}}_handleIntersectionChange(p){this._isPaused=p.isIntersecting===void 0?p.intersectionRatio===0:!p.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(p,g,E=!1){this._isPaused?this._needsFullRefresh=!0:(E||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(p,g,this._rowCount))}_renderRows(p,g){this._renderer.value&&(p=Math.min(p,this._rowCount-1),g=Math.min(g,this._rowCount-1),this._renderer.value.renderRows(p,g),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:p,end:g}),this._onRender.fire({start:p,end:g}),this._isNextRenderRedrawOnly=!0)}resize(p,g){this._rowCount=g,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(p){this._renderer.value=p,this._renderer.value.onRequestRedraw(g=>this.refreshRows(g.start,g.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(p){return this._renderDebouncer.addRefreshCallback(p)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var p,g;this._renderer.value&&((g=(p=this._renderer.value).clearTextureAtlas)===null||g===void 0||g.call(p),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(p,g){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value.handleResize(p,g)):this._renderer.value.handleResize(p,g),this._fullRefresh())}handleCharSizeChanged(){var p;(p=this._renderer.value)===null||p===void 0||p.handleCharSizeChanged()}handleBlur(){var p;(p=this._renderer.value)===null||p===void 0||p.handleBlur()}handleFocus(){var p;(p=this._renderer.value)===null||p===void 0||p.handleFocus()}handleSelectionChanged(p,g,E){var T;this._selectionState.start=p,this._selectionState.end=g,this._selectionState.columnSelectMode=E,(T=this._renderer.value)===null||T===void 0||T.handleSelectionChanged(p,g,E)}handleCursorMove(){var p;(p=this._renderer.value)===null||p===void 0||p.handleCursorMove()}clear(){var p;(p=this._renderer.value)===null||p===void 0||p.clear()}};i.RenderService=r=l([m(2,o.IOptionsService),m(3,d.ICharSizeService),m(4,o.IDecorationService),m(5,o.IBufferService),m(6,d.ICoreBrowserService),m(7,d.IThemeService)],r)},9312:function(C,i,n){var l=this&&this.__decorate||function(w,x,I,B){var S,M=arguments.length,P=M<3?x:B===null?B=Object.getOwnPropertyDescriptor(x,I):B;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(w,x,I,B);else for(var H=w.length-1;H>=0;H--)(S=w[H])&&(P=(M<3?S(P):M>3?S(x,I,P):S(x,I))||P);return M>3&&P&&Object.defineProperty(x,I,P),P},m=this&&this.__param||function(w,x){return function(I,B){x(I,B,w)}};Object.defineProperty(i,"__esModule",{value:!0}),i.SelectionService=void 0;const s=n(9806),h=n(9504),f=n(456),d=n(4725),u=n(8460),t=n(844),a=n(6114),o=n(4841),r=n(511),p=n(2585),g=String.fromCharCode(160),E=new RegExp(g,"g");let T=i.SelectionService=class extends t.Disposable{constructor(w,x,I,B,S,M,P,H,N){super(),this._element=w,this._screenElement=x,this._linkifier=I,this._bufferService=B,this._coreService=S,this._mouseService=M,this._optionsService=P,this._renderService=H,this._coreBrowserService=N,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new r.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new u.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new u.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new u.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new u.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=F=>this._handleMouseMove(F),this._mouseUpListener=F=>this._handleMouseUp(F),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(F=>this._handleTrim(F)),this.register(this._bufferService.buffers.onBufferActivate(F=>this._handleBufferActivate(F))),this.enable(),this._model=new f.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,t.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const w=this._model.finalSelectionStart,x=this._model.finalSelectionEnd;return!(!w||!x||w[0]===x[0]&&w[1]===x[1])}get selectionText(){const w=this._model.finalSelectionStart,x=this._model.finalSelectionEnd;if(!w||!x)return"";const I=this._bufferService.buffer,B=[];if(this._activeSelectionMode===3){if(w[0]===x[0])return"";const S=w[0]<x[0]?w[0]:x[0],M=w[0]<x[0]?x[0]:w[0];for(let P=w[1];P<=x[1];P++){const H=I.translateBufferLineToString(P,!0,S,M);B.push(H)}}else{const S=w[1]===x[1]?x[0]:void 0;B.push(I.translateBufferLineToString(w[1],!0,w[0],S));for(let M=w[1]+1;M<=x[1]-1;M++){const P=I.lines.get(M),H=I.translateBufferLineToString(M,!0);P!=null&&P.isWrapped?B[B.length-1]+=H:B.push(H)}if(w[1]!==x[1]){const M=I.lines.get(x[1]),P=I.translateBufferLineToString(x[1],!0,0,x[0]);M&&M.isWrapped?B[B.length-1]+=P:B.push(P)}}return B.map(S=>S.replace(E," ")).join(a.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(w){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),a.isLinux&&w&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(w){const x=this._getMouseBufferCoords(w),I=this._model.finalSelectionStart,B=this._model.finalSelectionEnd;return!!(I&&B&&x)&&this._areCoordsInSelection(x,I,B)}isCellInSelection(w,x){const I=this._model.finalSelectionStart,B=this._model.finalSelectionEnd;return!(!I||!B)&&this._areCoordsInSelection([w,x],I,B)}_areCoordsInSelection(w,x,I){return w[1]>x[1]&&w[1]<I[1]||x[1]===I[1]&&w[1]===x[1]&&w[0]>=x[0]&&w[0]<I[0]||x[1]<I[1]&&w[1]===I[1]&&w[0]<I[0]||x[1]<I[1]&&w[1]===x[1]&&w[0]>=x[0]}_selectWordAtCursor(w,x){var I,B;const S=(B=(I=this._linkifier.currentLink)===null||I===void 0?void 0:I.link)===null||B===void 0?void 0:B.range;if(S)return this._model.selectionStart=[S.start.x-1,S.start.y-1],this._model.selectionStartLength=(0,o.getRangeLength)(S,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const M=this._getMouseBufferCoords(w);return!!M&&(this._selectWordAt(M,x),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(w,x){this._model.clearSelection(),w=Math.max(w,0),x=Math.min(x,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,w],this._model.selectionEnd=[this._bufferService.cols,x],this.refresh(),this._onSelectionChange.fire()}_handleTrim(w){this._model.handleTrim(w)&&this.refresh()}_getMouseBufferCoords(w){const x=this._mouseService.getCoords(w,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(x)return x[0]--,x[1]--,x[1]+=this._bufferService.buffer.ydisp,x}_getMouseEventScrollAmount(w){let x=(0,s.getCoordsRelativeToElement)(this._coreBrowserService.window,w,this._screenElement)[1];const I=this._renderService.dimensions.css.canvas.height;return x>=0&&x<=I?0:(x>I&&(x-=I),x=Math.min(Math.max(x,-50),50),x/=50,x/Math.abs(x)+Math.round(14*x))}shouldForceSelection(w){return a.isMac?w.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:w.shiftKey}handleMouseDown(w){if(this._mouseDownTimeStamp=w.timeStamp,(w.button!==2||!this.hasSelection)&&w.button===0){if(!this._enabled){if(!this.shouldForceSelection(w))return;w.stopPropagation()}w.preventDefault(),this._dragScrollAmount=0,this._enabled&&w.shiftKey?this._handleIncrementalClick(w):w.detail===1?this._handleSingleClick(w):w.detail===2?this._handleDoubleClick(w):w.detail===3&&this._handleTripleClick(w),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(w){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(w))}_handleSingleClick(w){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(w)?3:0,this._model.selectionStart=this._getMouseBufferCoords(w),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const x=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);x&&x.length!==this._model.selectionStart[0]&&x.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(w){this._selectWordAtCursor(w,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(w){const x=this._getMouseBufferCoords(w);x&&(this._activeSelectionMode=2,this._selectLineAt(x[1]))}shouldColumnSelect(w){return w.altKey&&!(a.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(w){if(w.stopImmediatePropagation(),!this._model.selectionStart)return;const x=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(w),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(w),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const I=this._bufferService.buffer;if(this._model.selectionEnd[1]<I.lines.length){const B=I.lines.get(this._model.selectionEnd[1]);B&&B.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}x&&x[0]===this._model.selectionEnd[0]&&x[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const w=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(w.ydisp+this._bufferService.rows,w.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=w.ydisp),this.refresh()}}_handleMouseUp(w){const x=w.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&x<500&&w.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const I=this._mouseService.getCoords(w,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(I&&I[0]!==void 0&&I[1]!==void 0){const B=(0,h.moveToCellSequence)(I[0]-1,I[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(B,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const w=this._model.finalSelectionStart,x=this._model.finalSelectionEnd,I=!(!w||!x||w[0]===x[0]&&w[1]===x[1]);I?w&&x&&(this._oldSelectionStart&&this._oldSelectionEnd&&w[0]===this._oldSelectionStart[0]&&w[1]===this._oldSelectionStart[1]&&x[0]===this._oldSelectionEnd[0]&&x[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(w,x,I)):this._oldHasSelection&&this._fireOnSelectionChange(w,x,I)}_fireOnSelectionChange(w,x,I){this._oldSelectionStart=w,this._oldSelectionEnd=x,this._oldHasSelection=I,this._onSelectionChange.fire()}_handleBufferActivate(w){this.clearSelection(),this._trimListener.dispose(),this._trimListener=w.activeBuffer.lines.onTrim(x=>this._handleTrim(x))}_convertViewportColToCharacterIndex(w,x){let I=x;for(let B=0;x>=B;B++){const S=w.loadCell(B,this._workCell).getChars().length;this._workCell.getWidth()===0?I--:S>1&&x!==B&&(I+=S-1)}return I}setSelection(w,x,I){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[w,x],this._model.selectionStartLength=I,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(w){this._isClickInSelection(w)||(this._selectWordAtCursor(w,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(w,x,I=!0,B=!0){if(w[0]>=this._bufferService.cols)return;const S=this._bufferService.buffer,M=S.lines.get(w[1]);if(!M)return;const P=S.translateBufferLineToString(w[1],!1);let H=this._convertViewportColToCharacterIndex(M,w[0]),N=H;const F=w[0]-H;let b=0,D=0,R=0,O=0;if(P.charAt(H)===" "){for(;H>0&&P.charAt(H-1)===" ";)H--;for(;N<P.length&&P.charAt(N+1)===" ";)N++}else{let j=w[0],X=w[0];M.getWidth(j)===0&&(b++,j--),M.getWidth(X)===2&&(D++,X++);const ie=M.getString(X).length;for(ie>1&&(O+=ie-1,N+=ie-1);j>0&&H>0&&!this._isCharWordSeparator(M.loadCell(j-1,this._workCell));){M.loadCell(j-1,this._workCell);const A=this._workCell.getChars().length;this._workCell.getWidth()===0?(b++,j--):A>1&&(R+=A-1,H-=A-1),H--,j--}for(;X<M.length&&N+1<P.length&&!this._isCharWordSeparator(M.loadCell(X+1,this._workCell));){M.loadCell(X+1,this._workCell);const A=this._workCell.getChars().length;this._workCell.getWidth()===2?(D++,X++):A>1&&(O+=A-1,N+=A-1),N++,X++}}N++;let z=H+F-b+R,W=Math.min(this._bufferService.cols,N-H+b+D-R-O);if(x||P.slice(H,N).trim()!==""){if(I&&z===0&&M.getCodePoint(0)!==32){const j=S.lines.get(w[1]-1);if(j&&M.isWrapped&&j.getCodePoint(this._bufferService.cols-1)!==32){const X=this._getWordAt([this._bufferService.cols-1,w[1]-1],!1,!0,!1);if(X){const ie=this._bufferService.cols-X.start;z-=ie,W+=ie}}}if(B&&z+W===this._bufferService.cols&&M.getCodePoint(this._bufferService.cols-1)!==32){const j=S.lines.get(w[1]+1);if(j!=null&&j.isWrapped&&j.getCodePoint(0)!==32){const X=this._getWordAt([0,w[1]+1],!1,!1,!0);X&&(W+=X.length)}}return{start:z,length:W}}}_selectWordAt(w,x){const I=this._getWordAt(w,x);if(I){for(;I.start<0;)I.start+=this._bufferService.cols,w[1]--;this._model.selectionStart=[I.start,w[1]],this._model.selectionStartLength=I.length}}_selectToWordAt(w){const x=this._getWordAt(w,!0);if(x){let I=w[1];for(;x.start<0;)x.start+=this._bufferService.cols,I--;if(!this._model.areSelectionValuesReversed())for(;x.start+x.length>this._bufferService.cols;)x.length-=this._bufferService.cols,I++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?x.start:x.start+x.length,I]}}_isCharWordSeparator(w){return w.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(w.getChars())>=0}_selectLineAt(w){const x=this._bufferService.buffer.getWrappedRangeForLine(w),I={start:{x:0,y:x.first},end:{x:this._bufferService.cols-1,y:x.last}};this._model.selectionStart=[0,x.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,o.getRangeLength)(I,this._bufferService.cols)}};i.SelectionService=T=l([m(3,p.IBufferService),m(4,p.ICoreService),m(5,d.IMouseService),m(6,p.IOptionsService),m(7,d.IRenderService),m(8,d.ICoreBrowserService)],T)},4725:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.IThemeService=i.ICharacterJoinerService=i.ISelectionService=i.IRenderService=i.IMouseService=i.ICoreBrowserService=i.ICharSizeService=void 0;const l=n(8343);i.ICharSizeService=(0,l.createDecorator)("CharSizeService"),i.ICoreBrowserService=(0,l.createDecorator)("CoreBrowserService"),i.IMouseService=(0,l.createDecorator)("MouseService"),i.IRenderService=(0,l.createDecorator)("RenderService"),i.ISelectionService=(0,l.createDecorator)("SelectionService"),i.ICharacterJoinerService=(0,l.createDecorator)("CharacterJoinerService"),i.IThemeService=(0,l.createDecorator)("ThemeService")},6731:function(C,i,n){var l=this&&this.__decorate||function(T,w,x,I){var B,S=arguments.length,M=S<3?w:I===null?I=Object.getOwnPropertyDescriptor(w,x):I;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(T,w,x,I);else for(var P=T.length-1;P>=0;P--)(B=T[P])&&(M=(S<3?B(M):S>3?B(w,x,M):B(w,x))||M);return S>3&&M&&Object.defineProperty(w,x,M),M},m=this&&this.__param||function(T,w){return function(x,I){w(x,I,T)}};Object.defineProperty(i,"__esModule",{value:!0}),i.ThemeService=i.DEFAULT_ANSI_COLORS=void 0;const s=n(7239),h=n(8055),f=n(8460),d=n(844),u=n(2585),t=h.css.toColor("#ffffff"),a=h.css.toColor("#000000"),o=h.css.toColor("#ffffff"),r=h.css.toColor("#000000"),p={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};i.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const T=[h.css.toColor("#2e3436"),h.css.toColor("#cc0000"),h.css.toColor("#4e9a06"),h.css.toColor("#c4a000"),h.css.toColor("#3465a4"),h.css.toColor("#75507b"),h.css.toColor("#06989a"),h.css.toColor("#d3d7cf"),h.css.toColor("#555753"),h.css.toColor("#ef2929"),h.css.toColor("#8ae234"),h.css.toColor("#fce94f"),h.css.toColor("#729fcf"),h.css.toColor("#ad7fa8"),h.css.toColor("#34e2e2"),h.css.toColor("#eeeeec")],w=[0,95,135,175,215,255];for(let x=0;x<216;x++){const I=w[x/36%6|0],B=w[x/6%6|0],S=w[x%6];T.push({css:h.channels.toCss(I,B,S),rgba:h.channels.toRgba(I,B,S)})}for(let x=0;x<24;x++){const I=8+10*x;T.push({css:h.channels.toCss(I,I,I),rgba:h.channels.toRgba(I,I,I)})}return T})());let g=i.ThemeService=class extends d.Disposable{get colors(){return this._colors}constructor(T){super(),this._optionsService=T,this._contrastCache=new s.ColorContrastCache,this._halfContrastCache=new s.ColorContrastCache,this._onChangeColors=this.register(new f.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:t,background:a,cursor:o,cursorAccent:r,selectionForeground:void 0,selectionBackgroundTransparent:p,selectionBackgroundOpaque:h.color.blend(a,p),selectionInactiveBackgroundTransparent:p,selectionInactiveBackgroundOpaque:h.color.blend(a,p),ansi:i.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(T={}){const w=this._colors;if(w.foreground=E(T.foreground,t),w.background=E(T.background,a),w.cursor=E(T.cursor,o),w.cursorAccent=E(T.cursorAccent,r),w.selectionBackgroundTransparent=E(T.selectionBackground,p),w.selectionBackgroundOpaque=h.color.blend(w.background,w.selectionBackgroundTransparent),w.selectionInactiveBackgroundTransparent=E(T.selectionInactiveBackground,w.selectionBackgroundTransparent),w.selectionInactiveBackgroundOpaque=h.color.blend(w.background,w.selectionInactiveBackgroundTransparent),w.selectionForeground=T.selectionForeground?E(T.selectionForeground,h.NULL_COLOR):void 0,w.selectionForeground===h.NULL_COLOR&&(w.selectionForeground=void 0),h.color.isOpaque(w.selectionBackgroundTransparent)&&(w.selectionBackgroundTransparent=h.color.opacity(w.selectionBackgroundTransparent,.3)),h.color.isOpaque(w.selectionInactiveBackgroundTransparent)&&(w.selectionInactiveBackgroundTransparent=h.color.opacity(w.selectionInactiveBackgroundTransparent,.3)),w.ansi=i.DEFAULT_ANSI_COLORS.slice(),w.ansi[0]=E(T.black,i.DEFAULT_ANSI_COLORS[0]),w.ansi[1]=E(T.red,i.DEFAULT_ANSI_COLORS[1]),w.ansi[2]=E(T.green,i.DEFAULT_ANSI_COLORS[2]),w.ansi[3]=E(T.yellow,i.DEFAULT_ANSI_COLORS[3]),w.ansi[4]=E(T.blue,i.DEFAULT_ANSI_COLORS[4]),w.ansi[5]=E(T.magenta,i.DEFAULT_ANSI_COLORS[5]),w.ansi[6]=E(T.cyan,i.DEFAULT_ANSI_COLORS[6]),w.ansi[7]=E(T.white,i.DEFAULT_ANSI_COLORS[7]),w.ansi[8]=E(T.brightBlack,i.DEFAULT_ANSI_COLORS[8]),w.ansi[9]=E(T.brightRed,i.DEFAULT_ANSI_COLORS[9]),w.ansi[10]=E(T.brightGreen,i.DEFAULT_ANSI_COLORS[10]),w.ansi[11]=E(T.brightYellow,i.DEFAULT_ANSI_COLORS[11]),w.ansi[12]=E(T.brightBlue,i.DEFAULT_ANSI_COLORS[12]),w.ansi[13]=E(T.brightMagenta,i.DEFAULT_ANSI_COLORS[13]),w.ansi[14]=E(T.brightCyan,i.DEFAULT_ANSI_COLORS[14]),w.ansi[15]=E(T.brightWhite,i.DEFAULT_ANSI_COLORS[15]),T.extendedAnsi){const x=Math.min(w.ansi.length-16,T.extendedAnsi.length);for(let I=0;I<x;I++)w.ansi[I+16]=E(T.extendedAnsi[I],i.DEFAULT_ANSI_COLORS[I+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(T){this._restoreColor(T),this._onChangeColors.fire(this.colors)}_restoreColor(T){if(T!==void 0)switch(T){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[T]=this._restoreColors.ansi[T]}else for(let w=0;w<this._restoreColors.ansi.length;++w)this._colors.ansi[w]=this._restoreColors.ansi[w]}modifyColors(T){T(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function E(T,w){if(T!==void 0)try{return h.css.toColor(T)}catch{}return w}i.ThemeService=g=l([m(0,u.IOptionsService)],g)},6349:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CircularList=void 0;const l=n(8460),m=n(844);class s extends m.Disposable{constructor(f){super(),this._maxLength=f,this.onDeleteEmitter=this.register(new l.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new l.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new l.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(f){if(this._maxLength===f)return;const d=new Array(f);for(let u=0;u<Math.min(f,this.length);u++)d[u]=this._array[this._getCyclicIndex(u)];this._array=d,this._maxLength=f,this._startIndex=0}get length(){return this._length}set length(f){if(f>this._length)for(let d=this._length;d<f;d++)this._array[d]=void 0;this._length=f}get(f){return this._array[this._getCyclicIndex(f)]}set(f,d){this._array[this._getCyclicIndex(f)]=d}push(f){this._array[this._getCyclicIndex(this._length)]=f,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(f,d,...u){if(d){for(let t=f;t<this._length-d;t++)this._array[this._getCyclicIndex(t)]=this._array[this._getCyclicIndex(t+d)];this._length-=d,this.onDeleteEmitter.fire({index:f,amount:d})}for(let t=this._length-1;t>=f;t--)this._array[this._getCyclicIndex(t+u.length)]=this._array[this._getCyclicIndex(t)];for(let t=0;t<u.length;t++)this._array[this._getCyclicIndex(f+t)]=u[t];if(u.length&&this.onInsertEmitter.fire({index:f,amount:u.length}),this._length+u.length>this._maxLength){const t=this._length+u.length-this._maxLength;this._startIndex+=t,this._length=this._maxLength,this.onTrimEmitter.fire(t)}else this._length+=u.length}trimStart(f){f>this._length&&(f=this._length),this._startIndex+=f,this._length-=f,this.onTrimEmitter.fire(f)}shiftElements(f,d,u){if(!(d<=0)){if(f<0||f>=this._length)throw new Error("start argument out of range");if(f+u<0)throw new Error("Cannot shift elements in list beyond index 0");if(u>0){for(let a=d-1;a>=0;a--)this.set(f+a+u,this.get(f+a));const t=f+d+u-this._length;if(t>0)for(this._length+=t;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let t=0;t<d;t++)this.set(f+t+u,this.get(f+t))}}_getCyclicIndex(f){return(this._startIndex+f)%this._maxLength}}i.CircularList=s},1439:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.clone=void 0,i.clone=function n(l,m=5){if(typeof l!="object")return l;const s=Array.isArray(l)?[]:{};for(const h in l)s[h]=m<=1?l[h]:l[h]&&n(l[h],m-1);return s}},8055:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.contrastRatio=i.toPaddedHex=i.rgba=i.rgb=i.css=i.color=i.channels=i.NULL_COLOR=void 0;const l=n(6114);let m=0,s=0,h=0,f=0;var d,u,t,a,o;function r(g){const E=g.toString(16);return E.length<2?"0"+E:E}function p(g,E){return g<E?(E+.05)/(g+.05):(g+.05)/(E+.05)}i.NULL_COLOR={css:"#00000000",rgba:0},function(g){g.toCss=function(E,T,w,x){return x!==void 0?`#${r(E)}${r(T)}${r(w)}${r(x)}`:`#${r(E)}${r(T)}${r(w)}`},g.toRgba=function(E,T,w,x=255){return(E<<24|T<<16|w<<8|x)>>>0}}(d||(i.channels=d={})),function(g){function E(T,w){return f=Math.round(255*w),[m,s,h]=o.toChannels(T.rgba),{css:d.toCss(m,s,h,f),rgba:d.toRgba(m,s,h,f)}}g.blend=function(T,w){if(f=(255&w.rgba)/255,f===1)return{css:w.css,rgba:w.rgba};const x=w.rgba>>24&255,I=w.rgba>>16&255,B=w.rgba>>8&255,S=T.rgba>>24&255,M=T.rgba>>16&255,P=T.rgba>>8&255;return m=S+Math.round((x-S)*f),s=M+Math.round((I-M)*f),h=P+Math.round((B-P)*f),{css:d.toCss(m,s,h),rgba:d.toRgba(m,s,h)}},g.isOpaque=function(T){return(255&T.rgba)==255},g.ensureContrastRatio=function(T,w,x){const I=o.ensureContrastRatio(T.rgba,w.rgba,x);if(I)return o.toColor(I>>24&255,I>>16&255,I>>8&255)},g.opaque=function(T){const w=(255|T.rgba)>>>0;return[m,s,h]=o.toChannels(w),{css:d.toCss(m,s,h),rgba:w}},g.opacity=E,g.multiplyOpacity=function(T,w){return f=255&T.rgba,E(T,f*w/255)},g.toColorRGB=function(T){return[T.rgba>>24&255,T.rgba>>16&255,T.rgba>>8&255]}}(u||(i.color=u={})),function(g){let E,T;if(!l.isNode){const w=document.createElement("canvas");w.width=1,w.height=1;const x=w.getContext("2d",{willReadFrequently:!0});x&&(E=x,E.globalCompositeOperation="copy",T=E.createLinearGradient(0,0,1,1))}g.toColor=function(w){if(w.match(/#[\da-f]{3,8}/i))switch(w.length){case 4:return m=parseInt(w.slice(1,2).repeat(2),16),s=parseInt(w.slice(2,3).repeat(2),16),h=parseInt(w.slice(3,4).repeat(2),16),o.toColor(m,s,h);case 5:return m=parseInt(w.slice(1,2).repeat(2),16),s=parseInt(w.slice(2,3).repeat(2),16),h=parseInt(w.slice(3,4).repeat(2),16),f=parseInt(w.slice(4,5).repeat(2),16),o.toColor(m,s,h,f);case 7:return{css:w,rgba:(parseInt(w.slice(1),16)<<8|255)>>>0};case 9:return{css:w,rgba:parseInt(w.slice(1),16)>>>0}}const x=w.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(x)return m=parseInt(x[1]),s=parseInt(x[2]),h=parseInt(x[3]),f=Math.round(255*(x[5]===void 0?1:parseFloat(x[5]))),o.toColor(m,s,h,f);if(!E||!T)throw new Error("css.toColor: Unsupported css format");if(E.fillStyle=T,E.fillStyle=w,typeof E.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(E.fillRect(0,0,1,1),[m,s,h,f]=E.getImageData(0,0,1,1).data,f!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:d.toRgba(m,s,h,f),css:w}}}(t||(i.css=t={})),function(g){function E(T,w,x){const I=T/255,B=w/255,S=x/255;return .2126*(I<=.03928?I/12.92:Math.pow((I+.055)/1.055,2.4))+.7152*(B<=.03928?B/12.92:Math.pow((B+.055)/1.055,2.4))+.0722*(S<=.03928?S/12.92:Math.pow((S+.055)/1.055,2.4))}g.relativeLuminance=function(T){return E(T>>16&255,T>>8&255,255&T)},g.relativeLuminance2=E}(a||(i.rgb=a={})),function(g){function E(w,x,I){const B=w>>24&255,S=w>>16&255,M=w>>8&255;let P=x>>24&255,H=x>>16&255,N=x>>8&255,F=p(a.relativeLuminance2(P,H,N),a.relativeLuminance2(B,S,M));for(;F<I&&(P>0||H>0||N>0);)P-=Math.max(0,Math.ceil(.1*P)),H-=Math.max(0,Math.ceil(.1*H)),N-=Math.max(0,Math.ceil(.1*N)),F=p(a.relativeLuminance2(P,H,N),a.relativeLuminance2(B,S,M));return(P<<24|H<<16|N<<8|255)>>>0}function T(w,x,I){const B=w>>24&255,S=w>>16&255,M=w>>8&255;let P=x>>24&255,H=x>>16&255,N=x>>8&255,F=p(a.relativeLuminance2(P,H,N),a.relativeLuminance2(B,S,M));for(;F<I&&(P<255||H<255||N<255);)P=Math.min(255,P+Math.ceil(.1*(255-P))),H=Math.min(255,H+Math.ceil(.1*(255-H))),N=Math.min(255,N+Math.ceil(.1*(255-N))),F=p(a.relativeLuminance2(P,H,N),a.relativeLuminance2(B,S,M));return(P<<24|H<<16|N<<8|255)>>>0}g.ensureContrastRatio=function(w,x,I){const B=a.relativeLuminance(w>>8),S=a.relativeLuminance(x>>8);if(p(B,S)<I){if(S<B){const H=E(w,x,I),N=p(B,a.relativeLuminance(H>>8));if(N<I){const F=T(w,x,I);return N>p(B,a.relativeLuminance(F>>8))?H:F}return H}const M=T(w,x,I),P=p(B,a.relativeLuminance(M>>8));if(P<I){const H=E(w,x,I);return P>p(B,a.relativeLuminance(H>>8))?M:H}return M}},g.reduceLuminance=E,g.increaseLuminance=T,g.toChannels=function(w){return[w>>24&255,w>>16&255,w>>8&255,255&w]},g.toColor=function(w,x,I,B){return{css:d.toCss(w,x,I,B),rgba:d.toRgba(w,x,I,B)}}}(o||(i.rgba=o={})),i.toPaddedHex=r,i.contrastRatio=p},8969:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CoreTerminal=void 0;const l=n(844),m=n(2585),s=n(4348),h=n(7866),f=n(744),d=n(7302),u=n(6975),t=n(8460),a=n(1753),o=n(1480),r=n(7994),p=n(9282),g=n(5435),E=n(5981),T=n(2660);let w=!1;class x extends l.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new t.EventEmitter),this._onScroll.event(B=>{var S;(S=this._onScrollApi)===null||S===void 0||S.fire(B.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(B){for(const S in B)this.optionsService.options[S]=B[S]}constructor(B){super(),this._windowsWrappingHeuristics=this.register(new l.MutableDisposable),this._onBinary=this.register(new t.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new t.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new t.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new t.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new t.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new t.EventEmitter),this._instantiationService=new s.InstantiationService,this.optionsService=this.register(new d.OptionsService(B)),this._instantiationService.setService(m.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(f.BufferService)),this._instantiationService.setService(m.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(h.LogService)),this._instantiationService.setService(m.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(u.CoreService)),this._instantiationService.setService(m.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(a.CoreMouseService)),this._instantiationService.setService(m.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(o.UnicodeService)),this._instantiationService.setService(m.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(r.CharsetService),this._instantiationService.setService(m.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(T.OscLinkService),this._instantiationService.setService(m.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new g.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,t.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,t.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,t.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,t.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(S=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(S=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new E.WriteBuffer((S,M)=>this._inputHandler.parse(S,M))),this.register((0,t.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(B,S){this._writeBuffer.write(B,S)}writeSync(B,S){this._logService.logLevel<=m.LogLevelEnum.WARN&&!w&&(this._logService.warn("writeSync is unreliable and will be removed soon."),w=!0),this._writeBuffer.writeSync(B,S)}resize(B,S){isNaN(B)||isNaN(S)||(B=Math.max(B,f.MINIMUM_COLS),S=Math.max(S,f.MINIMUM_ROWS),this._bufferService.resize(B,S))}scroll(B,S=!1){this._bufferService.scroll(B,S)}scrollLines(B,S,M){this._bufferService.scrollLines(B,S,M)}scrollPages(B){this.scrollLines(B*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(B){const S=B-this._bufferService.buffer.ydisp;S!==0&&this.scrollLines(S)}registerEscHandler(B,S){return this._inputHandler.registerEscHandler(B,S)}registerDcsHandler(B,S){return this._inputHandler.registerDcsHandler(B,S)}registerCsiHandler(B,S){return this._inputHandler.registerCsiHandler(B,S)}registerOscHandler(B,S){return this._inputHandler.registerOscHandler(B,S)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let B=!1;const S=this.optionsService.rawOptions.windowsPty;S&&S.buildNumber!==void 0&&S.buildNumber!==void 0?B=S.backend==="conpty"&&S.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(B=!0),B?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const B=[];B.push(this.onLineFeed(p.updateWindowsModeWrappedState.bind(null,this._bufferService))),B.push(this.registerCsiHandler({final:"H"},()=>((0,p.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,l.toDisposable)(()=>{for(const S of B)S.dispose()})}}}i.CoreTerminal=x},8460:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.forwardEvent=i.EventEmitter=void 0,i.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=n=>(this._listeners.push(n),{dispose:()=>{if(!this._disposed){for(let l=0;l<this._listeners.length;l++)if(this._listeners[l]===n)return void this._listeners.splice(l,1)}}})),this._event}fire(n,l){const m=[];for(let s=0;s<this._listeners.length;s++)m.push(this._listeners[s]);for(let s=0;s<m.length;s++)m[s].call(void 0,n,l)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},i.forwardEvent=function(n,l){return n(m=>l.fire(m))}},5435:function(C,i,n){var l=this&&this.__decorate||function(F,b,D,R){var O,z=arguments.length,W=z<3?b:R===null?R=Object.getOwnPropertyDescriptor(b,D):R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")W=Reflect.decorate(F,b,D,R);else for(var j=F.length-1;j>=0;j--)(O=F[j])&&(W=(z<3?O(W):z>3?O(b,D,W):O(b,D))||W);return z>3&&W&&Object.defineProperty(b,D,W),W},m=this&&this.__param||function(F,b){return function(D,R){b(D,R,F)}};Object.defineProperty(i,"__esModule",{value:!0}),i.InputHandler=i.WindowsOptionsReportType=void 0;const s=n(2584),h=n(7116),f=n(2015),d=n(844),u=n(482),t=n(8437),a=n(8460),o=n(643),r=n(511),p=n(3734),g=n(2585),E=n(6242),T=n(6351),w=n(5941),x={"(":0,")":1,"*":2,"+":3,"-":1,".":2},I=131072;function B(F,b){if(F>24)return b.setWinLines||!1;switch(F){case 1:return!!b.restoreWin;case 2:return!!b.minimizeWin;case 3:return!!b.setWinPosition;case 4:return!!b.setWinSizePixels;case 5:return!!b.raiseWin;case 6:return!!b.lowerWin;case 7:return!!b.refreshWin;case 8:return!!b.setWinSizeChars;case 9:return!!b.maximizeWin;case 10:return!!b.fullscreenWin;case 11:return!!b.getWinState;case 13:return!!b.getWinPosition;case 14:return!!b.getWinSizePixels;case 15:return!!b.getScreenSizePixels;case 16:return!!b.getCellSizePixels;case 18:return!!b.getWinSizeChars;case 19:return!!b.getScreenSizeChars;case 20:return!!b.getIconTitle;case 21:return!!b.getWinTitle;case 22:return!!b.pushTitle;case 23:return!!b.popTitle;case 24:return!!b.setWinLines}return!1}var S;(function(F){F[F.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",F[F.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(S||(i.WindowsOptionsReportType=S={}));let M=0;class P extends d.Disposable{getAttrData(){return this._curAttrData}constructor(b,D,R,O,z,W,j,X,ie=new f.EscapeSequenceParser){super(),this._bufferService=b,this._charsetService=D,this._coreService=R,this._logService=O,this._optionsService=z,this._oscLinkService=W,this._coreMouseService=j,this._unicodeService=X,this._parser=ie,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new u.StringToUtf32,this._utf8Decoder=new u.Utf8ToUtf32,this._workCell=new r.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=t.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new a.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new a.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new a.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new a.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new a.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new a.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new a.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new a.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new a.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new a.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new a.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new a.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new a.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new H(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(A=>this._activeBuffer=A.activeBuffer)),this._parser.setCsiHandlerFallback((A,$)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(A),params:$.toArray()})}),this._parser.setEscHandlerFallback(A=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(A)})}),this._parser.setExecuteHandlerFallback(A=>{this._logService.debug("Unknown EXECUTE code: ",{code:A})}),this._parser.setOscHandlerFallback((A,$,q)=>{this._logService.debug("Unknown OSC code: ",{identifier:A,action:$,data:q})}),this._parser.setDcsHandlerFallback((A,$,q)=>{$==="HOOK"&&(q=q.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(A),action:$,payload:q})}),this._parser.setPrintHandler((A,$,q)=>this.print(A,$,q)),this._parser.registerCsiHandler({final:"@"},A=>this.insertChars(A)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},A=>this.scrollLeft(A)),this._parser.registerCsiHandler({final:"A"},A=>this.cursorUp(A)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},A=>this.scrollRight(A)),this._parser.registerCsiHandler({final:"B"},A=>this.cursorDown(A)),this._parser.registerCsiHandler({final:"C"},A=>this.cursorForward(A)),this._parser.registerCsiHandler({final:"D"},A=>this.cursorBackward(A)),this._parser.registerCsiHandler({final:"E"},A=>this.cursorNextLine(A)),this._parser.registerCsiHandler({final:"F"},A=>this.cursorPrecedingLine(A)),this._parser.registerCsiHandler({final:"G"},A=>this.cursorCharAbsolute(A)),this._parser.registerCsiHandler({final:"H"},A=>this.cursorPosition(A)),this._parser.registerCsiHandler({final:"I"},A=>this.cursorForwardTab(A)),this._parser.registerCsiHandler({final:"J"},A=>this.eraseInDisplay(A,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},A=>this.eraseInDisplay(A,!0)),this._parser.registerCsiHandler({final:"K"},A=>this.eraseInLine(A,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},A=>this.eraseInLine(A,!0)),this._parser.registerCsiHandler({final:"L"},A=>this.insertLines(A)),this._parser.registerCsiHandler({final:"M"},A=>this.deleteLines(A)),this._parser.registerCsiHandler({final:"P"},A=>this.deleteChars(A)),this._parser.registerCsiHandler({final:"S"},A=>this.scrollUp(A)),this._parser.registerCsiHandler({final:"T"},A=>this.scrollDown(A)),this._parser.registerCsiHandler({final:"X"},A=>this.eraseChars(A)),this._parser.registerCsiHandler({final:"Z"},A=>this.cursorBackwardTab(A)),this._parser.registerCsiHandler({final:"`"},A=>this.charPosAbsolute(A)),this._parser.registerCsiHandler({final:"a"},A=>this.hPositionRelative(A)),this._parser.registerCsiHandler({final:"b"},A=>this.repeatPrecedingCharacter(A)),this._parser.registerCsiHandler({final:"c"},A=>this.sendDeviceAttributesPrimary(A)),this._parser.registerCsiHandler({prefix:">",final:"c"},A=>this.sendDeviceAttributesSecondary(A)),this._parser.registerCsiHandler({final:"d"},A=>this.linePosAbsolute(A)),this._parser.registerCsiHandler({final:"e"},A=>this.vPositionRelative(A)),this._parser.registerCsiHandler({final:"f"},A=>this.hVPosition(A)),this._parser.registerCsiHandler({final:"g"},A=>this.tabClear(A)),this._parser.registerCsiHandler({final:"h"},A=>this.setMode(A)),this._parser.registerCsiHandler({prefix:"?",final:"h"},A=>this.setModePrivate(A)),this._parser.registerCsiHandler({final:"l"},A=>this.resetMode(A)),this._parser.registerCsiHandler({prefix:"?",final:"l"},A=>this.resetModePrivate(A)),this._parser.registerCsiHandler({final:"m"},A=>this.charAttributes(A)),this._parser.registerCsiHandler({final:"n"},A=>this.deviceStatus(A)),this._parser.registerCsiHandler({prefix:"?",final:"n"},A=>this.deviceStatusPrivate(A)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},A=>this.softReset(A)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},A=>this.setCursorStyle(A)),this._parser.registerCsiHandler({final:"r"},A=>this.setScrollRegion(A)),this._parser.registerCsiHandler({final:"s"},A=>this.saveCursor(A)),this._parser.registerCsiHandler({final:"t"},A=>this.windowOptions(A)),this._parser.registerCsiHandler({final:"u"},A=>this.restoreCursor(A)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},A=>this.insertColumns(A)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},A=>this.deleteColumns(A)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},A=>this.selectProtected(A)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},A=>this.requestMode(A,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},A=>this.requestMode(A,!1)),this._parser.setExecuteHandler(s.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(s.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(s.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(s.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(s.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(s.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(s.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(s.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(s.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(s.C1.IND,()=>this.index()),this._parser.setExecuteHandler(s.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(s.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new E.OscHandler(A=>(this.setTitle(A),this.setIconName(A),!0))),this._parser.registerOscHandler(1,new E.OscHandler(A=>this.setIconName(A))),this._parser.registerOscHandler(2,new E.OscHandler(A=>this.setTitle(A))),this._parser.registerOscHandler(4,new E.OscHandler(A=>this.setOrReportIndexedColor(A))),this._parser.registerOscHandler(8,new E.OscHandler(A=>this.setHyperlink(A))),this._parser.registerOscHandler(10,new E.OscHandler(A=>this.setOrReportFgColor(A))),this._parser.registerOscHandler(11,new E.OscHandler(A=>this.setOrReportBgColor(A))),this._parser.registerOscHandler(12,new E.OscHandler(A=>this.setOrReportCursorColor(A))),this._parser.registerOscHandler(104,new E.OscHandler(A=>this.restoreIndexedColor(A))),this._parser.registerOscHandler(110,new E.OscHandler(A=>this.restoreFgColor(A))),this._parser.registerOscHandler(111,new E.OscHandler(A=>this.restoreBgColor(A))),this._parser.registerOscHandler(112,new E.OscHandler(A=>this.restoreCursorColor(A))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const A in h.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:A},()=>this.selectCharset("("+A)),this._parser.registerEscHandler({intermediates:")",final:A},()=>this.selectCharset(")"+A)),this._parser.registerEscHandler({intermediates:"*",final:A},()=>this.selectCharset("*"+A)),this._parser.registerEscHandler({intermediates:"+",final:A},()=>this.selectCharset("+"+A)),this._parser.registerEscHandler({intermediates:"-",final:A},()=>this.selectCharset("-"+A)),this._parser.registerEscHandler({intermediates:".",final:A},()=>this.selectCharset("."+A)),this._parser.registerEscHandler({intermediates:"/",final:A},()=>this.selectCharset("/"+A));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(A=>(this._logService.error("Parsing error: ",A),A)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new T.DcsHandler((A,$)=>this.requestStatusString(A,$)))}_preserveStack(b,D,R,O){this._parseStack.paused=!0,this._parseStack.cursorStartX=b,this._parseStack.cursorStartY=D,this._parseStack.decodedLength=R,this._parseStack.position=O}_logSlowResolvingAsync(b){this._logService.logLevel<=g.LogLevelEnum.WARN&&Promise.race([b,new Promise((D,R)=>setTimeout(()=>R("#SLOW_TIMEOUT"),5e3))]).catch(D=>{if(D!=="#SLOW_TIMEOUT")throw D;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(b,D){let R,O=this._activeBuffer.x,z=this._activeBuffer.y,W=0;const j=this._parseStack.paused;if(j){if(R=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,D))return this._logSlowResolvingAsync(R),R;O=this._parseStack.cursorStartX,z=this._parseStack.cursorStartY,this._parseStack.paused=!1,b.length>I&&(W=this._parseStack.position+I)}if(this._logService.logLevel<=g.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof b=="string"?` "${b}"`:` "${Array.prototype.map.call(b,X=>String.fromCharCode(X)).join("")}"`),typeof b=="string"?b.split("").map(X=>X.charCodeAt(0)):b),this._parseBuffer.length<b.length&&this._parseBuffer.length<I&&(this._parseBuffer=new Uint32Array(Math.min(b.length,I))),j||this._dirtyRowTracker.clearRange(),b.length>I)for(let X=W;X<b.length;X+=I){const ie=X+I<b.length?X+I:b.length,A=typeof b=="string"?this._stringDecoder.decode(b.substring(X,ie),this._parseBuffer):this._utf8Decoder.decode(b.subarray(X,ie),this._parseBuffer);if(R=this._parser.parse(this._parseBuffer,A))return this._preserveStack(O,z,A,X),this._logSlowResolvingAsync(R),R}else if(!j){const X=typeof b=="string"?this._stringDecoder.decode(b,this._parseBuffer):this._utf8Decoder.decode(b,this._parseBuffer);if(R=this._parser.parse(this._parseBuffer,X))return this._preserveStack(O,z,X,0),this._logSlowResolvingAsync(R),R}this._activeBuffer.x===O&&this._activeBuffer.y===z||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(b,D,R){let O,z;const W=this._charsetService.charset,j=this._optionsService.rawOptions.screenReaderMode,X=this._bufferService.cols,ie=this._coreService.decPrivateModes.wraparound,A=this._coreService.modes.insertMode,$=this._curAttrData;let q=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&R-D>0&&q.getWidth(this._activeBuffer.x-1)===2&&q.setCellFromCodePoint(this._activeBuffer.x-1,0,1,$.fg,$.bg,$.extended);for(let V=D;V<R;++V){if(O=b[V],z=this._unicodeService.wcwidth(O),O<127&&W){const K=W[String.fromCharCode(O)];K&&(O=K.charCodeAt(0))}if(j&&this._onA11yChar.fire((0,u.stringFromCodePoint)(O)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),z||!this._activeBuffer.x){if(this._activeBuffer.x+z-1>=X){if(ie){for(;this._activeBuffer.x<X;)q.setCellFromCodePoint(this._activeBuffer.x++,0,1,$.fg,$.bg,$.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),q=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=X-1,z===2)continue}if(A&&(q.insertCells(this._activeBuffer.x,z,this._activeBuffer.getNullCell($),$),q.getWidth(X-1)===2&&q.setCellFromCodePoint(X-1,o.NULL_CELL_CODE,o.NULL_CELL_WIDTH,$.fg,$.bg,$.extended)),q.setCellFromCodePoint(this._activeBuffer.x++,O,z,$.fg,$.bg,$.extended),z>0)for(;--z;)q.setCellFromCodePoint(this._activeBuffer.x++,0,0,$.fg,$.bg,$.extended)}else q.getWidth(this._activeBuffer.x-1)?q.addCodepointToCell(this._activeBuffer.x-1,O):q.addCodepointToCell(this._activeBuffer.x-2,O)}R-D>0&&(q.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<X&&R-D>0&&q.getWidth(this._activeBuffer.x)===0&&!q.hasContent(this._activeBuffer.x)&&q.setCellFromCodePoint(this._activeBuffer.x,0,1,$.fg,$.bg,$.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(b,D){return b.final!=="t"||b.prefix||b.intermediates?this._parser.registerCsiHandler(b,D):this._parser.registerCsiHandler(b,R=>!B(R.params[0],this._optionsService.rawOptions.windowOptions)||D(R))}registerDcsHandler(b,D){return this._parser.registerDcsHandler(b,new T.DcsHandler(D))}registerEscHandler(b,D){return this._parser.registerEscHandler(b,D)}registerOscHandler(b,D){return this._parser.registerOscHandler(b,new E.OscHandler(D))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var b;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((b=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||b===void 0)&&b.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const D=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);D.hasWidth(this._activeBuffer.x)&&!D.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const b=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-b),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(b=this._bufferService.cols-1){this._activeBuffer.x=Math.min(b,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(b,D){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=b,this._activeBuffer.y=this._activeBuffer.scrollTop+D):(this._activeBuffer.x=b,this._activeBuffer.y=D),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(b,D){this._restrictCursor(),this._setCursor(this._activeBuffer.x+b,this._activeBuffer.y+D)}cursorUp(b){const D=this._activeBuffer.y-this._activeBuffer.scrollTop;return D>=0?this._moveCursor(0,-Math.min(D,b.params[0]||1)):this._moveCursor(0,-(b.params[0]||1)),!0}cursorDown(b){const D=this._activeBuffer.scrollBottom-this._activeBuffer.y;return D>=0?this._moveCursor(0,Math.min(D,b.params[0]||1)):this._moveCursor(0,b.params[0]||1),!0}cursorForward(b){return this._moveCursor(b.params[0]||1,0),!0}cursorBackward(b){return this._moveCursor(-(b.params[0]||1),0),!0}cursorNextLine(b){return this.cursorDown(b),this._activeBuffer.x=0,!0}cursorPrecedingLine(b){return this.cursorUp(b),this._activeBuffer.x=0,!0}cursorCharAbsolute(b){return this._setCursor((b.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(b){return this._setCursor(b.length>=2?(b.params[1]||1)-1:0,(b.params[0]||1)-1),!0}charPosAbsolute(b){return this._setCursor((b.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(b){return this._moveCursor(b.params[0]||1,0),!0}linePosAbsolute(b){return this._setCursor(this._activeBuffer.x,(b.params[0]||1)-1),!0}vPositionRelative(b){return this._moveCursor(0,b.params[0]||1),!0}hVPosition(b){return this.cursorPosition(b),!0}tabClear(b){const D=b.params[0];return D===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:D===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(b){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let D=b.params[0]||1;for(;D--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(b){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let D=b.params[0]||1;for(;D--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(b){const D=b.params[0];return D===1&&(this._curAttrData.bg|=536870912),D!==2&&D!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(b,D,R,O=!1,z=!1){const W=this._activeBuffer.lines.get(this._activeBuffer.ybase+b);W.replaceCells(D,R,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),z),O&&(W.isWrapped=!1)}_resetBufferLine(b,D=!1){const R=this._activeBuffer.lines.get(this._activeBuffer.ybase+b);R&&(R.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),D),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+b),R.isWrapped=!1)}eraseInDisplay(b,D=!1){let R;switch(this._restrictCursor(this._bufferService.cols),b.params[0]){case 0:for(R=this._activeBuffer.y,this._dirtyRowTracker.markDirty(R),this._eraseInBufferLine(R++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,D);R<this._bufferService.rows;R++)this._resetBufferLine(R,D);this._dirtyRowTracker.markDirty(R);break;case 1:for(R=this._activeBuffer.y,this._dirtyRowTracker.markDirty(R),this._eraseInBufferLine(R,0,this._activeBuffer.x+1,!0,D),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(R+1).isWrapped=!1);R--;)this._resetBufferLine(R,D);this._dirtyRowTracker.markDirty(0);break;case 2:for(R=this._bufferService.rows,this._dirtyRowTracker.markDirty(R-1);R--;)this._resetBufferLine(R,D);this._dirtyRowTracker.markDirty(0);break;case 3:const O=this._activeBuffer.lines.length-this._bufferService.rows;O>0&&(this._activeBuffer.lines.trimStart(O),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-O,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-O,0),this._onScroll.fire(0))}return!0}eraseInLine(b,D=!1){switch(this._restrictCursor(this._bufferService.cols),b.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,D);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,D);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,D)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(b){this._restrictCursor();let D=b.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const R=this._activeBuffer.ybase+this._activeBuffer.y,O=this._bufferService.rows-1-this._activeBuffer.scrollBottom,z=this._bufferService.rows-1+this._activeBuffer.ybase-O+1;for(;D--;)this._activeBuffer.lines.splice(z-1,1),this._activeBuffer.lines.splice(R,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(b){this._restrictCursor();let D=b.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const R=this._activeBuffer.ybase+this._activeBuffer.y;let O;for(O=this._bufferService.rows-1-this._activeBuffer.scrollBottom,O=this._bufferService.rows-1+this._activeBuffer.ybase-O;D--;)this._activeBuffer.lines.splice(R,1),this._activeBuffer.lines.splice(O,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(b){this._restrictCursor();const D=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return D&&(D.insertCells(this._activeBuffer.x,b.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(b){this._restrictCursor();const D=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return D&&(D.deleteCells(this._activeBuffer.x,b.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(b){let D=b.params[0]||1;for(;D--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(b){let D=b.params[0]||1;for(;D--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(t.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(b){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const D=b.params[0]||1;for(let R=this._activeBuffer.scrollTop;R<=this._activeBuffer.scrollBottom;++R){const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+R);O.deleteCells(0,D,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(b){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const D=b.params[0]||1;for(let R=this._activeBuffer.scrollTop;R<=this._activeBuffer.scrollBottom;++R){const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+R);O.insertCells(0,D,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(b){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const D=b.params[0]||1;for(let R=this._activeBuffer.scrollTop;R<=this._activeBuffer.scrollBottom;++R){const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+R);O.insertCells(this._activeBuffer.x,D,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(b){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const D=b.params[0]||1;for(let R=this._activeBuffer.scrollTop;R<=this._activeBuffer.scrollBottom;++R){const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+R);O.deleteCells(this._activeBuffer.x,D,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),O.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(b){this._restrictCursor();const D=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return D&&(D.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(b.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(b){if(!this._parser.precedingCodepoint)return!0;const D=b.params[0]||1,R=new Uint32Array(D);for(let O=0;O<D;++O)R[O]=this._parser.precedingCodepoint;return this.print(R,0,R.length),!0}sendDeviceAttributesPrimary(b){return b.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(s.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(s.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(b){return b.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(s.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(s.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(b.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(s.C0.ESC+"[>83;40003;0c")),!0}_is(b){return(this._optionsService.rawOptions.termName+"").indexOf(b)===0}setMode(b){for(let D=0;D<b.length;D++)switch(b.params[D]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(b){for(let D=0;D<b.length;D++)switch(b.params[D]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,h.DEFAULT_CHARSET),this._charsetService.setgCharset(1,h.DEFAULT_CHARSET),this._charsetService.setgCharset(2,h.DEFAULT_CHARSET),this._charsetService.setgCharset(3,h.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(b){for(let D=0;D<b.length;D++)switch(b.params[D]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(b){for(let D=0;D<b.length;D++)switch(b.params[D]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),b.params[D]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(b,D){const R=this._coreService.decPrivateModes,{activeProtocol:O,activeEncoding:z}=this._coreMouseService,W=this._coreService,{buffers:j,cols:X}=this._bufferService,{active:ie,alt:A}=j,$=this._optionsService.rawOptions,q=ce=>ce?1:2,V=b.params[0];return K=V,Z=D?V===2?4:V===4?q(W.modes.insertMode):V===12?3:V===20?q($.convertEol):0:V===1?q(R.applicationCursorKeys):V===3?$.windowOptions.setWinLines?X===80?2:X===132?1:0:0:V===6?q(R.origin):V===7?q(R.wraparound):V===8?3:V===9?q(O==="X10"):V===12?q($.cursorBlink):V===25?q(!W.isCursorHidden):V===45?q(R.reverseWraparound):V===66?q(R.applicationKeypad):V===67?4:V===1e3?q(O==="VT200"):V===1002?q(O==="DRAG"):V===1003?q(O==="ANY"):V===1004?q(R.sendFocus):V===1005?4:V===1006?q(z==="SGR"):V===1015?4:V===1016?q(z==="SGR_PIXELS"):V===1048?1:V===47||V===1047||V===1049?q(ie===A):V===2004?q(R.bracketedPasteMode):0,W.triggerDataEvent(`${s.C0.ESC}[${D?"":"?"}${K};${Z}$y`),!0;var K,Z}_updateAttrColor(b,D,R,O,z){return D===2?(b|=50331648,b&=-16777216,b|=p.AttributeData.fromColorRGB([R,O,z])):D===5&&(b&=-50331904,b|=33554432|255&R),b}_extractColor(b,D,R){const O=[0,0,-1,0,0,0];let z=0,W=0;do{if(O[W+z]=b.params[D+W],b.hasSubParams(D+W)){const j=b.getSubParams(D+W);let X=0;do O[1]===5&&(z=1),O[W+X+1+z]=j[X];while(++X<j.length&&X+W+1+z<O.length);break}if(O[1]===5&&W+z>=2||O[1]===2&&W+z>=5)break;O[1]&&(z=1)}while(++W+D<b.length&&W+z<O.length);for(let j=2;j<O.length;++j)O[j]===-1&&(O[j]=0);switch(O[0]){case 38:R.fg=this._updateAttrColor(R.fg,O[1],O[3],O[4],O[5]);break;case 48:R.bg=this._updateAttrColor(R.bg,O[1],O[3],O[4],O[5]);break;case 58:R.extended=R.extended.clone(),R.extended.underlineColor=this._updateAttrColor(R.extended.underlineColor,O[1],O[3],O[4],O[5])}return W}_processUnderline(b,D){D.extended=D.extended.clone(),(!~b||b>5)&&(b=1),D.extended.underlineStyle=b,D.fg|=268435456,b===0&&(D.fg&=-268435457),D.updateExtended()}_processSGR0(b){b.fg=t.DEFAULT_ATTR_DATA.fg,b.bg=t.DEFAULT_ATTR_DATA.bg,b.extended=b.extended.clone(),b.extended.underlineStyle=0,b.extended.underlineColor&=-67108864,b.updateExtended()}charAttributes(b){if(b.length===1&&b.params[0]===0)return this._processSGR0(this._curAttrData),!0;const D=b.length;let R;const O=this._curAttrData;for(let z=0;z<D;z++)R=b.params[z],R>=30&&R<=37?(O.fg&=-50331904,O.fg|=16777216|R-30):R>=40&&R<=47?(O.bg&=-50331904,O.bg|=16777216|R-40):R>=90&&R<=97?(O.fg&=-50331904,O.fg|=16777224|R-90):R>=100&&R<=107?(O.bg&=-50331904,O.bg|=16777224|R-100):R===0?this._processSGR0(O):R===1?O.fg|=134217728:R===3?O.bg|=67108864:R===4?(O.fg|=268435456,this._processUnderline(b.hasSubParams(z)?b.getSubParams(z)[0]:1,O)):R===5?O.fg|=536870912:R===7?O.fg|=67108864:R===8?O.fg|=1073741824:R===9?O.fg|=2147483648:R===2?O.bg|=134217728:R===21?this._processUnderline(2,O):R===22?(O.fg&=-134217729,O.bg&=-134217729):R===23?O.bg&=-67108865:R===24?(O.fg&=-268435457,this._processUnderline(0,O)):R===25?O.fg&=-536870913:R===27?O.fg&=-67108865:R===28?O.fg&=-1073741825:R===29?O.fg&=2147483647:R===39?(O.fg&=-67108864,O.fg|=16777215&t.DEFAULT_ATTR_DATA.fg):R===49?(O.bg&=-67108864,O.bg|=16777215&t.DEFAULT_ATTR_DATA.bg):R===38||R===48||R===58?z+=this._extractColor(b,z,O):R===53?O.bg|=1073741824:R===55?O.bg&=-1073741825:R===59?(O.extended=O.extended.clone(),O.extended.underlineColor=-1,O.updateExtended()):R===100?(O.fg&=-67108864,O.fg|=16777215&t.DEFAULT_ATTR_DATA.fg,O.bg&=-67108864,O.bg|=16777215&t.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",R);return!0}deviceStatus(b){switch(b.params[0]){case 5:this._coreService.triggerDataEvent(`${s.C0.ESC}[0n`);break;case 6:const D=this._activeBuffer.y+1,R=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${s.C0.ESC}[${D};${R}R`)}return!0}deviceStatusPrivate(b){if(b.params[0]===6){const D=this._activeBuffer.y+1,R=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${s.C0.ESC}[?${D};${R}R`)}return!0}softReset(b){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(b){const D=b.params[0]||1;switch(D){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const R=D%2==1;return this._optionsService.options.cursorBlink=R,!0}setScrollRegion(b){const D=b.params[0]||1;let R;return(b.length<2||(R=b.params[1])>this._bufferService.rows||R===0)&&(R=this._bufferService.rows),R>D&&(this._activeBuffer.scrollTop=D-1,this._activeBuffer.scrollBottom=R-1,this._setCursor(0,0)),!0}windowOptions(b){if(!B(b.params[0],this._optionsService.rawOptions.windowOptions))return!0;const D=b.length>1?b.params[1]:0;switch(b.params[0]){case 14:D!==2&&this._onRequestWindowsOptionsReport.fire(S.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(S.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${s.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:D!==0&&D!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),D!==0&&D!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:D!==0&&D!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),D!==0&&D!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(b){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(b){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(b){return this._windowTitle=b,this._onTitleChange.fire(b),!0}setIconName(b){return this._iconName=b,!0}setOrReportIndexedColor(b){const D=[],R=b.split(";");for(;R.length>1;){const O=R.shift(),z=R.shift();if(/^\d+$/.exec(O)){const W=parseInt(O);if(N(W))if(z==="?")D.push({type:0,index:W});else{const j=(0,w.parseColor)(z);j&&D.push({type:1,index:W,color:j})}}}return D.length&&this._onColor.fire(D),!0}setHyperlink(b){const D=b.split(";");return!(D.length<2)&&(D[1]?this._createHyperlink(D[0],D[1]):!D[0]&&this._finishHyperlink())}_createHyperlink(b,D){this._getCurrentLinkId()&&this._finishHyperlink();const R=b.split(":");let O;const z=R.findIndex(W=>W.startsWith("id="));return z!==-1&&(O=R[z].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:O,uri:D}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(b,D){const R=b.split(";");for(let O=0;O<R.length&&!(D>=this._specialColors.length);++O,++D)if(R[O]==="?")this._onColor.fire([{type:0,index:this._specialColors[D]}]);else{const z=(0,w.parseColor)(R[O]);z&&this._onColor.fire([{type:1,index:this._specialColors[D],color:z}])}return!0}setOrReportFgColor(b){return this._setOrReportSpecialColor(b,0)}setOrReportBgColor(b){return this._setOrReportSpecialColor(b,1)}setOrReportCursorColor(b){return this._setOrReportSpecialColor(b,2)}restoreIndexedColor(b){if(!b)return this._onColor.fire([{type:2}]),!0;const D=[],R=b.split(";");for(let O=0;O<R.length;++O)if(/^\d+$/.exec(R[O])){const z=parseInt(R[O]);N(z)&&D.push({type:2,index:z})}return D.length&&this._onColor.fire(D),!0}restoreFgColor(b){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(b){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(b){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,h.DEFAULT_CHARSET),!0}selectCharset(b){return b.length!==2?(this.selectDefaultCharset(),!0):(b[0]==="/"||this._charsetService.setgCharset(x[b[0]],h.CHARSETS[b[1]]||h.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const b=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,b,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=t.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(b){return this._charsetService.setgLevel(b),!0}screenAlignmentPattern(){const b=new r.CellData;b.content=4194304|"E".charCodeAt(0),b.fg=this._curAttrData.fg,b.bg=this._curAttrData.bg,this._setCursor(0,0);for(let D=0;D<this._bufferService.rows;++D){const R=this._activeBuffer.ybase+this._activeBuffer.y+D,O=this._activeBuffer.lines.get(R);O&&(O.fill(b),O.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(b,D){const R=this._bufferService.buffer,O=this._optionsService.rawOptions;return(z=>(this._coreService.triggerDataEvent(`${s.C0.ESC}${z}${s.C0.ESC}\\`),!0))(b==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:b==='"p'?'P1$r61;1"p':b==="r"?`P1$r${R.scrollTop+1};${R.scrollBottom+1}r`:b==="m"?"P1$r0m":b===" q"?`P1$r${{block:2,underline:4,bar:6}[O.cursorStyle]-(O.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(b,D){this._dirtyRowTracker.markRangeDirty(b,D)}}i.InputHandler=P;let H=class{constructor(F){this._bufferService=F,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(F){F<this.start?this.start=F:F>this.end&&(this.end=F)}markRangeDirty(F,b){F>b&&(M=F,F=b,b=M),F<this.start&&(this.start=F),b>this.end&&(this.end=b)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function N(F){return 0<=F&&F<256}H=l([m(0,g.IBufferService)],H)},844:(C,i)=>{function n(l){for(const m of l)m.dispose();l.length=0}Object.defineProperty(i,"__esModule",{value:!0}),i.getDisposeArrayDisposable=i.disposeArray=i.toDisposable=i.MutableDisposable=i.Disposable=void 0,i.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const l of this._disposables)l.dispose();this._disposables.length=0}register(l){return this._disposables.push(l),l}unregister(l){const m=this._disposables.indexOf(l);m!==-1&&this._disposables.splice(m,1)}},i.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(l){var m;this._isDisposed||l===this._value||((m=this._value)===null||m===void 0||m.dispose(),this._value=l)}clear(){this.value=void 0}dispose(){var l;this._isDisposed=!0,(l=this._value)===null||l===void 0||l.dispose(),this._value=void 0}},i.toDisposable=function(l){return{dispose:l}},i.disposeArray=n,i.getDisposeArrayDisposable=function(l){return{dispose:()=>n(l)}}},1505:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.FourKeyMap=i.TwoKeyMap=void 0;class n{constructor(){this._data={}}set(m,s,h){this._data[m]||(this._data[m]={}),this._data[m][s]=h}get(m,s){return this._data[m]?this._data[m][s]:void 0}clear(){this._data={}}}i.TwoKeyMap=n,i.FourKeyMap=class{constructor(){this._data=new n}set(l,m,s,h,f){this._data.get(l,m)||this._data.set(l,m,new n),this._data.get(l,m).set(s,h,f)}get(l,m,s,h){var f;return(f=this._data.get(l,m))===null||f===void 0?void 0:f.get(s,h)}clear(){this._data.clear()}}},6114:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.isChromeOS=i.isLinux=i.isWindows=i.isIphone=i.isIpad=i.isMac=i.getSafariVersion=i.isSafari=i.isLegacyEdge=i.isFirefox=i.isNode=void 0,i.isNode=typeof navigator>"u";const n=i.isNode?"node":navigator.userAgent,l=i.isNode?"node":navigator.platform;i.isFirefox=n.includes("Firefox"),i.isLegacyEdge=n.includes("Edge"),i.isSafari=/^((?!chrome|android).)*safari/i.test(n),i.getSafariVersion=function(){if(!i.isSafari)return 0;const m=n.match(/Version\/(\d+)/);return m===null||m.length<2?0:parseInt(m[1])},i.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(l),i.isIpad=l==="iPad",i.isIphone=l==="iPhone",i.isWindows=["Windows","Win16","Win32","WinCE"].includes(l),i.isLinux=l.indexOf("Linux")>=0,i.isChromeOS=/\bCrOS\b/.test(n)},6106:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.SortedList=void 0;let n=0;i.SortedList=class{constructor(l){this._getKey=l,this._array=[]}clear(){this._array.length=0}insert(l){this._array.length!==0?(n=this._search(this._getKey(l)),this._array.splice(n,0,l)):this._array.push(l)}delete(l){if(this._array.length===0)return!1;const m=this._getKey(l);if(m===void 0||(n=this._search(m),n===-1)||this._getKey(this._array[n])!==m)return!1;do if(this._array[n]===l)return this._array.splice(n,1),!0;while(++n<this._array.length&&this._getKey(this._array[n])===m);return!1}*getKeyIterator(l){if(this._array.length!==0&&(n=this._search(l),!(n<0||n>=this._array.length)&&this._getKey(this._array[n])===l))do yield this._array[n];while(++n<this._array.length&&this._getKey(this._array[n])===l)}forEachByKey(l,m){if(this._array.length!==0&&(n=this._search(l),!(n<0||n>=this._array.length)&&this._getKey(this._array[n])===l))do m(this._array[n]);while(++n<this._array.length&&this._getKey(this._array[n])===l)}values(){return[...this._array].values()}_search(l){let m=0,s=this._array.length-1;for(;s>=m;){let h=m+s>>1;const f=this._getKey(this._array[h]);if(f>l)s=h-1;else{if(!(f<l)){for(;h>0&&this._getKey(this._array[h-1])===l;)h--;return h}m=h+1}}return m}}},7226:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DebouncedIdleTask=i.IdleTaskQueue=i.PriorityTaskQueue=void 0;const l=n(6114);class m{constructor(){this._tasks=[],this._i=0}enqueue(f){this._tasks.push(f),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(f){this._idleCallback=void 0;let d=0,u=0,t=f.timeRemaining(),a=0;for(;this._i<this._tasks.length;){if(d=Date.now(),this._tasks[this._i]()||this._i++,d=Math.max(1,Date.now()-d),u=Math.max(d,u),a=f.timeRemaining(),1.5*u>a)return t-d<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(t-d))}ms`),void this._start();t=a}this.clear()}}class s extends m{_requestCallback(f){return setTimeout(()=>f(this._createDeadline(16)))}_cancelCallback(f){clearTimeout(f)}_createDeadline(f){const d=Date.now()+f;return{timeRemaining:()=>Math.max(0,d-Date.now())}}}i.PriorityTaskQueue=s,i.IdleTaskQueue=!l.isNode&&"requestIdleCallback"in window?class extends m{_requestCallback(h){return requestIdleCallback(h)}_cancelCallback(h){cancelIdleCallback(h)}}:s,i.DebouncedIdleTask=class{constructor(){this._queue=new i.IdleTaskQueue}set(h){this._queue.clear(),this._queue.enqueue(h)}flush(){this._queue.flush()}}},9282:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.updateWindowsModeWrappedState=void 0;const l=n(643);i.updateWindowsModeWrappedState=function(m){const s=m.buffer.lines.get(m.buffer.ybase+m.buffer.y-1),h=s==null?void 0:s.get(m.cols-1),f=m.buffer.lines.get(m.buffer.ybase+m.buffer.y);f&&h&&(f.isWrapped=h[l.CHAR_DATA_CODE_INDEX]!==l.NULL_CELL_CODE&&h[l.CHAR_DATA_CODE_INDEX]!==l.WHITESPACE_CELL_CODE)}},3734:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ExtendedAttrs=i.AttributeData=void 0;class n{constructor(){this.fg=0,this.bg=0,this.extended=new l}static toColorRGB(s){return[s>>>16&255,s>>>8&255,255&s]}static fromColorRGB(s){return(255&s[0])<<16|(255&s[1])<<8|255&s[2]}clone(){const s=new n;return s.fg=this.fg,s.bg=this.bg,s.extended=this.extended.clone(),s}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}i.AttributeData=n;class l{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(s){this._ext=s}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(s){this._ext&=-469762049,this._ext|=s<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(s){this._ext&=-67108864,this._ext|=67108863&s}get urlId(){return this._urlId}set urlId(s){this._urlId=s}constructor(s=0,h=0){this._ext=0,this._urlId=0,this._ext=s,this._urlId=h}clone(){return new l(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}i.ExtendedAttrs=l},9092:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Buffer=i.MAX_BUFFER_SIZE=void 0;const l=n(6349),m=n(7226),s=n(3734),h=n(8437),f=n(4634),d=n(511),u=n(643),t=n(4863),a=n(7116);i.MAX_BUFFER_SIZE=4294967295,i.Buffer=class{constructor(o,r,p){this._hasScrollback=o,this._optionsService=r,this._bufferService=p,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=h.DEFAULT_ATTR_DATA.clone(),this.savedCharset=a.DEFAULT_CHARSET,this.markers=[],this._nullCell=d.CellData.fromCharData([0,u.NULL_CELL_CHAR,u.NULL_CELL_WIDTH,u.NULL_CELL_CODE]),this._whitespaceCell=d.CellData.fromCharData([0,u.WHITESPACE_CELL_CHAR,u.WHITESPACE_CELL_WIDTH,u.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new m.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new l.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(o){return o?(this._nullCell.fg=o.fg,this._nullCell.bg=o.bg,this._nullCell.extended=o.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new s.ExtendedAttrs),this._nullCell}getWhitespaceCell(o){return o?(this._whitespaceCell.fg=o.fg,this._whitespaceCell.bg=o.bg,this._whitespaceCell.extended=o.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new s.ExtendedAttrs),this._whitespaceCell}getBlankLine(o,r){return new h.BufferLine(this._bufferService.cols,this.getNullCell(o),r)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const o=this.ybase+this.y-this.ydisp;return o>=0&&o<this._rows}_getCorrectBufferLength(o){if(!this._hasScrollback)return o;const r=o+this._optionsService.rawOptions.scrollback;return r>i.MAX_BUFFER_SIZE?i.MAX_BUFFER_SIZE:r}fillViewportRows(o){if(this.lines.length===0){o===void 0&&(o=h.DEFAULT_ATTR_DATA);let r=this._rows;for(;r--;)this.lines.push(this.getBlankLine(o))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new l.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(o,r){const p=this.getNullCell(h.DEFAULT_ATTR_DATA);let g=0;const E=this._getCorrectBufferLength(r);if(E>this.lines.maxLength&&(this.lines.maxLength=E),this.lines.length>0){if(this._cols<o)for(let w=0;w<this.lines.length;w++)g+=+this.lines.get(w).resize(o,p);let T=0;if(this._rows<r)for(let w=this._rows;w<r;w++)this.lines.length<r+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new h.BufferLine(o,p)):this.ybase>0&&this.lines.length<=this.ybase+this.y+T+1?(this.ybase--,T++,this.ydisp>0&&this.ydisp--):this.lines.push(new h.BufferLine(o,p)));else for(let w=this._rows;w>r;w--)this.lines.length>r+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(E<this.lines.maxLength){const w=this.lines.length-E;w>0&&(this.lines.trimStart(w),this.ybase=Math.max(this.ybase-w,0),this.ydisp=Math.max(this.ydisp-w,0),this.savedY=Math.max(this.savedY-w,0)),this.lines.maxLength=E}this.x=Math.min(this.x,o-1),this.y=Math.min(this.y,r-1),T&&(this.y+=T),this.savedX=Math.min(this.savedX,o-1),this.scrollTop=0}if(this.scrollBottom=r-1,this._isReflowEnabled&&(this._reflow(o,r),this._cols>o))for(let T=0;T<this.lines.length;T++)g+=+this.lines.get(T).resize(o,p);this._cols=o,this._rows=r,this._memoryCleanupQueue.clear(),g>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let o=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,o=!1);let r=0;for(;this._memoryCleanupPosition<this.lines.length;)if(r+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),r>100)return!0;return o}get _isReflowEnabled(){const o=this._optionsService.rawOptions.windowsPty;return o&&o.buildNumber?this._hasScrollback&&o.backend==="conpty"&&o.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(o,r){this._cols!==o&&(o>this._cols?this._reflowLarger(o,r):this._reflowSmaller(o,r))}_reflowLarger(o,r){const p=(0,f.reflowLargerGetLinesToRemove)(this.lines,this._cols,o,this.ybase+this.y,this.getNullCell(h.DEFAULT_ATTR_DATA));if(p.length>0){const g=(0,f.reflowLargerCreateNewLayout)(this.lines,p);(0,f.reflowLargerApplyNewLayout)(this.lines,g.layout),this._reflowLargerAdjustViewport(o,r,g.countRemoved)}}_reflowLargerAdjustViewport(o,r,p){const g=this.getNullCell(h.DEFAULT_ATTR_DATA);let E=p;for(;E-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<r&&this.lines.push(new h.BufferLine(o,g))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-p,0)}_reflowSmaller(o,r){const p=this.getNullCell(h.DEFAULT_ATTR_DATA),g=[];let E=0;for(let T=this.lines.length-1;T>=0;T--){let w=this.lines.get(T);if(!w||!w.isWrapped&&w.getTrimmedLength()<=o)continue;const x=[w];for(;w.isWrapped&&T>0;)w=this.lines.get(--T),x.unshift(w);const I=this.ybase+this.y;if(I>=T&&I<T+x.length)continue;const B=x[x.length-1].getTrimmedLength(),S=(0,f.reflowSmallerGetNewLineLengths)(x,this._cols,o),M=S.length-x.length;let P;P=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+M):Math.max(0,this.lines.length-this.lines.maxLength+M);const H=[];for(let O=0;O<M;O++){const z=this.getBlankLine(h.DEFAULT_ATTR_DATA,!0);H.push(z)}H.length>0&&(g.push({start:T+x.length+E,newLines:H}),E+=H.length),x.push(...H);let N=S.length-1,F=S[N];F===0&&(N--,F=S[N]);let b=x.length-M-1,D=B;for(;b>=0;){const O=Math.min(D,F);if(x[N]===void 0)break;if(x[N].copyCellsFrom(x[b],D-O,F-O,O,!0),F-=O,F===0&&(N--,F=S[N]),D-=O,D===0){b--;const z=Math.max(b,0);D=(0,f.getWrappedLineTrimmedLength)(x,z,this._cols)}}for(let O=0;O<x.length;O++)S[O]<o&&x[O].setCell(S[O],p);let R=M-P;for(;R-- >0;)this.ybase===0?this.y<r-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+E)-r&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+M,this.ybase+r-1)}if(g.length>0){const T=[],w=[];for(let N=0;N<this.lines.length;N++)w.push(this.lines.get(N));const x=this.lines.length;let I=x-1,B=0,S=g[B];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+E);let M=0;for(let N=Math.min(this.lines.maxLength-1,x+E-1);N>=0;N--)if(S&&S.start>I+M){for(let F=S.newLines.length-1;F>=0;F--)this.lines.set(N--,S.newLines[F]);N++,T.push({index:I+1,amount:S.newLines.length}),M+=S.newLines.length,S=g[++B]}else this.lines.set(N,w[I--]);let P=0;for(let N=T.length-1;N>=0;N--)T[N].index+=P,this.lines.onInsertEmitter.fire(T[N]),P+=T[N].amount;const H=Math.max(0,x+E-this.lines.maxLength);H>0&&this.lines.onTrimEmitter.fire(H)}}translateBufferLineToString(o,r,p=0,g){const E=this.lines.get(o);return E?E.translateToString(r,p,g):""}getWrappedRangeForLine(o){let r=o,p=o;for(;r>0&&this.lines.get(r).isWrapped;)r--;for(;p+1<this.lines.length&&this.lines.get(p+1).isWrapped;)p++;return{first:r,last:p}}setupTabStops(o){for(o!=null?this.tabs[o]||(o=this.prevStop(o)):(this.tabs={},o=0);o<this._cols;o+=this._optionsService.rawOptions.tabStopWidth)this.tabs[o]=!0}prevStop(o){for(o==null&&(o=this.x);!this.tabs[--o]&&o>0;);return o>=this._cols?this._cols-1:o<0?0:o}nextStop(o){for(o==null&&(o=this.x);!this.tabs[++o]&&o<this._cols;);return o>=this._cols?this._cols-1:o<0?0:o}clearMarkers(o){this._isClearing=!0;for(let r=0;r<this.markers.length;r++)this.markers[r].line===o&&(this.markers[r].dispose(),this.markers.splice(r--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let o=0;o<this.markers.length;o++)this.markers[o].dispose(),this.markers.splice(o--,1);this._isClearing=!1}addMarker(o){const r=new t.Marker(o);return this.markers.push(r),r.register(this.lines.onTrim(p=>{r.line-=p,r.line<0&&r.dispose()})),r.register(this.lines.onInsert(p=>{r.line>=p.index&&(r.line+=p.amount)})),r.register(this.lines.onDelete(p=>{r.line>=p.index&&r.line<p.index+p.amount&&r.dispose(),r.line>p.index&&(r.line-=p.amount)})),r.register(r.onDispose(()=>this._removeMarker(r))),r}_removeMarker(o){this._isClearing||this.markers.splice(this.markers.indexOf(o),1)}}},8437:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BufferLine=i.DEFAULT_ATTR_DATA=void 0;const l=n(3734),m=n(511),s=n(643),h=n(482);i.DEFAULT_ATTR_DATA=Object.freeze(new l.AttributeData);let f=0;class d{constructor(t,a,o=!1){this.isWrapped=o,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*t);const r=a||m.CellData.fromCharData([0,s.NULL_CELL_CHAR,s.NULL_CELL_WIDTH,s.NULL_CELL_CODE]);for(let p=0;p<t;++p)this.setCell(p,r);this.length=t}get(t){const a=this._data[3*t+0],o=2097151&a;return[this._data[3*t+1],2097152&a?this._combined[t]:o?(0,h.stringFromCodePoint)(o):"",a>>22,2097152&a?this._combined[t].charCodeAt(this._combined[t].length-1):o]}set(t,a){this._data[3*t+1]=a[s.CHAR_DATA_ATTR_INDEX],a[s.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[t]=a[1],this._data[3*t+0]=2097152|t|a[s.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*t+0]=a[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|a[s.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(t){return this._data[3*t+0]>>22}hasWidth(t){return 12582912&this._data[3*t+0]}getFg(t){return this._data[3*t+1]}getBg(t){return this._data[3*t+2]}hasContent(t){return 4194303&this._data[3*t+0]}getCodePoint(t){const a=this._data[3*t+0];return 2097152&a?this._combined[t].charCodeAt(this._combined[t].length-1):2097151&a}isCombined(t){return 2097152&this._data[3*t+0]}getString(t){const a=this._data[3*t+0];return 2097152&a?this._combined[t]:2097151&a?(0,h.stringFromCodePoint)(2097151&a):""}isProtected(t){return 536870912&this._data[3*t+2]}loadCell(t,a){return f=3*t,a.content=this._data[f+0],a.fg=this._data[f+1],a.bg=this._data[f+2],2097152&a.content&&(a.combinedData=this._combined[t]),268435456&a.bg&&(a.extended=this._extendedAttrs[t]),a}setCell(t,a){2097152&a.content&&(this._combined[t]=a.combinedData),268435456&a.bg&&(this._extendedAttrs[t]=a.extended),this._data[3*t+0]=a.content,this._data[3*t+1]=a.fg,this._data[3*t+2]=a.bg}setCellFromCodePoint(t,a,o,r,p,g){268435456&p&&(this._extendedAttrs[t]=g),this._data[3*t+0]=a|o<<22,this._data[3*t+1]=r,this._data[3*t+2]=p}addCodepointToCell(t,a){let o=this._data[3*t+0];2097152&o?this._combined[t]+=(0,h.stringFromCodePoint)(a):(2097151&o?(this._combined[t]=(0,h.stringFromCodePoint)(2097151&o)+(0,h.stringFromCodePoint)(a),o&=-2097152,o|=2097152):o=a|4194304,this._data[3*t+0]=o)}insertCells(t,a,o,r){if((t%=this.length)&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs),a<this.length-t){const p=new m.CellData;for(let g=this.length-t-a-1;g>=0;--g)this.setCell(t+a+g,this.loadCell(t+g,p));for(let g=0;g<a;++g)this.setCell(t+g,o)}else for(let p=t;p<this.length;++p)this.setCell(p,o);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs)}deleteCells(t,a,o,r){if(t%=this.length,a<this.length-t){const p=new m.CellData;for(let g=0;g<this.length-t-a;++g)this.setCell(t+g,this.loadCell(t+a+g,p));for(let g=this.length-a;g<this.length;++g)this.setCell(g,o)}else for(let p=t;p<this.length;++p)this.setCell(p,o);t&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs),this.getWidth(t)!==0||this.hasContent(t)||this.setCellFromCodePoint(t,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs)}replaceCells(t,a,o,r,p=!1){if(p)for(t&&this.getWidth(t-1)===2&&!this.isProtected(t-1)&&this.setCellFromCodePoint(t-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs),a<this.length&&this.getWidth(a-1)===2&&!this.isProtected(a)&&this.setCellFromCodePoint(a,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs);t<a&&t<this.length;)this.isProtected(t)||this.setCell(t,o),t++;else for(t&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs),a<this.length&&this.getWidth(a-1)===2&&this.setCellFromCodePoint(a,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new l.ExtendedAttrs);t<a&&t<this.length;)this.setCell(t++,o)}resize(t,a){if(t===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const o=3*t;if(t>this.length){if(this._data.buffer.byteLength>=4*o)this._data=new Uint32Array(this._data.buffer,0,o);else{const r=new Uint32Array(o);r.set(this._data),this._data=r}for(let r=this.length;r<t;++r)this.setCell(r,a)}else{this._data=this._data.subarray(0,o);const r=Object.keys(this._combined);for(let g=0;g<r.length;g++){const E=parseInt(r[g],10);E>=t&&delete this._combined[E]}const p=Object.keys(this._extendedAttrs);for(let g=0;g<p.length;g++){const E=parseInt(p[g],10);E>=t&&delete this._extendedAttrs[E]}}return this.length=t,4*o*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const t=new Uint32Array(this._data.length);return t.set(this._data),this._data=t,1}return 0}fill(t,a=!1){if(a)for(let o=0;o<this.length;++o)this.isProtected(o)||this.setCell(o,t);else{this._combined={},this._extendedAttrs={};for(let o=0;o<this.length;++o)this.setCell(o,t)}}copyFrom(t){this.length!==t.length?this._data=new Uint32Array(t._data):this._data.set(t._data),this.length=t.length,this._combined={};for(const a in t._combined)this._combined[a]=t._combined[a];this._extendedAttrs={};for(const a in t._extendedAttrs)this._extendedAttrs[a]=t._extendedAttrs[a];this.isWrapped=t.isWrapped}clone(){const t=new d(0);t._data=new Uint32Array(this._data),t.length=this.length;for(const a in this._combined)t._combined[a]=this._combined[a];for(const a in this._extendedAttrs)t._extendedAttrs[a]=this._extendedAttrs[a];return t.isWrapped=this.isWrapped,t}getTrimmedLength(){for(let t=this.length-1;t>=0;--t)if(4194303&this._data[3*t+0])return t+(this._data[3*t+0]>>22);return 0}getNoBgTrimmedLength(){for(let t=this.length-1;t>=0;--t)if(4194303&this._data[3*t+0]||50331648&this._data[3*t+2])return t+(this._data[3*t+0]>>22);return 0}copyCellsFrom(t,a,o,r,p){const g=t._data;if(p)for(let T=r-1;T>=0;T--){for(let w=0;w<3;w++)this._data[3*(o+T)+w]=g[3*(a+T)+w];268435456&g[3*(a+T)+2]&&(this._extendedAttrs[o+T]=t._extendedAttrs[a+T])}else for(let T=0;T<r;T++){for(let w=0;w<3;w++)this._data[3*(o+T)+w]=g[3*(a+T)+w];268435456&g[3*(a+T)+2]&&(this._extendedAttrs[o+T]=t._extendedAttrs[a+T])}const E=Object.keys(t._combined);for(let T=0;T<E.length;T++){const w=parseInt(E[T],10);w>=a&&(this._combined[w-a+o]=t._combined[w])}}translateToString(t=!1,a=0,o=this.length){t&&(o=Math.min(o,this.getTrimmedLength()));let r="";for(;a<o;){const p=this._data[3*a+0],g=2097151&p;r+=2097152&p?this._combined[a]:g?(0,h.stringFromCodePoint)(g):s.WHITESPACE_CELL_CHAR,a+=p>>22||1}return r}}i.BufferLine=d},4841:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.getRangeLength=void 0,i.getRangeLength=function(n,l){if(n.start.y>n.end.y)throw new Error(`Buffer range end (${n.end.x}, ${n.end.y}) cannot be before start (${n.start.x}, ${n.start.y})`);return l*(n.end.y-n.start.y)+(n.end.x-n.start.x+1)}},4634:(C,i)=>{function n(l,m,s){if(m===l.length-1)return l[m].getTrimmedLength();const h=!l[m].hasContent(s-1)&&l[m].getWidth(s-1)===1,f=l[m+1].getWidth(0)===2;return h&&f?s-1:s}Object.defineProperty(i,"__esModule",{value:!0}),i.getWrappedLineTrimmedLength=i.reflowSmallerGetNewLineLengths=i.reflowLargerApplyNewLayout=i.reflowLargerCreateNewLayout=i.reflowLargerGetLinesToRemove=void 0,i.reflowLargerGetLinesToRemove=function(l,m,s,h,f){const d=[];for(let u=0;u<l.length-1;u++){let t=u,a=l.get(++t);if(!a.isWrapped)continue;const o=[l.get(u)];for(;t<l.length&&a.isWrapped;)o.push(a),a=l.get(++t);if(h>=u&&h<t){u+=o.length-1;continue}let r=0,p=n(o,r,m),g=1,E=0;for(;g<o.length;){const w=n(o,g,m),x=w-E,I=s-p,B=Math.min(x,I);o[r].copyCellsFrom(o[g],E,p,B,!1),p+=B,p===s&&(r++,p=0),E+=B,E===w&&(g++,E=0),p===0&&r!==0&&o[r-1].getWidth(s-1)===2&&(o[r].copyCellsFrom(o[r-1],s-1,p++,1,!1),o[r-1].setCell(s-1,f))}o[r].replaceCells(p,s,f);let T=0;for(let w=o.length-1;w>0&&(w>r||o[w].getTrimmedLength()===0);w--)T++;T>0&&(d.push(u+o.length-T),d.push(T)),u+=o.length-1}return d},i.reflowLargerCreateNewLayout=function(l,m){const s=[];let h=0,f=m[h],d=0;for(let u=0;u<l.length;u++)if(f===u){const t=m[++h];l.onDeleteEmitter.fire({index:u-d,amount:t}),u+=t-1,d+=t,f=m[++h]}else s.push(u);return{layout:s,countRemoved:d}},i.reflowLargerApplyNewLayout=function(l,m){const s=[];for(let h=0;h<m.length;h++)s.push(l.get(m[h]));for(let h=0;h<s.length;h++)l.set(h,s[h]);l.length=m.length},i.reflowSmallerGetNewLineLengths=function(l,m,s){const h=[],f=l.map((a,o)=>n(l,o,m)).reduce((a,o)=>a+o);let d=0,u=0,t=0;for(;t<f;){if(f-t<s){h.push(f-t);break}d+=s;const a=n(l,u,m);d>a&&(d-=a,u++);const o=l[u].getWidth(d-1)===2;o&&d--;const r=o?s-1:s;h.push(r),t+=r}return h},i.getWrappedLineTrimmedLength=n},5295:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BufferSet=void 0;const l=n(8460),m=n(844),s=n(9092);class h extends m.Disposable{constructor(d,u){super(),this._optionsService=d,this._bufferService=u,this._onBufferActivate=this.register(new l.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new s.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new s.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(d){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(d),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(d,u){this._normal.resize(d,u),this._alt.resize(d,u),this.setupTabStops(d)}setupTabStops(d){this._normal.setupTabStops(d),this._alt.setupTabStops(d)}}i.BufferSet=h},511:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CellData=void 0;const l=n(482),m=n(643),s=n(3734);class h extends s.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new s.ExtendedAttrs,this.combinedData=""}static fromCharData(d){const u=new h;return u.setFromCharData(d),u}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,l.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(d){this.fg=d[m.CHAR_DATA_ATTR_INDEX],this.bg=0;let u=!1;if(d[m.CHAR_DATA_CHAR_INDEX].length>2)u=!0;else if(d[m.CHAR_DATA_CHAR_INDEX].length===2){const t=d[m.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=t&&t<=56319){const a=d[m.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=a&&a<=57343?this.content=1024*(t-55296)+a-56320+65536|d[m.CHAR_DATA_WIDTH_INDEX]<<22:u=!0}else u=!0}else this.content=d[m.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|d[m.CHAR_DATA_WIDTH_INDEX]<<22;u&&(this.combinedData=d[m.CHAR_DATA_CHAR_INDEX],this.content=2097152|d[m.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}i.CellData=h},643:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.WHITESPACE_CELL_CODE=i.WHITESPACE_CELL_WIDTH=i.WHITESPACE_CELL_CHAR=i.NULL_CELL_CODE=i.NULL_CELL_WIDTH=i.NULL_CELL_CHAR=i.CHAR_DATA_CODE_INDEX=i.CHAR_DATA_WIDTH_INDEX=i.CHAR_DATA_CHAR_INDEX=i.CHAR_DATA_ATTR_INDEX=i.DEFAULT_EXT=i.DEFAULT_ATTR=i.DEFAULT_COLOR=void 0,i.DEFAULT_COLOR=0,i.DEFAULT_ATTR=256|i.DEFAULT_COLOR<<9,i.DEFAULT_EXT=0,i.CHAR_DATA_ATTR_INDEX=0,i.CHAR_DATA_CHAR_INDEX=1,i.CHAR_DATA_WIDTH_INDEX=2,i.CHAR_DATA_CODE_INDEX=3,i.NULL_CELL_CHAR="",i.NULL_CELL_WIDTH=1,i.NULL_CELL_CODE=0,i.WHITESPACE_CELL_CHAR=" ",i.WHITESPACE_CELL_WIDTH=1,i.WHITESPACE_CELL_CODE=32},4863:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Marker=void 0;const l=n(8460),m=n(844);class s{get id(){return this._id}constructor(f){this.line=f,this.isDisposed=!1,this._disposables=[],this._id=s._nextId++,this._onDispose=this.register(new l.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,m.disposeArray)(this._disposables),this._disposables.length=0)}register(f){return this._disposables.push(f),f}}i.Marker=s,s._nextId=1},7116:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DEFAULT_CHARSET=i.CHARSETS=void 0,i.CHARSETS={},i.DEFAULT_CHARSET=i.CHARSETS.B,i.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},i.CHARSETS.A={"#":"£"},i.CHARSETS.B=void 0,i.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},i.CHARSETS.C=i.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},i.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},i.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},i.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},i.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},i.CHARSETS.E=i.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},i.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},i.CHARSETS.H=i.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},i.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(C,i)=>{var n,l,m;Object.defineProperty(i,"__esModule",{value:!0}),i.C1_ESCAPED=i.C1=i.C0=void 0,function(s){s.NUL="\0",s.SOH="",s.STX="",s.ETX="",s.EOT="",s.ENQ="",s.ACK="",s.BEL="\x07",s.BS="\b",s.HT="	",s.LF=`
`,s.VT="\v",s.FF="\f",s.CR="\r",s.SO="",s.SI="",s.DLE="",s.DC1="",s.DC2="",s.DC3="",s.DC4="",s.NAK="",s.SYN="",s.ETB="",s.CAN="",s.EM="",s.SUB="",s.ESC="\x1B",s.FS="",s.GS="",s.RS="",s.US="",s.SP=" ",s.DEL=""}(n||(i.C0=n={})),function(s){s.PAD="",s.HOP="",s.BPH="",s.NBH="",s.IND="",s.NEL="",s.SSA="",s.ESA="",s.HTS="",s.HTJ="",s.VTS="",s.PLD="",s.PLU="",s.RI="",s.SS2="",s.SS3="",s.DCS="",s.PU1="",s.PU2="",s.STS="",s.CCH="",s.MW="",s.SPA="",s.EPA="",s.SOS="",s.SGCI="",s.SCI="",s.CSI="",s.ST="",s.OSC="",s.PM="",s.APC=""}(l||(i.C1=l={})),function(s){s.ST=`${n.ESC}\\`}(m||(i.C1_ESCAPED=m={}))},7399:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.evaluateKeyboardEvent=void 0;const l=n(2584),m={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};i.evaluateKeyboardEvent=function(s,h,f,d){const u={type:0,cancel:!1,key:void 0},t=(s.shiftKey?1:0)|(s.altKey?2:0)|(s.ctrlKey?4:0)|(s.metaKey?8:0);switch(s.keyCode){case 0:s.key==="UIKeyInputUpArrow"?u.key=h?l.C0.ESC+"OA":l.C0.ESC+"[A":s.key==="UIKeyInputLeftArrow"?u.key=h?l.C0.ESC+"OD":l.C0.ESC+"[D":s.key==="UIKeyInputRightArrow"?u.key=h?l.C0.ESC+"OC":l.C0.ESC+"[C":s.key==="UIKeyInputDownArrow"&&(u.key=h?l.C0.ESC+"OB":l.C0.ESC+"[B");break;case 8:if(s.altKey){u.key=l.C0.ESC+l.C0.DEL;break}u.key=l.C0.DEL;break;case 9:if(s.shiftKey){u.key=l.C0.ESC+"[Z";break}u.key=l.C0.HT,u.cancel=!0;break;case 13:u.key=s.altKey?l.C0.ESC+l.C0.CR:l.C0.CR,u.cancel=!0;break;case 27:u.key=l.C0.ESC,s.altKey&&(u.key=l.C0.ESC+l.C0.ESC),u.cancel=!0;break;case 37:if(s.metaKey)break;t?(u.key=l.C0.ESC+"[1;"+(t+1)+"D",u.key===l.C0.ESC+"[1;3D"&&(u.key=l.C0.ESC+(f?"b":"[1;5D"))):u.key=h?l.C0.ESC+"OD":l.C0.ESC+"[D";break;case 39:if(s.metaKey)break;t?(u.key=l.C0.ESC+"[1;"+(t+1)+"C",u.key===l.C0.ESC+"[1;3C"&&(u.key=l.C0.ESC+(f?"f":"[1;5C"))):u.key=h?l.C0.ESC+"OC":l.C0.ESC+"[C";break;case 38:if(s.metaKey)break;t?(u.key=l.C0.ESC+"[1;"+(t+1)+"A",f||u.key!==l.C0.ESC+"[1;3A"||(u.key=l.C0.ESC+"[1;5A")):u.key=h?l.C0.ESC+"OA":l.C0.ESC+"[A";break;case 40:if(s.metaKey)break;t?(u.key=l.C0.ESC+"[1;"+(t+1)+"B",f||u.key!==l.C0.ESC+"[1;3B"||(u.key=l.C0.ESC+"[1;5B")):u.key=h?l.C0.ESC+"OB":l.C0.ESC+"[B";break;case 45:s.shiftKey||s.ctrlKey||(u.key=l.C0.ESC+"[2~");break;case 46:u.key=t?l.C0.ESC+"[3;"+(t+1)+"~":l.C0.ESC+"[3~";break;case 36:u.key=t?l.C0.ESC+"[1;"+(t+1)+"H":h?l.C0.ESC+"OH":l.C0.ESC+"[H";break;case 35:u.key=t?l.C0.ESC+"[1;"+(t+1)+"F":h?l.C0.ESC+"OF":l.C0.ESC+"[F";break;case 33:s.shiftKey?u.type=2:s.ctrlKey?u.key=l.C0.ESC+"[5;"+(t+1)+"~":u.key=l.C0.ESC+"[5~";break;case 34:s.shiftKey?u.type=3:s.ctrlKey?u.key=l.C0.ESC+"[6;"+(t+1)+"~":u.key=l.C0.ESC+"[6~";break;case 112:u.key=t?l.C0.ESC+"[1;"+(t+1)+"P":l.C0.ESC+"OP";break;case 113:u.key=t?l.C0.ESC+"[1;"+(t+1)+"Q":l.C0.ESC+"OQ";break;case 114:u.key=t?l.C0.ESC+"[1;"+(t+1)+"R":l.C0.ESC+"OR";break;case 115:u.key=t?l.C0.ESC+"[1;"+(t+1)+"S":l.C0.ESC+"OS";break;case 116:u.key=t?l.C0.ESC+"[15;"+(t+1)+"~":l.C0.ESC+"[15~";break;case 117:u.key=t?l.C0.ESC+"[17;"+(t+1)+"~":l.C0.ESC+"[17~";break;case 118:u.key=t?l.C0.ESC+"[18;"+(t+1)+"~":l.C0.ESC+"[18~";break;case 119:u.key=t?l.C0.ESC+"[19;"+(t+1)+"~":l.C0.ESC+"[19~";break;case 120:u.key=t?l.C0.ESC+"[20;"+(t+1)+"~":l.C0.ESC+"[20~";break;case 121:u.key=t?l.C0.ESC+"[21;"+(t+1)+"~":l.C0.ESC+"[21~";break;case 122:u.key=t?l.C0.ESC+"[23;"+(t+1)+"~":l.C0.ESC+"[23~";break;case 123:u.key=t?l.C0.ESC+"[24;"+(t+1)+"~":l.C0.ESC+"[24~";break;default:if(!s.ctrlKey||s.shiftKey||s.altKey||s.metaKey)if(f&&!d||!s.altKey||s.metaKey)!f||s.altKey||s.ctrlKey||s.shiftKey||!s.metaKey?s.key&&!s.ctrlKey&&!s.altKey&&!s.metaKey&&s.keyCode>=48&&s.key.length===1?u.key=s.key:s.key&&s.ctrlKey&&(s.key==="_"&&(u.key=l.C0.US),s.key==="@"&&(u.key=l.C0.NUL)):s.keyCode===65&&(u.type=1);else{const a=m[s.keyCode],o=a==null?void 0:a[s.shiftKey?1:0];if(o)u.key=l.C0.ESC+o;else if(s.keyCode>=65&&s.keyCode<=90){const r=s.ctrlKey?s.keyCode-64:s.keyCode+32;let p=String.fromCharCode(r);s.shiftKey&&(p=p.toUpperCase()),u.key=l.C0.ESC+p}else if(s.keyCode===32)u.key=l.C0.ESC+(s.ctrlKey?l.C0.NUL:" ");else if(s.key==="Dead"&&s.code.startsWith("Key")){let r=s.code.slice(3,4);s.shiftKey||(r=r.toLowerCase()),u.key=l.C0.ESC+r,u.cancel=!0}}else s.keyCode>=65&&s.keyCode<=90?u.key=String.fromCharCode(s.keyCode-64):s.keyCode===32?u.key=l.C0.NUL:s.keyCode>=51&&s.keyCode<=55?u.key=String.fromCharCode(s.keyCode-51+27):s.keyCode===56?u.key=l.C0.DEL:s.keyCode===219?u.key=l.C0.ESC:s.keyCode===220?u.key=l.C0.FS:s.keyCode===221&&(u.key=l.C0.GS)}return u}},482:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Utf8ToUtf32=i.StringToUtf32=i.utf32ToString=i.stringFromCodePoint=void 0,i.stringFromCodePoint=function(n){return n>65535?(n-=65536,String.fromCharCode(55296+(n>>10))+String.fromCharCode(n%1024+56320)):String.fromCharCode(n)},i.utf32ToString=function(n,l=0,m=n.length){let s="";for(let h=l;h<m;++h){let f=n[h];f>65535?(f-=65536,s+=String.fromCharCode(55296+(f>>10))+String.fromCharCode(f%1024+56320)):s+=String.fromCharCode(f)}return s},i.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(n,l){const m=n.length;if(!m)return 0;let s=0,h=0;if(this._interim){const f=n.charCodeAt(h++);56320<=f&&f<=57343?l[s++]=1024*(this._interim-55296)+f-56320+65536:(l[s++]=this._interim,l[s++]=f),this._interim=0}for(let f=h;f<m;++f){const d=n.charCodeAt(f);if(55296<=d&&d<=56319){if(++f>=m)return this._interim=d,s;const u=n.charCodeAt(f);56320<=u&&u<=57343?l[s++]=1024*(d-55296)+u-56320+65536:(l[s++]=d,l[s++]=u)}else d!==65279&&(l[s++]=d)}return s}},i.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(n,l){const m=n.length;if(!m)return 0;let s,h,f,d,u=0,t=0,a=0;if(this.interim[0]){let p=!1,g=this.interim[0];g&=(224&g)==192?31:(240&g)==224?15:7;let E,T=0;for(;(E=63&this.interim[++T])&&T<4;)g<<=6,g|=E;const w=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,x=w-T;for(;a<x;){if(a>=m)return 0;if(E=n[a++],(192&E)!=128){a--,p=!0;break}this.interim[T++]=E,g<<=6,g|=63&E}p||(w===2?g<128?a--:l[u++]=g:w===3?g<2048||g>=55296&&g<=57343||g===65279||(l[u++]=g):g<65536||g>1114111||(l[u++]=g)),this.interim.fill(0)}const o=m-4;let r=a;for(;r<m;){for(;!(!(r<o)||128&(s=n[r])||128&(h=n[r+1])||128&(f=n[r+2])||128&(d=n[r+3]));)l[u++]=s,l[u++]=h,l[u++]=f,l[u++]=d,r+=4;if(s=n[r++],s<128)l[u++]=s;else if((224&s)==192){if(r>=m)return this.interim[0]=s,u;if(h=n[r++],(192&h)!=128){r--;continue}if(t=(31&s)<<6|63&h,t<128){r--;continue}l[u++]=t}else if((240&s)==224){if(r>=m)return this.interim[0]=s,u;if(h=n[r++],(192&h)!=128){r--;continue}if(r>=m)return this.interim[0]=s,this.interim[1]=h,u;if(f=n[r++],(192&f)!=128){r--;continue}if(t=(15&s)<<12|(63&h)<<6|63&f,t<2048||t>=55296&&t<=57343||t===65279)continue;l[u++]=t}else if((248&s)==240){if(r>=m)return this.interim[0]=s,u;if(h=n[r++],(192&h)!=128){r--;continue}if(r>=m)return this.interim[0]=s,this.interim[1]=h,u;if(f=n[r++],(192&f)!=128){r--;continue}if(r>=m)return this.interim[0]=s,this.interim[1]=h,this.interim[2]=f,u;if(d=n[r++],(192&d)!=128){r--;continue}if(t=(7&s)<<18|(63&h)<<12|(63&f)<<6|63&d,t<65536||t>1114111)continue;l[u++]=t}}return u}}},225:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.UnicodeV6=void 0;const n=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],l=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let m;i.UnicodeV6=class{constructor(){if(this.version="6",!m){m=new Uint8Array(65536),m.fill(1),m[0]=0,m.fill(0,1,32),m.fill(0,127,160),m.fill(2,4352,4448),m[9001]=2,m[9002]=2,m.fill(2,11904,42192),m[12351]=1,m.fill(2,44032,55204),m.fill(2,63744,64256),m.fill(2,65040,65050),m.fill(2,65072,65136),m.fill(2,65280,65377),m.fill(2,65504,65511);for(let s=0;s<n.length;++s)m.fill(0,n[s][0],n[s][1]+1)}}wcwidth(s){return s<32?0:s<127?1:s<65536?m[s]:function(h,f){let d,u=0,t=f.length-1;if(h<f[0][0]||h>f[t][1])return!1;for(;t>=u;)if(d=u+t>>1,h>f[d][1])u=d+1;else{if(!(h<f[d][0]))return!0;t=d-1}return!1}(s,l)?0:s>=131072&&s<=196605||s>=196608&&s<=262141?2:1}}},5981:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.WriteBuffer=void 0;const l=n(8460),m=n(844);class s extends m.Disposable{constructor(f){super(),this._action=f,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new l.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(f,d){if(d!==void 0&&this._syncCalls>d)return void(this._syncCalls=0);if(this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let u;for(this._isSyncWriting=!0;u=this._writeBuffer.shift();){this._action(u);const t=this._callbacks.shift();t&&t()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(f,d){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(d),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(d)}_innerWrite(f=0,d=!0){const u=f||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const t=this._writeBuffer[this._bufferOffset],a=this._action(t,d);if(a){const r=p=>Date.now()-u>=12?setTimeout(()=>this._innerWrite(0,p)):this._innerWrite(u,p);return void a.catch(p=>(queueMicrotask(()=>{throw p}),Promise.resolve(!1))).then(r)}const o=this._callbacks[this._bufferOffset];if(o&&o(),this._bufferOffset++,this._pendingData-=t.length,Date.now()-u>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}i.WriteBuffer=s},5941:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.toRgbString=i.parseColor=void 0;const n=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,l=/^[\da-f]+$/;function m(s,h){const f=s.toString(16),d=f.length<2?"0"+f:f;switch(h){case 4:return f[0];case 8:return d;case 12:return(d+d).slice(0,3);default:return d+d}}i.parseColor=function(s){if(!s)return;let h=s.toLowerCase();if(h.indexOf("rgb:")===0){h=h.slice(4);const f=n.exec(h);if(f){const d=f[1]?15:f[4]?255:f[7]?4095:65535;return[Math.round(parseInt(f[1]||f[4]||f[7]||f[10],16)/d*255),Math.round(parseInt(f[2]||f[5]||f[8]||f[11],16)/d*255),Math.round(parseInt(f[3]||f[6]||f[9]||f[12],16)/d*255)]}}else if(h.indexOf("#")===0&&(h=h.slice(1),l.exec(h)&&[3,6,9,12].includes(h.length))){const f=h.length/3,d=[0,0,0];for(let u=0;u<3;++u){const t=parseInt(h.slice(f*u,f*u+f),16);d[u]=f===1?t<<4:f===2?t:f===3?t>>4:t>>8}return d}},i.toRgbString=function(s,h=16){const[f,d,u]=s;return`rgb:${m(f,h)}/${m(d,h)}/${m(u,h)}`}},5770:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PAYLOAD_LIMIT=void 0,i.PAYLOAD_LIMIT=1e7},6351:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DcsHandler=i.DcsParser=void 0;const l=n(482),m=n(8742),s=n(5770),h=[];i.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=h,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=h}registerHandler(d,u){this._handlers[d]===void 0&&(this._handlers[d]=[]);const t=this._handlers[d];return t.push(u),{dispose:()=>{const a=t.indexOf(u);a!==-1&&t.splice(a,1)}}}clearHandler(d){this._handlers[d]&&delete this._handlers[d]}setHandlerFallback(d){this._handlerFb=d}reset(){if(this._active.length)for(let d=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;d>=0;--d)this._active[d].unhook(!1);this._stack.paused=!1,this._active=h,this._ident=0}hook(d,u){if(this.reset(),this._ident=d,this._active=this._handlers[d]||h,this._active.length)for(let t=this._active.length-1;t>=0;t--)this._active[t].hook(u);else this._handlerFb(this._ident,"HOOK",u)}put(d,u,t){if(this._active.length)for(let a=this._active.length-1;a>=0;a--)this._active[a].put(d,u,t);else this._handlerFb(this._ident,"PUT",(0,l.utf32ToString)(d,u,t))}unhook(d,u=!0){if(this._active.length){let t=!1,a=this._active.length-1,o=!1;if(this._stack.paused&&(a=this._stack.loopPosition-1,t=u,o=this._stack.fallThrough,this._stack.paused=!1),!o&&t===!1){for(;a>=0&&(t=this._active[a].unhook(d),t!==!0);a--)if(t instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!1,t;a--}for(;a>=0;a--)if(t=this._active[a].unhook(!1),t instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!0,t}else this._handlerFb(this._ident,"UNHOOK",d);this._active=h,this._ident=0}};const f=new m.Params;f.addParam(0),i.DcsHandler=class{constructor(d){this._handler=d,this._data="",this._params=f,this._hitLimit=!1}hook(d){this._params=d.length>1||d.params[0]?d.clone():f,this._data="",this._hitLimit=!1}put(d,u,t){this._hitLimit||(this._data+=(0,l.utf32ToString)(d,u,t),this._data.length>s.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(d){let u=!1;if(this._hitLimit)u=!1;else if(d&&(u=this._handler(this._data,this._params),u instanceof Promise))return u.then(t=>(this._params=f,this._data="",this._hitLimit=!1,t));return this._params=f,this._data="",this._hitLimit=!1,u}}},2015:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.EscapeSequenceParser=i.VT500_TRANSITION_TABLE=i.TransitionTable=void 0;const l=n(844),m=n(8742),s=n(6242),h=n(6351);class f{constructor(a){this.table=new Uint8Array(a)}setDefault(a,o){this.table.fill(a<<4|o)}add(a,o,r,p){this.table[o<<8|a]=r<<4|p}addMany(a,o,r,p){for(let g=0;g<a.length;g++)this.table[o<<8|a[g]]=r<<4|p}}i.TransitionTable=f;const d=160;i.VT500_TRANSITION_TABLE=function(){const t=new f(4095),a=Array.apply(null,Array(256)).map((T,w)=>w),o=(T,w)=>a.slice(T,w),r=o(32,127),p=o(0,24);p.push(25),p.push.apply(p,o(28,32));const g=o(0,14);let E;for(E in t.setDefault(1,0),t.addMany(r,0,2,0),g)t.addMany([24,26,153,154],E,3,0),t.addMany(o(128,144),E,3,0),t.addMany(o(144,152),E,3,0),t.add(156,E,0,0),t.add(27,E,11,1),t.add(157,E,4,8),t.addMany([152,158,159],E,0,7),t.add(155,E,11,3),t.add(144,E,11,9);return t.addMany(p,0,3,0),t.addMany(p,1,3,1),t.add(127,1,0,1),t.addMany(p,8,0,8),t.addMany(p,3,3,3),t.add(127,3,0,3),t.addMany(p,4,3,4),t.add(127,4,0,4),t.addMany(p,6,3,6),t.addMany(p,5,3,5),t.add(127,5,0,5),t.addMany(p,2,3,2),t.add(127,2,0,2),t.add(93,1,4,8),t.addMany(r,8,5,8),t.add(127,8,5,8),t.addMany([156,27,24,26,7],8,6,0),t.addMany(o(28,32),8,0,8),t.addMany([88,94,95],1,0,7),t.addMany(r,7,0,7),t.addMany(p,7,0,7),t.add(156,7,0,0),t.add(127,7,0,7),t.add(91,1,11,3),t.addMany(o(64,127),3,7,0),t.addMany(o(48,60),3,8,4),t.addMany([60,61,62,63],3,9,4),t.addMany(o(48,60),4,8,4),t.addMany(o(64,127),4,7,0),t.addMany([60,61,62,63],4,0,6),t.addMany(o(32,64),6,0,6),t.add(127,6,0,6),t.addMany(o(64,127),6,0,0),t.addMany(o(32,48),3,9,5),t.addMany(o(32,48),5,9,5),t.addMany(o(48,64),5,0,6),t.addMany(o(64,127),5,7,0),t.addMany(o(32,48),4,9,5),t.addMany(o(32,48),1,9,2),t.addMany(o(32,48),2,9,2),t.addMany(o(48,127),2,10,0),t.addMany(o(48,80),1,10,0),t.addMany(o(81,88),1,10,0),t.addMany([89,90,92],1,10,0),t.addMany(o(96,127),1,10,0),t.add(80,1,11,9),t.addMany(p,9,0,9),t.add(127,9,0,9),t.addMany(o(28,32),9,0,9),t.addMany(o(32,48),9,9,12),t.addMany(o(48,60),9,8,10),t.addMany([60,61,62,63],9,9,10),t.addMany(p,11,0,11),t.addMany(o(32,128),11,0,11),t.addMany(o(28,32),11,0,11),t.addMany(p,10,0,10),t.add(127,10,0,10),t.addMany(o(28,32),10,0,10),t.addMany(o(48,60),10,8,10),t.addMany([60,61,62,63],10,0,11),t.addMany(o(32,48),10,9,12),t.addMany(p,12,0,12),t.add(127,12,0,12),t.addMany(o(28,32),12,0,12),t.addMany(o(32,48),12,9,12),t.addMany(o(48,64),12,0,11),t.addMany(o(64,127),12,12,13),t.addMany(o(64,127),10,12,13),t.addMany(o(64,127),9,12,13),t.addMany(p,13,13,13),t.addMany(r,13,13,13),t.add(127,13,0,13),t.addMany([27,156,24,26],13,14,0),t.add(d,0,2,0),t.add(d,8,5,8),t.add(d,6,0,6),t.add(d,11,0,11),t.add(d,13,13,13),t}();class u extends l.Disposable{constructor(a=i.VT500_TRANSITION_TABLE){super(),this._transitions=a,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new m.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(o,r,p)=>{},this._executeHandlerFb=o=>{},this._csiHandlerFb=(o,r)=>{},this._escHandlerFb=o=>{},this._errorHandlerFb=o=>o,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,l.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new s.OscParser),this._dcsParser=this.register(new h.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(a,o=[64,126]){let r=0;if(a.prefix){if(a.prefix.length>1)throw new Error("only one byte as prefix supported");if(r=a.prefix.charCodeAt(0),r&&60>r||r>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(a.intermediates){if(a.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let g=0;g<a.intermediates.length;++g){const E=a.intermediates.charCodeAt(g);if(32>E||E>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");r<<=8,r|=E}}if(a.final.length!==1)throw new Error("final must be a single byte");const p=a.final.charCodeAt(0);if(o[0]>p||p>o[1])throw new Error(`final must be in range ${o[0]} .. ${o[1]}`);return r<<=8,r|=p,r}identToString(a){const o=[];for(;a;)o.push(String.fromCharCode(255&a)),a>>=8;return o.reverse().join("")}setPrintHandler(a){this._printHandler=a}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(a,o){const r=this._identifier(a,[48,126]);this._escHandlers[r]===void 0&&(this._escHandlers[r]=[]);const p=this._escHandlers[r];return p.push(o),{dispose:()=>{const g=p.indexOf(o);g!==-1&&p.splice(g,1)}}}clearEscHandler(a){this._escHandlers[this._identifier(a,[48,126])]&&delete this._escHandlers[this._identifier(a,[48,126])]}setEscHandlerFallback(a){this._escHandlerFb=a}setExecuteHandler(a,o){this._executeHandlers[a.charCodeAt(0)]=o}clearExecuteHandler(a){this._executeHandlers[a.charCodeAt(0)]&&delete this._executeHandlers[a.charCodeAt(0)]}setExecuteHandlerFallback(a){this._executeHandlerFb=a}registerCsiHandler(a,o){const r=this._identifier(a);this._csiHandlers[r]===void 0&&(this._csiHandlers[r]=[]);const p=this._csiHandlers[r];return p.push(o),{dispose:()=>{const g=p.indexOf(o);g!==-1&&p.splice(g,1)}}}clearCsiHandler(a){this._csiHandlers[this._identifier(a)]&&delete this._csiHandlers[this._identifier(a)]}setCsiHandlerFallback(a){this._csiHandlerFb=a}registerDcsHandler(a,o){return this._dcsParser.registerHandler(this._identifier(a),o)}clearDcsHandler(a){this._dcsParser.clearHandler(this._identifier(a))}setDcsHandlerFallback(a){this._dcsParser.setHandlerFallback(a)}registerOscHandler(a,o){return this._oscParser.registerHandler(a,o)}clearOscHandler(a){this._oscParser.clearHandler(a)}setOscHandlerFallback(a){this._oscParser.setHandlerFallback(a)}setErrorHandler(a){this._errorHandler=a}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(a,o,r,p,g){this._parseStack.state=a,this._parseStack.handlers=o,this._parseStack.handlerPos=r,this._parseStack.transition=p,this._parseStack.chunkPos=g}parse(a,o,r){let p,g=0,E=0,T=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,T=this._parseStack.chunkPos+1;else{if(r===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const w=this._parseStack.handlers;let x=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(r===!1&&x>-1){for(;x>=0&&(p=w[x](this._params),p!==!0);x--)if(p instanceof Promise)return this._parseStack.handlerPos=x,p}this._parseStack.handlers=[];break;case 4:if(r===!1&&x>-1){for(;x>=0&&(p=w[x](),p!==!0);x--)if(p instanceof Promise)return this._parseStack.handlerPos=x,p}this._parseStack.handlers=[];break;case 6:if(g=a[this._parseStack.chunkPos],p=this._dcsParser.unhook(g!==24&&g!==26,r),p)return p;g===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(g=a[this._parseStack.chunkPos],p=this._oscParser.end(g!==24&&g!==26,r),p)return p;g===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,T=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let w=T;w<o;++w){switch(g=a[w],E=this._transitions.table[this.currentState<<8|(g<160?g:d)],E>>4){case 2:for(let M=w+1;;++M){if(M>=o||(g=a[M])<32||g>126&&g<d){this._printHandler(a,w,M),w=M-1;break}if(++M>=o||(g=a[M])<32||g>126&&g<d){this._printHandler(a,w,M),w=M-1;break}if(++M>=o||(g=a[M])<32||g>126&&g<d){this._printHandler(a,w,M),w=M-1;break}if(++M>=o||(g=a[M])<32||g>126&&g<d){this._printHandler(a,w,M),w=M-1;break}}break;case 3:this._executeHandlers[g]?this._executeHandlers[g]():this._executeHandlerFb(g),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:w,code:g,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const x=this._csiHandlers[this._collect<<8|g];let I=x?x.length-1:-1;for(;I>=0&&(p=x[I](this._params),p!==!0);I--)if(p instanceof Promise)return this._preserveStack(3,x,I,E,w),p;I<0&&this._csiHandlerFb(this._collect<<8|g,this._params),this.precedingCodepoint=0;break;case 8:do switch(g){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(g-48)}while(++w<o&&(g=a[w])>47&&g<60);w--;break;case 9:this._collect<<=8,this._collect|=g;break;case 10:const B=this._escHandlers[this._collect<<8|g];let S=B?B.length-1:-1;for(;S>=0&&(p=B[S](),p!==!0);S--)if(p instanceof Promise)return this._preserveStack(4,B,S,E,w),p;S<0&&this._escHandlerFb(this._collect<<8|g),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|g,this._params);break;case 13:for(let M=w+1;;++M)if(M>=o||(g=a[M])===24||g===26||g===27||g>127&&g<d){this._dcsParser.put(a,w,M),w=M-1;break}break;case 14:if(p=this._dcsParser.unhook(g!==24&&g!==26),p)return this._preserveStack(6,[],0,E,w),p;g===27&&(E|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let M=w+1;;M++)if(M>=o||(g=a[M])<32||g>127&&g<d){this._oscParser.put(a,w,M),w=M-1;break}break;case 6:if(p=this._oscParser.end(g!==24&&g!==26),p)return this._preserveStack(5,[],0,E,w),p;g===27&&(E|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&E}}}i.EscapeSequenceParser=u},6242:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.OscHandler=i.OscParser=void 0;const l=n(5770),m=n(482),s=[];i.OscParser=class{constructor(){this._state=0,this._active=s,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(h,f){this._handlers[h]===void 0&&(this._handlers[h]=[]);const d=this._handlers[h];return d.push(f),{dispose:()=>{const u=d.indexOf(f);u!==-1&&d.splice(u,1)}}}clearHandler(h){this._handlers[h]&&delete this._handlers[h]}setHandlerFallback(h){this._handlerFb=h}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=s}reset(){if(this._state===2)for(let h=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;h>=0;--h)this._active[h].end(!1);this._stack.paused=!1,this._active=s,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||s,this._active.length)for(let h=this._active.length-1;h>=0;h--)this._active[h].start();else this._handlerFb(this._id,"START")}_put(h,f,d){if(this._active.length)for(let u=this._active.length-1;u>=0;u--)this._active[u].put(h,f,d);else this._handlerFb(this._id,"PUT",(0,m.utf32ToString)(h,f,d))}start(){this.reset(),this._state=1}put(h,f,d){if(this._state!==3){if(this._state===1)for(;f<d;){const u=h[f++];if(u===59){this._state=2,this._start();break}if(u<48||57<u)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+u-48}this._state===2&&d-f>0&&this._put(h,f,d)}}end(h,f=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let d=!1,u=this._active.length-1,t=!1;if(this._stack.paused&&(u=this._stack.loopPosition-1,d=f,t=this._stack.fallThrough,this._stack.paused=!1),!t&&d===!1){for(;u>=0&&(d=this._active[u].end(h),d!==!0);u--)if(d instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=u,this._stack.fallThrough=!1,d;u--}for(;u>=0;u--)if(d=this._active[u].end(!1),d instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=u,this._stack.fallThrough=!0,d}else this._handlerFb(this._id,"END",h);this._active=s,this._id=-1,this._state=0}}},i.OscHandler=class{constructor(h){this._handler=h,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(h,f,d){this._hitLimit||(this._data+=(0,m.utf32ToString)(h,f,d),this._data.length>l.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(h){let f=!1;if(this._hitLimit)f=!1;else if(h&&(f=this._handler(this._data),f instanceof Promise))return f.then(d=>(this._data="",this._hitLimit=!1,d));return this._data="",this._hitLimit=!1,f}}},8742:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Params=void 0;const n=2147483647;class l{static fromArray(s){const h=new l;if(!s.length)return h;for(let f=Array.isArray(s[0])?1:0;f<s.length;++f){const d=s[f];if(Array.isArray(d))for(let u=0;u<d.length;++u)h.addSubParam(d[u]);else h.addParam(d)}return h}constructor(s=32,h=32){if(this.maxLength=s,this.maxSubParamsLength=h,h>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(s),this.length=0,this._subParams=new Int32Array(h),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(s),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const s=new l(this.maxLength,this.maxSubParamsLength);return s.params.set(this.params),s.length=this.length,s._subParams.set(this._subParams),s._subParamsLength=this._subParamsLength,s._subParamsIdx.set(this._subParamsIdx),s._rejectDigits=this._rejectDigits,s._rejectSubDigits=this._rejectSubDigits,s._digitIsSub=this._digitIsSub,s}toArray(){const s=[];for(let h=0;h<this.length;++h){s.push(this.params[h]);const f=this._subParamsIdx[h]>>8,d=255&this._subParamsIdx[h];d-f>0&&s.push(Array.prototype.slice.call(this._subParams,f,d))}return s}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(s){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(s<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=s>n?n:s}}addSubParam(s){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(s<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=s>n?n:s,this._subParamsIdx[this.length-1]++}}hasSubParams(s){return(255&this._subParamsIdx[s])-(this._subParamsIdx[s]>>8)>0}getSubParams(s){const h=this._subParamsIdx[s]>>8,f=255&this._subParamsIdx[s];return f-h>0?this._subParams.subarray(h,f):null}getSubParamsAll(){const s={};for(let h=0;h<this.length;++h){const f=this._subParamsIdx[h]>>8,d=255&this._subParamsIdx[h];d-f>0&&(s[h]=this._subParams.slice(f,d))}return s}addDigit(s){let h;if(this._rejectDigits||!(h=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const f=this._digitIsSub?this._subParams:this.params,d=f[h-1];f[h-1]=~d?Math.min(10*d+s,n):s}}i.Params=l},5741:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.AddonManager=void 0,i.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let n=this._addons.length-1;n>=0;n--)this._addons[n].instance.dispose()}loadAddon(n,l){const m={instance:l,dispose:l.dispose,isDisposed:!1};this._addons.push(m),l.dispose=()=>this._wrappedAddonDispose(m),l.activate(n)}_wrappedAddonDispose(n){if(n.isDisposed)return;let l=-1;for(let m=0;m<this._addons.length;m++)if(this._addons[m]===n){l=m;break}if(l===-1)throw new Error("Could not dispose an addon that has not been loaded");n.isDisposed=!0,n.dispose.apply(n.instance),this._addons.splice(l,1)}}},8771:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BufferApiView=void 0;const l=n(3785),m=n(511);i.BufferApiView=class{constructor(s,h){this._buffer=s,this.type=h}init(s){return this._buffer=s,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(s){const h=this._buffer.lines.get(s);if(h)return new l.BufferLineApiView(h)}getNullCell(){return new m.CellData}}},3785:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BufferLineApiView=void 0;const l=n(511);i.BufferLineApiView=class{constructor(m){this._line=m}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(m,s){if(!(m<0||m>=this._line.length))return s?(this._line.loadCell(m,s),s):this._line.loadCell(m,new l.CellData)}translateToString(m,s,h){return this._line.translateToString(m,s,h)}}},8285:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BufferNamespaceApi=void 0;const l=n(8771),m=n(8460),s=n(844);class h extends s.Disposable{constructor(d){super(),this._core=d,this._onBufferChange=this.register(new m.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new l.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new l.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}i.BufferNamespaceApi=h},7975:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ParserApi=void 0,i.ParserApi=class{constructor(n){this._core=n}registerCsiHandler(n,l){return this._core.registerCsiHandler(n,m=>l(m.toArray()))}addCsiHandler(n,l){return this.registerCsiHandler(n,l)}registerDcsHandler(n,l){return this._core.registerDcsHandler(n,(m,s)=>l(m,s.toArray()))}addDcsHandler(n,l){return this.registerDcsHandler(n,l)}registerEscHandler(n,l){return this._core.registerEscHandler(n,l)}addEscHandler(n,l){return this.registerEscHandler(n,l)}registerOscHandler(n,l){return this._core.registerOscHandler(n,l)}addOscHandler(n,l){return this.registerOscHandler(n,l)}}},7090:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.UnicodeApi=void 0,i.UnicodeApi=class{constructor(n){this._core=n}register(n){this._core.unicodeService.register(n)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(n){this._core.unicodeService.activeVersion=n}}},744:function(C,i,n){var l=this&&this.__decorate||function(t,a,o,r){var p,g=arguments.length,E=g<3?a:r===null?r=Object.getOwnPropertyDescriptor(a,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(t,a,o,r);else for(var T=t.length-1;T>=0;T--)(p=t[T])&&(E=(g<3?p(E):g>3?p(a,o,E):p(a,o))||E);return g>3&&E&&Object.defineProperty(a,o,E),E},m=this&&this.__param||function(t,a){return function(o,r){a(o,r,t)}};Object.defineProperty(i,"__esModule",{value:!0}),i.BufferService=i.MINIMUM_ROWS=i.MINIMUM_COLS=void 0;const s=n(8460),h=n(844),f=n(5295),d=n(2585);i.MINIMUM_COLS=2,i.MINIMUM_ROWS=1;let u=i.BufferService=class extends h.Disposable{get buffer(){return this.buffers.active}constructor(t){super(),this.isUserScrolling=!1,this._onResize=this.register(new s.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new s.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(t.rawOptions.cols||0,i.MINIMUM_COLS),this.rows=Math.max(t.rawOptions.rows||0,i.MINIMUM_ROWS),this.buffers=this.register(new f.BufferSet(t,this))}resize(t,a){this.cols=t,this.rows=a,this.buffers.resize(t,a),this._onResize.fire({cols:t,rows:a})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(t,a=!1){const o=this.buffer;let r;r=this._cachedBlankLine,r&&r.length===this.cols&&r.getFg(0)===t.fg&&r.getBg(0)===t.bg||(r=o.getBlankLine(t,a),this._cachedBlankLine=r),r.isWrapped=a;const p=o.ybase+o.scrollTop,g=o.ybase+o.scrollBottom;if(o.scrollTop===0){const E=o.lines.isFull;g===o.lines.length-1?E?o.lines.recycle().copyFrom(r):o.lines.push(r.clone()):o.lines.splice(g+1,0,r.clone()),E?this.isUserScrolling&&(o.ydisp=Math.max(o.ydisp-1,0)):(o.ybase++,this.isUserScrolling||o.ydisp++)}else{const E=g-p+1;o.lines.shiftElements(p+1,E-1,-1),o.lines.set(g,r.clone())}this.isUserScrolling||(o.ydisp=o.ybase),this._onScroll.fire(o.ydisp)}scrollLines(t,a,o){const r=this.buffer;if(t<0){if(r.ydisp===0)return;this.isUserScrolling=!0}else t+r.ydisp>=r.ybase&&(this.isUserScrolling=!1);const p=r.ydisp;r.ydisp=Math.max(Math.min(r.ydisp+t,r.ybase),0),p!==r.ydisp&&(a||this._onScroll.fire(r.ydisp))}};i.BufferService=u=l([m(0,d.IOptionsService)],u)},7994:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CharsetService=void 0,i.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(n){this.glevel=n,this.charset=this._charsets[n]}setgCharset(n,l){this._charsets[n]=l,this.glevel===n&&(this.charset=l)}}},1753:function(C,i,n){var l=this&&this.__decorate||function(r,p,g,E){var T,w=arguments.length,x=w<3?p:E===null?E=Object.getOwnPropertyDescriptor(p,g):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(r,p,g,E);else for(var I=r.length-1;I>=0;I--)(T=r[I])&&(x=(w<3?T(x):w>3?T(p,g,x):T(p,g))||x);return w>3&&x&&Object.defineProperty(p,g,x),x},m=this&&this.__param||function(r,p){return function(g,E){p(g,E,r)}};Object.defineProperty(i,"__esModule",{value:!0}),i.CoreMouseService=void 0;const s=n(2585),h=n(8460),f=n(844),d={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:r=>r.button!==4&&r.action===1&&(r.ctrl=!1,r.alt=!1,r.shift=!1,!0)},VT200:{events:19,restrict:r=>r.action!==32},DRAG:{events:23,restrict:r=>r.action!==32||r.button!==3},ANY:{events:31,restrict:r=>!0}};function u(r,p){let g=(r.ctrl?16:0)|(r.shift?4:0)|(r.alt?8:0);return r.button===4?(g|=64,g|=r.action):(g|=3&r.button,4&r.button&&(g|=64),8&r.button&&(g|=128),r.action===32?g|=32:r.action!==0||p||(g|=3)),g}const t=String.fromCharCode,a={DEFAULT:r=>{const p=[u(r,!1)+32,r.col+32,r.row+32];return p[0]>255||p[1]>255||p[2]>255?"":`\x1B[M${t(p[0])}${t(p[1])}${t(p[2])}`},SGR:r=>{const p=r.action===0&&r.button!==4?"m":"M";return`\x1B[<${u(r,!0)};${r.col};${r.row}${p}`},SGR_PIXELS:r=>{const p=r.action===0&&r.button!==4?"m":"M";return`\x1B[<${u(r,!0)};${r.x};${r.y}${p}`}};let o=i.CoreMouseService=class extends f.Disposable{constructor(r,p){super(),this._bufferService=r,this._coreService=p,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new h.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const g of Object.keys(d))this.addProtocol(g,d[g]);for(const g of Object.keys(a))this.addEncoding(g,a[g]);this.reset()}addProtocol(r,p){this._protocols[r]=p}addEncoding(r,p){this._encodings[r]=p}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(r){if(!this._protocols[r])throw new Error(`unknown protocol "${r}"`);this._activeProtocol=r,this._onProtocolChange.fire(this._protocols[r].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(r){if(!this._encodings[r])throw new Error(`unknown encoding "${r}"`);this._activeEncoding=r}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(r){if(r.col<0||r.col>=this._bufferService.cols||r.row<0||r.row>=this._bufferService.rows||r.button===4&&r.action===32||r.button===3&&r.action!==32||r.button!==4&&(r.action===2||r.action===3)||(r.col++,r.row++,r.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,r,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(r))return!1;const p=this._encodings[this._activeEncoding](r);return p&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(p):this._coreService.triggerDataEvent(p,!0)),this._lastEvent=r,!0}explainEvents(r){return{down:!!(1&r),up:!!(2&r),drag:!!(4&r),move:!!(8&r),wheel:!!(16&r)}}_equalEvents(r,p,g){if(g){if(r.x!==p.x||r.y!==p.y)return!1}else if(r.col!==p.col||r.row!==p.row)return!1;return r.button===p.button&&r.action===p.action&&r.ctrl===p.ctrl&&r.alt===p.alt&&r.shift===p.shift}};i.CoreMouseService=o=l([m(0,s.IBufferService),m(1,s.ICoreService)],o)},6975:function(C,i,n){var l=this&&this.__decorate||function(o,r,p,g){var E,T=arguments.length,w=T<3?r:g===null?g=Object.getOwnPropertyDescriptor(r,p):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(o,r,p,g);else for(var x=o.length-1;x>=0;x--)(E=o[x])&&(w=(T<3?E(w):T>3?E(r,p,w):E(r,p))||w);return T>3&&w&&Object.defineProperty(r,p,w),w},m=this&&this.__param||function(o,r){return function(p,g){r(p,g,o)}};Object.defineProperty(i,"__esModule",{value:!0}),i.CoreService=void 0;const s=n(1439),h=n(8460),f=n(844),d=n(2585),u=Object.freeze({insertMode:!1}),t=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let a=i.CoreService=class extends f.Disposable{constructor(o,r,p){super(),this._bufferService=o,this._logService=r,this._optionsService=p,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new h.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new h.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new h.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new h.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,s.clone)(u),this.decPrivateModes=(0,s.clone)(t)}reset(){this.modes=(0,s.clone)(u),this.decPrivateModes=(0,s.clone)(t)}triggerDataEvent(o,r=!1){if(this._optionsService.rawOptions.disableStdin)return;const p=this._bufferService.buffer;r&&this._optionsService.rawOptions.scrollOnUserInput&&p.ybase!==p.ydisp&&this._onRequestScrollToBottom.fire(),r&&this._onUserInput.fire(),this._logService.debug(`sending data "${o}"`,()=>o.split("").map(g=>g.charCodeAt(0))),this._onData.fire(o)}triggerBinaryEvent(o){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${o}"`,()=>o.split("").map(r=>r.charCodeAt(0))),this._onBinary.fire(o))}};i.CoreService=a=l([m(0,d.IBufferService),m(1,d.ILogService),m(2,d.IOptionsService)],a)},9074:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.DecorationService=void 0;const l=n(8055),m=n(8460),s=n(844),h=n(6106);let f=0,d=0;class u extends s.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new h.SortedList(o=>o==null?void 0:o.marker.line),this._onDecorationRegistered=this.register(new m.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new m.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,s.toDisposable)(()=>this.reset()))}registerDecoration(o){if(o.marker.isDisposed)return;const r=new t(o);if(r){const p=r.marker.onDispose(()=>r.dispose());r.onDispose(()=>{r&&(this._decorations.delete(r)&&this._onDecorationRemoved.fire(r),p.dispose())}),this._decorations.insert(r),this._onDecorationRegistered.fire(r)}return r}reset(){for(const o of this._decorations.values())o.dispose();this._decorations.clear()}*getDecorationsAtCell(o,r,p){var g,E,T;let w=0,x=0;for(const I of this._decorations.getKeyIterator(r))w=(g=I.options.x)!==null&&g!==void 0?g:0,x=w+((E=I.options.width)!==null&&E!==void 0?E:1),o>=w&&o<x&&(!p||((T=I.options.layer)!==null&&T!==void 0?T:"bottom")===p)&&(yield I)}forEachDecorationAtCell(o,r,p,g){this._decorations.forEachByKey(r,E=>{var T,w,x;f=(T=E.options.x)!==null&&T!==void 0?T:0,d=f+((w=E.options.width)!==null&&w!==void 0?w:1),o>=f&&o<d&&(!p||((x=E.options.layer)!==null&&x!==void 0?x:"bottom")===p)&&g(E)})}}i.DecorationService=u;class t extends s.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=l.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=l.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(o){super(),this.options=o,this.onRenderEmitter=this.register(new m.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new m.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=o.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.InstantiationService=i.ServiceCollection=void 0;const l=n(2585),m=n(8343);class s{constructor(...f){this._entries=new Map;for(const[d,u]of f)this.set(d,u)}set(f,d){const u=this._entries.get(f);return this._entries.set(f,d),u}forEach(f){for(const[d,u]of this._entries.entries())f(d,u)}has(f){return this._entries.has(f)}get(f){return this._entries.get(f)}}i.ServiceCollection=s,i.InstantiationService=class{constructor(){this._services=new s,this._services.set(l.IInstantiationService,this)}setService(h,f){this._services.set(h,f)}getService(h){return this._services.get(h)}createInstance(h,...f){const d=(0,m.getServiceDependencies)(h).sort((a,o)=>a.index-o.index),u=[];for(const a of d){const o=this._services.get(a.id);if(!o)throw new Error(`[createInstance] ${h.name} depends on UNKNOWN service ${a.id}.`);u.push(o)}const t=d.length>0?d[0].index:f.length;if(f.length!==t)throw new Error(`[createInstance] First service dependency of ${h.name} at position ${t+1} conflicts with ${f.length} static arguments`);return new h(...f,...u)}}},7866:function(C,i,n){var l=this&&this.__decorate||function(t,a,o,r){var p,g=arguments.length,E=g<3?a:r===null?r=Object.getOwnPropertyDescriptor(a,o):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(t,a,o,r);else for(var T=t.length-1;T>=0;T--)(p=t[T])&&(E=(g<3?p(E):g>3?p(a,o,E):p(a,o))||E);return g>3&&E&&Object.defineProperty(a,o,E),E},m=this&&this.__param||function(t,a){return function(o,r){a(o,r,t)}};Object.defineProperty(i,"__esModule",{value:!0}),i.traceCall=i.setTraceLogger=i.LogService=void 0;const s=n(844),h=n(2585),f={trace:h.LogLevelEnum.TRACE,debug:h.LogLevelEnum.DEBUG,info:h.LogLevelEnum.INFO,warn:h.LogLevelEnum.WARN,error:h.LogLevelEnum.ERROR,off:h.LogLevelEnum.OFF};let d,u=i.LogService=class extends s.Disposable{get logLevel(){return this._logLevel}constructor(t){super(),this._optionsService=t,this._logLevel=h.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),d=this}_updateLogLevel(){this._logLevel=f[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(t){for(let a=0;a<t.length;a++)typeof t[a]=="function"&&(t[a]=t[a]())}_log(t,a,o){this._evalLazyOptionalParams(o),t.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+a,...o)}trace(t,...a){var o,r;this._logLevel<=h.LogLevelEnum.TRACE&&this._log((r=(o=this._optionsService.options.logger)===null||o===void 0?void 0:o.trace.bind(this._optionsService.options.logger))!==null&&r!==void 0?r:console.log,t,a)}debug(t,...a){var o,r;this._logLevel<=h.LogLevelEnum.DEBUG&&this._log((r=(o=this._optionsService.options.logger)===null||o===void 0?void 0:o.debug.bind(this._optionsService.options.logger))!==null&&r!==void 0?r:console.log,t,a)}info(t,...a){var o,r;this._logLevel<=h.LogLevelEnum.INFO&&this._log((r=(o=this._optionsService.options.logger)===null||o===void 0?void 0:o.info.bind(this._optionsService.options.logger))!==null&&r!==void 0?r:console.info,t,a)}warn(t,...a){var o,r;this._logLevel<=h.LogLevelEnum.WARN&&this._log((r=(o=this._optionsService.options.logger)===null||o===void 0?void 0:o.warn.bind(this._optionsService.options.logger))!==null&&r!==void 0?r:console.warn,t,a)}error(t,...a){var o,r;this._logLevel<=h.LogLevelEnum.ERROR&&this._log((r=(o=this._optionsService.options.logger)===null||o===void 0?void 0:o.error.bind(this._optionsService.options.logger))!==null&&r!==void 0?r:console.error,t,a)}};i.LogService=u=l([m(0,h.IOptionsService)],u),i.setTraceLogger=function(t){d=t},i.traceCall=function(t,a,o){if(typeof o.value!="function")throw new Error("not supported");const r=o.value;o.value=function(...p){if(d.logLevel!==h.LogLevelEnum.TRACE)return r.apply(this,p);d.trace(`GlyphRenderer#${r.name}(${p.map(E=>JSON.stringify(E)).join(", ")})`);const g=r.apply(this,p);return d.trace(`GlyphRenderer#${r.name} return`,g),g}}},7302:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.OptionsService=i.DEFAULT_OPTIONS=void 0;const l=n(8460),m=n(844),s=n(6114);i.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:s.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const h=["normal","bold","100","200","300","400","500","600","700","800","900"];class f extends m.Disposable{constructor(u){super(),this._onOptionChange=this.register(new l.EventEmitter),this.onOptionChange=this._onOptionChange.event;const t=Object.assign({},i.DEFAULT_OPTIONS);for(const a in u)if(a in t)try{const o=u[a];t[a]=this._sanitizeAndValidateOption(a,o)}catch(o){console.error(o)}this.rawOptions=t,this.options=Object.assign({},t),this._setupOptions()}onSpecificOptionChange(u,t){return this.onOptionChange(a=>{a===u&&t(this.rawOptions[u])})}onMultipleOptionChange(u,t){return this.onOptionChange(a=>{u.indexOf(a)!==-1&&t()})}_setupOptions(){const u=a=>{if(!(a in i.DEFAULT_OPTIONS))throw new Error(`No option with key "${a}"`);return this.rawOptions[a]},t=(a,o)=>{if(!(a in i.DEFAULT_OPTIONS))throw new Error(`No option with key "${a}"`);o=this._sanitizeAndValidateOption(a,o),this.rawOptions[a]!==o&&(this.rawOptions[a]=o,this._onOptionChange.fire(a))};for(const a in this.rawOptions){const o={get:u.bind(this,a),set:t.bind(this,a)};Object.defineProperty(this.options,a,o)}}_sanitizeAndValidateOption(u,t){switch(u){case"cursorStyle":if(t||(t=i.DEFAULT_OPTIONS[u]),!function(a){return a==="block"||a==="underline"||a==="bar"}(t))throw new Error(`"${t}" is not a valid value for ${u}`);break;case"wordSeparator":t||(t=i.DEFAULT_OPTIONS[u]);break;case"fontWeight":case"fontWeightBold":if(typeof t=="number"&&1<=t&&t<=1e3)break;t=h.includes(t)?t:i.DEFAULT_OPTIONS[u];break;case"cursorWidth":t=Math.floor(t);case"lineHeight":case"tabStopWidth":if(t<1)throw new Error(`${u} cannot be less than 1, value: ${t}`);break;case"minimumContrastRatio":t=Math.max(1,Math.min(21,Math.round(10*t)/10));break;case"scrollback":if((t=Math.min(t,4294967295))<0)throw new Error(`${u} cannot be less than 0, value: ${t}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(t<=0)throw new Error(`${u} cannot be less than or equal to 0, value: ${t}`);break;case"rows":case"cols":if(!t&&t!==0)throw new Error(`${u} must be numeric, value: ${t}`);break;case"windowsPty":t=t??{}}return t}}i.OptionsService=f},2660:function(C,i,n){var l=this&&this.__decorate||function(f,d,u,t){var a,o=arguments.length,r=o<3?d:t===null?t=Object.getOwnPropertyDescriptor(d,u):t;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(f,d,u,t);else for(var p=f.length-1;p>=0;p--)(a=f[p])&&(r=(o<3?a(r):o>3?a(d,u,r):a(d,u))||r);return o>3&&r&&Object.defineProperty(d,u,r),r},m=this&&this.__param||function(f,d){return function(u,t){d(u,t,f)}};Object.defineProperty(i,"__esModule",{value:!0}),i.OscLinkService=void 0;const s=n(2585);let h=i.OscLinkService=class{constructor(f){this._bufferService=f,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(f){const d=this._bufferService.buffer;if(f.id===void 0){const p=d.addMarker(d.ybase+d.y),g={data:f,id:this._nextId++,lines:[p]};return p.onDispose(()=>this._removeMarkerFromLink(g,p)),this._dataByLinkId.set(g.id,g),g.id}const u=f,t=this._getEntryIdKey(u),a=this._entriesWithId.get(t);if(a)return this.addLineToLink(a.id,d.ybase+d.y),a.id;const o=d.addMarker(d.ybase+d.y),r={id:this._nextId++,key:this._getEntryIdKey(u),data:u,lines:[o]};return o.onDispose(()=>this._removeMarkerFromLink(r,o)),this._entriesWithId.set(r.key,r),this._dataByLinkId.set(r.id,r),r.id}addLineToLink(f,d){const u=this._dataByLinkId.get(f);if(u&&u.lines.every(t=>t.line!==d)){const t=this._bufferService.buffer.addMarker(d);u.lines.push(t),t.onDispose(()=>this._removeMarkerFromLink(u,t))}}getLinkData(f){var d;return(d=this._dataByLinkId.get(f))===null||d===void 0?void 0:d.data}_getEntryIdKey(f){return`${f.id};;${f.uri}`}_removeMarkerFromLink(f,d){const u=f.lines.indexOf(d);u!==-1&&(f.lines.splice(u,1),f.lines.length===0&&(f.data.id!==void 0&&this._entriesWithId.delete(f.key),this._dataByLinkId.delete(f.id)))}};i.OscLinkService=h=l([m(0,s.IBufferService)],h)},8343:(C,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.createDecorator=i.getServiceDependencies=i.serviceRegistry=void 0;const n="di$target",l="di$dependencies";i.serviceRegistry=new Map,i.getServiceDependencies=function(m){return m[l]||[]},i.createDecorator=function(m){if(i.serviceRegistry.has(m))return i.serviceRegistry.get(m);const s=function(h,f,d){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(u,t,a){t[n]===t?t[l].push({id:u,index:a}):(t[l]=[{id:u,index:a}],t[n]=t)})(s,h,d)};return s.toString=()=>m,i.serviceRegistry.set(m,s),s}},2585:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.IDecorationService=i.IUnicodeService=i.IOscLinkService=i.IOptionsService=i.ILogService=i.LogLevelEnum=i.IInstantiationService=i.ICharsetService=i.ICoreService=i.ICoreMouseService=i.IBufferService=void 0;const l=n(8343);var m;i.IBufferService=(0,l.createDecorator)("BufferService"),i.ICoreMouseService=(0,l.createDecorator)("CoreMouseService"),i.ICoreService=(0,l.createDecorator)("CoreService"),i.ICharsetService=(0,l.createDecorator)("CharsetService"),i.IInstantiationService=(0,l.createDecorator)("InstantiationService"),function(s){s[s.TRACE=0]="TRACE",s[s.DEBUG=1]="DEBUG",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.OFF=5]="OFF"}(m||(i.LogLevelEnum=m={})),i.ILogService=(0,l.createDecorator)("LogService"),i.IOptionsService=(0,l.createDecorator)("OptionsService"),i.IOscLinkService=(0,l.createDecorator)("OscLinkService"),i.IUnicodeService=(0,l.createDecorator)("UnicodeService"),i.IDecorationService=(0,l.createDecorator)("DecorationService")},1480:(C,i,n)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.UnicodeService=void 0;const l=n(8460),m=n(225);i.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new l.EventEmitter,this.onChange=this._onChange.event;const s=new m.UnicodeV6;this.register(s),this._active=s.version,this._activeProvider=s}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(s){if(!this._providers[s])throw new Error(`unknown Unicode version "${s}"`);this._active=s,this._activeProvider=this._providers[s],this._onChange.fire(s)}register(s){this._providers[s.version]=s}wcwidth(s){return this._activeProvider.wcwidth(s)}getStringCellWidth(s){let h=0;const f=s.length;for(let d=0;d<f;++d){let u=s.charCodeAt(d);if(55296<=u&&u<=56319){if(++d>=f)return h+this.wcwidth(u);const t=s.charCodeAt(d);56320<=t&&t<=57343?u=1024*(u-55296)+t-56320+65536:h+=this.wcwidth(t)}h+=this.wcwidth(u)}return h}}}},y={};function k(C){var i=y[C];if(i!==void 0)return i.exports;var n=y[C]={exports:{}};return _[C].call(n.exports,n,n.exports,k),n.exports}var L={};return(()=>{var C=L;Object.defineProperty(C,"__esModule",{value:!0}),C.Terminal=void 0;const i=k(9042),n=k(3236),l=k(844),m=k(5741),s=k(8285),h=k(7975),f=k(7090),d=["cols","rows"];class u extends l.Disposable{constructor(a){super(),this._core=this.register(new n.Terminal(a)),this._addonManager=this.register(new m.AddonManager),this._publicOptions=Object.assign({},this._core.options);const o=p=>this._core.options[p],r=(p,g)=>{this._checkReadonlyOptions(p),this._core.options[p]=g};for(const p in this._core.options){const g={get:o.bind(this,p),set:r.bind(this,p)};Object.defineProperty(this._publicOptions,p,g)}}_checkReadonlyOptions(a){if(d.includes(a))throw new Error(`Option "${a}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new h.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new f.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new s.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const a=this._core.coreService.decPrivateModes;let o="none";switch(this._core.coreMouseService.activeProtocol){case"X10":o="x10";break;case"VT200":o="vt200";break;case"DRAG":o="drag";break;case"ANY":o="any"}return{applicationCursorKeysMode:a.applicationCursorKeys,applicationKeypadMode:a.applicationKeypad,bracketedPasteMode:a.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:o,originMode:a.origin,reverseWraparoundMode:a.reverseWraparound,sendFocusMode:a.sendFocus,wraparoundMode:a.wraparound}}get options(){return this._publicOptions}set options(a){for(const o in a)this._publicOptions[o]=a[o]}blur(){this._core.blur()}focus(){this._core.focus()}resize(a,o){this._verifyIntegers(a,o),this._core.resize(a,o)}open(a){this._core.open(a)}attachCustomKeyEventHandler(a){this._core.attachCustomKeyEventHandler(a)}registerLinkProvider(a){return this._core.registerLinkProvider(a)}registerCharacterJoiner(a){return this._checkProposedApi(),this._core.registerCharacterJoiner(a)}deregisterCharacterJoiner(a){this._checkProposedApi(),this._core.deregisterCharacterJoiner(a)}registerMarker(a=0){return this._verifyIntegers(a),this._core.registerMarker(a)}registerDecoration(a){var o,r,p;return this._checkProposedApi(),this._verifyPositiveIntegers((o=a.x)!==null&&o!==void 0?o:0,(r=a.width)!==null&&r!==void 0?r:0,(p=a.height)!==null&&p!==void 0?p:0),this._core.registerDecoration(a)}hasSelection(){return this._core.hasSelection()}select(a,o,r){this._verifyIntegers(a,o,r),this._core.select(a,o,r)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(a,o){this._verifyIntegers(a,o),this._core.selectLines(a,o)}dispose(){super.dispose()}scrollLines(a){this._verifyIntegers(a),this._core.scrollLines(a)}scrollPages(a){this._verifyIntegers(a),this._core.scrollPages(a)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(a){this._verifyIntegers(a),this._core.scrollToLine(a)}clear(){this._core.clear()}write(a,o){this._core.write(a,o)}writeln(a,o){this._core.write(a),this._core.write(`\r
`,o)}paste(a){this._core.paste(a)}refresh(a,o){this._verifyIntegers(a,o),this._core.refresh(a,o)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(a){this._addonManager.loadAddon(this,a)}static get strings(){return i}_verifyIntegers(...a){for(const o of a)if(o===1/0||isNaN(o)||o%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...a){for(const o of a)if(o&&(o===1/0||isNaN(o)||o%1!=0||o<0))throw new Error("This API only accepts positive integers")}}C.Terminal=u})(),L})())})(Wa);var ji={},$a={get exports(){return ji},set exports(e){ji=e}};(function(e,c){(function(_,y){e.exports=y()})(self,()=>(()=>{var _={};return(()=>{var y=_;Object.defineProperty(y,"__esModule",{value:!0}),y.FitAddon=void 0,y.FitAddon=class{activate(k){this._terminal=k}dispose(){}fit(){const k=this.proposeDimensions();if(!k||!this._terminal||isNaN(k.cols)||isNaN(k.rows))return;const L=this._terminal._core;this._terminal.rows===k.rows&&this._terminal.cols===k.cols||(L._renderService.clear(),this._terminal.resize(k.cols,k.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const k=this._terminal._core,L=k._renderService.dimensions;if(L.css.cell.width===0||L.css.cell.height===0)return;const C=this._terminal.options.scrollback===0?0:k.viewport.scrollBarWidth,i=window.getComputedStyle(this._terminal.element.parentElement),n=parseInt(i.getPropertyValue("height")),l=Math.max(0,parseInt(i.getPropertyValue("width"))),m=window.getComputedStyle(this._terminal.element),s=n-(parseInt(m.getPropertyValue("padding-top"))+parseInt(m.getPropertyValue("padding-bottom"))),h=l-(parseInt(m.getPropertyValue("padding-right"))+parseInt(m.getPropertyValue("padding-left")))-C;return{cols:Math.max(2,Math.floor(h/L.css.cell.width)),rows:Math.max(1,Math.floor(s/L.css.cell.height))}}}})(),_})())})($a);const Cn="10.0.24223.355",Is={RESET:"\x1B[0m",BLACK:"\x1B[30m",RED:"\x1B[31m",GREEN:"\x1B[32m",LIGHT_YELLOW:"\x1B[93m",YELLOW:"\x1B[33m",YELLOW_BACKGROUND:"\x1B[43m",BLUE:"\x1B[34m",PURPLE:"\x1B[35m",CYAN:"\x1B[36m",WHITE:"\x1B[37m",BOLD:"\x1B[1m",UNBOLD:"\x1B[21m",UNDERLINE:"\x1B[4m",STOP_UNDERLINE:"\x1B[24m",BLINK:"\x1B[5m"};function Ua(e){const c=_=>{const y=st.getState("USER_HOME").USER_HOME;let k=y,L="",C=0,i="",n=navigator.clipboard,l="",m=0,s=[],h=0;function f(S){k=S.replace(/\\+/g,"/"),L=k+">",C=L.length}f(y),G(e)&&f(e),ue.readFile(y+"/.cmdHistory",(S,M)=>{!S&&G(M)&&M.text().then(P=>{try{s=JSON.parse(P),h=s.length-1}catch{}})});const d=new Ui.Terminal({cursorBlink:!0,cursorStyle:"underline",allowTransparency:!0,fontFamily:"Consolas"}),u=new ji.FitAddon;d.loadAddon(u);let t;t=v("div",{className:"w-full h-full",onmousedown:w}),d.open(t);const a={cls:"Clears the screen.",dir:"Displays a list of files and subdirectories in a directory.",cd:"Displays the name of or changes the current directory.",mkdir:"Creates a directory.",rm:"Removes a directory.",print:"Prints a text file.",help:"Provides Help information for Windows commands.",exit:"Quits"};function o(){Object.keys(a).forEach(S=>{d.write(`\r
`+S+"	"+a[S])}),d.write(`\r
`),g()}const r=`[Version ${Cn}]`;function p(){return Is.GREEN+L+Is.WHITE}function g(){d.write(`\r
`+p())}r.split(`
`).map(S=>d.writeln(S)),g(),d.onKey(({key:S,domEvent:M})=>{const P=M.key;if(!/^(?!F[0-9]).*/g.test(P))return;const H=!M.altKey&&!M.ctrlKey&&!M.metaKey;if(M.ctrlKey){const N=P.toLowerCase();N==="l"?d.clear():N==="a"?d.selectAll():N==="c"?d.hasSelection()?E():(l="",g()):N==="v"&&T();return}if(P===De.ArrowLeft)d.buffer.active.cursorX>C&&d.write("\x1B[1D");else if(P===De.ArrowRight)d.buffer.active.cursorX<l.length+C&&d.write("\x1B[1C");else if(P===De.ArrowUp)s.length>0&&(l=s[h],d.write("\x1B[2K\r"+p()+l),h>0&&(h-=1));else if(P===De.ArrowDown)h+1<s.length&&(h+=1,l=s[h],d.write("\x1B[2K\r"+p()+l));else if(P===De.BackSpace){if(d.buffer.active.cursorX>C)if(d.buffer.active.cursorX===C+l.length)l=l.slice(0,-1),d.write("\b \b");else{const N=l.slice(0,d.buffer.active.cursorX-C-1),F=l.slice(d.buffer.active.cursorX-C);l=N+F,m=C+l.length-d.buffer.active.cursorX+1,d.write("\x1B[2K\r"+p()+l+"\x1B["+m+"D")}}else if(P===De.Delete){if(d.buffer.active.cursorX>=C&&d.buffer.active.cursorX<C+l.length){const N=L+l,F=N.slice(C,d.buffer.active.cursorX),b=N.slice(d.buffer.active.cursorX+1,N.length);l=F+b,m=C+l.length-d.buffer.active.cursorX,d.write("\x1B[2K\r"+p()+l+(b.length>0?"\x1B["+m+"D":""))}}else if(P===De.Home)d.buffer.active.cursorX>C&&(m=d.buffer.active.cursorX-C,d.write("\x1B["+m+"D"));else if(P===De.End){const N=L+l;d.buffer.active.cursorX<N.length&&(m=N.length-d.buffer.active.cursorX,d.write("\x1B["+m+"C"))}else{if(P===De.Insert)return;if(P===De.Enter)l.replace(/^\s+|\s+$/g,"").length!=0?I(l):g(),l="";else{if(P===De.Tab)return;if(H){if(d.buffer.active.cursorX===C+l.length)l+=S,d.write(S);else if(d.buffer.active.cursorX<C+l.length){const N=L+l,F=N.slice(C,d.buffer.active.cursorX),b=N.slice(d.buffer.active.cursorX,N.length);l=F+S+b,m=C+l.length-d.buffer.active.cursorX-1,d.write("\x1B[2K\r"+p()+l+(b.length>0?"\x1B["+m+"D":""))}}}}});function E(){i=d.getSelection(),n.writeText(i)}function T(){n.readText().then(S=>{if(d.buffer.active.cursorX===C+l.length)d.write(S),l=l+S;else if(d.buffer.active.cursorX<C+l.length){const M=L+l,P=M.slice(C,d.buffer.active.cursorX),H=M.slice(d.buffer.active.cursorX,M.length);l=P+S+H,m=C+l.length-d.buffer.active.cursorX,d.write("\x1B[2K\r"+p()+l+(H.length>0?"\x1B["+m+"D":""))}})}function w(S){S.button===2&&(d.hasSelection()?(E(),d.clearSelection()):T())}function x(S){const M=S.replace(/\\+/g,"/").replace(/\/+/g,"/").split("/").filter(H=>H!=="");let P=k.split("/").filter(H=>H!=="");for(let H of M)H==="~"?P=y.split("/").filter(N=>N!==""):H===".."?P.length-1>0&&P.splice(P.length-1,1):P.push(H);return P.join("/")}function I(S){u.fit(),h=s.push(S)-1,ue.writeFile(y+"/.cmdHistory",new Blob([JSON.stringify(s)]));let M=[];if(S.indexOf('"')>-1?M=S.split('"'):S.indexOf("'")>-1?M=S.split("'"):M=S.split(" "),M=M.filter(N=>N!==""),!M.length)return;const P=M[0].replace(/\s+/g,"");let H=M[1];if(G(a[P])){if(P==="dir"){let N=function(){d.write(`\r
The system cannot find the path specified.
`),g()},F=function(b){ue.readFolder(b,(D,R)=>{if(D)B(D);else{d.write(`\r
Directory of `+b+`
`);const O=R.some(X=>X.type!=="folder"),z=R.some(X=>X.type==="folder"),W=R.every(X=>X.type!=="folder"),j=R.every(X=>X.type==="folder");R.forEach(X=>{const ie=new Date(X.mdate);d.write(`\r
`+Hi(ie)+"  "+Et(ie)+"	"+(O&&z?(X.type==="folder"?"<DIR> 	 	":" 	")+(Oi(X.size)?X.size.toPrecision()+"	":""):(j&&X.type==="folder"?"<DIR>	":"")+(W&&Oi(X.size)?X.size.toPrecision()+"		":""))+X.name)}),d.write(`\r
`),g()}})};if(H||(H=k),Ge(H)||_t(H))F(H);else if($t(H)){const b=x(H);F(b)}else N()}else if(P==="exit")g(),setTimeout(()=>{_.close()},200);else if(P==="cls")d.clear(),l="",d.write("\x1B[2K\r"+p());else if(P==="help")o();else if(P==="cd"){let N=function(){d.write(`\r
The system cannot find the path specified.
`),g()};if(!H)N();else if(Ge(H)||_t(H))ue.stats(H,F=>{F?(d.write(`\r
`+F.message),N()):(f(H),g())});else if($t(H)){const F=x(H);ue.stats(F,b=>{b?N():(f(F),g())})}else N()}else if(P==="mkdir"){let N=function(F){F?d.write(`\r
`+F+`
`):d.write(`\r
The system cannot find the path specified.
`),g()};if(!H)N();else if(Ge(H))ue.createFolder(H,F=>{F?N(F.message):g()});else if($t(H)){const F=x(H);ue.createFolder(F,b=>{b?N(b.message):g()})}else _t(H)?(d.write(`\r
Folder already exisist!`),g()):N()}else if(P==="rm"){let N=function(F){F?d.write(`\r
`+F+`
`):d.write(`\r
The system cannot find the path specified.
`),g()};if(!H)N();else{let F=function(b,D,R=0){const O=D[R];if(!G(O)){g();return}ue.unlink(b+"/"+O.name,z=>{z?(N(z.message),g()):F(b,D,R+1)})};if(H=H.trim(),H==="*")ue.readFolder(k,(b,D)=>{b?(N(b.message),g()):F(k,D),g()});else if(Ge(H)){const b=H.replace(/\\+/g,"/").replace(/\/+/g,"/");if(k.indexOf(b)>-1){N("Can not execute this action!");return}ue.unlink(b,D=>{D?N(D.message):g()})}else if($t(H)){const b=x(H);if(k.indexOf(b)>-1){N("Can not execute this action!");return}ue.unlink(b,D=>{D?N(D.message):g()})}else N()}}else if(P==="print"){let N=function(b){b?d.write(`\r
`+b+`
`):d.write(`\r
The system cannot find the path specified.
`),g()},F=function(b){if(k.indexOf(b)>-1){N("Can not execute this action!");return}ue.readFile(b,(D,R)=>{D?N(D.message):G(R)?R.size>1e4?(d.write(`\r
Name: `+(R.name||nt(b))+" Size: "+R.size),g()):R.text().then(O=>{const z=O.split(`
`);for(let W of z)d.write(`\r
`+W);d.write(`\r
`),g()}):N()})};if(!H)N();else if(Ge(H)){const b=H.replace(/\\+/g,"/").replace(/\/+/g,"/");F(b)}else if($t(H)){const b=x(H);F(b)}else N()}}else G(yi[P])?(g(),yi[P](H)):(d.write(`\r
"`+P+`" is not recognized as an internal or external command, operable program or batch file.
`),d.write(`\r
Type "help" for available commands
`),g())}function B(S){d.write(`\r
`+S.message+`
`),g()}return _.addEventListener("focus",()=>{d.focus()}),_.addEventListener("close",()=>{d.dispose()}),_.addEventListener("passiveResize",Ns(()=>{u.fit()},200)),_.addEventListener("ready",()=>{u.fit()}),t};at({icon:se.cmd.icon,name:se.cmd.name,title:se.cmd.productName,top:100,left:100,width:800,height:450,center:!0,content:c,className:"cmd-app",extendContextMenu:[{divider:!0},{text:"Properties"}]})}function ja(e){at({args:e,icon:At.mediaPlayer.icon,hideIcon:!0,name:At.mediaPlayer.name,title:At.mediaPlayer.productName,autoHideTitleBar:!0,top:50,left:50,width:800,height:480,minWidth:300,minHeight:100,center:!0,singleInstance:!0,content:c=>{let _;function y(k){const L=vt(k);if(L===".mkv"||L===".mp4"||L===".webm"){const C=v("div",{className:"w-full h-full relative"},[v("video",{className:"w-full h-full",controls:!0,autoplay:!0,style:{objectFit:"contain"},mySrc:k})]);return c.setSize({width:800,height:480}),c.setTitle(nt(k)),C}if(L===".mp3"||L===".aac"||L===".m4a"||L===".ogg"||L===".flac"||L===".wav"){const C=v("div",{className:"w-full h-full relative p-20"},[v("audio",{className:"w-full h-full",controls:!0,autoplay:!0,mySrc:k})]);return c.setSize({width:800,height:124}),c.setTitle(nt(k)),C}return v("div",{},"Not supported file")}return c.addEventListener("secondInstance",k=>{_=y(k),c.setContent(_),c.isVisible()||c.show(),c.focus()}),c.addEventListener("ready",()=>{_=y(e),c.setContent(_)}),null}})}function Va(e){if(!G(e)){He("photos");return}at({args:e,icon:At.photoViewer.icon,hideIcon:!0,name:At.photoViewer.name,title:At.photoViewer.productName,hideTitle:!0,top:50,left:50,width:800,height:480,minWidth:580,minHeight:200,center:!0,singleInstance:!0,titlebarHeight:40,stretchTitlebarContent:!0,transprencyContent:!0,content:c=>{let _,y,k,L,C,i,n,l,m=0,s=0,h=0,f=0,d=0,u=0,t=0,a=0,o,r=0,p=0,g=0,E=0;y=v("div",{className:"photo-viewer-titlebar-content w-full h-full flex items-center"},[v("div",{className:"flex items-center flex-1 h-full"},[v("div",{className:"photo-viewer-titlebar-home flex items-center content-center flex-shrink-0",style:{width:"40px",height:"40px"},innerHTML:Gs(20),onclick(){He("photos")}}),v("div",{["drag-region"]:"drag",className:"w-full h-full flex items-center",style:{padding:"0 10px"}},k=v("div",{className:"text-ellipsis line-clamp-1"}))]),v("div",{className:"flex items-center content-center h-full"},[v("div",{title:"Edit Image",className:"photo-viewer-titlebar-content-button",innerHTML:$r()}),v("div",{title:"Rotate",className:"photo-viewer-titlebar-content-button",innerHTML:Sr}),v("div",{title:"Delete",className:"photo-viewer-titlebar-content-button",innerHTML:Gr()}),v("div",{title:"Add to favorites",className:"photo-viewer-titlebar-content-button",innerHTML:Yr()}),v("div",{title:"Print",className:"photo-viewer-titlebar-content-button",innerHTML:Jr()}),v("div",{title:"Share",className:"photo-viewer-titlebar-content-button",innerHTML:Zr()}),v("div",{title:"More options",className:"photo-viewer-titlebar-content-button",innerHTML:Xs(),onclick(W){const j=W.currentTarget,X=j.getBoundingClientRect();Ot({top:X.top+X.height,left:X.left},j,[{text:"Set as desktop wallpaper",onClick(){Ge(l)?Ki(l,(A,$)=>{A||ie(URL.createObjectURL($))}):ie(l);function ie(A){ln(A,($,q)=>{const V=nt(l),Z=st.getState("USER_HOME").USER_HOME+"/AppData/Microsoft/Windows/Desktop/Background/"+"Thumbnails/"+V;ue.writeFile(Z,q,()=>{We.setBackgroundImage({name:V,path:l,thumbnailPath:Z})})})}c.focus()}},{text:"Resize image",onClick(){c.focus()}},{text:"Copy as path",onClick(){c.focus()}},{text:"Settings",onClick(){c.focus()}}],!1)}})]),v("div",{["drag-region"]:"drag",className:"flex items-center flex-1 h-full"})]),c.titlebar.setTitlebarContent(y),_=v("div",{className:"w-full h-full",style:{position:"relative",paddingBottom:"40px"}},[C=v("div",{className:"w-full h-full flex items-center content-center",style:{position:"relative",overflow:"hidden"},onwheel:B},L=v("div",{className:"photo-viewer-container w-full h-full",onmousedown:w})),v("div",{className:"photo-viewer-bottom flex items-center"},[v("div",{}),v("div",{className:"flex items-center",style:{marginLeft:"auto"}},[i=v("div",{style:{paddingRight:"10px"}}),v("div",{title:"Zoom out",className:"photo-viewer-bottom-button",innerHTML:Vr(18),onclick:()=>{F(-1)}}),v("div",{title:"Zoom in",className:"photo-viewer-bottom-button",innerHTML:jr(18),onclick:()=>{F(1)}}),v("div",{title:"Zoom to fit",className:"photo-viewer-bottom-button",innerHTML:Kr(18),onclick:H}),v("div",{title:"Zoom to actual size",className:"photo-viewer-bottom-button",innerHTML:qr(18),onclick:N}),v("div",{title:"Fullscreen",className:"photo-viewer-bottom-button",innerHTML:Xr(14),onclick:()=>{c.toggleFullscreen()}})])])]);function T(W){const j=vt(W);if(!an(j)){L.textContent="Not supported file";return}zo(W,ie=>{G(ie)&&(l=W,L.textContent="",L.style.myBackgroundImage=W,o=ie,M(),(o.width>n.width||o.height>n.height)&&H(),o.width<n.width&&o.height<n.height&&P())});const X=nt(W);c.setTitle(X),k.textContent=X}function w(W){W.button===0&&(W.preventDefault(),g=W.clientX,E=W.clientY,document.onmouseup=I,document.onmousemove=x)}function x(W){r=g-W.clientX,p=E-W.clientY,g=W.clientX,E=W.clientY;const j=L.offsetTop-p,X=L.offsetLeft-r;h>n.width&&(X>0?s=0:X+h<n.width?s=n.width-h:s=X,L.style.left=s+"px"),f>n.height&&(j>0?m=0:j+f<n.height?m=n.height-f:m=j,L.style.top=m+"px")}function I(){document.onmouseup=null,document.onmousemove=null}function B(W){let j=W.deltaY>0?-1:1;t=W.offsetX,a=W.offsetY,F(j)}function S(){n={width:C.offsetWidth,height:C.offsetHeight}}function M(){if(R())u=100;else{const W=n.width/n.height;let j=0;W<o.ratio?j=n.width:j=n.height*o.ratio,u=j/o.width*100}}function P(){m=(n.height-o.height)/2,s=(n.width-o.width)/2,h=o.width,f=o.height,u=100,d=100,de(L,{top:m+"px",left:s+"px",width:h+"px",height:f+"px"}),D()}function H(){S();const W=n.width/n.height,j={};if(W<o.ratio){const X=n.width/o.ratio;m=(n.height-X)/2,s=0,h=n.width,f=X}else{const X=n.height*o.ratio,ie=(n.width-X)/2;m=0,s=ie,h=X,f=n.height}d=h/o.width*100,h<n.width&&f<n.height?u=100:u=d,j.top=m+"px",j.left=s+"px",j.width=h+"px",j.height=f+"px",D(),de(L,j)}function N(){b(100)}function F(W){h<n.width&&(t=h/2),f<n.height&&(a=f/2);let j=h+h*.1*W;(h<o.width&&o.width<j||h>o.width&&o.width>j)&&(j=o.width);let X=t/h,ie=a/f,A=j/o.width*100;A<u&&(A=u,j=A*o.width/100),A>5e3&&(A=5e3,j=A*o.width/100),d=A,h=j,f=h/o.ratio;let $=X*h-t,q=ie*f-a;s-=$,m-=q,W===-1&&(h>n.width?(s>0&&(s=0),s+h<n.width&&(s=n.width-h)):s=(n.width-h)/2,f>n.height?(m>0&&(m=0),m+f<n.height&&(m=n.height-f)):m=(n.height-f)/2),h<n.width&&f<n.height&&(m=(n.height-f)/2,s=(n.width-h)/2),de(L,{width:h+"px",height:f+"px",top:m+"px",left:s+"px"}),D()}function b(W){const j=W*o.width/100,X=j/o.ratio,ie=.5*j-h/2,A=.5*X-f/2;d=W,m-=A,s-=ie,h=j,f=X,de(L,{top:m+"px",left:s+"px",width:h+"px",height:f+"px"}),D()}function D(){i.textContent=Math.round(d)+" %"}function R(){return S(),o.width<n.width&&o.height<n.height}function O(){d===u?R()?P():H():d>u&&(M(),s>0&&(s=0,L.style.left=s+"px"),h+s<n.width&&(s=(n.width-h)/2,L.style.left=s+"px"),m>0&&(m=0,L.style.top=m+"px"),f+m<n.height&&(m=(n.height-f)/2,L.style.top=m+"px"))}function z(){setTimeout(()=>{O()},250)}return c.addEventListener("resize",ar(()=>{O()},50)),c.addEventListener("maximize",()=>{z()}),c.addEventListener("unmaximize",()=>{z()}),c.addEventListener("snap",()=>{z()}),c.addEventListener("unSnap",()=>{z()}),c.addEventListener("restore",()=>{z()}),c.addEventListener("fullscreen",()=>{z()}),c.addEventListener("secondInstance",W=>{c.isVisible()||c.show(),c.focus(),T(W)}),c.addEventListener("ready",()=>{c.setContent(_),T(e)}),null}})}const yi={settings:Fa,explorer:oa,notepad:la,word:()=>{qe(se.word)},powerpoint:()=>{qe(se.powerpoint)},onenote:()=>{qe(se.onenote)},mail:()=>{qe(se.mail)},todo:()=>{qe(se.todo)},store:()=>{qe(se.store)},photos:ba,photoViewer:Va,mediaPlayer:ja,yourphone:()=>{qe(se.yourphone)},whiteboard:()=>{qe(se.whiteboard)},calculator:za,spotify:()=>{qe(se.spotify)},twitter:()=>{qe(se.twitter)},vscode:()=>{qe(se.vscode)},terminal:()=>{qe(se.terminal)},cmd:Ua,github:()=>{qe(se.github)},discord:()=>{qe(se.discord)}};String.prototype.toFirstUpperCase=function(){return this.charAt(0).toUpperCase()+this.substring(1,this.length)};const Ka=localStorage.getItem("OS_VERSION");G(Ka)||(ve.reset(),localStorage.setItem("OS_VERSION",Cn));or&&document.documentElement.classList.add("isWebkit");document.documentElement.style.setProperty("--taskbar-height",Fe.toString()+"px");document.addEventListener("dragover",e=>{e.preventDefault()});document.addEventListener("drop",e=>{e.preventDefault()});document.addEventListener("contextmenu",e=>{e.preventDefault()});const Ye=ve.getState();Ye.recentImages||(Ye.recentImages=[$e[15],$e[9],$e[21],$e[0],$e[8]]);let Si=Ye.themeIndex>-1?Ye.themes[Ye.themeIndex]:Ye.customTheme;G(Si)||(Si=Ye.themes[0],ve.setState({themeIndex:0}));G(Ye.brightness)&&Qt.setBrightness(Ye.brightness);Ye.nightlight&&Qt.setNightLight(Ye.nightlight);zi(Ye.roundedCorner);cn(Ye.useBorder);un(Si);dn(Si.background.thumbnailPath);function fi(e,c){const _=yi[e];G(_)?yi[e](c):fn()}function qa(e){if(e.type==="link")window.open(e.args,"_blank");else if(e.type==="app")fi(e.name,e.args);else if(e.type==="file"){const c=Pt(As(e.args));fi(c.appName,e.args)}else e.type==="folder"&&fi(se.explorer.name,e.args)}Be(re.createWindow,"index",({appName:e,args:c})=>{fi(e,c)});Be(re.startProcess,"index",e=>{qa(e)});Be(re.backgroundImageChange,"index",e=>{dn(e.thumbnailPath)});
